(function(){
shadow$provide[579]=function(za,ea,bb,P){function A(q,E,G){var K,T={},k=null,l=null;void 0!==G&&(k=""+G);void 0!==E.key&&(k=""+E.key);void 0!==E.ref&&(l=E.ref);for(K in E)w.call(E,K)&&!b.hasOwnProperty(K)&&(T[K]=E[K]);if(q&&q.defaultProps)for(K in E=q.defaultProps,E)void 0===T[K]&&(T[K]=E[K]);return{$$typeof:Y,type:q,key:k,ref:l,props:T,_owner:F.current}}ea(216);za=ea(22);var Y=60103;P.Fragment=60107;"function"===typeof Symbol&&Symbol.for&&(ea=Symbol.for,Y=ea("react.element"),P.Fragment=ea("react.fragment"));
var F=za.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w=Object.prototype.hasOwnProperty,b={key:!0,ref:!0,__self:!0,__source:!0};P.jsx=A;P.jsxs=A};
shadow$provide[581]=function(za,ea,bb,P){bb.exports=ea(579)};
shadow$provide[582]=function(za,ea,bb,P){function A(Xa){for(var xb="https://reactjs.org/docs/error-decoder.html?invariant\x3d"+Xa,qb=1;qb<arguments.length;qb++)xb+="\x26args[]\x3d"+encodeURIComponent(arguments[qb]);return"Minified React error #"+Xa+"; visit "+xb+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Y(Xa){if(null==Xa)return null;if("function"===typeof Xa)return Xa.displayName||Xa.name||null;if("string"===typeof Xa)return Xa;
switch(Xa){case t:return"Fragment";case z:return"Portal";case I:return"Profiler";case L:return"StrictMode";case ja:return"Suspense";case X:return"SuspenseList"}if("object"===typeof Xa)switch(Xa.$$typeof){case Q:return(Xa.displayName||"Context")+".Consumer";case R:return(Xa._context.displayName||"Context")+".Provider";case N:var xb=Xa.render;xb=xb.displayName||xb.name||"";return Xa.displayName||(""!==xb?"ForwardRef("+xb+")":"ForwardRef");case Z:return Y(Xa.type);case W:return Y(Xa._render);case aa:xb=
Xa._payload;Xa=Xa._init;try{return Y(Xa(xb))}catch(qb){}}return null}function F(Xa,xb){for(var qb=Xa._threadCount|0;qb<=xb;qb++)Xa[qb]=Xa._currentValue2,Xa._threadCount=qb+1}function w(Xa,xb,qb,ac){if(ac&&(ac=Xa.contextType,"object"===typeof ac&&null!==ac))return F(ac,qb),ac[qb];if(Xa=Xa.contextTypes){qb={};for(var ic in Xa)qb[ic]=xb[ic];xb=qb}else xb=wa;return xb}function b(Xa){if(Ja.call(db,Xa))return!0;if(Ja.call(Qa,Xa))return!1;if(xa.test(Xa))return db[Xa]=!0;Qa[Xa]=!0;return!1}function q(Xa,
xb,qb,ac){if(null!==qb&&0===qb.type)return!1;switch(typeof xb){case "function":case "symbol":return!0;case "boolean":if(ac)return!1;if(null!==qb)return!qb.acceptsBooleans;Xa=Xa.toLowerCase().slice(0,5);return"data-"!==Xa&&"aria-"!==Xa;default:return!1}}function E(Xa,xb,qb,ac){if(null===xb||"undefined"===typeof xb||q(Xa,xb,qb,ac))return!0;if(ac)return!1;if(null!==qb)switch(qb.type){case 3:return!xb;case 4:return!1===xb;case 5:return isNaN(xb);case 6:return isNaN(xb)||1>xb}return!1}function G(Xa,xb,
qb,ac,ic,yb,Nb){this.acceptsBooleans=2===xb||3===xb||4===xb;this.attributeName=ac;this.attributeNamespace=ic;this.mustUseProperty=qb;this.propertyName=Xa;this.type=xb;this.sanitizeURL=yb;this.removeEmptyString=Nb}function K(Xa){return Xa[1].toUpperCase()}function T(Xa){if("boolean"===typeof Xa||"number"===typeof Xa)return""+Xa;Xa=""+Xa;var xb=Fa.exec(Xa);if(xb){var qb="",ac,ic=0;for(ac=xb.index;ac<Xa.length;ac++){switch(Xa.charCodeAt(ac)){case 34:xb="\x26quot;";break;case 38:xb="\x26amp;";break;case 39:xb=
"\x26#x27;";break;case 60:xb="\x26lt;";break;case 62:xb="\x26gt;";break;default:continue}ic!==ac&&(qb+=Xa.substring(ic,ac));ic=ac+1;qb+=xb}Xa=ic!==ac?qb+Xa.substring(ic,ac):qb}return Xa}function k(Xa,xb){var qb=Ca.hasOwnProperty(Xa)?Ca[Xa]:null,ac;if(ac="style"!==Xa)ac=null!==qb?0===qb.type:!(2<Xa.length)||"o"!==Xa[0]&&"O"!==Xa[0]||"n"!==Xa[1]&&"N"!==Xa[1]?!1:!0;if(ac||E(Xa,xb,qb,!1))return"";if(null!==qb){Xa=qb.attributeName;ac=qb.type;if(3===ac||4===ac&&!0===xb)return Xa+'\x3d""';qb.sanitizeURL&&
(xb=""+xb);return Xa+'\x3d"'+(T(xb)+'"')}return b(Xa)?Xa+'\x3d"'+(T(xb)+'"'):""}function l(Xa,xb){return Xa===xb&&(0!==Xa||1/Xa===1/xb)||Xa!==Xa&&xb!==xb}function a(){if(null===la)throw Error(A(321));return la}function h(){if(0<Ua)throw Error(A(312));return{memoizedState:null,queue:null,next:null}}function n(){null===ta?null===va?(oa=!1,va=ta=h()):(oa=!0,ta=va):null===ta.next?(oa=!1,ta=ta.next=h()):(oa=!0,ta=ta.next);return ta}function p(Xa,xb,qb,ac){for(;Ma;)Ma=!1,Ua+=1,ta=null,qb=Xa(xb,ac);C();
return qb}function C(){la=null;Ma=!1;va=null;Ua=0;ta=Ta=null}function x(Xa,xb){return"function"===typeof xb?xb(Xa):xb}function u(Xa,xb,qb){la=a();ta=n();if(oa){var ac=ta.queue;xb=ac.dispatch;if(null!==Ta&&(qb=Ta.get(ac),void 0!==qb)){Ta.delete(ac);ac=ta.memoizedState;do ac=Xa(ac,qb.action),qb=qb.next;while(null!==qb);ta.memoizedState=ac;return[ac,xb]}return[ta.memoizedState,xb]}Xa=Xa===x?"function"===typeof xb?xb():xb:void 0!==qb?qb(xb):xb;ta.memoizedState=Xa;Xa=ta.queue={last:null,dispatch:null};
Xa=Xa.dispatch=e.bind(null,la,Xa);return[ta.memoizedState,Xa]}function g(Xa,xb){la=a();ta=n();xb=void 0===xb?null:xb;if(null!==ta){var qb=ta.memoizedState;if(null!==qb&&null!==xb){var ac=qb[1];a:if(null===ac)ac=!1;else{for(var ic=0;ic<ac.length&&ic<xb.length;ic++)if(!ka(xb[ic],ac[ic])){ac=!1;break a}ac=!0}if(ac)return qb[0]}}Xa=Xa();ta.memoizedState=[Xa,xb];return Xa}function e(Xa,xb,qb){if(!(25>Ua))throw Error(A(301));if(Xa===la)if(Ma=!0,Xa={action:qb,next:null},null===Ta&&(Ta=new Map),qb=Ta.get(xb),
void 0===qb)Ta.set(xb,Xa);else{for(xb=qb;null!==xb.next;)xb=xb.next;xb.next=Xa}}function H(){}function B(Xa){switch(Xa){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function J(Xa){if(void 0===Xa||null===Xa)return Xa;var xb="";O.Children.forEach(Xa,function(qb){null!=qb&&(xb+=qb)});return xb}function V(Xa,xb){if(void 0===Xa)throw Error(A(152,Y(xb)||"Component"));}function y(Xa,xb,qb){function ac(Nb,
Cb){var kb=Cb.prototype&&Cb.prototype.isReactComponent,ub=w(Cb,xb,qb,kb),zb=[],ib=!1,rb={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===zb)return null},enqueueReplaceState:function(Jc,pd){ib=!0;zb=[pd]},enqueueSetState:function(Jc,pd){if(null===zb)return null;zb.push(pd)}};if(kb){if(kb=new Cb(Nb.props,ub,rb),"function"===typeof Cb.getDerivedStateFromProps){var Db=Cb.getDerivedStateFromProps.call(null,Nb.props,kb.state);null!=Db&&(kb.state=S({},kb.state,Db))}}else if(la={},
kb=Cb(Nb.props,ub,rb),kb=p(Cb,Nb.props,kb,ub),null==kb||null==kb.render){Xa=kb;V(Xa,Cb);return}kb.props=Nb.props;kb.context=ub;kb.updater=rb;rb=kb.state;void 0===rb&&(kb.state=rb=null);if("function"===typeof kb.UNSAFE_componentWillMount||"function"===typeof kb.componentWillMount)if("function"===typeof kb.componentWillMount&&"function"!==typeof Cb.getDerivedStateFromProps&&kb.componentWillMount(),"function"===typeof kb.UNSAFE_componentWillMount&&"function"!==typeof Cb.getDerivedStateFromProps&&kb.UNSAFE_componentWillMount(),
zb.length){rb=zb;var cc=ib;zb=null;ib=!1;if(cc&&1===rb.length)kb.state=rb[0];else{Db=cc?rb[0]:kb.state;var bc=!0;for(cc=cc?1:0;cc<rb.length;cc++){var Dc=rb[cc];Dc="function"===typeof Dc?Dc.call(kb,Db,Nb.props,ub):Dc;null!=Dc&&(bc?(bc=!1,Db=S({},Db,Dc)):S(Db,Dc))}kb.state=Db}}else zb=null;Xa=kb.render();V(Xa,Cb);if("function"===typeof kb.getChildContext&&(Nb=Cb.childContextTypes,"object"===typeof Nb)){var nc=kb.getChildContext(),Oc;for(Oc in nc)if(!(Oc in Nb))throw Error(A(108,Y(Cb)||"Unknown",Oc));
}nc&&(xb=S({},xb,nc))}for(;O.isValidElement(Xa);){var ic=Xa,yb=ic.type;if("function"!==typeof yb)break;ac(ic,yb)}return{child:Xa,context:xb}}var S=ea(216),O=ea(22),z=60106,t=60107,L=60108,I=60114,R=60109,Q=60110,N=60112,ja=60113,X=60120,Z=60115,aa=60116,W=60121,ha=60117,da=60119,fa=60129,ra=60131;"function"===typeof Symbol&&Symbol.for&&(za=Symbol.for,z=za("react.portal"),t=za("react.fragment"),L=za("react.strict_mode"),I=za("react.profiler"),R=za("react.provider"),Q=za("react.context"),N=za("react.forward_ref"),
ja=za("react.suspense"),X=za("react.suspense_list"),Z=za("react.memo"),aa=za("react.lazy"),W=za("react.block"),ha=za("react.fundamental"),da=za("react.scope"),fa=za("react.debug_trace_mode"),ra=za("react.legacy_hidden"));za=O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;var wa={},sa=new Uint16Array(16);for(ea=0;15>ea;ea++)sa[ea]=ea+1;sa[15]=0;var xa=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,
Ja=Object.prototype.hasOwnProperty,Qa={},db={},Ca={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(Xa){Ca[Xa]=new G(Xa,0,!1,Xa,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(Xa){var xb=Xa[0];Ca[xb]=new G(xb,1,!1,Xa[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(Xa){Ca[Xa]=
new G(Xa,2,!1,Xa.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(Xa){Ca[Xa]=new G(Xa,2,!1,Xa,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(Xa){Ca[Xa]=new G(Xa,3,!1,Xa.toLowerCase(),null,!1,!1)});["checked",
"multiple","muted","selected"].forEach(function(Xa){Ca[Xa]=new G(Xa,3,!0,Xa,null,!1,!1)});["capture","download"].forEach(function(Xa){Ca[Xa]=new G(Xa,4,!1,Xa,null,!1,!1)});["cols","rows","size","span"].forEach(function(Xa){Ca[Xa]=new G(Xa,6,!1,Xa,null,!1,!1)});["rowSpan","start"].forEach(function(Xa){Ca[Xa]=new G(Xa,5,!1,Xa.toLowerCase(),null,!1,!1)});var Na=/[\-:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(Xa){var xb=
Xa.replace(Na,K);Ca[xb]=new G(xb,1,!1,Xa,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(Xa){var xb=Xa.replace(Na,K);Ca[xb]=new G(xb,1,!1,Xa,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(Xa){var xb=Xa.replace(Na,K);Ca[xb]=new G(xb,1,!1,Xa,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(Xa){Ca[Xa]=new G(Xa,1,!1,Xa.toLowerCase(),null,!1,!1)});
Ca.xlinkHref=new G("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(Xa){Ca[Xa]=new G(Xa,1,!1,Xa.toLowerCase(),null,!0,!0)});var Fa=/["'&<>]/,ka="function"===typeof Object.is?Object.is:l,la=null,va=null,ta=null,oa=!1,Ma=!1,Ta=null,Ua=0,Pa=null,cb={readContext:function(Xa){var xb=Pa.threadID;F(Xa,xb);return Xa[xb]},useContext:function(Xa){a();var xb=Pa.threadID;F(Xa,xb);return Xa[xb]},useMemo:g,useReducer:u,useRef:function(Xa){la=
a();ta=n();var xb=ta.memoizedState;return null===xb?(Xa={current:Xa},ta.memoizedState=Xa):xb},useState:function(Xa){return u(x,Xa)},useLayoutEffect:function(){},useCallback:function(Xa,xb){return g(function(){return Xa},xb)},useImperativeHandle:H,useEffect:H,useDebugValue:H,useDeferredValue:function(Xa){a();return Xa},useTransition:function(){a();return[function(Xa){Xa()},!1]},useOpaqueIdentifier:function(){return(Pa.identifierPrefix||"")+"R:"+(Pa.uniqueID++).toString(36)},useMutableSource:function(Xa,
xb){a();return xb(Xa._source)}},gb={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Lb=S({menuitem:!0},gb),Eb={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,
gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Da=["Webkit","ms","Moz","O"];Object.keys(Eb).forEach(function(Xa){Da.forEach(function(xb){xb=xb+Xa.charAt(0).toUpperCase()+Xa.substring(1);Eb[xb]=Eb[Xa]})});var pb=/([A-Z])/g,jb=/^ms-/,Za=O.Children.toArray,
hb=za.ReactCurrentDispatcher,Ya={listing:!0,pre:!0,textarea:!0},ec=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Uc={},Rc={},Fc=Object.prototype.hasOwnProperty,Ic={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null},Sa=function(){function Xa(qb,ac,ic){O.isValidElement(qb)?qb.type!==t?qb=[qb]:(qb=qb.props.children,qb=O.isValidElement(qb)?[qb]:Za(qb)):qb=Za(qb);qb={type:null,domNamespace:"http://www.w3.org/1999/xhtml",children:qb,childIndex:0,context:wa,footer:""};
var yb=sa[0];if(0===yb){var Nb=sa;yb=Nb.length;var Cb=2*yb;if(!(65536>=Cb))throw Error(A(304));var kb=new Uint16Array(Cb);kb.set(Nb);sa=kb;sa[0]=yb+1;for(Nb=yb;Nb<Cb-1;Nb++)sa[Nb]=Nb+1;sa[Cb-1]=0}else sa[0]=sa[yb];this.threadID=yb;this.stack=[qb];this.exhausted=!1;this.currentSelectValue=null;this.previousWasTextNode=!1;this.makeStaticMarkup=ac;this.suspenseDepth=0;this.contextIndex=-1;this.contextStack=[];this.contextValueStack=[];this.uniqueID=0;this.identifierPrefix=ic&&ic.identifierPrefix||""}
var xb=Xa.prototype;xb.destroy=function(){if(!this.exhausted){this.exhausted=!0;this.clearProviders();var qb=this.threadID;sa[qb]=sa[0];sa[0]=qb}};xb.pushProvider=function(qb){var ac=++this.contextIndex,ic=qb.type._context,yb=this.threadID;F(ic,yb);var Nb=ic[yb];this.contextStack[ac]=ic;this.contextValueStack[ac]=Nb;ic[yb]=qb.props.value};xb.popProvider=function(){var qb=this.contextIndex,ac=this.contextStack[qb],ic=this.contextValueStack[qb];this.contextStack[qb]=null;this.contextValueStack[qb]=
null;this.contextIndex--;ac[this.threadID]=ic};xb.clearProviders=function(){for(var qb=this.contextIndex;0<=qb;qb--)this.contextStack[qb][this.threadID]=this.contextValueStack[qb]};xb.read=function(qb){if(this.exhausted)return null;var ac=Pa;Pa=this;var ic=hb.current;hb.current=cb;try{for(var yb=[""],Nb=!1;yb[0].length<qb;){if(0===this.stack.length){this.exhausted=!0;var Cb=this.threadID;sa[Cb]=sa[0];sa[0]=Cb;break}var kb=this.stack[this.stack.length-1];if(Nb||kb.childIndex>=kb.children.length){var ub=
kb.footer;""!==ub&&(this.previousWasTextNode=!1);this.stack.pop();if("select"===kb.type)this.currentSelectValue=null;else if(null!=kb.type&&null!=kb.type.type&&kb.type.type.$$typeof===R)this.popProvider(kb.type);else if(kb.type===ja){this.suspenseDepth--;var zb=yb.pop();if(Nb){Nb=!1;var ib=kb.fallbackFrame;if(!ib)throw Error(A(303));this.stack.push(ib);yb[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}else yb[this.suspenseDepth]+=zb}yb[this.suspenseDepth]+=ub}else{var rb=kb.children[kb.childIndex++],
Db="";try{Db+=this.render(rb,kb.context,kb.domNamespace)}catch(cc){if(null!=cc&&"function"===typeof cc.then)throw Error(A(294));throw cc;}finally{}yb.length<=this.suspenseDepth&&yb.push("");yb[this.suspenseDepth]+=Db}}return yb[0]}finally{hb.current=ic,Pa=ac,C()}};xb.render=function(qb,ac,ic){if("string"===typeof qb||"number"===typeof qb){ic=""+qb;if(""===ic)return"";if(this.makeStaticMarkup)return T(ic);if(this.previousWasTextNode)return"\x3c!-- --\x3e"+T(ic);this.previousWasTextNode=!0;return T(ic)}ac=
y(qb,ac,this.threadID);qb=ac.child;ac=ac.context;if(null===qb||!1===qb)return"";if(!O.isValidElement(qb)){if(null!=qb&&null!=qb.$$typeof){ic=qb.$$typeof;if(ic===z)throw Error(A(257));throw Error(A(258,ic.toString()));}qb=Za(qb);this.stack.push({type:null,domNamespace:ic,children:qb,childIndex:0,context:ac,footer:""});return""}var yb=qb.type;if("string"===typeof yb)return this.renderDOM(qb,ac,ic);switch(yb){case ra:case fa:case L:case I:case X:case t:return qb=Za(qb.props.children),this.stack.push({type:null,
domNamespace:ic,children:qb,childIndex:0,context:ac,footer:""}),"";case ja:throw Error(A(294));case da:throw Error(A(343));}if("object"===typeof yb&&null!==yb)switch(yb.$$typeof){case N:la={};var Nb=yb.render(qb.props,qb.ref);Nb=p(yb.render,qb.props,Nb,qb.ref);Nb=Za(Nb);this.stack.push({type:null,domNamespace:ic,children:Nb,childIndex:0,context:ac,footer:""});return"";case Z:return qb=[O.createElement(yb.type,S({ref:qb.ref},qb.props))],this.stack.push({type:null,domNamespace:ic,children:qb,childIndex:0,
context:ac,footer:""}),"";case R:return yb=Za(qb.props.children),ic={type:qb,domNamespace:ic,children:yb,childIndex:0,context:ac,footer:""},this.pushProvider(qb),this.stack.push(ic),"";case Q:yb=qb.type;Nb=qb.props;var Cb=this.threadID;F(yb,Cb);yb=Za(Nb.children(yb[Cb]));this.stack.push({type:qb,domNamespace:ic,children:yb,childIndex:0,context:ac,footer:""});return"";case ha:throw Error(A(338));case aa:return yb=qb.type,Nb=yb._init,yb=Nb(yb._payload),qb=[O.createElement(yb,S({ref:qb.ref},qb.props))],
this.stack.push({type:null,domNamespace:ic,children:qb,childIndex:0,context:ac,footer:""}),""}throw Error(A(130,null==yb?yb:typeof yb,""));};xb.renderDOM=function(qb,ac,ic){var yb=qb.type.toLowerCase();"http://www.w3.org/1999/xhtml"===ic&&B(yb);if(!Uc.hasOwnProperty(yb)){if(!ec.test(yb))throw Error(A(65,yb));Uc[yb]=!0}var Nb=qb.props;if("input"===yb)Nb=S({type:void 0},Nb,{defaultChecked:void 0,defaultValue:void 0,value:null!=Nb.value?Nb.value:Nb.defaultValue,checked:null!=Nb.checked?Nb.checked:Nb.defaultChecked});
else if("textarea"===yb){var Cb=Nb.value;if(null==Cb){Cb=Nb.defaultValue;var kb=Nb.children;if(null!=kb){if(null!=Cb)throw Error(A(92));if(Array.isArray(kb)){if(!(1>=kb.length))throw Error(A(93));kb=kb[0]}Cb=""+kb}null==Cb&&(Cb="")}Nb=S({},Nb,{value:void 0,children:""+Cb})}else if("select"===yb)this.currentSelectValue=null!=Nb.value?Nb.value:Nb.defaultValue,Nb=S({},Nb,{value:void 0});else if("option"===yb){kb=this.currentSelectValue;var ub=J(Nb.children);if(null!=kb){var zb=null!=Nb.value?Nb.value+
"":ub;Cb=!1;if(Array.isArray(kb))for(var ib=0;ib<kb.length;ib++){if(""+kb[ib]===zb){Cb=!0;break}}else Cb=""+kb===zb;Nb=S({selected:void 0,children:void 0},Nb,{selected:Cb,children:ub})}}if(Cb=Nb){if(Lb[yb]&&(null!=Cb.children||null!=Cb.dangerouslySetInnerHTML))throw Error(A(137,yb));if(null!=Cb.dangerouslySetInnerHTML){if(null!=Cb.children)throw Error(A(60));if(!("object"===typeof Cb.dangerouslySetInnerHTML&&"__html"in Cb.dangerouslySetInnerHTML))throw Error(A(61));}if(null!=Cb.style&&"object"!==
typeof Cb.style)throw Error(A(62));}Cb=Nb;kb=this.makeStaticMarkup;ub=1===this.stack.length;zb="\x3c"+qb.type;a:if(-1===yb.indexOf("-"))ib="string"===typeof Cb.is;else switch(yb){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":ib=!1;break a;default:ib=!0}for(pd in Cb)if(Fc.call(Cb,pd)){var rb=Cb[pd];if(null!=rb){if("style"===pd){var Db=void 0,cc="",bc="";for(Db in rb)if(rb.hasOwnProperty(Db)){var Dc=
0===Db.indexOf("--"),nc=rb[Db];if(null!=nc){if(Dc)var Oc=Db;else if(Oc=Db,Rc.hasOwnProperty(Oc))Oc=Rc[Oc];else{var Jc=Oc.replace(pb,"-$1").toLowerCase().replace(jb,"-ms-");Oc=Rc[Oc]=Jc}cc+=bc+Oc+":";bc=Db;Dc=null==nc||"boolean"===typeof nc||""===nc?"":Dc||"number"!==typeof nc||0===nc||Eb.hasOwnProperty(bc)&&Eb[bc]?(""+nc).trim():nc+"px";cc+=Dc;bc=";"}}rb=cc||null}Db=null;ib?Ic.hasOwnProperty(pd)||(Db=pd,Db=b(Db)&&null!=rb?Db+'\x3d"'+(T(rb)+'"'):""):Db=k(pd,rb);Db&&(zb+=" "+Db)}}kb||ub&&(zb+=' data-reactroot\x3d""');
var pd=zb;Cb="";gb.hasOwnProperty(yb)?pd+="/\x3e":(pd+="\x3e",Cb="\x3c/"+qb.type+"\x3e");a:{kb=Nb.dangerouslySetInnerHTML;if(null!=kb){if(null!=kb.__html){kb=kb.__html;break a}}else if(kb=Nb.children,"string"===typeof kb||"number"===typeof kb){kb=T(kb);break a}kb=null}null!=kb?(Nb=[],Ya.hasOwnProperty(yb)&&"\n"===kb.charAt(0)&&(pd+="\n"),pd+=kb):Nb=Za(Nb.children);qb=qb.type;ic=null==ic||"http://www.w3.org/1999/xhtml"===ic?B(qb):"http://www.w3.org/2000/svg"===ic&&"foreignObject"===qb?"http://www.w3.org/1999/xhtml":
ic;this.stack.push({domNamespace:ic,type:yb,children:Nb,childIndex:0,context:ac,footer:Cb});this.previousWasTextNode=!1;return pd};return Xa}();P.renderToNodeStream=function(){throw Error(A(207));};P.renderToStaticMarkup=function(Xa,xb){Xa=new Sa(Xa,!0,xb);try{return Xa.read(Infinity)}finally{Xa.destroy()}};P.renderToStaticNodeStream=function(){throw Error(A(208));};P.renderToString=function(Xa,xb){Xa=new Sa(Xa,!1,xb);try{return Xa.read(Infinity)}finally{Xa.destroy()}};P.version="17.0.2"};
shadow$provide[584]=function(za,ea,bb,P){bb.exports=ea(582)};
shadow$provide[585]=function(za,ea,bb,P){function A(){if(!Jb&&(Jb="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jb))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jb(Pb)}function Y(c,m=0){return(Zc[c[m+0]]+Zc[c[m+1]]+Zc[c[m+2]]+Zc[c[m+3]]+"-"+Zc[c[m+4]]+Zc[c[m+5]]+"-"+Zc[c[m+6]]+Zc[c[m+7]]+"-"+Zc[c[m+8]]+Zc[c[m+9]]+"-"+Zc[c[m+10]]+Zc[c[m+11]]+Zc[c[m+12]]+Zc[c[m+13]]+Zc[c[m+14]]+
Zc[c[m+15]]).toLowerCase()}function F(c){let m=0;var M=0;for(var ca of c)m+=ca.w*ca.h,M=Math.max(M,ca.w);c.sort((La,fb)=>fb.h-La.h);M=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(m/.95)),M),h:Infinity}];let ua=ca=0;for(const La of c)for(c=M.length-1;0<=c;c--){var Ga=M[c];if(!(La.w>Ga.w||La.h>Ga.h)){La.x=Ga.x;La.y=Ga.y;ua=Math.max(ua,La.y+La.h);ca=Math.max(ca,La.x+La.w);La.w===Ga.w&&La.h===Ga.h?(Ga=M.pop(),c<M.length&&(M[c]=Ga)):La.h===Ga.h?(Ga.x+=La.w,Ga.w-=La.w):(La.w!==Ga.w&&M.push({x:Ga.x+La.w,y:Ga.y,
w:Ga.w-La.w,h:La.h}),Ga.y+=La.h,Ga.h-=La.h);break}}return{w:ca,h:ua,fill:m/(ca*ua)||0}}function w(c,...m){return{didIntersect:0<m.length,message:c,points:m}}function b(c,m,M=0){const ca=[c[0]+m[0]/2,c[1]+m[1]/2],ua=yd.rotWith(c,ca,M),Ga=yd.rotWith(yd.add(c,[m[0],0]),ca,M),La=yd.rotWith(yd.add(c,m),ca,M);c=yd.rotWith(yd.add(c,[0,m[1]]),ca,M);return[["top",[ua,Ga]],["right",[Ga,La]],["bottom",[La,c]],["left",[c,ua]]]}function q(c,m,M,ca){const [ua,Ga]=c,[La,fb]=m,[vb,Wb]=M,[oc,uc]=ca;return fb/La!==
(uc-Wb)/(oc-vb)&&(m=La*(uc-Wb)-fb*(oc-vb),0!==m&&(c=((Ga-Wb)*(oc-vb)-(ua-vb)*(uc-Wb))/m,m=((Ga-Wb)*La-(ua-vb)*fb)/m,0<=c&&0<=m&&1>=m))?w("intersection",[ua+c*La,Ga+c*fb]):w("no intersection")}function E(c,m,M,ca,ua=0){return a(M,ca,ua,c,m)}function G(c,m,M,ca=0){const {minX:ua,minY:Ga,width:La,height:fb}=M;return E(c,m,[ua,Ga],[La,fb],ca)}function K(c,m,M,ca){var ua=yd.sub(c,M);M=yd.sub(ca,M);m=yd.sub(m,c);ca=M[0]*ua[1]-M[1]*ua[0];ua=m[0]*ua[1]-m[1]*ua[0];M=M[1]*m[0]-M[0]*m[1];return 0===ca||0===
ua?w("coincident"):0===M?w("parallel"):0!==M&&(ca/=M,ua/=M,0<=ca&&1>=ca&&0<=ua&&1>=ua)?w("intersection",yd.add(c,yd.mul(m,ca))):w("no intersection")}function T(c,m,M,ca){var ua=(m[0]-c[0])*(m[0]-c[0])+(m[1]-c[1])*(m[1]-c[1]),Ga=2*((m[0]-c[0])*(c[0]-M[0])+(m[1]-c[1])*(c[1]-M[1]));M=Ga*Ga-4*ua*(M[0]*M[0]+M[1]*M[1]+c[0]*c[0]+c[1]*c[1]-2*(M[0]*c[0]+M[1]*c[1])-ca*ca);if(0>M)return w("outside");if(0===M)return w("tangent");ca=Math.sqrt(M);M=(-Ga+ca)/(2*ua);ua=(-Ga-ca)/(2*ua);if((0>M||1<M)&&(0>ua||1<ua))return 0>
M&&0>ua||1<M&&1<ua?w("outside"):w("inside");Ga=[];0<=M&&1>=M&&Ga.push(yd.lrp(c,m,M));0<=ua&&1>=ua&&Ga.push(yd.lrp(c,m,ua));return w("intersection",...Ga)}function k(c,m,M,ca,ua,Ga=0){if(0===ca||0===ua||yd.isEqual(c,m))return w("no intersection");ca=0>ca?ca:-ca;ua=0>ua?ua:-ua;c=yd.sub(yd.rotWith(c,M,-Ga),M);m=yd.sub(yd.rotWith(m,M,-Ga),M);var La=yd.sub(m,c),fb=La[0]*La[0]/ca/ca+La[1]*La[1]/ua/ua;La=2*c[0]*La[0]/ca/ca+2*c[1]*La[1]/ua/ua;const vb=[];ca=La*La-4*fb*(c[0]*c[0]/ca/ca+c[1]*c[1]/ua/ua-1);
0===ca?vb.push(-La/2/fb):0<ca&&(ca=Math.sqrt(ca),vb.push((-La+ca)/2/fb),vb.push((-La-ca)/2/fb));fb=vb.filter(Wb=>0<=Wb&&1>=Wb).map(Wb=>yd.add(M,yd.add(c,yd.mul(yd.sub(m,c),Wb)))).map(Wb=>yd.rotWith(Wb,M,Ga));return w("intersection",...fb)}function l(c,m,M){const ca=[];for(let ua=1;ua<M.length;ua++){const Ga=K(c,m,M[ua-1],M[ua]);Ga&&ca.push(...Ga.points)}return 0===ca.length?w("no intersection"):w("intersection",...M)}function a(c,m,M,ca,ua){return b(c,m,M).reduce((Ga,[La,[fb,vb]])=>{(fb=q(ca,ua,fb,
vb))&&Ga.push(w(La,...fb.points));return Ga},[]).filter(Ga=>Ga.didIntersect)}function h(c,m,M,ca){return b(c,m).reduce((ua,[Ga,[La,fb]])=>{(La=K(M,ca,La,fb))&&ua.push(w(Ga,...La.points));return ua},[]).filter(ua=>ua.didIntersect)}function n(c,m,M,ca){return b(c,m).reduce((ua,[Ga,[La,fb]])=>{(La=T(La,fb,M,ca))&&ua.push(ng(Gf({},La),{message:Ga}));return ua},[]).filter(ua=>ua.didIntersect)}function p(c,m,M,ca,ua,Ga=0){return b(c,m).reduce((La,[fb,[vb,Wb]])=>{(vb=k(vb,Wb,M,ca,ua,Ga))&&La.push(ng(Gf({},
vb),{message:fb}));return La},[]).filter(La=>La.didIntersect)}function C(c,m,M){return b(c,m).reduce((ca,[ua,[Ga,La]])=>{Ga=l(Ga,La,M);Ga.didIntersect&&ca.push(w(ua,...Ga.points));return ca},[]).filter(ca=>ca.didIntersect)}function x(c,m,M){return b(c,m).reduce((ca,[ua,[Ga,La]])=>{{const fb=[];for(let vb=1;vb<M.length+1;vb++){const Wb=K(Ga,La,M[vb-1],M[vb%M.length]);Wb&&fb.push(...Wb.points)}Ga=0===fb.length?w("no intersection"):w("intersection",...M)}Ga.didIntersect&&ca.push(w(ua,...Ga.points));
return ca},[]).filter(ca=>ca.didIntersect)}function u(c,m,M,ca=0,ua,Ga){return m===M?n(ua,Ga,c,m):p(ua,Ga,c,m,M,ca)}function g(c,m,M){const {minX:ca,minY:ua,width:Ga,height:La}=c;return h([ca,ua],[Ga,La],m,M)}function e(c){for(var m=arguments.length,M=Array(1<m?m-1:0),ca=1;ca<m;ca++)M[ca-1]=arguments[ca];throw Error("number"===typeof c?"[MobX] minified error nr: "+c+(M.length?" "+M.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":
"[MobX] "+c);}function H(){return"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof za?za:"undefined"!==typeof self?self:vk}function B(){Zy||e("Proxy not available")}function J(c){var m=!1;return function(){if(!m)return m=!0,c.apply(this,arguments)}}function V(c){return"function"===typeof c}function y(c){switch(typeof c){case "string":case "symbol":case "number":return!0}return!1}function S(c){return null!==c&&"object"===typeof c}function O(c){if(!S(c))return!1;
c=Object.getPrototypeOf(c);if(null==c)return!0;c=Object.hasOwnProperty.call(c,"constructor")&&c.constructor;return"function"===typeof c&&c.toString()===$y}function z(c){return(c=null==c?void 0:c.constructor)?"GeneratorFunction"===c.name||"GeneratorFunction"===c.displayName?!0:!1:!1}function t(c,m,M){Tk(c,m,{enumerable:!1,writable:!0,configurable:!0,value:M})}function L(c,m,M){Tk(c,m,{enumerable:!1,writable:!1,configurable:!0,value:M})}function I(c,m){var M="isMobX"+c;m.prototype[M]=!0;return function(ca){return S(ca)&&
!0===ca[M]}}function R(c){return c instanceof Map}function Q(c){return c instanceof Set}function N(c){var m=Object.keys(c);if(!mv)return m;var M=Object.getOwnPropertySymbols(c);return M.length?[].concat(m,M.filter(function(ca){return yq.propertyIsEnumerable.call(c,ca)})):m}function ja(c){return null===c?null:"object"===typeof c?""+c:c}function X(c,m){return yq.hasOwnProperty.call(c,m)}function Z(c,m){for(var M=0;M<m.length;M++){var ca=m[M];ca.enumerable=ca.enumerable||!1;ca.configurable=!0;"value"in
ca&&(ca.writable=!0);Object.defineProperty(c,ca.key,ca)}}function aa(c,m,M){m&&Z(c.prototype,m);M&&Z(c,M);Object.defineProperty(c,"prototype",{writable:!1});return c}function W(){W=Object.assign||function(c){for(var m=1;m<arguments.length;m++){var M=arguments[m],ca;for(ca in M)Object.prototype.hasOwnProperty.call(M,ca)&&(c[ca]=M[ca])}return c};return W.apply(this,arguments)}function ha(c,m){c.prototype=Object.create(m.prototype);c.prototype.constructor=c;da(c,m)}function da(c,m){da=Object.setPrototypeOf||
function(M,ca){M.__proto__=ca;return M};return da(c,m)}function fa(c){if(void 0===c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}function ra(c,m){if(c){if("string"===typeof c)return wa(c,m);var M=Object.prototype.toString.call(c).slice(8,-1);"Object"===M&&c.constructor&&(M=c.constructor.name);if("Map"===M||"Set"===M)return Array.from(c);if("Arguments"===M||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return wa(c,m)}}function wa(c,m){if(null==
m||m>c.length)m=c.length;for(var M=0,ca=Array(m);M<m;M++)ca[M]=c[M];return ca}function sa(c,m){var M="undefined"!==typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];if(M)return(M=M.call(c)).next.bind(M);if(Array.isArray(c)||(M=ra(c))||m&&c&&"number"===typeof c.length){M&&(c=M);var ca=0;return function(){return ca>=c.length?{done:!0}:{done:!1,value:c[ca++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}function xa(c){return Object.assign(function(m,M){Ja(m,M,c)},c)}function Ja(c,m,M){X(c,Kl)||t(c,Kl,W({},c[Kl]));M.annotationType_!==bz&&(c[Kl][m]=M)}function Qa(c){X(c,Kl)||t(c,Kl,W({},c[Kl]));return c[Kl]}function db(c,m,M){void 0===m&&(m=hp);void 0===M&&(M=hp);c=new zq(c);m!==hp&&Mc(qz,c,m,void 0);M!==hp&&ld(c,M);return c}function Ca(c,m,M){return qc(c)?c:Array.isArray(c)?Rg.array(c,{name:M}):O(c)?Rg.object(c,void 0,{name:M}):R(c)?Rg.map(c,{name:M}):Q(c)?Rg.set(c,{name:M}):"function"!==typeof c||
Dc(c)||Kc(c)?c:z(c)?Eq(c):Dq(M,c)}function Na(c){return c}function Fa(c,m){return{annotationType_:c,options_:m,make_:ka,extend_:la}}function ka(c,m,M,ca){var ua;if(null!=(ua=this.options_)&&ua.bound)return null===this.extend_(c,m,M,!1)?0:1;if(ca===c.target_)return null===this.extend_(c,m,M,!1)?0:2;if(Dc(M.value))return 1;c=va(c,this,m,M,!1);Tk(ca,m,c);return 2}function la(c,m,M,ca){M=va(c,this,m,M);return c.defineProperty_(m,M,ca)}function va(c,m,M,ca,ua){var Ga,La,fb,vb,Wb,oc,uc;void 0===ua&&(ua=
$f.safeDescriptors);ca=ca.value;if(null!=(Ga=m.options_)&&Ga.bound){var Sc;ca=ca.bind(null!=(Sc=c.proxy_)?Sc:c.target_)}return{value:Ya(null!=(La=null==(fb=m.options_)?void 0:fb.name)?La:M.toString(),ca,null!=(vb=null==(Wb=m.options_)?void 0:Wb.autoAction)?vb:!1,null!=(oc=m.options_)&&oc.bound?null!=(uc=c.proxy_)?uc:c.target_:void 0),configurable:ua?c.isPlainObject_:!0,enumerable:!1,writable:ua?!1:!0}}function ta(c,m){return{annotationType_:c,options_:m,make_:oa,extend_:Ma}}function oa(c,m,M,ca){var ua;
if(ca===c.target_)return null===this.extend_(c,m,M,!1)?0:2;if(null!=(ua=this.options_)&&ua.bound&&(!X(c.target_,m)||!Kc(c.target_[m]))&&null===this.extend_(c,m,M,!1))return 0;if(Kc(M.value))return 1;c=Ta(c,this,m,M,!1,!1);Tk(ca,m,c);return 2}function Ma(c,m,M,ca){var ua;M=Ta(c,this,m,M,null==(ua=this.options_)?void 0:ua.bound);return c.defineProperty_(m,M,ca)}function Ta(c,m,M,ca,ua,Ga){void 0===Ga&&(Ga=$f.safeDescriptors);m=ca.value;Kc(m)||(m=Eq(m));if(ua){var La;m=m.bind(null!=(La=c.proxy_)?La:
c.target_);m.isMobXFlow=!0}return{value:m,configurable:Ga?c.isPlainObject_:!0,enumerable:!1,writable:Ga?!1:!0}}function Ua(c,m){return{annotationType_:c,options_:m,make_:Pa,extend_:cb}}function Pa(c,m,M){return null===this.extend_(c,m,M,!1)?0:1}function cb(c,m,M,ca){return c.defineComputedProperty_(m,W({},this.options_,{get:M.get,set:M.set}),ca)}function gb(c,m){return{annotationType_:c,options_:m,make_:Lb,extend_:Eb}}function Lb(c,m,M){return null===this.extend_(c,m,M,!1)?0:1}function Eb(c,m,M,ca){var ua,
Ga;return c.defineObservableProperty_(m,M.value,null!=(ua=null==(Ga=this.options_)?void 0:Ga.enhancer)?ua:Ca,ca)}function Da(c){return{annotationType_:"true",options_:c,make_:pb,extend_:jb}}function pb(c,m,M,ca){var ua,Ga;if(M.get)return $g.make_(c,m,M,ca);if(M.set){M=Ya(m.toString(),M.set);if(ca===c.target_)return null===c.defineProperty_(m,{configurable:$f.safeDescriptors?c.isPlainObject_:!0,set:M})?0:2;Tk(ca,m,{configurable:!0,set:M});return 2}if(ca!==c.target_&&"function"===typeof M.value){var La;
if(z(M.value)){var fb;return(null!=(fb=this.options_)&&fb.autoBind?Eq.bound:Eq).make_(c,m,M,ca)}return(null!=(La=this.options_)&&La.autoBind?Dq.bound:Dq).make_(c,m,M,ca)}La=!1===(null==(ua=this.options_)?void 0:ua.deep)?Rg.ref:Rg;if("function"===typeof M.value&&null!=(Ga=this.options_)&&Ga.autoBind){var vb;M.value=M.value.bind(null!=(vb=c.proxy_)?vb:c.target_)}return La.make_(c,m,M,ca)}function jb(c,m,M,ca){var ua,Ga;if(M.get)return $g.extend_(c,m,M,ca);if(M.set)return c.defineProperty_(m,{configurable:$f.safeDescriptors?
c.isPlainObject_:!0,set:Ya(m.toString(),M.set)},ca);if("function"===typeof M.value&&null!=(ua=this.options_)&&ua.autoBind){var La;M.value=M.value.bind(null!=(La=c.proxy_)?La:c.target_)}return(!1===(null==(Ga=this.options_)?void 0:Ga.deep)?Rg.ref:Rg).extend_(c,m,M,ca)}function Za(c){if(!0===c.deep)var m=Ca;else{if(!1===c.deep)c=Na;else{c=c.defaultDecorator;var M;c=c?null!=(m=null==(M=c.options_)?void 0:M.enhancer)?m:Ca:Ca}m=c}return m}function hb(c,m,M){if(y(m))Ja(c,m,nv);else return qc(c)?c:O(c)?
Rg.object(c,m,M):Array.isArray(c)?Rg.array(c,m):R(c)?Rg.map(c,m):Q(c)?Rg.set(c,m):"object"===typeof c&&null!==c?c:Rg.box(c,m)}function Ya(c,m,M,ca){function ua(){a:{var Ga=ca||this,La=arguments,fb=$f.trackingDerivation,vb=!M||!fb;Nb();var Wb=$f.allowStateChanges;vb&&(Xa(),Wb=Uc(!0));var oc=xb(!0),uc=iz++,Sc=zr;zr=uc;try{var kd=m.apply(Ga,La);break a}catch(xd){var fd=xd;throw xd;}finally{zr!==uc&&e(30),zr=Sc,void 0!==fd&&($f.suppressReactionErrors=!0),$f.allowStateChanges=Wb,$f.allowStateReads=oc,
Cb(),vb&&($f.trackingDerivation=fb),$f.suppressReactionErrors=!1}kd=void 0}return kd}void 0===M&&(M=!1);ua.isMobxAction=!0;jz&&(sv.value=c,Object.defineProperty(ua,"name",sv));return ua}function ec(c,m){c=Uc(c);try{return m()}finally{$f.allowStateChanges=c}}function Uc(c){var m=$f.allowStateChanges;$f.allowStateChanges=c;return m}function Rc(c){switch(c.dependenciesState_){case Ei.UP_TO_DATE_:return!1;case Ei.NOT_TRACKING_:case Ei.STALE_:return!0;case Ei.POSSIBLY_STALE_:for(var m=xb(!0),M=Xa(),ca=
c.observing_,ua=ca.length,Ga=0;Ga<ua;Ga++){var La=ca[Ga];if(Cq(La)){if($f.disableErrorBoundaries)La.get();else try{La.get()}catch(fb){return $f.trackingDerivation=M,$f.allowStateReads=m,!0}if(c.dependenciesState_===Ei.STALE_)return $f.trackingDerivation=M,$f.allowStateReads=m,!0}}qb(c);$f.trackingDerivation=M;$f.allowStateReads=m;return!1}}function Fc(c,m,M){var ca=xb(!0);qb(c);c.newObserving_=Array(c.observing_.length+100);c.unboundDepsCount_=0;c.runId_=++$f.runId;var ua=$f.trackingDerivation;$f.trackingDerivation=
c;$f.inBatch++;if(!0===$f.disableErrorBoundaries)var Ga=m.call(M);else try{Ga=m.call(M)}catch(oc){Ga=new qo(oc)}$f.inBatch--;$f.trackingDerivation=ua;var La=c.observing_;m=c.observing_=c.newObserving_;M=Ei.UP_TO_DATE_;ua=0;for(var fb=c.unboundDepsCount_,vb=0;vb<fb;vb++){var Wb=m[vb];0===Wb.diffValue_&&(Wb.diffValue_=1,ua!==vb&&(m[ua]=Wb),ua++);Wb.dependenciesState_>M&&(M=Wb.dependenciesState_)}m.length=ua;c.newObserving_=null;for(fb=La.length;fb--;)vb=La[fb],0===vb.diffValue_&&ic(vb,c),vb.diffValue_=
0;for(;ua--;)La=m[ua],1===La.diffValue_&&(La.diffValue_=0,fb=c,La.observers_.add(fb),La.lowestObserverState_>fb.dependenciesState_&&(La.lowestObserverState_=fb.dependenciesState_));M!==Ei.UP_TO_DATE_&&(c.dependenciesState_=M,c.onBecomeStale_());$f.allowStateReads=ca;return Ga}function Ic(c){var m=c.observing_;c.observing_=[];for(var M=m.length;M--;)ic(m[M],c);c.dependenciesState_=Ei.NOT_TRACKING_}function Sa(c){var m=Xa();try{return c()}finally{$f.trackingDerivation=m}}function Xa(){var c=$f.trackingDerivation;
$f.trackingDerivation=null;return c}function xb(c){var m=$f.allowStateReads;$f.allowStateReads=c;return m}function qb(c){if(c.dependenciesState_!==Ei.UP_TO_DATE_){c.dependenciesState_=Ei.UP_TO_DATE_;c=c.observing_;for(var m=c.length;m--;)c[m].lowestObserverState_=Ei.UP_TO_DATE_}}function ac(){($f.pendingReactions.length||$f.inBatch||$f.isRunningReactions)&&e(36);tv=!0;if(Br){var c=H();0===--c.__mobxInstanceCount&&(c.__mobxGlobals=void 0);$f=new Ar}}function ic(c,m){c.observers_["delete"](m);0===c.observers_.size&&
yb(c)}function yb(c){!1===c.isPendingUnobservation_&&(c.isPendingUnobservation_=!0,$f.pendingUnobservations.push(c))}function Nb(){$f.inBatch++}function Cb(){if(0===--$f.inBatch){0<$f.inBatch||$f.isRunningReactions||Cr(rb);for(var c=$f.pendingUnobservations,m=0;m<c.length;m++){var M=c[m];M.isPendingUnobservation_=!1;0===M.observers_.size&&(M.isBeingObserved_&&(M.isBeingObserved_=!1,M.onBUO()),M instanceof Bq&&M.suspend_())}$f.pendingUnobservations=[]}}function kb(c){var m=$f.trackingDerivation;if(null!==
m)return m.runId_!==c.lastAccessedBy_&&(c.lastAccessedBy_=m.runId_,m.newObserving_[m.unboundDepsCount_++]=c,!c.isBeingObserved_&&$f.trackingContext&&(c.isBeingObserved_=!0,c.onBO())),c.isBeingObserved_;0===c.observers_.size&&0<$f.inBatch&&yb(c);return!1}function ub(c){c.lowestObserverState_!==Ei.STALE_&&(c.lowestObserverState_=Ei.STALE_,c.observers_.forEach(function(m){if(m.dependenciesState_===Ei.UP_TO_DATE_)m.onBecomeStale_();m.dependenciesState_=Ei.STALE_}))}function zb(c){c.lowestObserverState_!==
Ei.STALE_&&(c.lowestObserverState_=Ei.STALE_,c.observers_.forEach(function(m){m.dependenciesState_===Ei.POSSIBLY_STALE_?m.dependenciesState_=Ei.STALE_:m.dependenciesState_===Ei.UP_TO_DATE_&&(c.lowestObserverState_=Ei.UP_TO_DATE_)}))}function ib(c){c.lowestObserverState_===Ei.UP_TO_DATE_&&(c.lowestObserverState_=Ei.POSSIBLY_STALE_,c.observers_.forEach(function(m){m.dependenciesState_===Ei.UP_TO_DATE_&&(m.dependenciesState_=Ei.POSSIBLY_STALE_,m.onBecomeStale_())}))}function rb(){$f.isRunningReactions=
!0;for(var c=$f.pendingReactions,m=0;0<c.length;){++m===nz&&(console.error("[mobx] cycle in reaction: "+c[0]),c.splice(0));for(var M=c.splice(0),ca=0,ua=M.length;ca<ua;ca++)M[ca].runReaction_()}$f.isRunningReactions=!1}function Db(c){var m=Cr;Cr=function(M){return c(function(){return m(M)})}}function cc(c){console.warn("[mobx.spy] Is a no-op in production builds");return function(){}}function bc(c){return function(m,M){if(V(m))return Ya(m.name||"\x3cunnamed action\x3e",m,c);if(V(M))return Ya(m,M,
c);if(y(M))return Ja(m,M,c?wv:vv);if(y(m))return xa(Fa(c?"autoAction":uv,{name:m,autoAction:c}))}}function Dc(c){return V(c)&&!0===c.isMobxAction}function nc(c,m){function M(){c(vb)}var ca,ua;void 0===m&&(m=Ys);var Ga=null!=(ca=null==(ua=m)?void 0:ua.name)?ca:"Autorun";if(m.scheduler||m.delay){var La=Oc(m),fb=!1;var vb=new kp(Ga,function(){fb||(fb=!0,La(function(){fb=!1;vb.isDisposed_||vb.track(M)}))},m.onError,m.requiresObservable)}else vb=new kp(Ga,function(){this.track(M)},m.onError,m.requiresObservable);
vb.schedule_();return vb.getDisposer_()}function Oc(c){return c.scheduler?c.scheduler:c.delay?function(m){return setTimeout(m,c.delay)}:pz}function Jc(c,m,M){function ca(){oc=!1;if(!fd.isDisposed_){var xd=!1;fd.track(function(){var Jd=ec(!1,function(){return c(fd)});xd=Wb||!kd(uc,Jd);Sc=uc;uc=Jd});Wb&&M.fireImmediately?La(uc,Sc,fd):!Wb&&xd&&La(uc,Sc,fd);Wb=!1}}var ua;void 0===M&&(M=Ys);var Ga=null!=(ua=M.name)?ua:"Reaction",La=Ag(Ga,M.onError?pd(M.onError,m):m),fb=!M.scheduler&&!M.delay,vb=Oc(M),
Wb=!0,oc=!1,uc,Sc,kd=M.compareStructural?ip.structural:M.equals||ip["default"],fd=new kp(Ga,function(){Wb||fb?ca():oc||(oc=!0,vb(ca))},M.onError,M.requiresObservable);fd.schedule_();return fd.getDisposer_()}function pd(c,m){return function(){try{return m.apply(this,arguments)}catch(M){c.call(this,M)}}}function ld(c,m,M){return Mc(rz,c,m,M)}function Mc(c,m,M,ca){var ua="function"===typeof ca?ia(m,M):ia(m),Ga=V(ca)?ca:M,La=c+"L";ua[La]?ua[La].add(Ga):ua[La]=new Set([Ga]);return function(){var fb=ua[La];
fb&&(fb["delete"](Ga),0===fb.size&&delete ua[La])}}function ob(c){!0===c.isolateGlobalState&&ac();var m=c.useProxies,M=c.enforceActions;void 0!==m&&($f.useProxies="always"===m?!0:"never"===m?!1:"undefined"!==typeof Proxy);"ifavailable"===m&&($f.verifyProxies=!0);void 0!==M&&(m="always"===M?"always":"observed"===M,$f.enforceActions=m,$f.allowStateChanges=!0===m||"always"===m?!1:!0);["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(ca){ca in
c&&($f[ca]=!!c[ca])});$f.allowStateReads=!$f.observableRequiresReaction;c.reactionScheduler&&Db(c.reactionScheduler)}function xc(c,m,M,ca){var ua=az(m),Ga=jd(c,ca)[Eh];Nb();try{yr(ua).forEach(function(La){Ga.extend_(La,ua[La],M?La in M?M[La]:!0:!0)})}finally{Cb()}return c}function Sb(c){var m={name:c.name_};c.observing_&&0<c.observing_.length&&(m.dependencies=Array.from(new Set(c.observing_)).map(Sb));return m}function vc(){this.message="FLOW_CANCELLED"}function Kc(c){return!0===(null==c?void 0:c.isMobXFlow)}
function qc(c,m){return c?void 0!==m?Kb(c)?c[Eh].values_.has(m):!1:Kb(c)||!!c[Eh]||Zs(c)||Dr(c)||Cq(c):!1}function gc(c){if(Kb(c))return c[Eh].ownKeys_();e(38)}function Xb(c,m,M){c.set(m,M);return M}function mc(c,m){if(null==c||"object"!==typeof c||c instanceof Date||!qc(c))return c;if(lz(c)||Cq(c))return mc(c.get(),m);if(m.has(c))return m.get(c);if(Lc(c)){var M=Xb(m,c,Array(c.length));c.forEach(function(La,fb){M[fb]=mc(La,m)});return M}if(ro(c)){var ca=Xb(m,c,new Set);c.forEach(function(La){ca.add(mc(La,
m))});return ca}if(kn(c)){var ua=Xb(m,c,new Map);c.forEach(function(La,fb){ua.set(fb,mc(La,m))});return ua}var Ga=Xb(m,c,{});gc(c).forEach(function(La){yq.propertyIsEnumerable.call(c,La)&&(Ga[La]=mc(c[La],m))});return Ga}function Ab(c,m){return mc(c,new Map)}function Rb(){e("trace() is not available in production builds");for(var c=!1,m=arguments.length,M=Array(m),ca=0;ca<m;ca++)M[ca]=arguments[ca];"boolean"===typeof M[M.length-1]&&(c=M.pop());a:{switch(M.length){case 0:m=$f.trackingDerivation;break a;
case 1:m=ia(M[0]);break a;case 2:m=ia(M[0],M[1]);break a}m=void 0}if(!m)return e("'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");m.isTracing_===jp.NONE&&console.log("[mobx.trace] '"+m.name_+"' tracing enabled");m.isTracing_=c?jp.BREAK:jp.LOG}function tc(c,m){void 0===m&&(m=void 0);Nb();try{return c.apply(m)}finally{Cb()}}function sb(c){return void 0!==c.interceptors_&&0<c.interceptors_.length}function Gb(c,
m){var M=c.interceptors_||(c.interceptors_=[]);M.push(m);return J(function(){var ca=M.indexOf(m);-1!==ca&&M.splice(ca,1)})}function lb(c,m){var M=Xa();try{var ca=[].concat(c.interceptors_||[]);c=0;for(var ua=ca.length;c<ua&&((m=ca[c](m))&&!m.type&&e(14),m);c++);return m}finally{$f.trackingDerivation=M}}function Mb(c){return void 0!==c.changeListeners_&&0<c.changeListeners_.length}function Ib(c,m){var M=c.changeListeners_||(c.changeListeners_=[]);M.push(m);return J(function(){var ca=M.indexOf(m);-1!==
ca&&M.splice(ca,1)})}function hc(c,m){var M=Xa();if(c=c.changeListeners_){c=c.slice();for(var ca=0,ua=c.length;ca<ua;ca++)c[ca](m);$f.trackingDerivation=M}}function Cc(c,m,M){var ca=jd(c,M)[Eh];Nb();try{var ua;null!=(ua=m)?ua:m=Qa(c);yr(m).forEach(function(Ga){return ca.make_(Ga,m[Ga])})}finally{Cb()}return c}function ab(c,m,M,ca){void 0===M&&(M="ObservableArray");void 0===ca&&(ca=!1);B();m=new $s(M,m,ca,!1);L(m.values_,Eh,m);M=new Proxy(m.values_,vz);m.proxy_=M;c&&c.length&&(ca=Uc(!0),m.spliceWithArray_(0,
0,c),$f.allowStateChanges=ca);return M}function eb(c,m){"function"===typeof Array.prototype[c]&&(Er[c]=m(c))}function Va(c){return function(){var m=this[Eh];m.atom_.reportObserved();m=m.dehanceValues_(m.values_);return m[c].apply(m,arguments)}}function mb(c){return function(m,M){var ca=this,ua=this[Eh];ua.atom_.reportObserved();return ua.dehanceValues_(ua.values_)[c](function(Ga,La){return m.call(M,Ga,La,ca)})}}function Bb(c){return function(){var m=this,M=this[Eh];M.atom_.reportObserved();M=M.dehanceValues_(M.values_);
var ca=arguments[0];arguments[0]=function(ua,Ga,La){return ca(ua,Ga,La,m)};return M[c].apply(M,arguments)}}function Lc(c){return S(c)&&wz(c[Eh])}function cd(c){if(R(c)||kn(c))return c;if(Array.isArray(c))return new Map(c);if(O(c)){var m=new Map,M;for(M in c)m.set(M,c[M]);return m}return e(21,c)}function jd(c,m){var M;if(X(c,Eh))return c;var ca=null!=(M=null==m?void 0:m.name)?M:"ObservableObject";M=Cv;var ua=new Map;ca=String(ca);var Ga;var La=m?null!=(Ga=m.defaultDecorator)?Ga:Da(m):void 0;m=new M(c,
ua,ca,La);t(c,Eh,m);return c}function Ld(c){return Bv[c]||(Bv[c]={get:function(){return this[Eh].getObservablePropValue_(c)},set:function(m){return this[Eh].setObservablePropValue_(c,m)}})}function Kb(c){return S(c)?Dz(c[Eh]):!1}function Aa(c){return{enumerable:!1,configurable:!0,get:function(){return this[Eh].get_(c)},set:function(m){this[Eh].set_(c,m)}}}function qa(c){if(c>at){for(var m=at;m<c+100;m++)Tk(bt.prototype,""+m,Aa(m));at=c}}function f(c,m,M){return new bt(c,m,M)}function ia(c,m){if("object"===
typeof c&&null!==c){if(Lc(c))return void 0!==m&&e(23),c[Eh].atom_;if(ro(c))return c[Eh];if(kn(c)){if(void 0===m)return c.keysAtom_;var M=c.data_.get(m)||c.hasMap_.get(m);M||e(25,m,Ka(c));return M}if(Kb(c)){if(!m)return e(26);(M=c[Eh].values_.get(m))||e(27,m,Ka(c));return M}if(Zs(c)||Cq(c)||Dr(c))return c}else if(V(c)&&Dr(c[Eh]))return c[Eh];e(28)}function Wa(c,m){c||e(29);if(void 0!==m)return Wa(ia(c,m));if(Zs(c)||Cq(c)||Dr(c)||kn(c)||ro(c))return c;if(c[Eh])return c[Eh];e(24,c)}function Ka(c,m){if(void 0!==
m)c=ia(c,m);else{if(Dc(c))return c.name;c=Kb(c)||kn(c)||ro(c)?Wa(c):ia(c)}return c.name_}function ma(c,m,M){void 0===M&&(M=-1);return pa(c,m,M)}function pa(c,m,M,ca,ua){if(c===m)return 0!==c||1/c===1/m;if(null==c||null==m)return!1;if(c!==c)return m!==m;var Ga=typeof c;if("function"!==Ga&&"object"!==Ga&&"object"!=typeof m)return!1;Ga=Ev.call(c);if(Ga!==Ev.call(m))return!1;switch(Ga){case "[object RegExp]":case "[object String]":return""+c===""+m;case "[object Number]":return+c!==+c?+m!==+m:0===+c?
1/+c===1/m:+c===+m;case "[object Date]":case "[object Boolean]":return+c===+m;case "[object Symbol]":return"undefined"!==typeof Symbol&&Symbol.valueOf.call(c)===Symbol.valueOf.call(m);case "[object Map]":case "[object Set]":0<=M&&M++}c=Ea(c);m=Ea(m);Ga="[object Array]"===Ga;if(!Ga){if("object"!=typeof c||"object"!=typeof m)return!1;var La=c.constructor,fb=m.constructor;if(La!==fb&&!(V(La)&&La instanceof La&&V(fb)&&fb instanceof fb)&&"constructor"in c&&"constructor"in m)return!1}if(0===M)return!1;
0>M&&(M=-1);ca=ca||[];ua=ua||[];for(La=ca.length;La--;)if(ca[La]===c)return ua[La]===m;ca.push(c);ua.push(m);if(Ga){La=c.length;if(La!==m.length)return!1;for(;La--;)if(!pa(c[La],m[La],M-1,ca,ua))return!1}else{Ga=Object.keys(c);La=Ga.length;if(Object.keys(m).length!==La)return!1;for(;La--;)if(fb=Ga[La],!X(m,fb)||!pa(c[fb],m[fb],M-1,ca,ua))return!1}ca.pop();ua.pop();return!0}function Ea(c){return Lc(c)?c.slice():R(c)||kn(c)||Q(c)||ro(c)?Array.from(c.entries()):c}function $a(c){c[Symbol.iterator]=Ob;
return c}function Ob(){return this}function rc(c,m){const M=new Set(m),ca=Object.values(c),ua=new Set(ca.filter(Ga=>M.has(Ga.toId)||M.has(Ga.fromId)));c=ua.size;for(m=-1;0!==m;)ua.forEach(Ga=>{Ga=Ga.fromId;for(const La of ca)La.fromId===Ga&&ua.add(La),La.toId===Ga&&ua.add(La)}),m=ua.size-c,c=ua.size;return Array.from(ua.values())}function ad(c,m,M,ca,ua,Ga,La,fb){if(ua=m.getBindingPoint(ua,Ga,La,fb))return{id:ca,type:"line",fromId:c.id,toId:m.id,handleId:M,point:ne.toFixed(ua.point),distance:ua.distance}}
function sd(c,m){const M=c.getCenter(),ca=m.getCenter();var ua=Re();ua=ng(Gf({},Fq.defaultProps),{id:ua,type:Fq.id,parentId:c.props.parentId,point:M});c=ad(ua,c,"start",Re(),M,M,ne.uni(ne.sub(ca,M)),!1);m=ad(ua,m,"end",Re(),ca,ca,ne.uni(ne.sub(M,ca)),!1);return c&&m?(ua.handles.start.point=[0,0],ua.handles.end.point=ne.sub(ca,M),ua.handles.start.bindingId=c.id,ua.handles.end.bindingId=m.id,[ua,[c,m]]):null}function he(){return new Mz}function De(){return new WeakMap}function Je(c){if(!c)return jt(null);
var m=c.constructor;if(m===Object)return c===Object.prototype?{}:jt(c);if(~Kz.call(m).indexOf("[native code]"))try{return new m}catch(M){}return jt(c)}function Ff(c){var m="";c.global&&(m+="g");c.ignoreCase&&(m+="i");c.multiline&&(m+="m");c.unicode&&(m+="u");c.sticky&&(m+="y");return m}function gf(c){return c.flags}function hf(c){c=Lz.call(c);return c.substring(8,c.length-1)}function rf(c){return c[Symbol.toStringTag]||hf(c)}function vg(c){return qw(c).concat(kt(c))}function Cg(c,m,M){for(var ca=
Tz(c),ua=0,Ga=ca.length,La,fb;ua<Ga;++ua)if(La=ca[ua],"callee"!==La&&"caller"!==La)if(fb=Rz(c,La)){fb.get||fb.set||(fb.value=M.copier(fb.value,M));try{Qz(m,La,fb)}catch(vb){m[La]=fb.value}}else m[La]=M.copier(c[La],M);return m}function Gg(c,m){var M=new m.Constructor;m.cache.set(c,M);c.forEach(function(ca,ua){M.set(ua,m.copier(ca,m))});return M}function Vf(c,m){var M=Je(m.prototype);m.cache.set(c,M);for(var ca in c)sw.call(c,ca)&&(M[ca]=m.copier(c[ca],m));return M}function Hg(c,m){var M=Je(m.prototype);
m.cache.set(c,M);for(var ca in c)sw.call(c,ca)&&(M[ca]=m.copier(c[ca],m));ca=kt(c);for(var ua=0,Ga=ca.length,La;ua<Ga;++ua)La=ca[ua],Sz.call(c,La)&&(M[La]=m.copier(c[La],m));return M}function Gh(c,m){return new m.Constructor(c.valueOf())}function gh(c,m){return c}function Sh(c,m){var M=new m.Constructor;m.cache.set(c,M);c.forEach(function(ca){M.add(m.copier(ca,m))});return M}function Xh(c){function m(Ga,La){La.prototype=La.Constructor=void 0;if(!Ga||"object"!==typeof Ga)return Ga;if(La.cache.has(Ga))return La.cache.get(Ga);
La.prototype=Ga.__proto__||Vz(Ga);La.Constructor=La.prototype&&La.prototype.constructor;if(!La.Constructor||La.Constructor===Object)return ua(Ga,La);if(Uz(Ga))return ca(Ga,La);var fb=M[Pz(Ga)];return fb?fb(Ga,La):"function"===typeof Ga.then?Ga:ua(Ga,La)}c=lt({},uw,c);var M={Arguments:c.object,Array:c.array,ArrayBuffer:c.arrayBuffer,Blob:c.blob,Boolean:Gh,DataView:c.dataView,Date:c.date,Error:c.error,Float32Array:c.arrayBuffer,Float64Array:c.arrayBuffer,Int8Array:c.arrayBuffer,Int16Array:c.arrayBuffer,
Int32Array:c.arrayBuffer,Map:c.map,Number:Gh,Object:c.object,Promise:gh,RegExp:c.regExp,Set:c.set,String:Gh,WeakMap:gh,WeakSet:gh,Uint8Array:c.arrayBuffer,Uint8ClampedArray:c.arrayBuffer,Uint16Array:c.arrayBuffer,Uint32Array:c.arrayBuffer,Uint64Array:c.arrayBuffer},ca=M.Array,ua=M.Object;return function(Ga){return m(Ga,{Constructor:void 0,cache:Nz(),copier:m,prototype:void 0})}}function vi(c,m){return(0,Zz.default)(c,m,{arrayMerge:(M,ca,ua)=>ca})}function Qi(c,m,M,ca=!1){const [ua,Ga]=m,[La,fb]=M;
c=La+(c-ua)/(Ga-ua)*(fb-La);return ca?La<fb?Math.max(Math.min(c,fb),La):Math.max(Math.min(c,La),fb):c}function ai(c,m){return new Promise((M,ca)=>{if("video"===m){const ua=document.createElement("video");ua.addEventListener("loadedmetadata",function(){M([this.videoWidth,this.videoHeight])},!1);ua.src=c}else if("image"===m){const ua=new Image;ua.onload=()=>M([ua.width,ua.height]);ua.src=c;ua.onerror=Ga=>ca(Ga)}else"pdf"===m&&M([595,842])})}function Cf(c){return Object.values(Oa).includes(c)}function Df(c,
m){return Cf(c)||null==c?`var(--ls-wb-${m}-color-${c?c:"default"})`:c}function mg(){var c;null==(c=document.getElementById("__textLabelMeasure"))?void 0:c.remove();c=document.createElement("pre");c.id="__textLabelMeasure";Object.assign(c.style,{whiteSpace:"pre",width:"auto",borderLeft:"2px solid transparent",borderRight:"1px solid transparent",borderBottom:"2px solid transparent",padding:"0px",margin:"0px",opacity:"0",position:"absolute",top:"-500px",left:"0px",zIndex:"9999",userSelect:"none",pointerEvents:"none",
font:"var(--ls-font-family)"});c.tabIndex=-1;document.body.appendChild(c);return c}function sg(c,m,M=0){var ca,ua,Ga;if(!c)return[16,32];let La;La="string"===typeof m?m:`${null!=(ca=m.fontStyle)?ca:"normal"} ${null!=(ua=m.fontVariant)?ua:"normal"} ${null!=(Ga=m.fontWeight)?Ga:"normal"} ${m.fontSize}px/${m.fontSize*m.lineHeight}px ${m.fontFamily}`;if(!mt.has(`${c}-${La}-${M}`)){if(!on)return[10,10];on.parentNode||document.body.appendChild(on);on.innerHTML=`${c}&#8203;`;on.style.font=La;on.style.padding=
M+"px";m=on.getBoundingClientRect();mt.set(`${c}-${La}-${M}`,[Math.ceil(m.width||1),Math.ceil(m.height||1)])}return mt.get(`${c}-${La}-${M}`)}function rg(c){try{if("string"!==typeof c||!sc.test(c))throw TypeError("Invalid UUID");let m;const M=new Uint8Array(16);M[0]=(m=parseInt(c.slice(0,8),16))>>>24;M[1]=m>>>16&255;M[2]=m>>>8&255;M[3]=m&255;M[4]=(m=parseInt(c.slice(9,13),16))>>>8;M[5]=m&255;M[6]=(m=parseInt(c.slice(14,18),16))>>>8;M[7]=m&255;M[8]=(m=parseInt(c.slice(19,23),16))>>>8;M[9]=m&255;M[10]=
(m=parseInt(c.slice(24,36),16))/1099511627776&255;M[11]=m/4294967296&255;M[12]=m>>>24&255;M[13]=m>>>16&255;M[14]=m>>>8&255;M[15]=m&255;return!0}catch(m){return!1}}function og(c,m=0,M){let ca;return function(...ua){null==M?void 0:M(...ua);clearTimeout(ca);ca=setTimeout(()=>c.apply(ua),m)}}function Ub(){return/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)}function dc(){var c,m,M;return(null==(M=null==(m=null==(c=null==window?void 0:window.logseq)?void 0:c.api)?void 0:m.get_state_from_store)?
void 0:M.call(m,"ui/developer-mode?"))||!1}function Hc(c){return!!c}function Bc(c=0){return new Promise(m=>setTimeout(m,c))}function bd(c="noid"){nt[c]||(nt[c]=xw.createContext({}));return nt[c]}function nd(c="noid"){return xw.useContext(bd(c))}function Vd(c){const {callbacks:m}=nd(),M=ww.useRef(-1);return ww.useMemo(()=>{const ca=ua=>{var Ga,La;const {order:fb=0}=ua;if(!fb){var vb=ua.target;vb.removeEventListener("pointerup",ca);vb.releasePointerCapture(ua.pointerId);null==(Ga=m.onPointerUp)?void 0:
Ga.call(m,{type:"selection",handle:c,order:fb},ua);Ga=Date.now();vb=Ga-M.current;300<vb?M.current=Ga:300>=vb&&(null==(La=m.onDoubleClick)?void 0:La.call(m,{type:"selection",handle:c,order:fb},ua),M.current=-1);ua.order=fb+1}};return{onPointerDown:ua=>{var Ga;const {order:La=0}=ua;if(!La){var fb=be(ua.currentTarget);fb.setPointerCapture(ua.pointerId);fb.addEventListener("pointerup",ca);null==(Ga=m.onPointerDown)?void 0:Ga.call(m,{type:"selection",handle:c,order:La},ua);ua.order=La+1}},onPointerMove:ua=>
{var Ga;const {order:La=0}=ua;La||(null==(Ga=m.onPointerMove)?void 0:Ga.call(m,{type:"selection",handle:c,order:La},ua),ua.order=La+1)},onPointerEnter:ua=>{var Ga;const {order:La=0}=ua;La||(null==(Ga=m.onPointerEnter)?void 0:Ga.call(m,{type:"selection",handle:c,order:La},ua),ua.order=La+1)},onPointerLeave:ua=>{var Ga;const {order:La=0}=ua;La||(null==(Ga=m.onPointerLeave)?void 0:Ga.call(m,{type:"selection",handle:c,order:La},ua),ua.order=La+1)},onKeyDown:ua=>{var Ga;null==(Ga=m.onKeyDown)?void 0:Ga.call(m,
{type:"selection",handle:c,order:-1},ua)},onKeyUp:ua=>{var Ga;null==(Ga=m.onKeyUp)?void 0:Ga.call(m,{type:"selection",handle:c,order:-1},ua)}}},[m])}function be(c){var m;if(null==(m=c.namespaceURI)?0:m.endsWith("svg")){if(c.parentElement)return be(c.parentElement);throw Error("Could not find a parent element of an HTML type!");}return c}function qe(c,m,M){const ca=Hq.useRef(!1),ua=Hq.useCallback(()=>{var Ga;if(ca.current){const La=null==(Ga=c.current)?void 0:Ga.getBoundingClientRect();La&&(Ga={minX:La.left,
maxX:La.left+La.width,minY:La.top,maxY:La.top+La.height,width:La.width,height:La.height},m.updateBounds(Ga),null==M?void 0:M(Ga))}else ca.current=!0},[c,M]);Hq.useEffect(()=>{const Ga=c.current?bA(c.current):document,La=og(ua,100);Ga.addEventListener("scroll",La);window.addEventListener("resize",La);return()=>{Ga.removeEventListener("scroll",La);window.removeEventListener("resize",La)}},[]);Hq.useLayoutEffect(()=>{const Ga=new ResizeObserver(La=>{La[0].contentRect&&ua()});c.current&&Ga.observe(c.current);
return()=>{Ga.disconnect()}},[c]);Hq.useEffect(()=>{ua();setTimeout(()=>{var Ga,La;null==(La=null==(Ga=c.current)?void 0:Ga.querySelector(".tl-canvas"))?void 0:La.focus()})},[c])}function Ye(c,m){return Object.keys(m).reduce((M,ca)=>{const ua=m[ca];return ua?M+`${`--${c}-${ca}`}: ${ua};
`:M},"")}function Pd(c,m,M=".logseq-tldraw"){ot.useLayoutEffect(()=>{const ca=document.createElement("style"),ua=Ye(c,m);ca.setAttribute("id",`${c}-theme`);ca.setAttribute("data-selector",M);ca.innerHTML=`
        ${M} {
          ${ua}
        }
      `;document.head.appendChild(ca);return()=>{ca&&document.head.contains(ca)&&document.head.removeChild(ca)}},[c,m,M])}function af(c,m){ot.useLayoutEffect(()=>{if(pt.get(c))return()=>{};const M=document.createElement("style");M.innerHTML=m;M.setAttribute("id",c);document.head.appendChild(M);pt.set(c,M);return()=>{M&&document.head.contains(M)&&(document.head.removeChild(M),pt.delete(c))}},[c,m])}function Ke(c,m){const M=ot.useMemo(()=>Gf(Gf({},cA),c),[c]);Pd("tl",M,m);af("tl-canvas",dA)}function Ue(c=
"noid"){qt[c]||(qt[c]=zw.createContext({}));return qt[c]}function Ve(c="noid"){return zw.useContext(Ue(c))}function uf(){const c=Ve(),{callbacks:m}=nd(),M=yw.useRef(-1);return yw.useMemo(()=>({onPointerDown:ca=>{var ua,Ga,La;if(!c.settings.penMode||"pen"===ca.pointerType&&ca.isPrimary){var {order:fb=0}=ca;fb||(null==(ua=ca.currentTarget)?void 0:ua.setPointerCapture(ca.pointerId));ca.isPrimary&&(null==(Ga=m.onPointerDown)?void 0:Ga.call(m,{type:"canvas",order:fb},ca),ua=Date.now(),Ga=ua-M.current,
300<Ga?M.current=ua:300>=Ga&&(null==(La=m.onDoubleClick)?void 0:La.call(m,{type:"canvas",order:fb},ca),M.current=-1))}},onPointerMove:ca=>{var ua;if(!c.settings.penMode||"pen"===ca.pointerType&&ca.isPrimary){var {order:Ga=0}=ca;null==(ua=m.onPointerMove)?void 0:ua.call(m,{type:"canvas",order:Ga},ca)}},onPointerUp:ca=>{var ua,Ga;if(!c.settings.penMode||"pen"===ca.pointerType&&ca.isPrimary){var {order:La=0}=ca;La||(null==(ua=ca.currentTarget)?void 0:ua.releasePointerCapture(ca.pointerId));null==(Ga=
m.onPointerUp)?void 0:Ga.call(m,{type:"canvas",order:La},ca)}},onPointerEnter:ca=>{var ua;if(!c.settings.penMode||"pen"===ca.pointerType&&ca.isPrimary){var {order:Ga=0}=ca;null==(ua=m.onPointerEnter)?void 0:ua.call(m,{type:"canvas",order:Ga},ca)}},onPointerLeave:ca=>{var ua;if(!c.settings.penMode||"pen"===ca.pointerType&&ca.isPrimary){var {order:Ga=0}=ca;null==(ua=m.onPointerLeave)?void 0:ua.call(m,{type:"canvas",order:Ga},ca)}},onDrop:ca=>Wh(this,null,function*(){ca.preventDefault();"clientX"in ca&&
c.drop(ca.dataTransfer,[ca.clientX,ca.clientY])}),onDragOver:ca=>{ca.preventDefault()},onTouchEnd:ca=>{let ua=c.selectedTool.id;"pencil"!==ua&&"highlighter"!==ua||ca.preventDefault()}}),[m])}function xe(c,m,M){return 0===m||Infinity===Math.abs(m)?Math.pow(c,5*M):c*m*M/(m+M*c)}function Sf(c,m,M,ca=.15){return 0===ca?Math.max(m,Math.min(c,M)):c<m?-xe(m-c,M-m,ca)+m:c>M?+xe(c-M,M-m,ca)+M:c}function Wf(c,[m,M],[ca,ua]){const [[Ga,La],[fb,vb]]=c;return[Sf(m,Ga,La,ca),Sf(M,fb,vb,ua)]}function $b(c,m,M){m in
c?Object.defineProperty(c,m,{value:M,enumerable:!0,configurable:!0,writable:!0}):c[m]=M;return c}function yc(c,m){var M=Object.keys(c);if(Object.getOwnPropertySymbols){var ca=Object.getOwnPropertySymbols(c);m&&(ca=ca.filter(function(ua){return Object.getOwnPropertyDescriptor(c,ua).enumerable}));M.push.apply(M,ca)}return M}function Qc(c){for(var m=1;m<arguments.length;m++){var M=null!=arguments[m]?arguments[m]:{};m%2?yc(Object(M),!0).forEach(function(ca){$b(c,ca,M[ca])}):Object.getOwnPropertyDescriptors?
Object.defineProperties(c,Object.getOwnPropertyDescriptors(M)):yc(Object(M)).forEach(function(ca){Object.defineProperty(c,ca,Object.getOwnPropertyDescriptor(M,ca))})}return c}function md(c){return c?c[0].toUpperCase()+c.slice(1):""}function Hd(c=!1,m){return c&&!eA.includes(m)}function Md(c,m="",M=!1){const ca=Aw[c];m=ca?ca[m]||m:m;return"on"+md(c)+md(m)+(Hd(M,m)?"Capture":"")}function Nd(c){c=c.substring(2).toLowerCase();const m=!!~c.indexOf("passive");m&&(c=c.replace("passive",""));var M=fA.includes(c)?
"capturecapture":"capture";(M=!!~c.indexOf(M))&&(c=c.replace("capture",""));return{device:c,capture:M,passive:m}}function te(c,m=""){const M=Aw[c];return c+(M?M[m]||m:m)}function ie(c){return"touches"in c?"touch":"pointerType"in c?c.pointerType:"mouse"}function Qe(c){return Array.from(c.touches).filter(m=>{var M,ca;return m.target===c.currentTarget||(null===(M=c.currentTarget)||void 0===M?void 0:null===(ca=M.contains)||void 0===ca?void 0:ca.call(M,m.target))})}function ye(c){return"touches"in c?("touchend"===
c.type||"touchcancel"===c.type?c.changedTouches:c.targetTouches)[0]:c}function Yd(c,m){const M=m.clientX-c.clientX,ca=m.clientY-c.clientY;return{angle:-(180*Math.atan2(M,ca))/Math.PI,distance:Math.hypot(M,ca),origin:[(m.clientX+c.clientX)/2,(m.clientY+c.clientY)/2]}}function Wd(c){return Qe(c).map(m=>m.identifier)}function de(c,m){const [M,ca]=Array.from(c.touches).filter(ua=>m.includes(ua.identifier));return Yd(M,ca)}function ke(c){const m=ye(c);return"touches"in c?m.identifier:m.pointerId}function je(c){c=
ye(c);return[c.clientX,c.clientY]}function Se(c){let {deltaX:m,deltaY:M,deltaMode:ca}=c;1===ca?(m*=40,M*=40):2===ca&&(m*=800,M*=800);return[m,M]}function Xe(c,...m){return"function"===typeof c?c(...m):c}function Ae(){}function we(...c){return 0===c.length?Ae:1===c.length?c[0]:function(){let m;for(const M of c)m=M.apply(this,arguments)||m;return m}}function ve([c,m],M){c=Math.abs(c);m=Math.abs(m);if(c>m&&c>M)return"x";if(m>c&&m>M)return"y"}function dg(c){const [m,M]=c.overflow,[ca,ua]=c._delta,[Ga,
La]=c._direction;if(0>m&&0<ca&&0>Ga||0<m&&0>ca&&0<Ga)c._movement[0]=c._movementBound[0];if(0>M&&0<ua&&0>La||0<M&&0>ua&&0<La)c._movement[1]=c._movementBound[1]}function yf(c){rt.set(c.key,c.engine);st.set(c.key,c.resolver)}function eh(c={},m){const M={};for(const [ca,ua]of Object.entries(m))switch(typeof ua){case "function":M[ca]=ua.call(M,c[ca],ca,c);break;case "object":M[ca]=eh(c[ca],ua);break;case "boolean":ua&&(M[ca]=c[ca])}return M}function Kg(c,m,M={}){const {target:ca,eventOptions:ua,window:Ga,
enabled:La,transform:fb}=c;var vb=CA;if(null==c)c={};else{if(null==c)var Wb={};else{Wb={};var oc=Object.keys(c),uc;for(uc=0;uc<oc.length;uc++){var Sc=oc[uc];0<=vb.indexOf(Sc)||(Wb[Sc]=c[Sc])}}if(Object.getOwnPropertySymbols)for(uc=Object.getOwnPropertySymbols(c),Sc=0;Sc<uc.length;Sc++)oc=uc[Sc],0<=vb.indexOf(oc)||Object.prototype.propertyIsEnumerable.call(c,oc)&&(Wb[oc]=c[oc]);c=Wb}M.shared=eh({target:ca,eventOptions:ua,window:Ga,enabled:La,transform:fb},BA);if(m){var kd=st.get(m);M[m]=eh(Qc({shared:M.shared},
c),kd)}else for(kd in c)(m=st.get(kd))&&(M[kd]=eh(Qc({shared:M.shared},c[kd]),m));return M}function Dg(c,m){c.gestures.add(m);c.gestureEventStores[m]=new Iw(c,m);c.gestureTimeoutStores[m]=new DA}function qh(c,m,M,ca,ua,Ga){if(c.has(M)&&rt.has(ca)){var La=M+"Start",fb=M+"End";ua[ca]=vb=>{let Wb=void 0;if(vb.first&&La in m)m[La](vb);M in m&&(Wb=m[M](vb));if(vb.last&&fb in m)m[fb](vb);return Wb};Ga[ca]=Ga[ca]||{}}}function Ge(c,m={},M,ca){const ua=tt.default.useMemo(()=>new EA(c),[]);ua.applyHandlers(c,
ca);ua.applyConfig(m,M);tt.default.useEffect(ua.effect.bind(ua));tt.default.useEffect(()=>ua.clean.bind(ua),[]);if(void 0===m.target)return ua.bind.bind(ua)}function Fg(c){c.forEach(yf);return function(m,M){M=M||{};const ca={},ua={},Ga=new Set;for(let Sc in m)FA.test(Sc)?(Ga.add(RegExp.lastMatch),ua[Sc]=m[Sc]):ca[Sc]=m[Sc];const [La,fb,vb]=[ua,ca,Ga];m={};qh(vb,La,"onDrag","drag",m,M);qh(vb,La,"onWheel","wheel",m,M);qh(vb,La,"onScroll","scroll",m,M);qh(vb,La,"onPinch","pinch",m,M);qh(vb,La,"onMove",
"move",m,M);qh(vb,La,"onHover","hover",m,M);const {handlers:Wb,nativeHandlers:oc,config:uc}={handlers:m,config:M,nativeHandlers:fb};return Ge(Wb,uc,void 0,oc)}}function Bh(c,m){return Fg([vA,yA,zA,AA,xA,wA])(c,m||{})}function Ih(c){const {viewport:m,inputs:M,callbacks:ca}=nd(),ua=Jr.useRef(void 0),Ga=Jr.useRef([0,0]),La=Jr.useRef(0),fb=Jr.useMemo(()=>({onWheel:vb=>{var Wb;({event:vb}=vb);vb.preventDefault();const {deltaY:oc,deltaX:uc}=vb;var Sc=0;if(vb.ctrlKey||vb.metaKey){Sc=Math.sign(vb.deltaY);
let Jd=oc;10<Math.abs(vb.deltaY)&&(Jd=10*Sc);Sc=Jd}const [kd,fd,xd]=[uc,oc,Sc];"pinching"===M.state||La.current>=vb.timeStamp||(La.current=vb.timeStamp,(vb.altKey||vb.ctrlKey||vb.metaKey)&&0===vb.buttons?(Sc=m.bounds,vb=null!=(Wb=M.currentScreenPoint)?Wb:[Sc.width/2,Sc.height/2],Wb=m.camera.zoom,m.onZoom(vb,Wb-xd/100*Wb)):(Wb=ne.mul(vb.shiftKey&&!Ub()?[fd,0]:[kd,fd],.8),ne.isEqual(Wb,[0,0])||m.panCamera(Wb)))},onPinchStart:({event:vb,delta:Wb,offset:oc,origin:uc})=>{var Sc;const kd=c.current;vb instanceof
WheelEvent||!(vb.target===kd||null!=kd&&kd.contains(vb.target))||(null==(Sc=ca.onPinchStart)?void 0:Sc.call(ca,{type:"canvas",order:0,delta:[...Wb,oc[0]],offset:oc,point:ne.sub(uc,M.containerOffset)},vb),ua.current=uc,Ga.current=[0,0])},onPinchEnd:({event:vb,offset:Wb,origin:oc})=>{var uc;const Sc=c.current;vb instanceof WheelEvent||!(vb.target===Sc||null!=Sc&&Sc.contains(vb.target))||"pinching"!==M.state||(null==(uc=ca.onPinchEnd)?void 0:uc.call(ca,{type:"canvas",order:0,delta:[0,0,Wb[0]],offset:Wb,
point:ne.sub(oc,M.containerOffset)},vb),Ga.current=[0,0])},onPinch:({event:vb,offset:Wb,origin:oc})=>{var uc,Sc=c.current;if(!(vb instanceof WheelEvent)&&(vb.target===Sc||null!=Sc&&Sc.contains(vb.target))){ua.current||(ua.current=oc);Sc=ne.sub(ua.current,oc);var kd=ne.sub(Sc,Ga.current);null==(uc=ca.onPinch)?void 0:uc.call(ca,{type:"canvas",order:0,delta:[...kd,Wb[0]],offset:Wb,point:ne.sub(oc,M.containerOffset)},vb);Ga.current=Sc}}}),[ca]);Bh(fb,{target:c,eventOptions:{passive:!1},pinch:{from:[m.camera.zoom,
m.camera.zoom],scaleBounds:()=>({from:m.camera.zoom,max:ul.maxZoom,min:ul.minZoom})}})}function Hb(c,m,M,ca){ut.useLayoutEffect(()=>{c.current.style.transform=`translate(
        calc(${m.minX}px - var(--tl-padding)),
        calc(${m.minY}px - var(--tl-padding)))
        scale(var(--tl-scale))`},[m.minX,m.minY,M,m.rotation]);ut.useLayoutEffect(()=>{const ua=c.current;ua.style.width=`calc(${Math.floor(m.width)}px + (var(--tl-padding) * 2))`;ua.style.height=`calc(${Math.floor(m.height)}px + (var(--tl-padding) * 2))`},[m.width,m.height]);ut.useLayoutEffect(()=>{const ua=c.current;void 0!==ca&&(ua.style.zIndex=ca.toString())},[ca])}function Tc(c,m){const {onPersist:M,onError:ca,onMount:ua,onCreateAssets:Ga,onCreateShapes:La,onDeleteAssets:fb,onDeleteShapes:vb,
onDrop:Wb,onPaste:oc,onCopy:uc,onCanvasDBClick:Sc}=m;Kw.useLayoutEffect(()=>{const kd=[];if(c)return window.tlapps=window.tlapps||{},window.tlapps[c.uuid]=c,ua&&ua(c,null),()=>{kd.forEach(fd=>fd());window.tlapps&&delete window.tlapps[c.uuid]}},[c]);Kw.useLayoutEffect(()=>{const kd=[];M&&kd.push(c.subscribe("persist",M));ca&&kd.push(c.subscribe("error",ca));La&&kd.push(c.subscribe("create-shapes",La));Ga&&kd.push(c.subscribe("create-assets",Ga));vb&&kd.push(c.subscribe("delete-shapes",vb));fb&&kd.push(c.subscribe("delete-assets",
fb));Wb&&kd.push(c.subscribe("drop",Wb));oc&&kd.push(c.subscribe("paste",oc));uc&&kd.push(c.subscribe("copy",uc));Sc&&kd.push(c.subscribe("canvas-dbclick",Sc));return()=>kd.forEach(fd=>fd())},[c,M,ca])}function Yc(c){if("app"in c)return c.app;const [m]=Lw.useState(()=>new $z(c.model,c.Shapes,c.Tools,c.readOnly));Lw.useLayoutEffect(()=>()=>{m.dispose()},[m]);return m}function qd(c,m){GA.useEffect(()=>{"model"in m&&m.model&&c.loadDocumentModel(m.model)},[m.model])}function wd(c){const m=nd(),{viewport:{bounds:M}}=
m;HA.useEffect(()=>{const ca=La=>{La.preventDefault()},ua=La=>{if(0!==La.touches.length){var fb=La.touches[0].pageX,vb=La.touches[0].radiusX||0;(10>fb-vb||fb+vb>M.width-10)&&La.preventDefault()}},Ga=c.current;if(!Ga)return()=>{};Ga.addEventListener("touchstart",ca,{passive:!0});Ga.addEventListener("gestureend",ca,{passive:!0});Ga.addEventListener("gesturechange",ca,{passive:!0});Ga.addEventListener("gesturestart",ca,{passive:!0});Ga.addEventListener("touchstart",ua,{passive:!0});return()=>{Ga&&(Ga.removeEventListener("touchstart",
ca),Ga.removeEventListener("gestureend",ca),Ga.removeEventListener("gesturechange",ca),Ga.removeEventListener("gesturestart",ca),Ga.removeEventListener("touchstart",ua))}},[c,M.width])}function Cd(c,m){const {inputs:M,callbacks:ca}=nd();return IA.useMemo(()=>({onPointerDown:ua=>{var Ga,La;const {order:fb=0}=ua;fb||(null==(Ga=ua.currentTarget)?void 0:Ga.setPointerCapture(ua.pointerId));Ga=c.props.handles[m];null==(La=ca.onPointerDown)?void 0:La.call(ca,{type:"handle",shape:c,handle:Ga,id:m,order:fb},
ua);ua.order=fb+1},onPointerMove:ua=>{var Ga;const {order:La=0}=ua,fb=c.props.handles[m];null==(Ga=ca.onPointerMove)?void 0:Ga.call(ca,{type:"handle",shape:c,handle:fb,id:m,order:La},ua);ua.order=La+1},onPointerUp:ua=>{var Ga,La;const {order:fb=0}=ua;fb||(null==(Ga=ua.currentTarget)?void 0:Ga.releasePointerCapture(ua.pointerId));Ga=c.props.handles[m];null==(La=ca.onPointerUp)?void 0:La.call(ca,{type:"handle",shape:c,handle:Ga,id:m,order:fb},ua);ua.order=fb+1},onPointerEnter:ua=>{var Ga;const {order:La=
0}=ua,fb=c.props.handles[m];null==(Ga=ca.onPointerEnter)?void 0:Ga.call(ca,{type:"handle",shape:c,handle:fb,id:m,order:La},ua);ua.order=La+1},onPointerLeave:ua=>{var Ga;const {order:La=0}=ua,fb=c.props.handles[m];null==(Ga=ca.onPointerLeave)?void 0:Ga.call(ca,{type:"handle",shape:c,handle:fb,id:m,order:La},ua);ua.order=La+1},onKeyUp:ua=>{var Ga;const La=c.props.handles[m];null==(Ga=ca.onKeyUp)?void 0:Ga.call(ca,{type:"handle",shape:c,handle:La,id:m,order:-1},ua)},onKeyDown:ua=>{var Ga;const La=c.props.handles[m];
null==(Ga=ca.onKeyDown)?void 0:Ga.call(ca,{type:"handle",shape:c,handle:La,id:m,order:-1},ua)}}),[c.id,M,ca])}function Sd(c,m,M=!1){return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 35 35' xmlns='http://www.w3.org/2000/svg'><g fill='none' style='transform-origin:center center' transform='rotate(${m})${M?" scale(-1,-1) translate(0, -32)":""}'>`+c.replaceAll('"',"'")+'\x3c/g\x3e\x3c/svg\x3e") 16 16, pointer'}function Ed(c,m,M=0){JA.useEffect(()=>{const ca=c.current;ca&&(ca.style.cursor=
KA[m](Dh.radiansToDegrees(M)))},[m,M])}function re(c){const {viewport:m}=nd(),M=Ve();LA.useLayoutEffect(()=>nc(()=>{const ca=og(()=>{var ua;null==(ua=c.current)?void 0:ua.style.setProperty("--tl-zoom",m.camera.zoom.toString())},200);"pinching"!==M.inputs.state&&null!=m.camera.zoom&&ca()}),[])}function Le(c,m=0){const [M,ca]=(0,Mw.useState)(c);(0,Mw.useEffect)(()=>{let ua=!1;const Ga=setTimeout(()=>{ua||ca(c)},m);return()=>{ua=!0;clearTimeout(Ga)}},[c,m]);return M}function Be(){const c=Ve();Nw.useEffect(()=>
{Jc(()=>Gf({},c.viewport.camera),()=>{window.sessionStorage.setItem("logseq.tldraw.camera:"+c.currentPageId,JSON.stringify(c.viewport.camera))})},[c.viewport.camera]);Nw.useEffect(()=>{var m;const M=JSON.parse(null!=(m=window.sessionStorage.getItem("logseq.tldraw.camera:"+c.currentPageId))?m:"null");M?c.viewport.update(M):c.selectedIds.size?c.api.zoomToSelection():c.api.zoomToFit()},[c])}function Ne(c){c()}function df(c){return Sb(ia(c,void 0))}function nf(c){return{reaction:c,mounted:!1,changedBeforeMount:!1,
cleanAt:Date.now()+NA}}function ue(c){var m=new Map,M=1,ca=new c(function(ua){var Ga=m.get(ua);Ga&&(Ga.reaction.dispose(),m.delete(ua))});return{addReactionToTrack:function(ua,Ga,La){var fb=M++;ca.register(La,fb,ua);ua.current=nf(Ga);ua.current.finalizationRegistryCleanupToken=fb;m.set(fb,ua.current);return ua.current},recordReactionAsCommitted:function(ua){ca.unregister(ua);ua.current&&ua.current.finalizationRegistryCleanupToken&&m.delete(ua.current.finalizationRegistryCleanupToken)},forceCleanupTimerToRunNowForTests:function(){},
resetCleanupScheduleForTests:function(){}}}function $e(){function c(){void 0===ca&&(ca=setTimeout(m,1E4))}function m(){ca=void 0;var ua=Date.now();M.forEach(function(Ga){var La=Ga.current;La&&ua>=La.cleanAt&&(La.reaction.dispose(),Ga.current=null,M.delete(Ga))});0<M.size&&c()}var M=new Set,ca;return{addReactionToTrack:function(ua,Ga,La){ua.current=nf(Ga);M.add(ua);c();return ua.current},recordReactionAsCommitted:function(ua){M.delete(ua)},forceCleanupTimerToRunNowForTests:function(){ca&&(clearTimeout(ca),
m())},resetCleanupScheduleForTests:function(){var ua;if(0<M.size){try{for(var Ga=OA(M),La=Ga.next();!La.done;La=Ga.next()){var fb=La.value,vb=fb.current;vb&&(vb.reaction.dispose(),fb.current=null)}}catch(oc){var Wb={error:oc}}finally{try{La&&!La.done&&(ua=Ga.return)&&ua.call(Ga)}finally{if(Wb)throw Wb.error;}}M.clear()}ca&&(clearTimeout(ca),ca=void 0)}}}function Ie(){return new RA}function gg(c,m){void 0===m&&(m="observed");var M=Qw(Kq.default.useState(Ie),1)[0],ca=Qw(Kq.default.useState(),2)[1],
ua=Kq.default.useRef(null);if(!ua.current)var Ga=new kp("observer".concat(m),function(){La.mounted?ca([]):La.changedBeforeMount=!0}),La=PA(ua,Ga,M);M=ua.current.reaction;Kq.default.useDebugValue(M,df);Kq.default.useEffect(function(){QA(ua);ua.current?(ua.current.mounted=!0,ua.current.changedBeforeMount&&(ua.current.changedBeforeMount=!1,ca([]))):(ua.current={reaction:new kp("observer".concat(m),function(){ca([])}),mounted:!0,changedBeforeMount:!1,cleanAt:Infinity},ca([]));return function(){ua.current.reaction.dispose();
ua.current=null}},[]);var fb,vb;M.track(function(){try{fb=c()}catch(Wb){vb=Wb}});if(vb)throw vb;return fb}function Ee(c,m){var M;if(Tw&&c.$$typeof===Tw)throw Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");m=null!==(M=null===m||void 0===m?void 0:m.forwardRef)&&void 0!==M?M:!1;var ca=c,ua=c.displayName||c.name;if(Sw&&c.$$typeof===Sw&&(m=!0,ca=c.render,"function"!==
typeof ca))throw Error("[mobx-react-lite] `render` property of ForwardRef was not a function");M=function(Ga,La){return gg(function(){return ca(Ga,La)},ua)};""!==ua&&(M.displayName=ua);c.contextTypes&&(M.contextTypes=c.contextTypes);m&&(M=(0,tp.forwardRef)(M));M=(0,tp.memo)(M);xf(c,M);return M}function xf(c,m){Object.keys(c).forEach(function(M){SA[M]||Object.defineProperty(m,M,Object.getOwnPropertyDescriptor(c,M))})}function Pf(c){var m=c.render;c=c.children||m;return"function"!==typeof c?null:gg(c)}
function Ig(c){const m=Ve(),{callbacks:M}=nd(),ca=Uw.useRef(!1);Uw.useEffect(()=>{const ua=vb=>{var Wb,oc;if(null==(Wb=c.current)?0:Wb.contains(document.activeElement))null==(oc=M.onKeyDown)?void 0:oc.call(M,{type:"canvas",order:-1},vb),ca.current=vb.shiftKey},Ga=vb=>{var Wb,oc;if(null==(Wb=c.current)?0:Wb.contains(document.activeElement))null==(oc=M.onKeyUp)?void 0:oc.call(M,{type:"canvas",order:-1},vb),ca.current=vb.shiftKey},La=vb=>{var Wb,oc,uc;!m.editingShape&&(null==(Wb=c.current)?0:Wb.contains(document.activeElement))&&
!["INPUT","TEXTAREA"].includes(null!=(uc=null==(oc=document.activeElement)?void 0:oc.tagName)?uc:"")&&(vb.preventDefault(),m.paste(vb,ca.current))},fb=vb=>{var Wb,oc,uc;!m.editingShape&&0<m.selectedShapes.size&&(null==(Wb=c.current)?0:Wb.contains(document.activeElement))&&!["INPUT","TEXTAREA"].includes(null!=(uc=null==(oc=document.activeElement)?void 0:oc.tagName)?uc:"")&&(vb.preventDefault(),m.copy())};window.addEventListener("keydown",ua);window.addEventListener("keyup",Ga);document.addEventListener("paste",
La);document.addEventListener("copy",fb);return()=>{window.removeEventListener("keydown",ua);window.removeEventListener("keyup",Ga);document.removeEventListener("paste",La);document.removeEventListener("copy",fb)}},[])}function Qg(c){const m=Ve(),{inputs:M,callbacks:ca}=nd(),ua=Zw.useRef(-1);return Zw.useMemo(()=>({onPointerDown:Ga=>{var La,fb;if(!m.settings.penMode||"pen"===Ga.pointerType&&Ga.isPrimary){var {order:vb=0}=Ga;vb||(null==(La=Ga.currentTarget)?void 0:La.setPointerCapture(Ga.pointerId));
null==(fb=ca.onPointerDown)?void 0:fb.call(ca,{type:"shape",shape:c,order:vb},Ga);Ga.order=vb+1}},onPointerMove:Ga=>{var La;if(!m.settings.penMode||"pen"===Ga.pointerType&&Ga.isPrimary){var {order:fb=0}=Ga;null==(La=ca.onPointerMove)?void 0:La.call(ca,{type:"shape",shape:c,order:fb},Ga);Ga.order=fb+1}},onPointerUp:Ga=>{var La,fb,vb;if(!m.settings.penMode||"pen"===Ga.pointerType&&Ga.isPrimary){var {order:Wb=0}=Ga;Wb||(null==(La=Ga.currentTarget)?void 0:La.releasePointerCapture(Ga.pointerId));null==
(fb=ca.onPointerUp)?void 0:fb.call(ca,{type:"shape",shape:c,order:Wb},Ga);La=Date.now();fb=La-ua.current;300<fb?ua.current=La:300>=fb&&(null==(vb=ca.onDoubleClick)?void 0:vb.call(ca,{type:"shape",shape:c,order:Wb},Ga),ua.current=-1);Ga.order=Wb+1}},onPointerEnter:Ga=>{var La;if(!m.settings.penMode||"pen"===Ga.pointerType&&Ga.isPrimary){var {order:fb=0}=Ga;null==(La=ca.onPointerEnter)?void 0:La.call(ca,{type:"shape",shape:c,order:fb},Ga);Ga.order=fb+1}},onPointerLeave:Ga=>{var La;if(!m.settings.penMode||
"pen"===Ga.pointerType&&Ga.isPrimary){var {order:fb=0}=Ga;null==(La=ca.onPointerLeave)?void 0:La.call(ca,{type:"shape",shape:c,order:fb},Ga);Ga.order=fb+1}},onKeyUp:Ga=>{var La;null==(La=ca.onKeyUp)?void 0:La.call(ca,{type:"shape",shape:c,order:-1},Ga)},onKeyDown:Ga=>{var La;null==(La=ca.onKeyDown)?void 0:La.call(ca,{type:"shape",shape:c,order:-1},Ga)}}),[c.id,M,ca])}function Tg(c){var {viewport:m,inputs:M,callbacks:ca,components:ua}=c;c=Ti(c,["viewport","inputs","callbacks","components"]);return(0,qx.jsx)(lB,
{id:c.id,viewport:m,inputs:M,callbacks:ca,components:ua,meta:c.meta,children:(0,qx.jsx)(hB,Gf({},c))})}function Qh(c){var {side:m,content:M,sideOffset:ca=10}=c;c=Ti(c,["side","content","sideOffset"]);return M?(0,wo.jsx)(Mq.TooltipProvider,{delayDuration:300,children:(0,wo.jsxs)(Mq.Tooltip,{children:[(0,wo.jsx)(Mq.TooltipTrigger,{asChild:!0,children:c.children}),(0,wo.jsxs)(Mq.TooltipContent,ng(Gf({sideOffset:ca,side:m},c),{children:[M,(0,wo.jsx)(Mq.TooltipArrow,{className:"popper-arrow"})]}))]})}):
(0,wo.jsx)(wo.Fragment,{children:c.children})}function Zh(c){var {className:m,tooltip:M,tooltipSide:ca}=c;c=Ti(c,["className","tooltip","tooltipSide"]);return(0,rx.jsx)(Qh,{content:M,side:ca,children:(0,rx.jsx)("button",Gf({className:"tl-button "+(null!=m?m:"")},c))})}function Ng(c){var {toggle:m=!0,pressed:M,onPressedChange:ca,className:ua,tooltip:Ga}=c;c=Ti(c,["toggle","pressed","onPressedChange","className","tooltip"]);return(0,Ft.jsx)(Qh,{content:Ga,children:(0,Ft.jsx)("div",{className:"inline-flex",
children:(0,Ft.jsx)(rB.Toggle,ng(Gf({},c),{"data-toggle":m,className:"tl-button"+(ua?" "+ua:""),pressed:M,onPressedChange:ca}))})})}function rk(c){var {side:m,align:M,alignOffset:ca,label:ua,children:Ga,border:La}=c;c=Ti(c,"side align alignOffset label children border".split(" "));return(0,Ur.jsxs)(Vr.Popover,{children:[(0,Ur.jsx)(Vr.PopoverTrigger,ng(Gf({},c),{"data-border":La,className:"tl-button tl-popover-trigger-button",children:ua})),(0,Ur.jsxs)(Vr.PopoverContent,{className:"w-auto p-1",align:M,
alignOffset:ca,side:m,sideOffset:15,collisionBoundary:document.querySelector(".logseq-tldraw"),children:[Ga,(0,Ur.jsx)(Vr.PopoverArrow,{className:"popper-arrow"})]})]})}function bj(c){function m(Wb){return Wb?(0,Rj.jsx)("div",{className:"tl-color-bg",style:{backgroundColor:Wb},children:(0,Rj.jsx)("div",{className:`w-full h-full bg-${Wb}-500`})}):(0,Rj.jsx)("div",{className:"tl-color-bg",children:(0,Rj.jsx)(hh,{name:"color-swatch"})})}var {color:M,opacity:ca,popoverSide:ua,setColor:Ga,setOpacity:La}=
c;c=Ti(c,["color","opacity","popoverSide","setColor","setOpacity"]);const {handlers:{t:fb}}=vx.default.useContext(si),vb=vx.default.useMemo(()=>{let Wb="";return og(oc=>{Ga(Wb)},100,oc=>{Wb=oc.target.value})},[]);return(0,Rj.jsx)(rk,ng(Gf({},c),{border:!0,side:ua,label:(0,Rj.jsx)(Qh,{content:fb("whiteboard/color"),side:ua,sideOffset:14,children:m(M)}),children:(0,Rj.jsxs)("div",{className:"p-1",children:[(0,Rj.jsx)("div",{className:"tl-color-palette",children:Object.values(Oa).map(Wb=>(0,Rj.jsx)("button",
{className:`tl-color-drip m-1${Wb===M?" active":""}`,onClick:()=>Ga(Wb),children:m(Wb)},Wb))}),(0,Rj.jsxs)("div",{className:"flex items-center tl-custom-color",children:[(0,Rj.jsx)("div",{className:`tl-color-drip m-1 mr-3 ${Cf(M)?"":"active"}`,children:(0,Rj.jsx)("div",{className:"color-input-wrapper tl-color-bg",children:(0,Rj.jsx)("input",Gf({className:"color-input cursor-pointer",id:"tl-custom-color-input",type:"color",value:/^#(?:[0-9a-f]{3}){1,2}$/i.test(M)?M:"#000000",onChange:vb,style:{opacity:Cf(M)?
0:1}},c))})}),(0,Rj.jsx)("label",{htmlFor:"tl-custom-color-input",className:"text-xs cursor-pointer",children:fb("whiteboard/select-custom-color")})]}),La&&(0,Rj.jsx)("div",{className:"mx-1 my-2",children:(0,Rj.jsxs)(Wr.Slider,{defaultValue:[null!=ca?ca:0],onValueCommit:Wb=>La(Wb[0]),max:1,step:.1,"aria-label":fb("whiteboard/opacity"),className:"tl-slider-root",children:[(0,Rj.jsx)(Wr.SliderTrack,{className:"tl-slider-track",children:(0,Rj.jsx)(Wr.SliderRange,{className:"tl-slider-range"})}),(0,Rj.jsx)(Wr.SliderThumb,
{className:"tl-slider-thumb"})]})})]})}))}function ik(c){var {options:m,tooltip:M,popoverSide:ca,compact:ua=!1,value:Ga,onValueChange:La}=c;c=Ti(c,"options tooltip popoverSide compact value onValueChange".split(" "));const [fb,vb]=zB.useState(!1);return(0,Fm.jsx)("div",ng(Gf({},c),{children:(0,Fm.jsxs)(wp.Select,{open:fb,onOpenChange:vb,value:Ga,onValueChange:La,children:[(0,Fm.jsx)(Qh,{content:M,side:ca,children:(0,Fm.jsxs)(wp.SelectTrigger,{className:`tl-select-trigger ${ua?"compact":""}`,children:[(0,Fm.jsx)(wp.SelectValue,
{}),!ua&&(0,Fm.jsx)(wp.SelectIcon,{asChild:!0,children:(0,Fm.jsx)(BB,{className:"h-4 w-4 opacity-50"})})]})}),(0,Fm.jsx)(wp.SelectContent,{className:"min-w-min",side:ca,position:"popper",sideOffset:14,align:"center",onKeyDown:Wb=>Wb.stopPropagation(),children:m.map(Wb=>(0,Fm.jsx)(wp.SelectItem,{value:Wb.value,children:Wb.label},Wb.value))})]})}))}function Gl(c){var {scaleLevel:m,compact:M,popoverSide:ca}=c;Ti(c,["scaleLevel","compact","popoverSide"]);const ua=Ve();({handlers:{t:c}}=CB.default.useContext(si));
const Ga=[{label:M?"XS":c("whiteboard/extra-small"),value:"xs"},{label:M?"SM":c("whiteboard/small"),value:"sm"},{label:M?"MD":c("whiteboard/medium"),value:"md"},{label:M?"LG":c("whiteboard/large"),value:"lg"},{label:M?"XL":c("whiteboard/extra-large"),value:"xl"},{label:M?"XXL":c("whiteboard/huge"),value:"xxl"}];return(0,DB.jsx)(ik,{tooltip:c("whiteboard/scale-level"),options:Ga,value:m,popoverSide:ca,compact:M,onValueChange:La=>{ua.api.setScaleLevel(La)}})}function Mj(c,m){return function(M){return c(m(M))}}
function Ok(c,m){return m(c)}function gm(c,m){return function(M){return c(m,M)}}function nl(c,m){return function(){return c(m)}}function Zj(c,m){m(c);return c}function bi(){for(var c=arguments.length,m=Array(c),M=0;M<c;M++)m[M]=arguments[M];return m}function Pk(c){c()}function jk(c){return function(){return c}}function yj(){for(var c=arguments.length,m=Array(c),M=0;M<c;M++)m[M]=arguments[M];return function(){m.map(Pk)}}function cj(){}function li(c,m){return c(1,m)}function Hl(c,m){c(0,m)}function Qk(c){c(2)}
function Il(c){return c(4)}function Zg(c,m){return li(c,gm(m,0))}function sk(c,m){var M=c(1,function(ca){M();m(ca)});return M}function ah(){var c=[];return function(m,M){switch(m){case 2:c.splice(0,c.length);break;case 1:return c.push(M),function(){var ca=c.indexOf(M);-1<ca&&c.splice(ca,1)};case 0:c.slice().forEach(function(ca){ca(M)});break;default:throw Error("unrecognized action "+m);}}}function jg(c){var m=c,M=ah();return function(ca,ua){switch(ca){case 1:ua(m);break;case 0:m=ua;break;case 4:return m}return M(ca,
ua)}}function uj(c){var m,M;return function(ca,ua){switch(ca){case 1:if(ua){if(M===ua)break;m&&m();M=ua;return m=c(1,ua)}m&&m();return cj;case 2:m&&m();M=null;break;default:throw Error("unrecognized action "+ca);}}}function Si(c){return Zj(ah(),function(m){return Zg(c,m)})}function Oi(c,m){return Zj(jg(m),function(M){return Zg(c,M)})}function pl(){for(var c=arguments.length,m=Array(c),M=0;M<c;M++)m[M]=arguments[M];return function(ca){return m.reduceRight(Ok,ca)}}function Of(c){for(var m=arguments.length,
M=Array(1<m?m-1:0),ca=1;ca<m;ca++)M[ca-1]=arguments[ca];var ua=pl.apply(void 0,M);return function(Ga,La){switch(Ga){case 1:return li(c,ua(La));case 2:c(2);break;default:throw Error("unrecognized action "+Ga);}}}function Bj(c,m){return c===m}function wh(c){void 0===c&&(c=Bj);var m;return function(M){return function(ca){c(m,ca)||(m=ca,M(ca))}}}function Ah(c){return function(m){return function(M){c(M)&&m(M)}}}function Bg(c){return function(m){return Mj(m,c)}}function Ej(c){return function(m){return function(){return m(c)}}}
function wi(c,m){return function(M){return function(ca){return M(m=c(m,ca))}}}function Wj(c){return function(m){return function(M){0<c?c--:m(M)}}}function Xj(c){var m,M;return function(ca){return function(ua){m=ua;M||=setTimeout(function(){M=void 0;ca(m)},c)}}}function Cl(c){var m,M;return function(ca){return function(ua){m=ua;M&&clearTimeout(M);M=setTimeout(function(){ca(m)},c)}}}function yh(){for(var c=arguments.length,m=Array(c),M=0;M<c;M++)m[M]=arguments[M];var ca=Array(m.length),ua=0,Ga=null,
La=Math.pow(2,m.length)-1;m.forEach(function(fb,vb){var Wb=Math.pow(2,vb);li(fb,function(oc){var uc=ua;ua|=Wb;ca[vb]=oc;uc!==La&&ua===La&&Ga&&(Ga(),Ga=null)})});return function(fb){return function(vb){var Wb=function(){return fb([vb].concat(ca))};ua===La?Wb():Ga=Wb}}}function Am(){for(var c=arguments.length,m=Array(c),M=0;M<c;M++)m[M]=arguments[M];return function(ca,ua){switch(ca){case 1:return yj.apply(void 0,m.map(function(Ga){return Ga(1,ua)}));case 2:break;default:throw Error("unrecognized action "+
ca);}}}function Lh(c,m){void 0===m&&(m=Bj);return Of(c,wh(m))}function zi(){for(var c=ah(),m=arguments.length,M=Array(m),ca=0;ca<m;ca++)M[ca]=arguments[ca];var ua=Array(M.length),Ga=0,La=Math.pow(2,M.length)-1;M.forEach(function(fb,vb){var Wb=Math.pow(2,vb);li(fb,function(oc){ua[vb]=oc;Ga|=Wb;Ga===La&&c(0,ua)})});return function(fb,vb){switch(fb){case 1:return Ga===La&&vb(ua),c(1,vb);case 2:c(2);break;default:throw Error("unrecognized action "+fb);}}}function sh(c,m,M){void 0===m&&(m=[]);M=(void 0===
M?{singleton:!0}:M).singleton;return{id:Symbol(),constructor:c,dependencies:m,singleton:M}}function Fj(c){var m=new Map;return function ua(ca){var Ga=ca.id,La=ca.constructor,fb=ca.dependencies;if((ca=ca.singleton)&&m.has(Ga))return m.get(Ga);La=La(fb.map(function(vb){return ua(vb)}));ca&&m.set(Ga,La);return La}(c)}function fl(c,m){if(null==c)return{};var M={},ca=Object.keys(c),ua;for(ua=0;ua<ca.length;ua++){var Ga=ca[ua];0<=m.indexOf(Ga)||(M[Ga]=c[Ga])}return M}function ql(c,m){if(c){if("string"===
typeof c)return fn(c,m);var M=Object.prototype.toString.call(c).slice(8,-1);"Object"===M&&c.constructor&&(M=c.constructor.name);if("Map"===M||"Set"===M)return Array.from(c);if("Arguments"===M||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(M))return fn(c,m)}}function fn(c,m){if(null==m||m>c.length)m=c.length;for(var M=0,ca=Array(m);M<m;M++)ca[M]=c[M];return ca}function fm(c,m){var M="undefined"!==typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];if(M)return(M=M.call(c)).next.bind(M);if(Array.isArray(c)||
(M=ql(c))||m&&c&&"number"===typeof c.length){M&&(c=M);var ca=0;return function(){return ca>=c.length?{done:!0}:{done:!1,value:c[ca++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function cp(c,m){for(var M={},ca={},ua=0,Ga=c.length;ua<Ga;)ca[c[ua]]=1,ua+=1;for(var La in m)ca.hasOwnProperty(La)||(M[La]=m[La]);return M}function pc(c,m,M){function ca(uc,Sc){uc.propsReady&&(0,uc.propsReady)(0,
!1);for(var kd=fm(La),fd;!(fd=kd()).done;)fd=fd.value,(0,uc[m.required[fd]])(0,Sc[fd]);for(kd=fm(fb);!(fd=kd()).done;)if(fd=fd.value,fd in Sc)(0,uc[m.optional[fd]])(0,Sc[fd]);uc.propsReady&&(0,uc.propsReady)(0,!0)}function ua(uc){return vb.reduce(function(Sc,kd){Sc[kd]=function(fd){(0,uc[m.methods[kd]])(0,fd)};return Sc},{})}function Ga(uc){return Wb.reduce(function(Sc,kd){Sc[kd]=uj(uc[m.events[kd]]);return Sc},{})}var La=Object.keys(m.required||{}),fb=Object.keys(m.optional||{}),vb=Object.keys(m.methods||
{}),Wb=Object.keys(m.events||{}),oc=(0,Ck.createContext)({});return{Component:(0,Ck.forwardRef)(function(uc,Sc){var kd=uc.children,fd=fl(uc,IB),xd=(0,Ck.useState)(function(){return Zj(Fj(c),function($c){return ca($c,fd)})})[0],Jd=(0,Ck.useState)(nl(Ga,xd))[0];Xr(function(){for(var $c=fm(Wb),hd;!(hd=$c()).done;)if(hd=hd.value,hd in fd)(0,Jd[hd])(1,fd[hd]);return function(){Object.values(Jd).map(Qk)}},[fd,Jd,xd]);Xr(function(){ca(xd,fd)});(0,Ck.useImperativeHandle)(Sc,jk(ua(xd)));return(0,Ck.createElement)(oc.Provider,
{value:xd},M?(0,Ck.createElement)(M,cp([].concat(La,fb,Wb),fd),kd):kd)}),usePublisher:function(uc){return(0,Ck.useCallback)(gm(Hl,(0,Ck.useContext)(oc)[uc]),[uc])},useEmitterValue:function(uc){var Sc=(0,Ck.useContext)(oc)[uc];uc=(0,Ck.useState)(nl(Il,Sc));var kd=uc[0],fd=uc[1];Xr(function(){return li(Sc,function(xd){xd!==kd&&fd(jk(xd))})},[Sc,kd]);return kd},useEmitter:function(uc,Sc){var kd=(0,Ck.useContext)(oc)[uc];Xr(function(){return kd(1,Sc)},[Sc,kd])}}}function Ia(){return Ia=Object.assign||
function(c){for(var m=1;m<arguments.length;m++){var M=arguments[m],ca;for(ca in M)Object.prototype.hasOwnProperty.call(M,ca)&&(c[ca]=M[ca])}return c},Ia.apply(this,arguments)}function zc(c,m){if(null==c)return{};var M,ca,ua={},Ga=Object.keys(c);for(ca=0;ca<Ga.length;ca++)0<=m.indexOf(M=Ga[ca])||(ua[M]=c[M]);return ua}function Ac(c,m){(null==m||m>c.length)&&(m=c.length);for(var M=0,ca=Array(m);M<m;M++)ca[M]=c[M];return ca}function Tb(c,m){var M="undefined"!=typeof Symbol&&c[Symbol.iterator]||c["@@iterator"];
if(M)return(M=M.call(c)).next.bind(M);if(Array.isArray(c)||(M=function(ua,Ga){if(ua){if("string"==typeof ua)return Ac(ua,Ga);var La=Object.prototype.toString.call(ua).slice(8,-1);return"Object"===La&&ua.constructor&&(La=ua.constructor.name),"Map"===La||"Set"===La?Array.from(ua):"Arguments"===La||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(La)?Ac(ua,Ga):void 0}}(c))||m&&c&&"number"==typeof c.length){M&&(c=M);var ca=0;return function(){return ca>=c.length?{done:!0}:{done:!1,value:c[ca++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}function Gc(c,m){void 0===m&&(m=!0);var M=(0,Rh.useRef)(null),ca=function(Ga){};if("undefined"!=typeof ResizeObserver){var ua=new ResizeObserver(function(Ga){Ga=Ga[0].target;null!==Ga.offsetParent&&c(Ga)});ca=function(Ga){Ga&&m?(ua.observe(Ga),M.current=Ga):(M.current&&ua.unobserve(M.current),M.current=null)}}return{ref:M,callbackRef:ca}}function lc(c,m){return void 0===m&&(m=!0),Gc(c,m).callbackRef}function Vb(c,m,M,ca,ua,Ga,La){return Gc(function(fb){for(var vb=function(uc,Sc,kd,fd){kd=uc.length;
if(0===kd)return null;for(var xd=[],Jd=0;Jd<kd;Jd++){var $c=uc.item(Jd);if($c&&void 0!==$c.dataset.index){var hd=parseInt($c.dataset.index),od=parseFloat($c.dataset.knownSize),Kd=Sc($c,"offsetHeight");if(0===Kd&&fd("Zero-sized element, this should not happen",{child:$c},Tj.ERROR),Kd!==od)$c=xd[xd.length-1],0===xd.length||$c.size!==Kd||$c.endIndex!==hd-1?xd.push({startIndex:hd,endIndex:hd,size:Kd}):xd[xd.length-1].endIndex++}}return xd}(fb.children,m,0,ua),Wb=fb.parentElement;!Wb.dataset.virtuosoScroller;)Wb=
Wb.parentElement;var oc="window"===Wb.firstElementChild.dataset.viewportType;ca({scrollTop:Math.max(La?La.scrollTop:oc?window.pageYOffset||document.documentElement.scrollTop:Wb.scrollTop,0),scrollHeight:La?La.scrollHeight:oc?document.documentElement.scrollHeight:Wb.scrollHeight,viewportHeight:La?La.offsetHeight:oc?window.innerHeight:Wb.offsetHeight});null==Ga||Ga(function(uc,Sc,kd){return"normal"===Sc||null!=Sc&&Sc.endsWith("px")||kd("row-gap was not resolved to pixel value correctly",Sc,Tj.WARN),
"normal"===Sc?0:parseInt(null!=Sc?Sc:"0",10)}(0,getComputedStyle(fb).rowGap,ua));null!==vb&&c(vb)},M)}function Qb(c,m){return Math.round(c.getBoundingClientRect()[m])}function Nc(c,m,M,ca,ua){void 0===ca&&(ca=cj);var Ga=(0,Rh.useRef)(null),La=(0,Rh.useRef)(null),fb=(0,Rh.useRef)(null),vb=(0,Rh.useRef)(!1),Wb=(0,Rh.useCallback)(function(oc){oc=oc.target;var uc=oc===window||oc===document,Sc=uc?window.pageYOffset||document.documentElement.scrollTop:oc.scrollTop,kd=uc?document.documentElement.scrollHeight:
oc.scrollHeight,fd=uc?window.innerHeight:oc.offsetHeight;oc=function(){c({scrollTop:Math.max(Sc,0),scrollHeight:kd,viewportHeight:fd})};vb.current?(0,JB.flushSync)(oc):oc();vb.current=!1;null!==La.current&&(Sc===La.current||0>=Sc||Sc===kd-fd)&&(La.current=null,m(!0),fb.current&&(clearTimeout(fb.current),fb.current=null))},[c,m]);return(0,Rh.useEffect)(function(){var oc=ua||Ga.current;return ca(ua||Ga.current),Wb({target:oc}),oc.addEventListener("scroll",Wb,{passive:!0}),function(){ca(null);oc.removeEventListener("scroll",
Wb)}},[Ga,Wb,M,ca,ua]),{scrollerRef:Ga,scrollByCallback:function(oc){vb.current=!0;Ga.current.scrollBy(oc)},scrollToCallback:function(oc){var uc=Ga.current;if(uc&&!("offsetHeight"in uc&&0===uc.offsetHeight)){var Sc,kd,fd,xd="smooth"===oc.behavior;if(uc===window?(kd=Math.max(Qb(document.documentElement,"height"),document.documentElement.scrollHeight),Sc=window.innerHeight,fd=document.documentElement.scrollTop):(kd=uc.scrollHeight,Sc=Qb(uc,"height"),fd=uc.scrollTop),oc.top=Math.ceil(Math.max(Math.min(kd-
Sc,oc.top),0)),1.01>Math.abs(Sc-kd)||oc.top===fd)return c({scrollTop:fd,scrollHeight:kd,viewportHeight:Sc}),void(xd&&m(!0));xd?(La.current=oc.top,fb.current&&clearTimeout(fb.current),fb.current=setTimeout(function(){fb.current=null;La.current=null;m(!0)},1E3)):La.current=null;uc.scrollTo(oc)}}}}function Wc(c,m,M,ca,ua){return void 0===ca&&(ca=mi),void 0===ua&&(ua=mi),{k:c,v:m,lvl:M,l:ca,r:ua}}function gd(c,m){if(c===mi)return mi;var M=c.k,ca=c.l,ua=c.r;if(m===M){if(ca===mi)return ua;if(ua===mi)return ca;
m=Oe(ca);return Lg(ff(c,{k:m[0],v:m[1],l:zf(ca)}))}return Lg(ff(c,m<M?{l:gd(ca,m)}:{r:gd(ua,m)}))}function vd(c,m,M){return(void 0===M&&(M="k"),c===mi)?[-Infinity,void 0]:c[M]===m?[c.k,c.v]:c[M]<m?(m=vd(c.r,m,M),-Infinity===m[0]?[c.k,c.v]:m):vd(c.l,m,M)}function Dd(c,m,M){return c===mi?Wc(m,M,1):m===c.k?ff(c,{k:m,v:M}):Mf(cg(ff(c,m<c.k?{l:Dd(c.l,m,M)}:{r:Dd(c.r,m,M)})))}function Td(c,m,M){if(c===mi)return[];var ca=c.k,ua=c.v,Ga=c.r,La=[];return ca>m&&(La=La.concat(Td(c.l,m,M))),ca>=m&&ca<=M&&La.push({k:ca,
v:ua}),ca<=M&&(La=La.concat(Td(Ga,m,M))),La}function se(c){return c===mi?[]:[].concat(se(c.l),[{k:c.k,v:c.v}],se(c.r))}function Oe(c){return c.r===mi?[c.k,c.v]:Oe(c.r)}function zf(c){return c.r===mi?c.l:Lg(ff(c,{r:zf(c.r)}))}function ff(c,m){return Wc(void 0!==m.k?m.k:c.k,void 0!==m.v?m.v:c.v,void 0!==m.lvl?m.lvl:c.lvl,void 0!==m.l?m.l:c.l,void 0!==m.r?m.r:c.r)}function Og(c){return c===mi||c.lvl>c.r.lvl}function Lg(c){var m=c.l,M=c.r,ca=c.lvl;if(M.lvl>=ca-1&&m.lvl>=ca-1)return c;if(ca>M.lvl+1){if(Og(m))return cg(ff(c,
{lvl:ca-1}));if(m===mi||m.r===mi)throw Error("Unexpected empty nodes");return ff(m.r,{l:ff(m,{r:m.r.l}),r:ff(c,{l:m.r.r,lvl:ca-1}),lvl:ca})}if(Og(c))return Mf(ff(c,{lvl:ca-1}));if(M===mi||M.l===mi)throw Error("Unexpected empty nodes");m=M.l;var ua=Og(m)?M.lvl-1:M.lvl;return ff(m,{l:ff(c,{r:m.l,lvl:ca-1}),r:Mf(ff(M,{l:m.r,lvl:ua})),lvl:m.lvl+1})}function Ug(c,m,M){return c===mi?[]:zg(Td(c,vd(c,m)[0],M),function(ca){return{index:ca.k,value:ca.v}})}function zg(c,m){var M=c.length;if(0===M)return[];var ca=
m(c[0]),ua=ca.index;ca=ca.value;for(var Ga=[],La=1;La<M;La++){var fb=m(c[La]),vb=fb.index;fb=fb.value;Ga.push({start:ua,end:vb-1,value:ca});ua=vb;ca=fb}return Ga.push({start:ua,end:Infinity,value:ca}),Ga}function Mf(c){var m=c.r,M=c.lvl;return m===mi||m.r===mi||m.lvl!==M||m.r.lvl!==M?c:ff(m,{l:ff(c,{r:m.l}),lvl:M+1})}function cg(c){var m=c.l;return m===mi||m.lvl!==c.lvl?c:ff(m,{r:ff(c,{l:m.r})})}function mh(c,m,M,ca){void 0===ca&&(ca=0);for(var ua=c.length-1;ca<=ua;){var Ga=Math.floor((ca+ua)/2),
La=M(c[Ga],m);if(0===La)return Ga;if(-1===La){if(2>ua-ca)return Ga-1;ua=Ga-1}else{if(ua===ca)return Ga;ca=Ga+1}}throw Error("Failed binary finding record in array - "+c.join(",")+", searched for "+m);}function ph(c){var m=c.size,M=c.startIndex,ca=c.endIndex;return function(ua){return ua.start===M&&(ua.end===ca||Infinity===ua.end)&&ua.value===m}}function Jf(c,m){c=c.index;return m===c?0:m<c?-1:1}function oi(c,m){c=c.offset;return m===c?0:m<c?-1:1}function Ch(c){return{index:c.index,value:c}}function gi(c,
m,M,ca){var ua=0,Ga=0,La=0,fb;0!==m?(La=c[fb=mh(c,m-1,Jf)].offset,Ga=vd(M,m-1),ua=Ga[0],Ga=Ga[1],c.length&&c[fb].size===vd(M,m)[1]&&--fb,c=c.slice(0,fb+1)):c=[];for(m=Tb(Ug(M,m,Infinity));!(M=m()).done;)fb=M.value,M=fb.start,fb=fb.value,ua=M-ua,La=ua*Ga+La+ua*ca,c.push({offset:La,size:fb,index:M}),ua=M,Ga=fb;return{offsetTree:c,lastIndex:ua,lastOffset:La,lastSize:Ga}}function uh(c,m){var M=m[0],ca=m[1],ua=m[3];0<M.length&&(0,m[2])("received item sizes",M,Tj.DEBUG);var Ga=c.sizeTree;m=Ga;var La=0;
if(0<ca.length&&Ga===mi&&2===M.length){var fb=M[0].size,vb=M[1].size;m=ca.reduce(function(oc,uc){return Dd(Dd(oc,uc,fb),uc+1,vb)},m)}else M=function(oc,uc){var Sc,kd=oc===mi?0:Infinity;for(uc=Tb(uc);!(Sc=uc()).done;){var fd=Sc.value;Sc=fd.size;var xd=fd.startIndex,Jd=fd.endIndex;if(kd=Math.min(kd,xd),oc===mi)oc=Dd(oc,0,Sc);else{var $c=Ug(oc,xd-1,Jd+1);if(!$c.some(ph(fd))){var hd,od=fd=!1;for($c=Tb($c);!(hd=$c()).done;){var Kd=hd.value;hd=Kd.start;var zd=Kd.end;Kd=Kd.value;fd?(Jd>=hd||Sc===Kd)&&(oc=
gd(oc,hd)):(od=Kd!==Sc,fd=!0);zd>Jd&&Jd>=hd&&Kd!==Sc&&(oc=Dd(oc,Jd+1,Kd))}od&&(oc=Dd(oc,xd,Sc))}}}return[oc,kd]}(m,M),m=M[0],La=M[1];if(m===Ga)return c;c=gi(c.offsetTree,La,m,ua);var Wb=c.offsetTree;return{sizeTree:m,offsetTree:Wb,lastIndex:c.lastIndex,lastOffset:c.lastOffset,lastSize:c.lastSize,groupOffsetTree:ca.reduce(function(oc,uc){return Dd(oc,uc,Ui(uc,Wb,ua))},mi),groupIndices:ca}}function Ui(c,m,M){if(0===m.length)return 0;m=m[mh(m,c,Jf)];c-=m.index;c=m.size*c+(c-1)*M+m.offset;return 0<c?
c+M:c}function Hh(c,m,M){if(void 0!==c.groupIndex)return m.groupIndices[c.groupIndex]+1;c=Ai("LAST"===c.index?M:c.index,m);return Math.max(0,c,Math.min(M,c))}function Ai(c,m){if(m.groupOffsetTree===mi)return c;for(var M=0;m.groupIndices[M]<=c+M;)M++;return c+M}function kj(c){c="number"==typeof c?{index:c}:c;return c.align||(c.align="start"),c.behavior&&NB||(c.behavior="auto"),c.offset||(c.offset=0),c}function Qn(c){return!!c&&("smooth"===c?"smooth":"auto")}function gl(c){return c.reduce(function(m,
M){return m.groupIndices.push(m.totalCount),m.totalCount+=M+1,m},{totalCount:0,groupIndices:[]})}function Pm(c,m){return!(!c||c[0]!==m[0]||c[1]!==m[1])}function yk(c,m){return!(!c||c.startIndex!==m.startIndex||c.endIndex!==m.endIndex)}function Rn(c,m,M){return"number"==typeof c?"up"===M&&"top"===m||"down"===M&&"bottom"===m?c:0:"up"===M?"top"===m?c.main:c.reverse:"bottom"===m?c.main:c.reverse}function qr(c,m,M){if(0===c.length)return[];if(m.groupOffsetTree===mi)return c.map(function(vb){return Ia({},
vb,{index:vb.index+M,originalIndex:vb.index})});var ca,ua=[],Ga=Ug(m.groupOffsetTree,c[0].index,c[c.length-1].index),La=void 0,fb=0;for(c=Tb(c);!(ca=c()).done;)ca=ca.value,(!La||La.end<ca.index)&&(La=Ga.shift(),fb=m.groupIndices.indexOf(La.start)),ua.push(Ia({},ca.index===La.start?{type:"group",index:fb}:{index:ca.index-(fb+1)+M,groupIndex:fb},{size:ca.size,offset:ca.offset,originalIndex:ca.index,data:ca.data}));return ua}function Lo(c,m,M,ca,ua,Ga){var La=0,fb=0;0<c.length&&(La=c[0].offset,fb=c[c.length-
1],fb=fb.offset+fb.size);var vb=M-ua.lastIndex,Wb=La;ca=ua.lastOffset+vb*ua.lastSize+(vb-1)*ca-fb;return{items:qr(c,ua,Ga),topItems:qr(m,ua,Ga),topListHeight:m.reduce(function(oc,uc){return uc.size+oc},0),offsetTop:La,offsetBottom:ca,top:Wb,bottom:fb,totalCount:M,firstItemIndex:Ga}}function Qm(c){var m,M=!1;return function(){return M||(M=!0,m=c()),m}}function Rm(c,m){var M=(0,Rh.useRef)(null),ca=(0,Rh.useCallback)(function(vb){if(null!==vb&&vb.offsetParent){var Wb=vb.getBoundingClientRect();vb=Wb.width;
if(m){var oc=m.getBoundingClientRect();Wb=Wb.top-oc.top;oc=oc.height-Math.max(0,Wb);Wb+=m.scrollTop}else oc=window.innerHeight-Math.max(0,Wb.top),Wb=Wb.top+window.pageYOffset;M.current={offsetTop:Wb,visibleHeight:oc,visibleWidth:vb};c(M.current)}},[c,m]),ua=Gc(ca),Ga=ua.callbackRef,La=ua.ref,fb=(0,Rh.useCallback)(function(){ca(La.current)},[ca,La]);return(0,Rh.useEffect)(function(){if(m){m.addEventListener("scroll",fb);var vb=new ResizeObserver(fb);return vb.observe(m),function(){m.removeEventListener("scroll",
fb);vb.unobserve(m)}}return window.addEventListener("scroll",fb),window.addEventListener("resize",fb),function(){window.removeEventListener("scroll",fb);window.removeEventListener("resize",fb)}},[fb,m]),Ga}function um(c){return c}function Lj(c,m){var M=ah();return li(M,function(){return console.warn("react-virtuoso: You are using a deprecated property. "+m,"color: red;","color: inherit;","color: blue;")}),Zg(M,c),M}function oj(c,m){if("string"!=typeof c)return{context:m}}function vq(c){var m=c.usePublisher,
M=c.useEmitter,ca=c.useEmitterValue;return th.memo(function(ua){var Ga=ua.style,La=ua.children;ua=zc(ua,aC);var fb=m("scrollContainerState"),vb=ca("ScrollerComponent"),Wb=m("smoothScrollTargetReached"),oc=ca("scrollerRef"),uc=ca("context");fb=Nc(fb,Wb,vb,oc);Wb=fb.scrollerRef;oc=fb.scrollByCallback;return M("scrollTo",fb.scrollToCallback),M("scrollBy",oc),(0,Rh.createElement)(vb,Ia({ref:Wb,style:Ia({},hC,Ga),"data-test-id":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0},ua,oj(vb,uc)),
La)})}function em(c){var m=c.usePublisher,M=c.useEmitter,ca=c.useEmitterValue;return th.memo(function(ua){var Ga=ua.style,La=ua.children;ua=zc(ua,bC);var fb=m("windowScrollContainerState"),vb=ca("ScrollerComponent"),Wb=m("smoothScrollTargetReached"),oc=ca("totalListHeight"),uc=ca("deviation"),Sc=ca("customScrollParent"),kd=ca("context");Wb=Nc(fb,Wb,vb,cj,Sc);var fd=Wb.scrollerRef;fb=Wb.scrollByCallback;Wb=Wb.scrollToCallback;return KB(function(){return fd.current=Sc||window,function(){fd.current=
null}},[fd,Sc]),M("windowScrollTo",Wb),M("scrollBy",fb),(0,Rh.createElement)(vb,Ia({style:Ia({position:"relative"},Ga,0!==oc?{height:oc+uc}:{}),"data-virtuoso-scroller":!0},ua,oj(vb,kd)),La)})}function $o(c,m,M){return Array.from({length:m-c+1}).map(function(ca,ua){return{index:ua+c,data:null==M?void 0:M[ua+c]}})}function qq(c,m){return c&&c.column===m.column&&c.row===m.row}function dm(c,m,M,ca){var ua=M.height;return void 0===ua||0===ca.length?{top:0,bottom:0}:{top:ym(c,m,M,ca[0].index),bottom:ym(c,
m,M,ca[ca.length-1].index)+ua}}function ym(c,m,M,ca){var ua=m.column;c=Ap(1,$r((c.width+ua)/(M.width+ua)));ca=$r(ca/c);M=ca*M.height+Ap(0,ca-1)*m.row;return 0<M?M+m.row:M}function Um(c,m,M){return"normal"===m||null!=m&&m.endsWith("px")||M(c+" was not resolved to pixel value correctly",m,Tj.WARN),"normal"===m?0:parseInt(null!=m?m:"0",10)}function hl(){hl=Object.assign?Object.assign.bind():function(c){for(var m=1;m<arguments.length;m++){var M=arguments[m],ca;for(ca in M)Object.prototype.hasOwnProperty.call(M,
ca)&&(c[ca]=M[ca])}return c};return hl.apply(this,arguments)}function Wl(c,m){Wl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,ca){M.__proto__=ca;return M};return Wl(c,m)}function ml(c,m){c.prototype=Object.create(m.prototype);c.prototype.constructor=c;Wl(c,m)}function go(c){go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(m){return m.__proto__||Object.getPrototypeOf(m)};return go(c)}function io(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;
if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(c){return!1}}function Tm(c,m,M){Tm=io()?Reflect.construct.bind():function(ca,ua,Ga){var La=[null];La.push.apply(La,ua);ca=new (Function.bind.apply(ca,La));Ga&&Wl(ca,Ga.prototype);return ca};return Tm.apply(null,arguments)}function lq(c){var m="function"===typeof Map?new Map:void 0;lq=function(M){function ca(){return Tm(M,arguments,go(this).constructor)}if(null===M||
-1===Function.toString.call(M).indexOf("[native code]"))return M;if("function"!==typeof M)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof m){if(m.has(M))return m.get(M);m.set(M,ca)}ca.prototype=Object.create(M.prototype,{constructor:{value:ca,enumerable:!1,writable:!0,configurable:!0}});return Wl(ca,M)};return lq(c)}function Ss(c,m,M){return Math.round(255*c)+","+Math.round(255*m)+","+Math.round(255*M)}function Dl(c,m,M,ca){void 0===ca&&(ca=Ss);if(0===
m)return ca(M,M,M);c=(c%360+360)%360/60;var ua=(1-Math.abs(2*M-1))*m,Ga=ua*(1-Math.abs(c%2-1)),La=m=0,fb=0;0<=c&&1>c?(m=ua,La=Ga):1<=c&&2>c?(m=Ga,La=ua):2<=c&&3>c?(La=ua,fb=Ga):3<=c&&4>c?(La=Ga,fb=ua):4<=c&&5>c?(m=Ga,fb=ua):5<=c&&6>c&&(m=ua,fb=Ga);M-=ua/2;return ca(m+M,La+M,fb+M)}function Ts(c){if("string"!==typeof c)throw new km(3);if("string"===typeof c){var m=c.toLowerCase();c=Mx[m]?"#"+Mx[m]:c}if(c.match(MC))return{red:parseInt(""+c[1]+c[2],16),green:parseInt(""+c[3]+c[4],16),blue:parseInt(""+
c[5]+c[6],16)};if(c.match(NC))return m=parseFloat((parseInt(""+c[7]+c[8],16)/255).toFixed(2)),{red:parseInt(""+c[1]+c[2],16),green:parseInt(""+c[3]+c[4],16),blue:parseInt(""+c[5]+c[6],16),alpha:m};if(c.match(OC))return{red:parseInt(""+c[1]+c[1],16),green:parseInt(""+c[2]+c[2],16),blue:parseInt(""+c[3]+c[3],16)};if(c.match(PC))return m=parseFloat((parseInt(""+c[4]+c[4],16)/255).toFixed(2)),{red:parseInt(""+c[1]+c[1],16),green:parseInt(""+c[2]+c[2],16),blue:parseInt(""+c[3]+c[3],16),alpha:m};if(m=Tt.exec(c))return{red:parseInt(""+
m[1],10),green:parseInt(""+m[2],10),blue:parseInt(""+m[3],10)};if(m=QC.exec(c.substring(0,50)))return{red:parseInt(""+m[1],10),green:parseInt(""+m[2],10),blue:parseInt(""+m[3],10),alpha:1<parseFloat(""+m[4])?parseFloat(""+m[4])/100:parseFloat(""+m[4])};var M=RC.exec(c);if(M){m=parseInt(""+M[1],10);var ca=parseInt(""+M[2],10)/100;M=parseInt(""+M[3],10)/100;m="rgb("+Dl(m,ca,M)+")";ca=Tt.exec(m);if(!ca)throw new km(4,c,m);return{red:parseInt(""+ca[1],10),green:parseInt(""+ca[2],10),blue:parseInt(""+
ca[3],10)}}if(m=SC.exec(c.substring(0,50))){ca=parseInt(""+m[1],10);M=parseInt(""+m[2],10)/100;var ua=parseInt(""+m[3],10)/100;ca="rgb("+Dl(ca,M,ua)+")";M=Tt.exec(ca);if(!M)throw new km(4,c,ca);return{red:parseInt(""+M[1],10),green:parseInt(""+M[2],10),blue:parseInt(""+M[3],10),alpha:1<parseFloat(""+m[4])?parseFloat(""+m[4])/100:parseFloat(""+m[4])}}throw new km(5);}function Ak(c){c=c.toString(16);return 1===c.length?"0"+c:c}function jh(c,m,M){return Ut("#"+Ak(Math.round(255*c))+Ak(Math.round(255*
m))+Ak(Math.round(255*M)))}function rr(c,m,M){if("number"===typeof c&&"number"===typeof m&&"number"===typeof M)return Ut("#"+Ak(c)+Ak(m)+Ak(M));if("object"===typeof c&&void 0===m&&void 0===M)return Ut("#"+Ak(c.red)+Ak(c.green)+Ak(c.blue));throw new km(6);}function rq(c){if("object"!==typeof c)throw new km(8);if("number"===typeof c.red&&"number"===typeof c.green&&"number"===typeof c.blue&&"number"===typeof c.alpha){if("object"===typeof c)c=1<=c.alpha?rr(c.red,c.green,c.blue):"rgba("+c.red+","+c.green+
","+c.blue+","+c.alpha+")";else throw new km(7);return c}if("number"===typeof c.red&&"number"===typeof c.green&&"number"===typeof c.blue&&("number"!==typeof c.alpha||"undefined"===typeof c.alpha))return rr(c);if("number"===typeof c.hue&&"number"===typeof c.saturation&&"number"===typeof c.lightness&&"number"===typeof c.alpha){if("object"===typeof c)c=1<=c.alpha?Dl(c.hue,c.saturation,c.lightness,jh):"rgba("+Dl(c.hue,c.saturation,c.lightness)+","+c.alpha+")";else throw new km(2);return c}if("number"===
typeof c.hue&&"number"===typeof c.saturation&&"number"===typeof c.lightness&&("number"!==typeof c.alpha||"undefined"===typeof c.alpha)){if("object"===typeof c)c=Dl(c.hue,c.saturation,c.lightness,jh);else throw new km(1);return c}throw new km(8);}function Po(c,m,M){return function(){var ca=M.concat(Array.prototype.slice.call(arguments));return ca.length>=m?c.apply(this,ca):Po(c,m,ca)}}function ap(c,m){if("transparent"===m)return m;m=Ts(m);var M=m.red/255,ca=m.green/255,ua=m.blue/255,Ga=Math.max(M,
ca,ua),La=Math.min(M,ca,ua),fb=(Ga+La)/2;if(Ga===La)m=void 0!==m.alpha?{hue:0,saturation:0,lightness:fb,alpha:m.alpha}:{hue:0,saturation:0,lightness:fb};else{var vb=Ga-La;La=.5<fb?vb/(2-Ga-La):vb/(Ga+La);switch(Ga){case M:M=(ca-ua)/vb+(ca<ua?6:0);break;case ca:M=(ua-M)/vb+2;break;default:M=(M-ca)/vb+4}M*=60;m=void 0!==m.alpha?{hue:M,saturation:La,lightness:fb,alpha:m.alpha}:{hue:M,saturation:La,lightness:fb}}fb=hl;c=m.lightness-parseFloat(c);return rq(fb({},m,{lightness:Math.max(0,Math.min(1,c))}))}
function Nk(c,m){var M;void 0!==m.strokeWidth&&(m.strokeWidth=Math.max(m.strokeWidth,1));void 0!==m.opacity&&(m.opacity=Math.min(1,Math.max(m.opacity,0)));let ca=null!=(M=m.fill)?M:c.props.fill;void 0===ca||Cf(ca)||"var(--ls-secondary-background-color)"===ca||m.noFill||!Co.includes(c.props.type)||(c=TC(.3,ca),m.stroke=c);return m}function sq({strokeWidth:c,size:m,mode:M}){return"svg"===M?(0,Nx.jsx)("rect",{className:"tl-binding-indicator",x:c,y:c,rx:2,ry:2,width:Math.max(0,m[0]-2*c),height:Math.max(0,
m[1]-2*c),strokeWidth:4*c}):(0,Nx.jsx)("div",{className:"tl-binding-indicator",style:{position:"absolute",left:0,top:0,right:0,bottom:0,boxShadow:"0 0 0 4px var(--tl-binding)",borderRadius:4}})}function Sm(){const c=Ve();return"panning"===c.inputs.state||"pinching"===c.inputs.state}function No({left:c,middle:m,right:M,stroke:ca,strokeWidth:ua}){return(0,$t.jsxs)("g",{children:[(0,$t.jsx)("path",{className:"tl-stroke-hitarea",d:`M ${c} L ${m} ${M}`}),(0,$t.jsx)("path",{d:`M ${c} L ${m} ${M}`,fill:"none",
stroke:ca,strokeWidth:ua,strokeLinecap:"round",strokeLinejoin:"round",pointerEvents:"none"})]})}function Vl(c,m,M){m=T(c,m,c,M).points;if(!m)return console.warn("Could not find an intersection for the arrow head."),{left:c,right:c};m=(M=m[0])?ne.rotWith(M,c,Math.PI/6):c;c=M?ne.rotWith(M,c,-Math.PI/6):c;return{left:m,right:c}}function tm(c,m,M){const {left:ca,right:ua}=Vl(c,m,M);return`M ${ca} L ${c} ${ua}`}function vj(c,m,M,ca,ua){c=c.strokeWidth;var Ga=ne.dist(m,M);c=Math.min(Ga/3,16*c);Ga=[];Ga.push(`M ${m} L ${M}`);
ca&&Ga.push(tm(m,M,c));ua&&Ga.push(tm(M,m,c));return Ga.join(" ")}function bp({id:c,bounds:m,labelSize:M,offset:ca,scale:ua=1}){return(0,fs.jsx)("defs",{children:(0,fs.jsxs)("mask",{id:c+"_clip",children:[(0,fs.jsx)("rect",{x:-100,y:-100,width:m.width+200,height:m.height+200,fill:"white"}),(0,fs.jsx)("rect",{x:m.width/2-M[0]/2*ua+((null==ca?void 0:ca[0])||0),y:m.height/2-M[1]/2*ua+((null==ca?void 0:ca[1])||0),width:M[0]*ua,height:M[1]*ua,rx:4*ua,ry:4*ua,fill:"black"})]})})}function Rk(c,m,M,ca=ua=>
ua){return c*ca(.5-m*(.5-M))}function ur(c){return[-c[0],-c[1]]}function Bk(c,m){return[c[0]+m[0],c[1]+m[1]]}function tj(c,m){return[c[0]-m[0],c[1]-m[1]]}function Yj(c,m){return[c[0]*m,c[1]*m]}function lo(c){return[c[1],-c[0]]}function Us(c,m){return c[0]===m[0]&&c[1]===m[1]}function zm(c){return c[0]*c[0]+c[1]*c[1]}function dn(c){var m=Math.hypot(c[0],c[1]);return[c[0]/m,c[1]/m]}function sr(c,m){return Math.hypot(c[1]-m[1],c[0]-m[0])}function tk(c,m,M){let ca=Math.sin(M);M=Math.cos(M);let ua=c[0]-
m[0];c=c[1]-m[1];return[ua*M-c*ca+m[0],ua*ca+c*M+m[1]]}function Jl(c,m,M){return Bk(c,Yj(tj(m,c),M))}function en(c,m,M){return Bk(c,Yj(m,M))}function uq(c,m={}){let {size:M=16,smoothing:ca=.5,thinning:ua=.5,simulatePressure:Ga=!0,easing:La=If=>If,start:fb={},end:vb={},last:Wb=!1}=m,{cap:oc=!0,easing:uc=If=>If*(2-If)}=fb,{cap:Sc=!0,easing:kd=If=>--If*If*If+1}=vb;if(0===c.length||0>=M)return[];var fd=c[c.length-1].runningLength;let xd=!1===fb.taper?0:!0===fb.taper?Math.max(M,fd):fb.taper,Jd=!1===vb.taper?
0:!0===vb.taper?Math.max(M,fd):vb.taper;var $c=Math.pow(M*ca,2);m=[];let hd=[];var od=c.slice(0,10).reduce((If,Ef)=>{var Yf=Ef.pressure;Ga&&(Ef=Gp(1,Ef.distance/M),Yf=Gp(1,1-Ef),Yf=Gp(1,If+.275*(Yf-If)*Ef));return(If+Yf)/2},c[0].pressure),Kd=Rk(M,ua,c[c.length-1].pressure,La),zd;let Te=c[0].vector;var We=c[0].point;let eg=We;var of=We;let Tf=eg;var Jg=!1;for(var bh=0;bh<c.length;bh++){var {pressure:Eg}=c[bh];let {point:If,vector:Ef,distance:Yf,runningLength:dh}=c[bh];if(bh<c.length-1&&3>fd-dh)continue;
ua?(Ga&&(Kd=Gp(1,Yf/M),Eg=Gp(1,1-Kd),Eg=Gp(1,od+.275*(Eg-od)*Kd)),Kd=Rk(M,ua,Eg,La)):Kd=M/2;void 0===zd&&(zd=Kd);var ch=dh<xd?uc(dh/xd):1,Bf=fd-dh<Jd?kd((fd-dh)/Jd):1;Kd=Math.max(.01,Kd*Math.min(ch,Bf));Bf=(bh<c.length-1?c[bh+1]:c[bh]).vector;let Fh=bh<c.length-1?Ef[0]*Bf[0]+Ef[1]*Bf[1]:1;ch=null!==Fh&&0>Fh;if(0>Ef[0]*Te[0]+Ef[1]*Te[1]&&!Jg||ch){We=Yj(lo(Te),Kd);for(let Pi=1/13,fi=0;1>=fi;fi+=Pi)of=tk(tj(If,We),If,Vq*fi),m.push(of),Tf=tk(Bk(If,We),If,Vq*-fi),hd.push(Tf);We=of;eg=Tf;ch&&(Jg=!0)}else(Jg=
!1,bh===c.length-1)?(Eg=Yj(lo(Ef),Kd),m.push(tj(If,Eg)),hd.push(Bk(If,Eg))):(od=Yj(lo(Jl(Bf,Ef,Fh)),Kd),of=tj(If,od),(1>=bh||zm(tj(We,of))>$c)&&(m.push(of),We=of),Tf=Bk(If,od),(1>=bh||zm(tj(eg,Tf))>$c)&&(hd.push(Tf),eg=Tf),od=Eg,Te=Ef)}fd=c[0].point.slice(0,2);$c=1<c.length?c[c.length-1].point.slice(0,2):Bk(c[0].point,[1,1]);of=[];Jg=[];if(1===c.length){if(!xd&&!Jd||Wb){c=en(fd,dn(lo(tj(fd,$c))),-(zd||Kd));m=[];for(let If=1/13,Ef=If;1>=Ef;Ef+=If)m.push(tk(c,fd,2*Vq*Ef));return m}}else{if(!(xd||Jd&&
1===c.length))if(oc)for(let If=1/13,Ef=If;1>=Ef;Ef+=If)zd=tk(hd[0],fd,Vq*Ef),of.push(zd);else bh=tj(m[0],hd[0]),zd=Yj(bh,.5),bh=Yj(bh,.51),of.push(tj(fd,zd),tj(fd,bh),Bk(fd,bh),Bk(fd,zd));zd=lo(ur(c[c.length-1].vector));if(Jd||xd&&1===c.length)Jg.push($c);else if(Sc){c=en($c,zd,Kd);for(let If=1/29,Ef=If;1>Ef;Ef+=If)Jg.push(tk(c,$c,3*Vq*Ef))}else Jg.push(Bk($c,Yj(zd,Kd)),Bk($c,Yj(zd,.99*Kd)),tj($c,Yj(zd,.99*Kd)),tj($c,Yj(zd,Kd)))}return m.concat(Jg,hd.reverse(),of)}function Ws(c,m={}){var M;let {streamline:ca=
.5,size:ua=16,last:Ga=!1}=m;if(0===c.length)return[];m=.15+.85*(1-ca);c=Array.isArray(c[0])?c:c.map(({x:uc,y:Sc,pressure:kd=.5})=>[uc,Sc,kd]);if(2===c.length){var La=c[1];c=c.slice(0,-1);for(var fb=1;5>fb;fb++)c.push(Jl(c[0],La,fb/4))}1===c.length&&(c=[...c,[...Bk(c[0],[1,1]),...c[0].slice(2)]]);La=[{point:[c[0][0],c[0][1]],pressure:0<=c[0][2]?c[0][2]:.25,vector:[1,1],distance:0,runningLength:0}];fb=!1;let vb=0,Wb=La[0],oc=c.length-1;for(let uc=1;uc<c.length;uc++){let Sc=Ga&&uc===oc?c[uc].slice(0,
2):Jl(Wb.point,c[uc],m);if(Us(Wb.point,Sc))continue;let kd=sr(Sc,Wb.point);if(vb+=kd,uc<oc&&!fb){if(vb<ua)continue;fb=!0}Wb={point:Sc,pressure:0<=c[uc][2]?c[uc][2]:.5,vector:dn(tj(Wb.point,Sc)),distance:kd,runningLength:vb};La.push(Wb)}return La[0].vector=(null==(M=La[1])?void 0:M.vector)||[0,0],La}function dp(c,m=4/3){return(new tq(c)).exportAsSVG(m)}function ep(c,m=4/3){return(new tq(c)).generatePreviewJsx(void 0,m)}function rl({id:c,type:m,onRemove:M,showContent:ca}){const ua=Ve(),{handlers:Ga}=
xx.default.useContext(si),La=Ga.t;return(0,Ri.jsxs)("div",{className:"tl-shape-links-panel-item color-level relative",children:[(0,Ri.jsx)("div",{className:"whitespace-pre break-all overflow-hidden text-ellipsis inline-flex",children:(0,Ri.jsx)(yx,{id:c,showReferenceContent:ca})}),(0,Ri.jsx)("div",{className:"flex-1"}),Ga.getBlockPageName(c)!==ua.currentPage.name&&(0,Ri.jsx)(Zh,{tooltip:La("whiteboard/open-page"),type:"button",onClick:()=>null==Ga?void 0:Ga.redirectToPage(c),children:(0,Ri.jsx)(hh,
{name:"open-as-page"})}),(0,Ri.jsx)(Zh,{tooltip:La("whiteboard/open-page-in-sidebar"),type:"button",onClick:()=>null==Ga?void 0:Ga.sidebarAddBlock(c,"B"===m?"block":"page"),children:(0,Ri.jsx)(hh,{name:"move-to-sidebar-right"})}),M&&(0,Ri.jsx)(Zh,{className:"tl-shape-links-panel-item-remove-button",tooltip:La("whiteboard/remove-link"),type:"button",onClick:M,children:(0,Ri.jsx)(hh,{name:"x",className:"!translate-y-0"})})]})}function uk({options:c,value:m,onValueChange:M}){return(0,yn.jsx)(is.ToggleGroup,
{type:"single",value:m,onValueChange:M,children:c.map(ca=>(0,yn.jsx)(Qh,{content:ca.tooltip,children:(0,yn.jsx)("div",{className:"inline-flex",children:(0,yn.jsx)(is.ToggleGroupItem,{className:"tl-button",value:ca.value,disabled:ca.value===m,children:(0,yn.jsx)(hh,{name:ca.icon})})})},ca.value))})}function ri({options:c,value:m,onValueChange:M}){return(0,yn.jsx)(is.ToggleGroup,{className:"inline-flex",type:"multiple",value:m,onValueChange:M,children:c.map(ca=>(0,yn.jsx)(is.ToggleGroupItem,{className:"tl-button",
value:ca.value,children:(0,yn.jsx)(hh,{name:ca.icon})},ca.value))})}function kk(c){return Ve().selectedShapesArray.filter(m=>!m.props.isLocked).filter(m=>{var M;return null==(M=lj[m.props.type])?void 0:M.includes(c)})}function wq(c){var m;c=c.match(/\.[0-9a-z]+$/i);if(!c)return"unknown";const M=c[0].toLowerCase();[c]=null!=(m=Object.entries(ps).find(([,ca])=>ca.includes(M)))?m:["unknown",null];return c}function Sk(...c){return(...m)=>Wh(this,null,function*(){for(const M of c){const ca=yield M(...m);
if(ca&&0<ca.length)return ca}return null})}function Bm(c,m){return Wh(this,null,function*(){return c.types.includes(m)?c instanceof DataTransfer?c.getData(m):yield(yield c.getType(m)).text():null})}function vr(){const {handlers:c}=Np.useContext(si);return Np.useCallback((m,M)=>Wh(this,null,function*(){if(M.shiftKey&&1===m.selectedShapesArray.length){var ca=yield navigator.clipboard.read();let ua;0<ca.length&&(ca=(yield(yield ca[0].getType("text/plain")).text()).trim())&&(/^\(\(.*\)\)$/.test(ca)&&
40===ca.length?(ca=ca.slice(2,-2),rg(ca)&&(ua=ca)):/^\[\[.*\]\]$/.test(ca)&&(ua=ca.slice(2,-2)));if(ua){m.selectedShapesArray[0].update({refs:[ua]});m.persist();return}}qs(m,M,c)}),[])}function lk(){const c=vr();return Mp.useCallback((m,M)=>Wh(this,[m,M],function*(ca,{dataTransfer:ua,point:Ga}){c(ca,{point:Ga,shiftKey:!1,dataTransfer:ua,fromDrop:!0})}),[])}function wr(){const {handlers:c}=ru.useContext(si);return ru.useCallback((m,{text:M,html:ca})=>{c.copyToClipboard(M,ca)},[])}function xr(){return rs.default.useCallback(c=>
Wh(this,null,function*(){setTimeout(()=>{c.transition("logseq-portal").selectedTool.transition("creating")},100)}),[])}var hm=Object.create,sl=Object.defineProperty,fp=Object.defineProperties,gn=Object.getOwnPropertyDescriptor,mo=Object.getOwnPropertyDescriptors,hn=Object.getOwnPropertyNames,gp=Object.getOwnPropertySymbols,xq=Object.getPrototypeOf,no=Object.prototype.hasOwnProperty,jn=Object.prototype.propertyIsEnumerable,Cm=(c,m,M)=>m in c?sl(c,m,{enumerable:!0,configurable:!0,writable:!0,value:M}):
c[m]=M,Gf=(c,m)=>{for(var M in m||={})no.call(m,M)&&Cm(c,M,m[M]);if(gp)for(M of gp(m))jn.call(m,M)&&Cm(c,M,m[M]);return c},ng=(c,m)=>fp(c,mo(m)),Ti=(c,m)=>{var M={},ca;for(ca in c)no.call(c,ca)&&0>m.indexOf(ca)&&(M[ca]=c[ca]);if(null!=c&&gp)for(ca of gp(c))0>m.indexOf(ca)&&jn.call(c,ca)&&(M[ca]=c[ca]);return M},oo=(c,m)=>function(){return m||(0,c[hn(c)[0]])((m={exports:{}}).exports,m),m.exports},mk=(c,m,M,ca)=>{if(m&&"object"===typeof m||"function"===typeof m)for(let ua of hn(m))no.call(c,ua)||ua===
M||sl(c,ua,{get:()=>m[ua],enumerable:!(ca=gn(m,ua))||ca.enumerable});return c},Qf=(c,m,M)=>(M=null!=c?hm(xq(c)):{},mk(!m&&c&&c.__esModule?M:sl(M,"default",{value:c,enumerable:!0}),c)),pe=(c,m,M,ca)=>{for(var ua=1<ca?void 0:ca?gn(m,M):m,Ga=c.length-1,La;0<=Ga;Ga--)if(La=c[Ga])ua=(ca?La(m,M,ua):La(ua))||ua;ca&&ua&&sl(m,M,ua);return ua},wb=(c,m,M)=>{Cm(c,"symbol"!==typeof m?m+"":m,M);return M},Wh=(c,m,M)=>new Promise((ca,ua)=>{var Ga=vb=>{try{fb(M.next(vb))}catch(Wb){ua(Wb)}},La=vb=>{try{fb(M.throw(vb))}catch(Wb){ua(Wb)}},
fb=vb=>vb.done?ca(vb.value):Promise.resolve(vb.value).then(Ga,La);fb((M=M.apply(c,m)).next())}),D=oo({["../../node_modules/rbush/rbush.min.js"](c,m){!function(M,ca){"object"==typeof c&&"undefined"!=typeof m?m.exports=ca():"function"==typeof define&&define.amd?define(ca):(M=M||self).RBush=ca()}(c,function(){function M($c,hd,od,Kd,zd){!function bh(We,eg,of,Tf,Jg){for(;Tf>of;){if(600<Tf-of){var Eg=Tf-of+1,ch=eg-of+1,Bf=Math.log(Eg),If=.5*Math.exp(2*Bf/3);Bf=.5*Math.sqrt(Bf*If*(Eg-If)/Eg)*(0>ch-Eg/2?
-1:1);bh(We,eg,Math.max(of,Math.floor(eg-ch*If/Eg+Bf)),Math.min(Tf,Math.floor(eg+(Eg-ch)*If/Eg+Bf)),Jg)}Eg=We[eg];ch=of;If=Tf;ca(We,of,eg);for(0<Jg(We[Tf],Eg)&&ca(We,of,Tf);ch<If;){ca(We,ch,If);ch++;for(If--;0>Jg(We[ch],Eg);)ch++;for(;0<Jg(We[If],Eg);)If--}0===Jg(We[of],Eg)?ca(We,of,If):ca(We,++If,Tf);If<=eg&&(of=If+1);eg<=If&&(Tf=If-1)}}($c,hd,od||0,Kd||$c.length-1,zd||ua)}function ca($c,hd,od){var Kd=$c[hd];$c[hd]=$c[od];$c[od]=Kd}function ua($c,hd){return $c<hd?-1:$c>hd?1:0}function Ga($c,hd){La($c,
0,$c.children.length,hd,$c)}function La($c,hd,od,Kd,zd){zd||=fd(null);zd.minX=1/0;zd.minY=1/0;zd.maxX=-1/0;for(zd.maxY=-1/0;hd<od;hd++){var Te=$c.children[hd];fb(zd,$c.leaf?Kd(Te):Te)}return zd}function fb($c,hd){return $c.minX=Math.min($c.minX,hd.minX),$c.minY=Math.min($c.minY,hd.minY),$c.maxX=Math.max($c.maxX,hd.maxX),$c.maxY=Math.max($c.maxY,hd.maxY),$c}function vb($c,hd){return $c.minX-hd.minX}function Wb($c,hd){return $c.minY-hd.minY}function oc($c){return($c.maxX-$c.minX)*($c.maxY-$c.minY)}
function uc($c){return $c.maxX-$c.minX+($c.maxY-$c.minY)}function Sc($c,hd){return $c.minX<=hd.minX&&$c.minY<=hd.minY&&hd.maxX<=$c.maxX&&hd.maxY<=$c.maxY}function kd($c,hd){return hd.minX<=$c.maxX&&hd.minY<=$c.maxY&&hd.maxX>=$c.minX&&hd.maxY>=$c.minY}function fd($c){return{children:$c,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function xd($c,hd,od,Kd,zd){for(var Te=[hd,od];Te.length;)if(!((od=Te.pop())-(hd=Te.pop())<=Kd)){var We=hd+Math.ceil((od-hd)/Kd/2)*Kd;M($c,We,hd,od,zd);Te.push(hd,
We,We,od)}}var Jd=function($c){void 0===$c&&($c=9);this._maxEntries=Math.max(4,$c);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));this.clear()};return Jd.prototype.all=function(){return this._all(this.data,[])},Jd.prototype.search=function($c){var hd=this.data,od=[];if(!kd($c,hd))return od;for(var Kd=this.toBBox,zd=[];hd;){for(var Te=0;Te<hd.children.length;Te++){var We=hd.children[Te],eg=hd.leaf?Kd(We):We;kd($c,eg)&&(hd.leaf?od.push(We):Sc($c,eg)?this._all(We,od):zd.push(We))}hd=zd.pop()}return od},
Jd.prototype.collides=function($c){var hd=this.data;if(!kd($c,hd))return!1;for(var od=[];hd;){for(var Kd=0;Kd<hd.children.length;Kd++){var zd=hd.children[Kd],Te=hd.leaf?this.toBBox(zd):zd;if(kd($c,Te)){if(hd.leaf||Sc($c,Te))return!0;od.push(zd)}}hd=od.pop()}return!1},Jd.prototype.load=function($c){if(!$c||!$c.length)return this;if($c.length<this._minEntries){for(var hd=0;hd<$c.length;hd++)this.insert($c[hd]);return this}$c=this._build($c.slice(),0,$c.length-1,0);this.data.children.length?this.data.height===
$c.height?this._splitRoot(this.data,$c):(this.data.height<$c.height&&(hd=this.data,this.data=$c,$c=hd),this._insert($c,this.data.height-$c.height-1,!0)):this.data=$c;return this},Jd.prototype.insert=function($c){return $c&&this._insert($c,this.data.height-1),this},Jd.prototype.clear=function(){return this.data=fd([]),this},Jd.prototype.remove=function($c,hd){if(!$c)return this;for(var od,Kd,zd,Te=this.data,We=this.toBBox($c),eg=[],of=[];Te||eg.length;){if(Te||(Te=eg.pop(),Kd=eg[eg.length-1],od=of.pop(),
zd=!0),Te.leaf){a:{var Tf=$c;var Jg=Te.children,bh=hd;if(bh){for(var Eg=0;Eg<Jg.length;Eg++)if(bh(Tf,Jg[Eg])){Tf=Eg;break a}Tf=-1}else Tf=Jg.indexOf(Tf)}if(-1!==Tf)return Te.children.splice(Tf,1),eg.push(Te),this._condense(eg),this}zd||Te.leaf||!Sc(Te,We)?Kd?(od++,Te=Kd.children[od],zd=!1):Te=null:(eg.push(Te),of.push(od),od=0,Kd=Te,Te=Te.children[0])}return this},Jd.prototype.toBBox=function($c){return $c},Jd.prototype.compareMinX=function($c,hd){return $c.minX-hd.minX},Jd.prototype.compareMinY=
function($c,hd){return $c.minY-hd.minY},Jd.prototype.toJSON=function(){return this.data},Jd.prototype.fromJSON=function($c){return this.data=$c,this},Jd.prototype._all=function($c,hd){for(var od=[];$c;)$c.leaf?hd.push.apply(hd,$c.children):od.push.apply(od,$c.children),$c=od.pop();return hd},Jd.prototype._build=function($c,hd,od,Kd){var zd,Te=od-hd+1,We=this._maxEntries;if(Te<=We)return Ga(zd=fd($c.slice(hd,od+1)),this.toBBox),zd;Kd||(Kd=Math.ceil(Math.log(Te)/Math.log(We)),We=Math.ceil(Te/Math.pow(We,
Kd-1)));(zd=fd([])).leaf=!1;zd.height=Kd;Te=Math.ceil(Te/We);We=Te*Math.ceil(Math.sqrt(We));for(xd($c,hd,od,We,this.compareMinX);hd<=od;hd+=We){var eg=Math.min(hd+We-1,od);xd($c,hd,eg,Te,this.compareMinY);for(var of=hd;of<=eg;of+=Te)zd.children.push(this._build($c,of,Math.min(of+Te-1,eg),Kd-1))}return Ga(zd,this.toBBox),zd},Jd.prototype._chooseSubtree=function($c,hd,od,Kd){for(;Kd.push(hd),!hd.leaf&&Kd.length-1!==od;){for(var zd=1/0,Te=1/0,We=void 0,eg=0;eg<hd.children.length;eg++){var of=hd.children[eg],
Tf=oc(of),Jg=(bh=$c,Eg=of,(Math.max(Eg.maxX,bh.maxX)-Math.min(Eg.minX,bh.minX))*(Math.max(Eg.maxY,bh.maxY)-Math.min(Eg.minY,bh.minY))-Tf);Jg<Te?(Te=Jg,zd=Tf<zd?Tf:zd,We=of):Jg===Te&&Tf<zd&&(zd=Tf,We=of)}hd=We||hd.children[0]}var bh,Eg;return hd},Jd.prototype._insert=function($c,hd,od){od=od?$c:this.toBBox($c);var Kd=[],zd=this._chooseSubtree(od,this.data,hd,Kd);zd.children.push($c);for(fb(zd,od);0<=hd&&Kd[hd].children.length>this._maxEntries;)this._split(Kd,hd),hd--;this._adjustParentBBoxes(od,Kd,
hd)},Jd.prototype._split=function($c,hd){var od=$c[hd],Kd=od.children.length,zd=this._minEntries;this._chooseSplitAxis(od,zd,Kd);Kd=this._chooseSplitIndex(od,zd,Kd);Kd=fd(od.children.splice(Kd,od.children.length-Kd));Kd.height=od.height;Kd.leaf=od.leaf;Ga(od,this.toBBox);Ga(Kd,this.toBBox);hd?$c[hd-1].children.push(Kd):this._splitRoot(od,Kd)},Jd.prototype._splitRoot=function($c,hd){this.data=fd([$c,hd]);this.data.height=$c.height+1;this.data.leaf=!1;Ga(this.data,this.toBBox)},Jd.prototype._chooseSplitIndex=
function($c,hd,od){for(var Kd,zd,Te,We,eg,of,Tf,Jg=1/0,bh=1/0,Eg=hd;Eg<=od-hd;Eg++){var ch=La($c,0,Eg,this.toBBox),Bf=La($c,Eg,od,this.toBBox),If=(zd=ch,Te=Bf,We=void 0,eg=void 0,of=void 0,Tf=void 0,We=Math.max(zd.minX,Te.minX),eg=Math.max(zd.minY,Te.minY),of=Math.min(zd.maxX,Te.maxX),Tf=Math.min(zd.maxY,Te.maxY),Math.max(0,of-We)*Math.max(0,Tf-eg));ch=oc(ch)+oc(Bf);If<Jg?(Jg=If,Kd=Eg,bh=ch<bh?ch:bh):If===Jg&&ch<bh&&(bh=ch,Kd=Eg)}return Kd||od-hd},Jd.prototype._chooseSplitAxis=function($c,hd,od){var Kd=
$c.leaf?this.compareMinX:vb,zd=$c.leaf?this.compareMinY:Wb;this._allDistMargin($c,hd,od,Kd)<this._allDistMargin($c,hd,od,zd)&&$c.children.sort(Kd)},Jd.prototype._allDistMargin=function($c,hd,od,Kd){$c.children.sort(Kd);Kd=this.toBBox;for(var zd=La($c,0,hd,Kd),Te=La($c,od-hd,od,Kd),We=uc(zd)+uc(Te),eg=hd;eg<od-hd;eg++){var of=$c.children[eg];fb(zd,$c.leaf?Kd(of):of);We+=uc(zd)}for(od=od-hd-1;od>=hd;od--)zd=$c.children[od],fb(Te,$c.leaf?Kd(zd):zd),We+=uc(Te);return We},Jd.prototype._adjustParentBBoxes=
function($c,hd,od){for(;0<=od;od--)fb(hd[od],$c)},Jd.prototype._condense=function($c){for(var hd=$c.length-1,od=void 0;0<=hd;hd--)0===$c[hd].children.length?0<hd?(od=$c[hd-1].children).splice(od.indexOf($c[hd]),1):this.clear():Ga($c[hd],this.toBBox)},Jd})}}),ba=oo({["../../node_modules/fast-deep-equal/index.js"](c,m){m.exports=function Ga(ca,ua){if(ca===ua)return!0;if(ca&&ua&&"object"==typeof ca&&"object"==typeof ua){if(ca.constructor!==ua.constructor)return!1;var La;if(Array.isArray(ca)){var fb=
ca.length;if(fb!=ua.length)return!1;for(La=fb;0!==La--;)if(!Ga(ca[La],ua[La]))return!1;return!0}if(ca.constructor===RegExp)return ca.source===ua.source&&ca.flags===ua.flags;if(ca.valueOf!==Object.prototype.valueOf)return ca.valueOf()===ua.valueOf();if(ca.toString!==Object.prototype.toString)return ca.toString()===ua.toString();var vb=Object.keys(ca);fb=vb.length;if(fb!==Object.keys(ua).length)return!1;for(La=fb;0!==La--;)if(!Object.prototype.hasOwnProperty.call(ua,vb[La]))return!1;for(La=fb;0!==La--;)if(fb=
vb[La],!Ga(ca[fb],ua[fb]))return!1;return!0}return ca!==ca&&ua!==ua}}}),Ba=oo({["../../../../node_modules/deepmerge/dist/cjs.js"](c,m){function M(uc,Sc){return!1!==Sc.clone&&Sc.isMergeableObject(uc)?vb(Array.isArray(uc)?[]:{},uc,Sc):uc}function ca(uc,Sc,kd){return uc.concat(Sc).map(function(fd){return M(fd,kd)})}function ua(uc){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(uc).filter(function(Sc){return Object.propertyIsEnumerable.call(uc,Sc)}):[]}function Ga(uc){return Object.keys(uc).concat(ua(uc))}
function La(uc,Sc){try{return Sc in uc}catch(kd){return!1}}function fb(uc,Sc,kd){var fd={};kd.isMergeableObject(uc)&&Ga(uc).forEach(function(xd){fd[xd]=M(uc[xd],kd)});Ga(Sc).forEach(function(xd){if(!La(uc,xd)||Object.hasOwnProperty.call(uc,xd)&&Object.propertyIsEnumerable.call(uc,xd))if(La(uc,xd)&&kd.isMergeableObject(Sc[xd])){if(kd.customMerge){var Jd=kd.customMerge(xd);Jd="function"===typeof Jd?Jd:vb}else Jd=vb;fd[xd]=Jd(uc[xd],Sc[xd],kd)}else fd[xd]=M(Sc[xd],kd)});return fd}function vb(uc,Sc,kd){kd=
kd||{};kd.arrayMerge=kd.arrayMerge||ca;kd.isMergeableObject=kd.isMergeableObject||Wb;kd.cloneUnlessOtherwiseSpecified=M;var fd=Array.isArray(Sc),xd=Array.isArray(uc);return fd!==xd?M(Sc,kd):fd?kd.arrayMerge(uc,Sc,kd):fb(uc,Sc,kd)}var Wb=function(uc){var Sc;if(Sc=!!uc&&"object"===typeof uc)Sc=Object.prototype.toString.call(uc),Sc=!("[object RegExp]"===Sc||"[object Date]"===Sc||uc.$$typeof===oc);return Sc},oc="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;vb.all=function(uc,
Sc){if(!Array.isArray(uc))throw Error("first argument should be an array");return uc.reduce(function(kd,fd){return vb(kd,fd,Sc)},{})};m.exports=vb}}),ya={};((c,m)=>{for(var M in m)sl(c,M,{get:m[M],enumerable:!0})})(ya,{App:()=>br,PreviewManager:()=>tq,generateJSXFromModel:()=>ep,generateSVGFromModel:()=>dp});bb.exports=(c=>mk(sl({},"__esModule",{value:!0}),c))(ya);var Oa=(c=>{c.Yellow="yellow";c.Red="red";c.Pink="pink";c.Green="green";c.Blue="blue";c.Purple="purple";c.Gray="gray";c.Default="";return c})(Oa||
{}),nb=(c=>{c.Box="box";c.Ellipse="ellipse";c.Polygon="polygon";return c})(nb||{}),Jb,Pb=new Uint8Array(16),sc=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Zc=[];for(let c=0;256>c;++c)Zc.push((c+256).toString(16).slice(1));var rd,Xd,ae=0,ee=0,Re=function(c,m,M){M=m&&M||0;const ca=m||Array(16);c=c||{};let ua=c.node||rd;var Ga=void 0!==c.clockseq?c.clockseq:Xd;if(null==ua||null==Ga){var La=c.random||(c.rng||A)();null==ua&&(ua=
rd=[La[0]|1,La[1],La[2],La[3],La[4],La[5]]);null==Ga&&(Ga=Xd=(La[6]<<8|La[7])&16383)}La=void 0!==c.msecs?c.msecs:Date.now();let fb=void 0!==c.nsecs?c.nsecs:ee+1;const vb=La-ae+(fb-ee)/1E4;0>vb&&void 0===c.clockseq&&(Ga=Ga+1&16383);(0>vb||La>ae)&&void 0===c.nsecs&&(fb=0);if(1E4<=fb)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");ae=La;ee=fb;Xd=Ga;La+=122192928E5;c=(1E4*(La&268435455)+fb)%4294967296;ca[M++]=c>>>24&255;ca[M++]=c>>>16&255;ca[M++]=c>>>8&255;ca[M++]=c&255;c=La/4294967296*
1E4&268435455;ca[M++]=c>>>8&255;ca[M++]=c&255;ca[M++]=c>>>24&15|16;ca[M++]=c>>>16&255;ca[M++]=Ga>>>8|128;ca[M++]=Ga&255;for(Ga=0;6>Ga;++Ga)ca[M+Ga]=ua[Ga];return m||Y(ca)},lf=class{static clamp(c,m,M){return Math.max(m,"undefined"!==typeof M?Math.min(c,M):c)}static clampV(c,m,M){return c.map(ca=>M?lf.clamp(ca,m,M):lf.clamp(ca,m))}static cross(c,m,M){return(m[0]-c[0])*(M[1]-c[1])-(M[0]-c[0])*(m[1]-c[1])}static snap(c,m=1){return[Math.round(c[0]/m)*m,Math.round(c[1]/m)*m]}},yd=lf;yd.neg=c=>[-c[0],-c[1]];
yd.add=(c,m)=>[c[0]+m[0],c[1]+m[1]];yd.addScalar=(c,m)=>[c[0]+m,c[1]+m];yd.sub=(c,m)=>[c[0]-m[0],c[1]-m[1]];yd.subScalar=(c,m)=>[c[0]-m,c[1]-m];yd.vec=(c,m)=>[m[0]-c[0],m[1]-c[1]];yd.mul=(c,m)=>[c[0]*m,c[1]*m];yd.mulV=(c,m)=>[c[0]*m[0],c[1]*m[1]];yd.div=(c,m)=>[c[0]/m,c[1]/m];yd.divV=(c,m)=>[c[0]/m[0],c[1]/m[1]];yd.per=c=>[c[1],-c[0]];yd.dpr=(c,m)=>c[0]*m[0]+c[1]*m[1];yd.cpr=(c,m)=>c[0]*m[1]-m[0]*c[1];yd.len2=c=>c[0]*c[0]+c[1]*c[1];yd.len=c=>Math.hypot(c[0],c[1]);yd.pry=(c,m)=>lf.dpr(c,m)/lf.len(m);
yd.uni=c=>lf.div(c,lf.len(c));yd.normalize=c=>lf.uni(c);yd.tangent=(c,m)=>lf.uni(lf.sub(c,m));yd.dist2=(c,m)=>lf.len2(lf.sub(c,m));yd.dist=(c,m)=>Math.hypot(c[1]-m[1],c[0]-m[0]);yd.fastDist=(c,m)=>{c=[m[0]-c[0],m[1]-c[1]];m=[Math.abs(c[0]),Math.abs(c[1])];let M=1/Math.max(m[0],m[1]);M*=1.29289-(m[0]+m[1])*M*.29289;return[c[0]*M,c[1]*M]};yd.ang=(c,m)=>Math.atan2(lf.cpr(c,m),lf.dpr(c,m));yd.angle=(c,m)=>Math.atan2(m[1]-c[1],m[0]-c[0]);yd.med=(c,m)=>lf.mul(lf.add(c,m),.5);yd.rot=(c,m=0)=>[c[0]*Math.cos(m)-
c[1]*Math.sin(m),c[0]*Math.sin(m)+c[1]*Math.cos(m)];yd.rotWith=(c,m,M=0)=>{if(0===M)return c;const ca=Math.sin(M);M=Math.cos(M);const ua=c[0]-m[0];c=c[1]-m[1];return[ua*M-c*ca+m[0],ua*ca+c*M+m[1]]};yd.isEqual=(c,m)=>c[0]===m[0]&&c[1]===m[1];yd.lrp=(c,m,M)=>lf.add(c,lf.mul(lf.sub(m,c),M));yd.int=(c,m,M,ca,ua=1)=>{M=(lf.clamp(M,ca)-M)/(ca-M);return lf.add(lf.mul(c,1-M),lf.mul(m,ua))};yd.ang3=(c,m,M)=>{c=lf.vec(m,c);m=lf.vec(m,M);return lf.ang(c,m)};yd.abs=c=>[Math.abs(c[0]),Math.abs(c[1])];yd.rescale=
(c,m)=>{const M=lf.len(c);return[m*c[0]/M,m*c[1]/M]};yd.isLeft=(c,m,M)=>(m[0]-c[0])*(M[1]-c[1])-(M[0]-c[0])*(m[1]-c[1]);yd.clockwise=(c,m,M)=>0<lf.isLeft(c,m,M);yd.toFixed=c=>c.map(m=>Math.round(100*m)/100);yd.nearestPointOnLineThroughPoint=(c,m,M)=>lf.add(c,lf.mul(m,lf.pry(lf.sub(M,c),m)));yd.distanceToLineThroughPoint=(c,m,M)=>lf.dist(M,lf.nearestPointOnLineThroughPoint(c,m,M));yd.nearestPointOnLineSegment=(c,m,M,ca=!0)=>{const ua=lf.uni(lf.sub(m,c));M=lf.add(c,lf.mul(ua,lf.pry(lf.sub(M,c),ua)));
if(ca){if(M[0]<Math.min(c[0],m[0]))return c[0]<m[0]?c:m;if(M[0]>Math.max(c[0],m[0]))return c[0]>m[0]?c:m;if(M[1]<Math.min(c[1],m[1]))return c[1]<m[1]?c:m;if(M[1]>Math.max(c[1],m[1]))return c[1]>m[1]?c:m}return M};yd.distanceToLineSegment=(c,m,M,ca=!0)=>lf.dist(M,lf.nearestPointOnLineSegment(c,m,M,ca));yd.nudge=(c,m,M)=>lf.isEqual(c,m)?c:lf.add(c,lf.mul(lf.uni(lf.sub(m,c)),M));yd.nudgeAtAngle=(c,m,M)=>[Math.cos(m)*M+c[0],Math.sin(m)*M+c[1]];yd.toPrecision=(c,m=4)=>[+c[0].toPrecision(m),+c[1].toPrecision(m)];
yd.pointsBetween=(c,m,M=6)=>Array.from(Array(M)).map((ca,ua)=>{ca=ua/(M-1);ua=Math.min(1,.5+Math.abs(.5-ca));return[...lf.lrp(c,m,ca),ua]});yd.slope=(c,m)=>c[0]===m[0]?NaN:(c[1]-m[1])/(c[0]-m[0]);yd.toAngle=c=>{c=Math.atan2(c[1],c[0]);return 0>c?c+2*Math.PI:c};yd.max=(...c)=>[Math.max(...c.map(m=>m[0])),Math.max(...c.map(m=>m[1]))];yd.min=(...c)=>[Math.min(...c.map(m=>m[0])),Math.min(...c.map(m=>m[1]))];var ne=yd,Me=class{static getRectangleSides(c,m,M=0){const ca=[c[0]+m[0]/2,c[1]+m[1]/2],ua=yd.rotWith(c,
ca,M),Ga=yd.rotWith(yd.add(c,[m[0],0]),ca,M),La=yd.rotWith(yd.add(c,m),ca,M);c=yd.rotWith(yd.add(c,[0,m[1]]),ca,M);return[["top",[ua,Ga]],["right",[Ga,La]],["bottom",[La,c]],["left",[c,ua]]]}static getBoundsSides(c){return Me.getRectangleSides([c.minX,c.minY],[c.width,c.height])}static expandBounds(c,m){return{minX:c.minX-m,minY:c.minY-m,maxX:c.maxX+m,maxY:c.maxY+m,width:c.width+2*m,height:c.height+2*m}}static boundsCollide(c,m){return!(c.maxX<m.minX||c.minX>m.maxX||c.maxY<m.minY||c.minY>m.maxY)}static boundsContain(c,
m){return Array.isArray(m)?c.minX<m[0]&&c.minY<m[1]&&c.maxY>m[1]&&c.maxX>m[0]:c.minX<m.minX&&c.minY<m.minY&&c.maxY>m.maxY&&c.maxX>m.maxX}static boundsContained(c,m){return Me.boundsContain(m,c)}static boundsAreEqual(c,m){return!(m.maxX!==c.maxX||m.minX!==c.minX||m.maxY!==c.maxY||m.minY!==c.minY)}static getBoundsFromPoints(c,m=0){let M=Infinity,ca=Infinity,ua=-Infinity,Ga=-Infinity;if(2>c.length)ca=M=0,Ga=ua=1;else for(const La of c)M=Math.min(La[0],M),ca=Math.min(La[1],ca),ua=Math.max(La[0],ua),Ga=
Math.max(La[1],Ga);return 0!==m?Me.getBoundsFromPoints(c.map(La=>yd.rotWith(La,[(M+ua)/2,(ca+Ga)/2],m))):{minX:M,minY:ca,maxX:ua,maxY:Ga,width:Math.max(1,ua-M),height:Math.max(1,Ga-ca)}}static centerBounds(c,m){const M=Me.getBoundsCenter(c);return Me.translateBounds(c,[m[0]-M[0],m[1]-M[1]])}static snapBoundsToGrid(c,m){const M=Math.round(c.minX/m)*m,ca=Math.round(c.minY/m)*m,ua=Math.round(c.maxX/m)*m;c=Math.round(c.maxY/m)*m;return{minX:M,minY:ca,maxX:ua,maxY:c,width:Math.max(1,ua-M),height:Math.max(1,
c-ca)}}static translateBounds(c,m){return{minX:c.minX+m[0],minY:c.minY+m[1],maxX:c.maxX+m[0],maxY:c.maxY+m[1],width:c.width,height:c.height}}static multiplyBounds(c,m){const M=Me.getBoundsCenter(c);return Me.centerBounds({minX:c.minX*m,minY:c.minY*m,maxX:c.maxX*m,maxY:c.maxY*m,width:c.width*m,height:c.height*m},[M[0]*m,M[1]*m])}static divideBounds(c,m){const M=Me.getBoundsCenter(c);return Me.centerBounds({minX:c.minX/m,minY:c.minY/m,maxX:c.maxX/m,maxY:c.maxY/m,width:c.width/m,height:c.height/m},[M[0]/
m,M[1]/m])}static getRotatedBounds(c,m=0){c=Me.getRotatedCorners(c,m);let M=m=Infinity,ca=-Infinity,ua=-Infinity;for(const Ga of c)m=Math.min(Ga[0],m),M=Math.min(Ga[1],M),ca=Math.max(Ga[0],ca),ua=Math.max(Ga[1],ua);return{minX:m,minY:M,maxX:ca,maxY:ua,width:Math.max(1,ca-m),height:Math.max(1,ua-M),rotation:0}}static getRotatedEllipseBounds(c,m,M,ca,ua=0){var Ga=Math.cos(ua);const La=Math.sin(ua);ua=Math.hypot(M*Ga,ca*La);Ga=Math.hypot(M*La,ca*Ga);return{minX:c+M-ua,minY:m+ca-Ga,maxX:c+M+ua,maxY:m+
ca+Ga,width:2*ua,height:2*Ga}}static getExpandedBounds(c,m){const M=Math.min(c.minX,m.minX),ca=Math.min(c.minY,m.minY),ua=Math.max(c.maxX,m.maxX);c=Math.max(c.maxY,m.maxY);return{minX:M,minY:ca,maxX:ua,maxY:c,width:Math.abs(ua-M),height:Math.abs(c-ca)}}static getCommonBounds(c){if(2>c.length)return c[0];let m=c[0];for(let M=1;M<c.length;M++)m=Me.getExpandedBounds(m,c[M]);return m}static getRotatedCorners(c,m=0){const M=[c.minX+c.width/2,c.minY+c.height/2];c=[[c.minX,c.minY],[c.maxX,c.minY],[c.maxX,
c.maxY],[c.minX,c.maxY]];return m?c.map(ca=>yd.rotWith(ca,M,m)):c}static getTransformedBoundingBox(c,m,M,ca=0,ua=!1){const [Ga,La]=[c.minX,c.minY],[fb,vb]=[c.maxX,c.maxY];let [Wb,oc]=[c.minX,c.minY],[uc,Sc]=[c.maxX,c.maxY];if("center"===m)return{minX:Wb+M[0],minY:oc+M[1],maxX:uc+M[0],maxY:Sc+M[1],width:uc-Wb,height:Sc-oc,scaleX:1,scaleY:1};const [kd,fd]=yd.rot(M,-ca);switch(m){case "top_edge":case "top_left_corner":case "top_right_corner":oc+=fd;break;case "bottom_edge":case "bottom_left_corner":case "bottom_right_corner":Sc+=
fd}switch(m){case "left_edge":case "top_left_corner":case "bottom_left_corner":Wb+=kd;break;case "right_edge":case "top_right_corner":case "bottom_right_corner":uc+=kd}var xd=fb-Ga;const Jd=vb-La;var $c=(uc-Wb)/xd,hd=(Sc-oc)/Jd;c=0>$c;M=0>hd;var od=Math.abs(uc-Wb),Kd=Math.abs(Sc-oc);if(ua)switch(ua=xd/Jd,xd=ua<od/Kd,hd=1/ua*(0>hd?1:-1)*od,$c=Kd*(0>$c?1:-1)*ua,m){case "top_left_corner":xd?oc=Sc+hd:Wb=uc+$c;break;case "top_right_corner":xd?oc=Sc+hd:uc=Wb-$c;break;case "bottom_right_corner":xd?Sc=oc-
hd:uc=Wb-$c;break;case "bottom_left_corner":xd?Sc=oc-hd:Wb=uc+$c;break;case "bottom_edge":case "top_edge":od=(Wb+uc)/2;Kd*=ua;Wb=od-Kd/2;uc=od+Kd/2;break;case "left_edge":case "right_edge":Kd=(oc+Sc)/2,od/=ua,oc=Kd-od/2,Sc=Kd+od/2}if(0!==ca%(2*Math.PI)){od=[0,0];Kd=yd.med([Ga,La],[fb,vb]);$c=yd.med([Wb,oc],[uc,Sc]);switch(m){case "top_left_corner":od=yd.sub(yd.rotWith([uc,Sc],$c,ca),yd.rotWith([fb,vb],Kd,ca));break;case "top_right_corner":od=yd.sub(yd.rotWith([Wb,Sc],$c,ca),yd.rotWith([Ga,vb],Kd,
ca));break;case "bottom_right_corner":od=yd.sub(yd.rotWith([Wb,oc],$c,ca),yd.rotWith([Ga,La],Kd,ca));break;case "bottom_left_corner":od=yd.sub(yd.rotWith([uc,oc],$c,ca),yd.rotWith([fb,La],Kd,ca));break;case "top_edge":od=yd.sub(yd.rotWith(yd.med([Wb,Sc],[uc,Sc]),$c,ca),yd.rotWith(yd.med([Ga,vb],[fb,vb]),Kd,ca));break;case "left_edge":od=yd.sub(yd.rotWith(yd.med([uc,oc],[uc,Sc]),$c,ca),yd.rotWith(yd.med([fb,La],[fb,vb]),Kd,ca));break;case "bottom_edge":od=yd.sub(yd.rotWith(yd.med([Wb,oc],[uc,oc]),
$c,ca),yd.rotWith(yd.med([Ga,La],[fb,La]),Kd,ca));break;case "right_edge":od=yd.sub(yd.rotWith(yd.med([Wb,oc],[Wb,Sc]),$c,ca),yd.rotWith(yd.med([Ga,La],[Ga,vb]),Kd,ca))}[Wb,oc]=yd.sub([Wb,oc],od);[uc,Sc]=yd.sub([uc,Sc],od)}uc<Wb&&([uc,Wb]=[Wb,uc]);Sc<oc&&([Sc,oc]=[oc,Sc]);return{minX:Wb,minY:oc,maxX:uc,maxY:Sc,width:uc-Wb,height:Sc-oc,scaleX:(uc-Wb)/(fb-Ga||1)*(c?-1:1),scaleY:(Sc-oc)/(vb-La||1)*(M?-1:1)}}static getTransformAnchor(c,m,M){let ca=c;switch(c){case "top_left_corner":ca=m&&M?"bottom_right_corner":
m?"top_right_corner":M?"bottom_left_corner":"bottom_right_corner";break;case "top_right_corner":ca=m&&M?"bottom_left_corner":m?"top_left_corner":M?"bottom_right_corner":"bottom_left_corner";break;case "bottom_right_corner":ca=m&&M?"top_left_corner":m?"bottom_left_corner":M?"top_right_corner":"top_left_corner";break;case "bottom_left_corner":ca=m&&M?"top_right_corner":m?"bottom_right_corner":M?"top_left_corner":"top_right_corner"}return ca}static getRelativeTransformedBoundingBox(c,m,M,ca,ua){ca=c.minX+
(ca?m.maxX-M.maxX:M.minX-m.minX)/m.width*c.width;ua=c.minY+(ua?m.maxY-M.maxY:M.minY-m.minY)/m.height*c.height;const Ga=M.width/m.width*c.width;c=M.height/m.height*c.height;return{minX:ca,minY:ua,maxX:ca+Ga,maxY:ua+c,width:Ga,height:c}}static getRotatedSize(c,m){const M=yd.div(c,2);c=[[0,0],[c[0],0],c,[0,c[1]]].map(ca=>yd.rotWith(ca,M,m));c=Me.getBoundsFromPoints(c);return[c.width,c.height]}static getBoundsCenter(c){return[c.minX+c.width/2,c.minY+c.height/2]}static getBoundsWithCenter(c){const m=Me.getBoundsCenter(c);
return ng(Gf({},c),{midX:m[0],midY:m[1]})}static getCommonTopLeft(c){const m=[Infinity,Infinity];c.forEach(M=>{m[0]=Math.min(m[0],M[0]);m[1]=Math.min(m[1],M[1])});return m}static getTLSnapPoints(c,m,M){const ca=Gf({},c);c=[0,0];const ua=[],Ga={minX:{id:"minX",isSnapped:!1},midX:{id:"midX",isSnapped:!1},maxX:{id:"maxX",isSnapped:!1},minY:{id:"minY",isSnapped:!1},midY:{id:"midY",isSnapped:!1},maxY:{id:"maxY",isSnapped:!1}},La=["midX","minX","maxX"],fb=["midY","minY","maxY"];m=m.map(Sc=>{const kd=La.flatMap((xd,
Jd)=>La.map(($c,hd)=>{const od=ca[xd]-Sc[$c];return{f:xd,t:$c,gap:od,distance:Math.abs(od),isCareful:0===Jd||3===Jd+hd}})),fd=fb.flatMap((xd,Jd)=>fb.map(($c,hd)=>{const od=ca[xd]-Sc[$c];return{f:xd,t:$c,gap:od,distance:Math.abs(od),isCareful:0===Jd||3===Jd+hd}}));return[Sc,kd,fd]});let vb=Infinity,Wb=Infinity,oc=Infinity,uc=Infinity;m.forEach(([,Sc,kd])=>{Sc.forEach(fd=>{fd.distance<M&&fd.distance<oc&&(oc=fd.distance,vb=fd.gap)});kd.forEach(fd=>{fd.distance<M&&fd.distance<uc&&(uc=fd.distance,Wb=fd.gap)})});
m.forEach(([Sc,kd,fd])=>{Infinity!==vb&&kd.forEach(xd=>{2>Math.abs(xd.gap-vb)&&(Ga[xd.f]=ng(Gf({},Ga[xd.f]),{isSnapped:!0,to:Sc[xd.t],B:Sc,distance:xd.distance}))});Infinity!==Wb&&fd.forEach(xd=>{2>Math.abs(xd.gap-Wb)&&(Ga[xd.f]=ng(Gf({},Ga[xd.f]),{isSnapped:!0,to:Sc[xd.t],B:Sc,distance:xd.distance}))})});c[0]=Infinity===vb?0:vb;c[1]=Infinity===Wb?0:Wb;ca.minX-=c[0];ca.midX-=c[0];ca.maxX-=c[0];ca.minY-=c[1];ca.midY-=c[1];ca.maxY-=c[1];La.forEach(Sc=>{Sc=Ga[Sc];if(Sc.isSnapped){var {id:kd,B:fd}=Sc;
Sc=ca[kd];ua.push("minX"===kd?[[Sc,ca.midY],[Sc,fd.minY],[Sc,fd.maxY]]:[[Sc,ca.minY],[Sc,ca.maxY],[Sc,fd.minY],[Sc,fd.maxY]])}});fb.forEach(Sc=>{Sc=Ga[Sc];if(Sc.isSnapped){var {id:kd,B:fd}=Sc;Sc=ca[kd];ua.push("midY"===kd?[[ca.midX,Sc],[fd.minX,Sc],[fd.maxX,Sc]]:[[ca.minX,Sc],[ca.maxX,Sc],[fd.minX,Sc],[fd.maxX,Sc]])}});return{offset:c,snapLines:ua}}static ensureRatio(c,m){const {width:M,height:ca}=c,ua=Gf({},c);M/ca<m?(ua.width=ca*m,ua.maxX+=M-c.width):(ua.height=M/m,ua.maxY+=ca-c.height);return ua}static getDistributions(c,
m){var M=c.map(Ga=>{const La=Ga.getBounds();return{id:Ga.id,point:[La.minX,La.minY],bounds:La,center:Ga.getCenter()}});c=M.length;var ca=Me.getCommonBounds(M.map(({bounds:Ga})=>Ga));const ua=[];switch(m){case "horizontal":m=M.reduce((Ga,La)=>Ga+La.bounds.width,0);if(m>ca.width){const Ga=M.sort((Wb,oc)=>Wb.bounds.minX-oc.bounds.minX)[0],La=M.sort((Wb,oc)=>oc.bounds.maxX-Wb.bounds.maxX)[0];ca=M.filter(Wb=>Wb!==Ga&&Wb!==La).sort((Wb,oc)=>Wb.center[0]-oc.center[0]);const fb=(La.center[0]-Ga.center[0])/
(c-1),vb=Ga.center[0]+fb;ca.forEach(({id:Wb,point:oc,bounds:uc},Sc)=>{ua.push({id:Wb,prev:oc,next:[vb+fb*Sc-uc.width/2,uc.minY]})})}else{M=M.sort((fb,vb)=>fb.center[0]-vb.center[0]);let Ga=ca.minX;const La=(ca.width-m)/(c-1);M.forEach(({id:fb,point:vb,bounds:Wb})=>{ua.push({id:fb,prev:vb,next:[Ga,Wb.minY]});Ga+=Wb.width+La})}break;case "vertical":if(m=M.reduce((Ga,La)=>Ga+La.bounds.height,0),m>ca.height){const Ga=M.sort((Wb,oc)=>Wb.bounds.minY-oc.bounds.minY)[0],La=M.sort((Wb,oc)=>oc.bounds.maxY-
Wb.bounds.maxY)[0];ca=M.filter(Wb=>Wb!==Ga&&Wb!==La).sort((Wb,oc)=>Wb.center[1]-oc.center[1]);const fb=(La.center[1]-Ga.center[1])/(c-1),vb=Ga.center[1]+fb;ca.forEach(({id:Wb,point:oc,bounds:uc},Sc)=>{ua.push({id:Wb,prev:oc,next:[uc.minX,vb+fb*Sc-uc.height/2]})})}else{M=M.sort((fb,vb)=>fb.center[1]-vb.center[1]);let Ga=ca.minY;const La=(ca.height-m)/(c-1);M.forEach(({id:fb,point:vb,bounds:Wb})=>{ua.push({id:fb,prev:vb,next:[Wb.minX,Ga]});Ga+=Wb.height+La})}}return ua}static getPackedDistributions(c){const m=
Me.getCommonBounds(c.map(({bounds:ua})=>ua)),M=[m.minX,m.minY],ca=Object.fromEntries(c.map(ua=>[ua.id,[ua.bounds.minX,ua.bounds.minY]]));c=c.filter(ua=>{var Ga,La,fb,vb;return!((null==(La=null==(Ga=ua.props.handles)?void 0:Ga.start)?0:La.bindingId)||(null==(vb=null==(fb=ua.props.handles)?void 0:fb.end)?0:vb.bindingId))}).map(ua=>{const Ga=ua.getBounds();return{id:ua.id,w:Ga.width+16,h:Ga.height+16,x:Ga.minX,y:Ga.minY}});F(c);return c.map(({id:ua,x:Ga,y:La})=>({id:ua,prev:ca[ua],next:[Ga+M[0],La+M[1]]}))}},
ji=class{static pointInCircle(c,m,M){return yd.dist(c,m)<=M}static pointInEllipse(c,m,M,ca,ua=0){ua=ua||0;var Ga=Math.cos(ua);ua=Math.sin(ua);m=yd.sub(c,m);c=Ga*m[0]+ua*m[1];Ga=ua*m[0]-Ga*m[1];return 1>=c*c/(M*M)+Ga*Ga/(ca*ca)}static pointInRect(c,m){return!(c[0]<m[0]||c[0]>c[0]+m[0]||c[1]<m[1]||c[1]>c[1]+m[1])}static pointInPolygon(c,m){let M=0;m.forEach((ca,ua)=>{ua=m[(ua+1)%m.length];ca[1]<=c[1]?ua[1]>c[1]&&0<yd.cross(ca,ua,c)&&(M+=1):ua[1]<=c[1]&&0>yd.cross(ca,ua,c)&&--M});return 0!==M}static pointInBounds(c,
m){return!(c[0]<m.minX||c[0]>m.maxX||c[1]<m.minY||c[1]>m.maxY)}static pointInPolyline(c,m,M=3){for(let ca=1;ca<m.length;ca++)if(yd.distanceToLineSegment(m[ca-1],m[ca],c)<M)return!0;return!1}static _getSqSegDist(c,m,M){let ca=m[0];m=m[1];let ua=M[0]-ca,Ga=M[1]-m;if(0!==ua||0!==Ga){const La=((c[0]-ca)*ua+(c[1]-m)*Ga)/(ua*ua+Ga*Ga);1<La?(ca=M[0],m=M[1]):0<La&&(ca+=ua*La,m+=Ga*La)}ua=c[0]-ca;Ga=c[1]-m;return ua*ua+Ga*Ga}static _simplifyStep(c,m,M,ca,ua){let Ga=ca,La=-1;for(let fb=m+1;fb<M;fb++){const vb=
ji._getSqSegDist(c[fb],c[m],c[M]);vb>Ga&&(La=fb,Ga=vb)}-1<La&&Ga>ca&&(1<La-m&&ji._simplifyStep(c,m,La,ca,ua),ua.push(c[La]),1<M-La&&ji._simplifyStep(c,La,M,ca,ua))}static simplify2(c,m=1){if(2>=c.length)return c;m*=m;var M=c[0],ca=c[1];const ua=[M];for(let Ga=1,La=c.length;Ga<La;Ga++)ca=c[Ga],(ca[0]-M[0])*(ca[0]-M[0])+(ca[1]-M[1])*(ca[1]-M[1])>m&&(ua.push(ca),M=ca);M!==ca&&ua.push(ca);M=ua.length-1;ca=[ua[0]];ji._simplifyStep(ua,0,M,m,ca);ca.push(ua[M],c[c.length-1]);return ca}static pointNearToPolyline(c,
m,M=8){const ca=m.length;for(let ua=1;ua<ca;ua++)if(yd.distanceToLineSegment(m[ua-1],m[ua],c)<M)return!0;return!1}},vh=ji;wb(vh,"simplify",(c,m=1)=>{var M=c.length;const ca=c[0],ua=c[M-1],[Ga,La]=ca,[fb,vb]=ua;if(2<M){let Wb=0,oc=0;const uc=yd.len2([vb-La,fb-Ga]);for(let Sc=1;Sc<M-1;Sc++){const [kd,fd]=c[Sc],xd=Math.pow(kd*(vb-La)+Ga*(fd-vb)+fb*(La-fd),2)/uc;Wb>xd||(Wb=xd,oc=Sc)}if(Wb>m)return M=ji.simplify(c.slice(0,oc+1),m),c=ji.simplify(c.slice(oc+1),m),M.concat(c.slice(1))}return[ca,ua]});var Th=
Math.PI,ci=Th/2,Pg=2*Th,xi={},di={bottom_edge:"ns-resize",top_edge:"ns-resize",left_edge:"ew-resize",right_edge:"ew-resize",bottom_left_corner:"nesw-resize",bottom_right_corner:"nwse-resize",top_left_corner:"nwse-resize",top_right_corner:"nesw-resize",bottom_left_resize_corner:"swne-rotate",bottom_right_resize_corner:"senw-rotate",top_left_resize_corner:"nwse-rotate",top_right_resize_corner:"nesw-rotate",rotate:"rotate",center:"grab",background:"grab"},Dh=class{static circleFromThreePoints(c,m,M){const [ca,
ua]=c,[Ga,La]=m,[fb,vb]=M;m=ca*(La-vb)-ua*(Ga-fb)+Ga*vb-fb*La;c=-((ca*ca+ua*ua)*(vb-La)+(Ga*Ga+La*La)*(ua-vb)+(fb*fb+vb*vb)*(La-ua))/(2*m);m=-((ca*ca+ua*ua)*(Ga-fb)+(Ga*Ga+La*La)*(fb-ca)+(fb*fb+vb*vb)*(ca-Ga))/(2*m);return[c,m,Math.hypot(c-ca,m-ua)]}static perimeterOfEllipse(c,m){const M=Math.pow(c-m,2)/Math.pow(c+m,2);return Th*(c+m)*(1+3*M/(10+Math.sqrt(4-3*M)))}static shortAngleDist(c,m){c=(m-c)%Pg;return 2*c%Pg-c}static longAngleDist(c,m){return Pg-Dh.shortAngleDist(c,m)}static lerpAngles(c,m,
M){return c+Dh.shortAngleDist(c,m)*M}static angleDelta(c,m){return Dh.shortAngleDist(c,m)}static getSweep(c,m,M){return Dh.angleDelta(ne.angle(c,m),ne.angle(c,M))}static clampRadians(c){return(Pg+c)%Pg}static snapAngleToSegments(c,m){m=Pg/m;c=Math.floor((Dh.clampRadians(c)+m/2)/m)*m%Pg;c<Th&&(c+=Pg);c>Th&&(c-=Pg);return c}static isAngleBetween(c,m,M){if(M===c||M===m)return!0;m=(m-c+ci)%ci;return m<=Th!==(M-c+ci)%ci>m}static degreesToRadians(c){return c*Th/180}static radiansToDegrees(c){return 180*
c/Th}static getArcLength(c,m,M,ca){c=Dh.getSweep(c,M,ca);return c/Pg*Pg*m}static getSweepFlag(c,m,M){M=ne.angle(c,M);return 0<(ne.angle(c,m)-M+3*Th)%Pg-Th?0:1}static getLargeArcFlag(c,m,M){c=ne.angle(M,c);m=(ne.angle(M,m)-c+3*Th)%Pg-Th;return Math.abs(m)>ci?0:1}static getArcDashOffset(c,m,M,ca,ua){const Ga=Dh.getSweepFlag(c,M,ca);m=Dh.getArcLength(c,m,M,ca);return-(0>Ga?m:Pg*c[2]-m)/2+ua}static getEllipseDashOffset(c,m){return-(Pg*c[2])/2+-m}static radiansToCardinalDirection(c){return c<.25*Math.PI?
"north":c<.75*Math.PI?"east":c<1.25*Math.PI?"south":c<1.75*Math.PI?"west":"north"}},ki=class{static getPolygonCentroid(c){var m=c.map(M=>M[0]);c=c.map(M=>M[1]);m=Math.min(...m)+Math.max(...m);c=Math.min(...c)+Math.max(...c);return[m?m/2:0,c?c/2:0]}};wb(ki,"getEdges",c=>{const m=c.length;return c.map((M,ca)=>[M,c[(ca+1)%m]])});wb(ki,"getEdgeOutwardNormal",(c,m)=>ne.per(ne.uni(ne.sub(m,c))));wb(ki,"getEdgeInwardNormal",(c,m)=>ne.neg(ki.getEdgeOutwardNormal(c,m)));wb(ki,"getOffsetEdge",(c,m,M)=>{M=ne.mul(ne.per(ne.uni(ne.sub(m,
c))),M);return[ne.add(c,M),ne.add(m,M)]});wb(ki,"getOffsetEdges",(c,m)=>c.map(([M,ca])=>ki.getOffsetEdge(M,ca,m)));wb(ki,"getOffsetPolygon",(c,m)=>{if(1>c.length)throw Error("Expected at least one point.");if(1===c.length)return c=c[0],[ne.add(c,[-m,-m]),ne.add(c,[m,-m]),ne.add(c,[m,m]),ne.add(c,[-m,m])];if(2===c.length){const [M,ca]=c;return[...ki.getOffsetEdge(M,ca,m),...ki.getOffsetEdge(ca,M,m)]}return ki.getOffsetEdges(ki.getEdges(c),m).flatMap((M,ca,ua)=>{{ca=ua[(ca+1)%ua.length];const Ga=yd.slope(M[0],
M[1]);ua=yd.slope(ca[0],ca[1]);Ga!==ua?Number.isNaN(Ga)&&!Number.isNaN(ua)?M=[M[0][0],(M[0][0]-ca[0][0])*ua+ca[0][1]]:Number.isNaN(ua)&&!Number.isNaN(Ga)?M=[ca[0][0],(ca[0][0]-M[0][0])*Ga+M[0][1]]:(M=(Ga*M[0][0]-ua*ca[0][0]+ca[0][1]-M[0][1])/(Ga-ua),M=[M,ua*(M-ca[0][0])+ca[0][1]]):M=void 0}if(void 0===M)throw Error("Expected an intersection");return M})});wb(ki,"getPolygonVertices",(c,m,M=0,ca=1)=>{c=ne.div(c,2);const [ua,Ga]=[Math.max(1,c[0]-M),Math.max(1,c[1]-M)];M=[];for(let Wb=0,oc=Pg/m;Wb<m;Wb++){var La=
(-ci+Wb*oc)%Pg,fb=(-ci+(Wb+1)*oc)%Pg;La=ne.add(c,[ua*Math.cos(La),Ga*Math.sin(La)]);fb=ne.add(c,[ua*Math.cos(fb),Ga*Math.sin(fb)]);var vb=ne.med(La,fb);vb=ne.nudge(vb,c,ne.dist(c,vb)*(1-ca));M.push(La,vb,fb)}return M});wb(ki,"getTriangleVertices",(c,m=0,M=1)=>{const [ca,ua]=c;var Ga=1-M;c=[ca/2,m/2];M=[ca-m,ua-m];m=[m/2,ua-m];const La=ki.getPolygonCentroid([c,M,m]),fb=ne.med(c,M),vb=ne.med(M,m),Wb=ne.med(m,c),oc=ne.dist(fb,La)*Ga,uc=ne.dist(vb,La)*Ga;Ga*=ne.dist(Wb,La);return[c,oc?ne.nudge(fb,La,
oc):fb,M,uc?ne.nudge(vb,La,uc):vb,m,Ga?ne.nudge(Wb,La,Ga):Wb]});wb(ki,"getStarVertices",(c,m,M,ca=1)=>{const ua=ne.div(m,2),Ga=ne.mul(ua,ca/2),La=Pg/M/2;return Array.from(Array(2*M)).map((fb,vb)=>{fb=-ci+vb*La;const [Wb,oc]=vb%2?Ga:ua;return ne.add(c,[Wb*Math.cos(fb),oc*Math.sin(fb)])})});var Nj=class{static getCurvedPathForPolygon(c){if(3>c.length)return"M -4, 0\n      a 4,4 0 1,0 8,0\n      a 4,4 0 1,0 -8,0";const m=["M",...c[0].slice(0,2),"Q"],M=c.length;for(let ca=1;ca<M;ca++){const [ua,Ga]=c[ca],
[La,fb]=c[(ca+1)%M];m.push(ua,Ga,(ua+La)/2,(Ga+fb)/2)}m.push("Z");return m.join(" ")}static getCurvedPathForPoints(c){if(3>c.length)return"M -4, 0\n      a 4,4 0 1,0 8,0\n      a 4,4 0 1,0 -8,0";const m=["M",...c[0].slice(0,2),"Q"],M=c.length;for(let ca=1;ca<M-1;ca++){const [ua,Ga]=c[ca],[La,fb]=c[ca+1];m.push(ua,Ga,(ua+La)/2,(Ga+fb)/2)}return m.join(" ")}static getSvgPathFromStroke(c,m=!0){const M=c.length;if(4>M)return"";let ca=c[0],ua=c[1];var Ga=c[2];Ga=`M${ca[0].toFixed(2)},${ca[1].toFixed(2)} Q${ua[0].toFixed(2)},${ua[1].toFixed(2)} ${((ua[0]+
Ga[0])/2).toFixed(2)},${((ua[1]+Ga[1])/2).toFixed(2)} T`;for(let La=2,fb=M-1;La<fb;La++)ca=c[La],ua=c[La+1],Ga+=`${((ca[0]+ua[0])/2).toFixed(2)},${((ca[1]+ua[1])/2).toFixed(2)} `;m&&(Ga+="Z");return Ga}static getSvgPathFromStrokePoints(c,m=!1){const M=c.length;if(4>M)return"";let ca=c[0].point,ua=c[1].point;var Ga=c[2].point;Ga=`M${ca[0].toFixed(2)},${ca[1].toFixed(2)} Q${ua[0].toFixed(2)},${ua[1].toFixed(2)} ${((ua[0]+Ga[0])/2).toFixed(2)},${((ua[1]+Ga[1])/2).toFixed(2)} T`;for(let La=2,fb=M-1;La<
fb;La++)ca=c[La].point,ua=c[La+1].point,Ga+=`${((ca[0]+ua[0])/2).toFixed(2)},${((ca[1]+ua[1])/2).toFixed(2)} `;m&&(Ga+="Z");return Ga}};wb(Nj,"TRIM_NUMBERS",/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g);var vk={},Dm=Object.assign,tl=Object.getOwnPropertyDescriptor,Tk=Object.defineProperty,yq=Object.prototype,Xs=[];Object.freeze(Xs);var Ys={};Object.freeze(Ys);var Zy="undefined"!==typeof Proxy,$y=Object.toString(),hp=function(){},mv="undefined"!==typeof Object.getOwnPropertySymbols,yr="undefined"!==
typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:mv?function(c){return Object.getOwnPropertyNames(c).concat(Object.getOwnPropertySymbols(c))}:Object.getOwnPropertyNames,az=Object.getOwnPropertyDescriptors||function(c){var m={};yr(c).forEach(function(M){m[M]=tl(c,M)});return m},Kl=Symbol("mobx-stored-annotations"),Eh=Symbol("mobx administration"),zq=function(){function c(M){void 0===M&&(M="Atom");this.name_=void 0;this.isBeingObserved_=this.isPendingUnobservation_=!1;this.observers_=new Set;this.lastAccessedBy_=
this.diffValue_=0;this.lowestObserverState_=Ei.NOT_TRACKING_;this.onBUOL=this.onBOL=void 0;this.name_=M}var m=c.prototype;m.onBO=function(){this.onBOL&&this.onBOL.forEach(function(M){return M()})};m.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(M){return M()})};m.reportObserved=function(){return kb(this)};m.reportChanged=function(){Nb();ub(this);Cb()};m.toString=function(){return this.name_};return c}(),Zs=I("Atom",zq),ip={identity:function(c,m){return c===m},structural:function(c,m){return ma(c,
m)},"default":function(c,m){return Object.is?Object.is(c,m):c===m?0!==c||1/c===1/m:c!==c&&m!==m},shallow:function(c,m){return ma(c,m,1)}},bz="override",cz=Da(),Aq={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Aq);var nv=gb("observable"),dz=gb("observable.ref",{enhancer:Na}),ez=gb("observable.shallow",{enhancer:function(c,m,M){if(void 0===c||null===c||Kb(c)||Lc(c)||kn(c)||ro(c))return c;if(Array.isArray(c))return Rg.array(c,{name:M,deep:!1});if(O(c))return Rg.object(c,void 0,
{name:M,deep:!1});if(R(c))return Rg.map(c,{name:M,deep:!1});if(Q(c))return Rg.set(c,{name:M,deep:!1})}}),fz=gb("observable.struct",{enhancer:function(c,m){return ma(c,m)?m:c}}),ov=xa(nv);Object.assign(hb,ov);var gz={box:function(c,m){m=m||Aq;return new po(c,Za(m),m.name,!0,m.equals)},array:function(c,m){m=m||Aq;return(!1===$f.useProxies||!1===m.proxy?f:ab)(c,Za(m),m.name)},map:function(c,m){m=m||Aq;return new zv(c,Za(m),m.name)},set:function(c,m){m=m||Aq;return new Av(c,Za(m),m.name)},object:function(c,
m,M){if(!1===$f.useProxies||!1===(null==M?void 0:M.proxy))M=jd({},M);else{var ca={},ua,Ga;B();ca=jd(ca,M);M=null!=(Ga=(ua=ca[Eh]).proxy_)?Ga:ua.proxy_=new Proxy(ca,uz)}return xc(M,c,m)},ref:xa(dz),shallow:xa(ez),deep:ov,struct:xa(fz)},Rg=Dm(hb,gz),pv=Ua("computed"),hz=Ua("computed.struct",{equals:ip.structural}),$g=function(c,m){if(y(m))return Ja(c,m,pv);if(O(c))return xa(Ua("computed",c));m=O(m)?m:{};m.get=c;m.name||(m.name=c.name||"");return new Bq(m)};Object.assign($g,pv);$g.struct=xa(hz);var qv,
rv,zr=0,iz=1,jz=null!=(qv=null==(rv=tl(function(){},"name"))?void 0:rv.configurable)?qv:!1,sv={value:"action",configurable:!0,writable:!1,enumerable:!1};var kz=Symbol.toPrimitive;var po=function(c){function m(ca,ua,Ga,La,fb){void 0===Ga&&(Ga="ObservableValue");void 0===fb&&(fb=ip["default"]);La=c.call(this,Ga)||this;La.enhancer=void 0;La.hasUnreportedChange_=!1;La.interceptors_=void 0;La.changeListeners_=void 0;La.value_=void 0;La.dehancer=void 0;La.enhancer=ua;La.name_=Ga;La.equals=fb;La.value_=
ua(ca,void 0,Ga);return La}ha(m,c);var M=m.prototype;M.dehanceValue=function(ca){return void 0!==this.dehancer?this.dehancer(ca):ca};M.set=function(ca){ca=this.prepareNewValue_(ca);ca!==$f.UNCHANGED&&this.setNewValue_(ca)};M.prepareNewValue_=function(ca){if(sb(this)){ca=lb(this,{object:this,type:im,newValue:ca});if(!ca)return $f.UNCHANGED;ca=ca.newValue}ca=this.enhancer(ca,this.value_,this.name_);return this.equals(this.value_,ca)?$f.UNCHANGED:ca};M.setNewValue_=function(ca){var ua=this.value_;this.value_=
ca;this.reportChanged();Mb(this)&&hc(this,{type:im,object:this,newValue:ca,oldValue:ua})};M.get=function(){this.reportObserved();return this.dehanceValue(this.value_)};M.intercept_=function(ca){return Gb(this,ca)};M.observe_=function(ca,ua){ua&&ca({observableKind:"value",debugObjectName:this.name_,object:this,type:im,newValue:this.value_,oldValue:void 0});return Ib(this,ca)};M.raw=function(){return this.value_};M.toJSON=function(){return this.get()};M.toString=function(){return this.name_+"["+this.value_+
"]"};M.valueOf=function(){return ja(this.get())};M[kz]=function(){return this.valueOf()};return m}(zq),lz=I("ObservableValue",po);var mz=Symbol.toPrimitive;var Bq=function(){function c(M){this.dependenciesState_=Ei.NOT_TRACKING_;this.observing_=[];this.newObserving_=null;this.isPendingUnobservation_=this.isBeingObserved_=!1;this.observers_=new Set;this.lastAccessedBy_=this.runId_=this.diffValue_=0;this.lowestObserverState_=Ei.UP_TO_DATE_;this.unboundDepsCount_=0;this.value_=new qo(null);this.triggeredBy_=
this.name_=void 0;this.isRunningSetter_=this.isComputing_=!1;this.setter_=this.derivation=void 0;this.isTracing_=jp.NONE;this.onBUOL=this.onBOL=this.keepAlive_=this.requiresReaction_=this.equals_=this.scope_=void 0;M.get||e(31);this.derivation=M.get;this.name_=M.name||"ComputedValue";M.set&&(this.setter_=Ya("ComputedValue-setter",M.set));this.equals_=M.equals||(M.compareStructural||M.struct?ip.structural:ip["default"]);this.scope_=M.context;this.requiresReaction_=M.requiresReaction;this.keepAlive_=
!!M.keepAlive}var m=c.prototype;m.onBecomeStale_=function(){ib(this)};m.onBO=function(){this.onBOL&&this.onBOL.forEach(function(M){return M()})};m.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(M){return M()})};m.get=function(){this.isComputing_&&e(32,this.name_,this.derivation);if(0!==$f.inBatch||0!==this.observers_.size||this.keepAlive_){if(kb(this),Rc(this)){var M=$f.trackingContext;this.keepAlive_&&!M&&($f.trackingContext=this);this.trackAndCompute()&&zb(this);$f.trackingContext=M}}else Rc(this)&&
(this.warnAboutUntrackedRead_(),Nb(),this.value_=this.computeValue_(!1),Cb());M=this.value_;if(M instanceof qo)throw M.cause;return M};m.set=function(M){if(this.setter_){this.isRunningSetter_&&e(33,this.name_);this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,M)}finally{this.isRunningSetter_=!1}}else e(34,this.name_)};m.trackAndCompute=function(){var M=this.value_,ca=this.dependenciesState_===Ei.NOT_TRACKING_,ua=this.computeValue_(!0);if(M=ca||M instanceof qo||ua instanceof qo||!this.equals_(M,
ua))this.value_=ua;return M};m.computeValue_=function(M){this.isComputing_=!0;var ca=Uc(!1);if(M)var ua=Fc(this,this.derivation,this.scope_);else if(!0===$f.disableErrorBoundaries)ua=this.derivation.call(this.scope_);else try{ua=this.derivation.call(this.scope_)}catch(Ga){ua=new qo(Ga)}$f.allowStateChanges=ca;this.isComputing_=!1;return ua};m.suspend_=function(){this.keepAlive_||(Ic(this),this.value_=void 0)};m.observe_=function(M,ca){var ua=this,Ga=!0,La=void 0;return nc(function(){var fb=ua.get();
if(!Ga||ca){var vb=Xa();M({observableKind:"computed",debugObjectName:ua.name_,type:im,object:ua,newValue:fb,oldValue:La});$f.trackingDerivation=vb}Ga=!1;La=fb})};m.warnAboutUntrackedRead_=function(){};m.toString=function(){return this.name_+"["+this.derivation.toString()+"]"};m.valueOf=function(){return ja(this.get())};m[mz]=function(){return this.valueOf()};return c}(),Cq=I("ComputedValue",Bq),Ei;(function(c){c[c.NOT_TRACKING_=-1]="NOT_TRACKING_";c[c.UP_TO_DATE_=0]="UP_TO_DATE_";c[c.POSSIBLY_STALE_=
1]="POSSIBLY_STALE_";c[c.STALE_=2]="STALE_"})(Ei||={});var jp;(function(c){c[c.NONE=0]="NONE";c[c.LOG=1]="LOG";c[c.BREAK=2]="BREAK"})(jp||={});var qo=function(c){this.cause=c},Ar=function(){this.version=6;this.UNCHANGED={};this.trackingContext=this.trackingDerivation=null;this.inBatch=this.mobxGuid=this.runId=0;this.pendingUnobservations=[];this.pendingReactions=[];this.allowStateChanges=this.isRunningReactions=!1;this.enforceActions=this.allowStateReads=!0;this.spyListeners=[];this.globalReactionErrorHandlers=
[];this.suppressReactionErrors=this.disableErrorBoundaries=this.observableRequiresReaction=this.reactionRequiresObservable=this.computedRequiresReaction=!1;this.useProxies=!0;this.verifyProxies=!1;this.safeDescriptors=!0},Br=!0,tv=!1,$f=function(){var c=H();0<c.__mobxInstanceCount&&!c.__mobxGlobals&&(Br=!1);c.__mobxGlobals&&c.__mobxGlobals.version!==(new Ar).version&&(Br=!1);if(Br){if(c.__mobxGlobals)return c.__mobxInstanceCount+=1,c.__mobxGlobals.UNCHANGED||(c.__mobxGlobals.UNCHANGED={}),c.__mobxGlobals;
c.__mobxInstanceCount=1;return c.__mobxGlobals=new Ar}setTimeout(function(){tv||e(35)},1);return new Ar}(),kp=function(){function c(M,ca,ua,Ga){void 0===M&&(M="Reaction");this.requiresObservable_=this.errorHandler_=this.onInvalidate_=this.name_=void 0;this.observing_=[];this.newObserving_=[];this.dependenciesState_=Ei.NOT_TRACKING_;this.unboundDepsCount_=this.runId_=this.diffValue_=0;this.isRunning_=this.isTrackPending_=this.isScheduled_=this.isDisposed_=!1;this.isTracing_=jp.NONE;this.name_=M;this.onInvalidate_=
ca;this.errorHandler_=ua;this.requiresObservable_=Ga}var m=c.prototype;m.onBecomeStale_=function(){this.schedule_()};m.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,$f.pendingReactions.push(this),0<$f.inBatch||$f.isRunningReactions||Cr(rb))};m.isScheduled=function(){return this.isScheduled_};m.runReaction_=function(){if(!this.isDisposed_){Nb();this.isScheduled_=!1;var M=$f.trackingContext;$f.trackingContext=this;if(Rc(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(ca){this.reportExceptionInDerivation_(ca)}}$f.trackingContext=
M;Cb()}};m.track=function(M){if(!this.isDisposed_){Nb();this.isRunning_=!0;var ca=$f.trackingContext;$f.trackingContext=this;M=Fc(this,M,void 0);$f.trackingContext=ca;this.isTrackPending_=this.isRunning_=!1;this.isDisposed_&&Ic(this);M instanceof qo&&this.reportExceptionInDerivation_(M.cause);Cb()}};m.reportExceptionInDerivation_=function(M){var ca=this;if(this.errorHandler_)this.errorHandler_(M,this);else{if($f.disableErrorBoundaries)throw M;$f.suppressReactionErrors||console.error("[mobx] uncaught error in '"+
this+"'",M);$f.globalReactionErrorHandlers.forEach(function(ua){return ua(M,ca)})}};m.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(Nb(),Ic(this),Cb()))};m.getDisposer_=function(){var M=this.dispose.bind(this);M[Eh]=this;return M};m.toString=function(){return"Reaction["+this.name_+"]"};m.trace=function(M){void 0===M&&(M=!1);Rb(this,M)};return c}(),nz=100,Cr=function(c){return c()},Dr=I("Reaction",kp),uv="action",vv=Fa(uv),oz=Fa("action.bound",{bound:!0}),wv=Fa("autoAction",
{autoAction:!0}),xv=Fa("autoAction.bound",{autoAction:!0,bound:!0}),Ag=bc(!1);Object.assign(Ag,vv);var Dq=bc(!0);Object.assign(Dq,wv);Ag.bound=xa(oz);Dq.bound=xa(xv);var pz=function(c){return c()},qz="onBO",rz="onBUO",sz=0;vc.prototype=Object.create(Error.prototype);var yv=ta("flow"),tz=ta("flow.bound",{bound:!0}),Eq=Object.assign(function(c,m){if(y(m))return Ja(c,m,yv);var M=c.name||"\x3cunnamed flow\x3e";m=function(){var ca=arguments,ua=++sz,Ga=Ag(M+" - runid: "+ua+" - init",c).apply(this,ca),La,
fb=void 0;ca=new Promise(function(vb,Wb){function oc(fd){fb=void 0;try{var xd=Ag(M+" - runid: "+ua+" - yield "+kd++,Ga.next).call(Ga,fd)}catch(Jd){return Wb(Jd)}Sc(xd)}function uc(fd){fb=void 0;try{var xd=Ag(M+" - runid: "+ua+" - yield "+kd++,Ga["throw"]).call(Ga,fd)}catch(Jd){return Wb(Jd)}Sc(xd)}function Sc(fd){if(V(null==fd?void 0:fd.then))fd.then(Sc,Wb);else{if(fd.done)return vb(fd.value);fb=Promise.resolve(fd.value);return fb.then(oc,uc)}}var kd=0;La=Wb;oc(void 0)});ca.cancel=Ag(M+" - runid: "+
ua+" - cancel",function(){try{if(fb){var vb=fb;V(vb.cancel)&&vb.cancel()}var Wb=Ga["return"](void 0),oc=Promise.resolve(Wb.value);oc.then(hp,hp);V(oc.cancel)&&oc.cancel();La(new vc)}catch(uc){La(uc)}});return ca};m.isMobXFlow=!0;return m},yv);Eq.bound=xa(tz);var uz={has:function(c,m){return c[Eh].has_(m)},get:function(c,m){return c[Eh].get_(m)},set:function(c,m,M){var ca;return y(m)?null!=(ca=c[Eh].set_(m,M,!0))?ca:!0:!1},deleteProperty:function(c,m){var M;return y(m)?null!=(M=c[Eh].delete_(m,!0))?
M:!0:!1},defineProperty:function(c,m,M){var ca;return null!=(ca=c[Eh].defineProperty_(m,M))?ca:!0},ownKeys:function(c){return c[Eh].ownKeys_()},preventExtensions:function(c){e(13)}},im="update",vz={get:function(c,m){var M=c[Eh];return m===Eh?M:"length"===m?M.getArrayLength_():"string"!==typeof m||isNaN(m)?X(Er,m)?Er[m]:c[m]:M.get_(parseInt(m))},set:function(c,m,M){var ca=c[Eh];"length"===m&&ca.setArrayLength_(M);"symbol"===typeof m||isNaN(m)?c[m]=M:ca.set_(parseInt(m),M);return!0},preventExtensions:function(){e(15)}},
$s=function(){function c(M,ca,ua,Ga){void 0===M&&(M="ObservableArray");this.atom_=this.legacyMode_=this.owned_=void 0;this.values_=[];this.proxy_=this.dehancer=this.enhancer_=this.changeListeners_=this.interceptors_=void 0;this.lastKnownLength_=0;this.owned_=ua;this.legacyMode_=Ga;this.atom_=new zq(M);this.enhancer_=function(La,fb){return ca(La,fb,"ObservableArray[..]")}}var m=c.prototype;m.dehanceValue_=function(M){return void 0!==this.dehancer?this.dehancer(M):M};m.dehanceValues_=function(M){return void 0!==
this.dehancer&&0<M.length?M.map(this.dehancer):M};m.intercept_=function(M){return Gb(this,M)};m.observe_=function(M,ca){void 0===ca&&(ca=!1);ca&&M({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0});return Ib(this,M)};m.getArrayLength_=function(){this.atom_.reportObserved();return this.values_.length};m.setArrayLength_=function(M){("number"!==typeof M||isNaN(M)||0>M)&&
e("Out of range: "+M);var ca=this.values_.length;if(M!==ca)if(M>ca){for(var ua=Array(M-ca),Ga=0;Ga<M-ca;Ga++)ua[Ga]=void 0;this.spliceWithArray_(ca,0,ua)}else this.spliceWithArray_(M,ca-M)};m.updateArrayLength_=function(M,ca){M!==this.lastKnownLength_&&e(16);this.lastKnownLength_+=ca;this.legacyMode_&&0<ca&&qa(M+ca+1)};m.spliceWithArray_=function(M,ca,ua){var Ga=this,La=this.values_.length;void 0===M?M=0:M>La?M=La:0>M&&(M=Math.max(0,La+M));ca=1===arguments.length?La-M:void 0===ca||null===ca?0:Math.max(0,
Math.min(ca,La-M));void 0===ua&&(ua=Xs);if(sb(this)){var fb=lb(this,{object:this.proxy_,type:"splice",index:M,removedCount:ca,added:ua});if(!fb)return Xs;ca=fb.removedCount;ua=fb.added}ua=0===ua.length?ua:ua.map(function(vb){return Ga.enhancer_(vb,void 0)});this.legacyMode_&&this.updateArrayLength_(La,ua.length-ca);La=this.spliceItemsIntoValues_(M,ca,ua);0===ca&&0===ua.length||this.notifyArraySplice_(M,ua,La);return this.dehanceValues_(La)};m.spliceItemsIntoValues_=function(M,ca,ua){if(1E4>ua.length){var Ga;
return(Ga=this.values_).splice.apply(Ga,[M,ca].concat(ua))}Ga=this.values_.slice(M,M+ca);var La=this.values_.slice(M+ca);this.values_.length+=ua.length-ca;for(ca=0;ca<ua.length;ca++)this.values_[M+ca]=ua[ca];for(ca=0;ca<La.length;ca++)this.values_[M+ua.length+ca]=La[ca];return Ga};m.notifyArrayChildUpdate_=function(M,ca,ua){var Ga=!this.owned_&&!1,La=Mb(this);M=La||Ga?{observableKind:"array",object:this.proxy_,type:im,debugObjectName:this.atom_.name_,index:M,newValue:ca,oldValue:ua}:null;this.atom_.reportChanged();
La&&hc(this,M)};m.notifyArraySplice_=function(M,ca,ua){var Ga=!this.owned_&&!1,La=Mb(this);M=La||Ga?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:M,removed:ua,added:ca,removedCount:ua.length,addedCount:ca.length}:null;this.atom_.reportChanged();La&&hc(this,M)};m.get_=function(M){if(this.legacyMode_&&M>=this.values_.length)console.warn("[mobx] Out of bounds read: "+M);else return this.atom_.reportObserved(),this.dehanceValue_(this.values_[M])};m.set_=
function(M,ca){var ua=this.values_;this.legacyMode_&&M>ua.length&&e(17,M,ua.length);if(M<ua.length){var Ga=ua[M];if(sb(this)){ca=lb(this,{type:im,object:this.proxy_,index:M,newValue:ca});if(!ca)return;ca=ca.newValue}ca=this.enhancer_(ca,Ga);ca!==Ga&&(ua[M]=ca,this.notifyArrayChildUpdate_(M,ca,Ga))}else{M=Array(M+1-ua.length);for(Ga=0;Ga<M.length-1;Ga++)M[Ga]=void 0;M[M.length-1]=ca;this.spliceWithArray_(ua.length,0,M)}};return c}(),Er={clear:function(){return this.splice(0)},replace:function(c){var m=
this[Eh];return m.spliceWithArray_(0,m.values_.length,c)},toJSON:function(){return this.slice()},splice:function(c,m){for(var M=arguments.length,ca=Array(2<M?M-2:0),ua=2;ua<M;ua++)ca[ua-2]=arguments[ua];M=this[Eh];switch(arguments.length){case 0:return[];case 1:return M.spliceWithArray_(c);case 2:return M.spliceWithArray_(c,m)}return M.spliceWithArray_(c,m,ca)},spliceWithArray:function(c,m,M){return this[Eh].spliceWithArray_(c,m,M)},push:function(){for(var c=this[Eh],m=arguments.length,M=Array(m),
ca=0;ca<m;ca++)M[ca]=arguments[ca];c.spliceWithArray_(c.values_.length,0,M);return c.values_.length},pop:function(){return this.splice(Math.max(this[Eh].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var c=this[Eh],m=arguments.length,M=Array(m),ca=0;ca<m;ca++)M[ca]=arguments[ca];c.spliceWithArray_(0,0,M);return c.values_.length},reverse:function(){$f.trackingDerivation&&e(37,"reverse");this.replace(this.slice().reverse());return this},sort:function(){$f.trackingDerivation&&
e(37,"sort");var c=this.slice();c.sort.apply(c,arguments);this.replace(c);return this},remove:function(c){var m=this[Eh];c=m.dehanceValues_(m.values_).indexOf(c);return-1<c?(this.splice(c,1),!0):!1}};eb("concat",Va);eb("flat",Va);eb("includes",Va);eb("indexOf",Va);eb("join",Va);eb("lastIndexOf",Va);eb("slice",Va);eb("toString",Va);eb("toLocaleString",Va);eb("every",mb);eb("filter",mb);eb("find",mb);eb("findIndex",mb);eb("flatMap",mb);eb("forEach",mb);eb("map",mb);eb("some",mb);eb("reduce",Bb);eb("reduceRight",
Bb);var wz=I("ObservableArrayAdministration",$s),xz={};var yz=Symbol.iterator;var zz=Symbol.toStringTag;var zv=function(){function c(M,ca,ua){var Ga=this;void 0===ca&&(ca=Ca);void 0===ua&&(ua="ObservableMap");this.name_=this.enhancer_=void 0;this[Eh]=xz;this.dehancer=this.changeListeners_=this.interceptors_=this.keysAtom_=this.hasMap_=this.data_=void 0;this.enhancer_=ca;this.name_=ua;V(Map)||e(18);this.keysAtom_=db("ObservableMap.keys()");this.data_=new Map;this.hasMap_=new Map;ec(!0,function(){Ga.merge(M)})}
var m=c.prototype;m.has_=function(M){return this.data_.has(M)};m.has=function(M){var ca=this;if(!$f.trackingDerivation)return this.has_(M);var ua=this.hasMap_.get(M);if(!ua){var Ga=ua=new po(this.has_(M),Na,"ObservableMap.key?",!1);this.hasMap_.set(M,Ga);ld(Ga,function(){return ca.hasMap_["delete"](M)})}return ua.get()};m.set=function(M,ca){var ua=this.has_(M);if(sb(this)){ca=lb(this,{type:ua?im:"add",object:this,newValue:ca,name:M});if(!ca)return this;ca=ca.newValue}ua?this.updateValue_(M,ca):this.addValue_(M,
ca);return this};m["delete"]=function(M){var ca=this;if(sb(this)&&!lb(this,{type:"delete",object:this,name:M}))return!1;if(this.has_(M)){var ua=Mb(this),Ga=ua?{observableKind:"map",debugObjectName:this.name_,type:"delete",object:this,oldValue:this.data_.get(M).value_,name:M}:null;tc(function(){var La;ca.keysAtom_.reportChanged();null==(La=ca.hasMap_.get(M))?void 0:La.setNewValue_(!1);ca.data_.get(M).setNewValue_(void 0);ca.data_["delete"](M)});ua&&hc(this,Ga);return!0}return!1};m.updateValue_=function(M,
ca){var ua=this.data_.get(M);ca=ua.prepareNewValue_(ca);if(ca!==$f.UNCHANGED){var Ga=Mb(this);M=Ga?{observableKind:"map",debugObjectName:this.name_,type:im,object:this,oldValue:ua.value_,name:M,newValue:ca}:null;ua.setNewValue_(ca);Ga&&hc(this,M)}};m.addValue_=function(M,ca){var ua=this;tc(function(){var fb,vb=new po(ca,ua.enhancer_,"ObservableMap.key",!1);ua.data_.set(M,vb);ca=vb.value_;null==(fb=ua.hasMap_.get(M))?void 0:fb.setNewValue_(!0);ua.keysAtom_.reportChanged()});var Ga=Mb(this),La=Ga?{observableKind:"map",
debugObjectName:this.name_,type:"add",object:this,name:M,newValue:ca}:null;Ga&&hc(this,La)};m.get=function(M){return this.has(M)?this.dehanceValue_(this.data_.get(M).get()):this.dehanceValue_(void 0)};m.dehanceValue_=function(M){return void 0!==this.dehancer?this.dehancer(M):M};m.keys=function(){this.keysAtom_.reportObserved();return this.data_.keys()};m.values=function(){var M=this,ca=this.keys();return $a({next:function(){var ua=ca.next(),Ga=ua.done;ua=ua.value;return{done:Ga,value:Ga?void 0:M.get(ua)}}})};
m.entries=function(){var M=this,ca=this.keys();return $a({next:function(){var ua=ca.next(),Ga=ua.done;ua=ua.value;return{done:Ga,value:Ga?void 0:[ua,M.get(ua)]}}})};m[yz]=function(){return this.entries()};m.forEach=function(M,ca){for(var ua=sa(this),Ga;!(Ga=ua()).done;)Ga=Ga.value,M.call(ca,Ga[1],Ga[0],this)};m.merge=function(M){var ca=this;kn(M)&&(M=new Map(M));tc(function(){O(M)?N(M).forEach(function(ua){return ca.set(ua,M[ua])}):Array.isArray(M)?M.forEach(function(ua){return ca.set(ua[0],ua[1])}):
R(M)?(M.constructor!==Map&&e(19,M),M.forEach(function(ua,Ga){return ca.set(Ga,ua)})):null!==M&&void 0!==M&&e(20,M)});return this};m.clear=function(){var M=this;tc(function(){Sa(function(){for(var ca=sa(M.keys()),ua;!(ua=ca()).done;)M["delete"](ua.value)})})};m.replace=function(M){var ca=this;tc(function(){for(var ua=cd(M),Ga=new Map,La=!1,fb=sa(ca.data_.keys()),vb;!(vb=fb()).done;)if(vb=vb.value,!ua.has(vb))if(ca["delete"](vb))La=!0;else{var Wb=ca.data_.get(vb);Ga.set(vb,Wb)}for(ua=sa(ua.entries());!(fb=
ua()).done;)vb=fb.value,fb=vb[0],Wb=vb[1],vb=ca.data_.has(fb),ca.set(fb,Wb),ca.data_.has(fb)&&(Wb=ca.data_.get(fb),Ga.set(fb,Wb),vb||(La=!0));if(!La)if(ca.data_.size!==Ga.size)ca.keysAtom_.reportChanged();else for(La=ca.data_.keys(),ua=Ga.keys(),fb=La.next(),vb=ua.next();!fb.done;){if(fb.value!==vb.value){ca.keysAtom_.reportChanged();break}fb=La.next();vb=ua.next()}ca.data_=Ga});return this};m.toString=function(){return"[object ObservableMap]"};m.toJSON=function(){return Array.from(this)};m.observe_=
function(M,ca){return Ib(this,M)};m.intercept_=function(M){return Gb(this,M)};aa(c,[{key:"size",get:function(){this.keysAtom_.reportObserved();return this.data_.size}},{key:zz,get:function(){return"Map"}}]);return c}(),kn=I("ObservableMap",zv),Az={};var Bz=Symbol.iterator;var Cz=Symbol.toStringTag;var Av=function(){function c(M,ca,ua){void 0===ca&&(ca=Ca);void 0===ua&&(ua="ObservableSet");this.name_=void 0;this[Eh]=Az;this.data_=new Set;this.enhancer_=this.dehancer=this.interceptors_=this.changeListeners_=
this.atom_=void 0;this.name_=ua;V(Set)||e(22);this.atom_=db(this.name_);this.enhancer_=function(Ga,La){return ca(Ga,La,ua)};M&&this.replace(M)}var m=c.prototype;m.dehanceValue_=function(M){return void 0!==this.dehancer?this.dehancer(M):M};m.clear=function(){var M=this;tc(function(){Sa(function(){for(var ca=sa(M.data_.values()),ua;!(ua=ca()).done;)M["delete"](ua.value)})})};m.forEach=function(M,ca){for(var ua=sa(this),Ga;!(Ga=ua()).done;)Ga=Ga.value,M.call(ca,Ga,Ga,this)};m.add=function(M){var ca=
this;if(sb(this)&&!lb(this,{type:"add",object:this,newValue:M}))return this;if(!this.has(M)){tc(function(){ca.data_.add(ca.enhancer_(M,void 0));ca.atom_.reportChanged()});var ua=Mb(this),Ga=ua?{observableKind:"set",debugObjectName:this.name_,type:"add",object:this,newValue:M}:null;ua&&hc(this,Ga)}return this};m["delete"]=function(M){var ca=this;if(sb(this)&&!lb(this,{type:"delete",object:this,oldValue:M}))return!1;if(this.has(M)){var ua=Mb(this),Ga=ua?{observableKind:"set",debugObjectName:this.name_,
type:"delete",object:this,oldValue:M}:null;tc(function(){ca.atom_.reportChanged();ca.data_["delete"](M)});ua&&hc(this,Ga);return!0}return!1};m.has=function(M){this.atom_.reportObserved();return this.data_.has(this.dehanceValue_(M))};m.entries=function(){var M=0,ca=Array.from(this.keys()),ua=Array.from(this.values());return $a({next:function(){var Ga=M;M+=1;return Ga<ua.length?{value:[ca[Ga],ua[Ga]],done:!1}:{done:!0}}})};m.keys=function(){return this.values()};m.values=function(){this.atom_.reportObserved();
var M=this,ca=0,ua=Array.from(this.data_.values());return $a({next:function(){return ca<ua.length?{value:M.dehanceValue_(ua[ca++]),done:!1}:{done:!0}}})};m.replace=function(M){var ca=this;ro(M)&&(M=new Set(M));tc(function(){Array.isArray(M)?(ca.clear(),M.forEach(function(ua){return ca.add(ua)})):Q(M)?(ca.clear(),M.forEach(function(ua){return ca.add(ua)})):null!==M&&void 0!==M&&e("Cannot initialize set from "+M)});return this};m.observe_=function(M,ca){return Ib(this,M)};m.intercept_=function(M){return Gb(this,
M)};m.toJSON=function(){return Array.from(this)};m.toString=function(){return"[object ObservableSet]"};m[Bz]=function(){return this.values()};aa(c,[{key:"size",get:function(){this.atom_.reportObserved();return this.data_.size}},{key:Cz,get:function(){return"Set"}}]);return c}(),ro=I("ObservableSet",Av),Bv=Object.create(null),Cv=function(){function c(M,ca,ua,Ga){void 0===ca&&(ca=new Map);void 0===Ga&&(Ga=cz);this.pendingKeys_=this.appliedAnnotations_=this.isPlainObject_=this.proxy_=this.interceptors_=
this.changeListeners_=this.keysAtom_=this.defaultAnnotation_=this.values_=this.target_=void 0;this.target_=M;this.values_=ca;this.name_=ua;this.defaultAnnotation_=Ga;this.keysAtom_=new zq("ObservableObject.keys");this.isPlainObject_=O(this.target_)}var m=c.prototype;m.getObservablePropValue_=function(M){return this.values_.get(M).get()};m.setObservablePropValue_=function(M,ca){var ua=this.values_.get(M);if(ua instanceof Bq)return ua.set(ca),!0;if(sb(this)){ca=lb(this,{type:im,object:this.proxy_||
this.target_,name:M,newValue:ca});if(!ca)return null;ca=ca.newValue}ca=ua.prepareNewValue_(ca);if(ca!==$f.UNCHANGED){var Ga=Mb(this);M=Ga?{type:im,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:ua.value_,name:M,newValue:ca}:null;ua.setNewValue_(ca);Ga&&hc(this,M)}return!0};m.get_=function(M){$f.trackingDerivation&&!X(this.target_,M)&&this.has_(M);return this.target_[M]};m.set_=function(M,ca,ua){void 0===ua&&(ua=!1);if(X(this.target_,M)){if(this.values_.has(M))return this.setObservablePropValue_(M,
ca);if(ua)return Reflect.set(this.target_,M,ca);this.target_[M]=ca;return!0}return this.extend_(M,{value:ca,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,ua)};m.has_=function(M){if(!$f.trackingDerivation)return M in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var ca=this.pendingKeys_.get(M);ca||(ca=new po(M in this.target_,Na,"ObservableObject.key?",!1),this.pendingKeys_.set(M,ca));return ca.get()};m.make_=function(M,ca){!0===ca&&(ca=this.defaultAnnotation_);if(!1!==
ca){if(!(M in this.target_)){var ua;if(null!=(ua=this.target_[Kl])&&ua[M])return;e(1,ca.annotationType_,this.name_+"."+M.toString())}for(ua=this.target_;ua&&ua!==yq;){var Ga=tl(ua,M);if(Ga){Ga=ca.make_(this,M,Ga,ua);if(0===Ga)return;if(1===Ga)break}ua=Object.getPrototypeOf(ua)}var La;null==(La=this.target_[Kl])?!0:delete La[M]}};m.extend_=function(M,ca,ua,Ga){void 0===Ga&&(Ga=!1);!0===ua&&(ua=this.defaultAnnotation_);if(!1===ua)return this.defineProperty_(M,ca,Ga);if(ca=ua.extend_(this,M,ca,Ga)){var La;
null==(La=this.target_[Kl])?!0:delete La[M]}return ca};m.defineProperty_=function(M,ca,ua){void 0===ua&&(ua=!1);try{Nb();var Ga=this.delete_(M);if(!Ga)return Ga;if(sb(this)){var La=lb(this,{object:this.proxy_||this.target_,name:M,type:"add",newValue:ca.value});if(!La)return null;var fb=La.newValue;ca.value!==fb&&(ca=W({},ca,{value:fb}))}if(ua){if(!Reflect.defineProperty(this.target_,M,ca))return!1}else Tk(this.target_,M,ca);this.notifyPropertyAddition_(M,ca.value)}finally{Cb()}return!0};m.defineObservableProperty_=
function(M,ca,ua,Ga){void 0===Ga&&(Ga=!1);try{Nb();var La=this.delete_(M);if(!La)return La;if(sb(this)){var fb=lb(this,{object:this.proxy_||this.target_,name:M,type:"add",newValue:ca});if(!fb)return null;ca=fb.newValue}var vb=Ld(M),Wb={configurable:$f.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:vb.get,set:vb.set};if(Ga){if(!Reflect.defineProperty(this.target_,M,Wb))return!1}else Tk(this.target_,M,Wb);var oc=new po(ca,ua,"ObservableObject.key",!1);this.values_.set(M,oc);this.notifyPropertyAddition_(M,
oc.value_)}finally{Cb()}return!0};m.defineComputedProperty_=function(M,ca,ua){void 0===ua&&(ua=!1);try{Nb();var Ga=this.delete_(M);if(!Ga)return Ga;if(sb(this)&&!lb(this,{object:this.proxy_||this.target_,name:M,type:"add",newValue:void 0}))return null;ca.name||(ca.name="ObservableObject.key");ca.context=this.proxy_||this.target_;var La=Ld(M),fb={configurable:$f.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:La.get,set:La.set};if(ua){if(!Reflect.defineProperty(this.target_,M,fb))return!1}else Tk(this.target_,
M,fb);this.values_.set(M,new Bq(ca));this.notifyPropertyAddition_(M,void 0)}finally{Cb()}return!0};m.delete_=function(M,ca){void 0===ca&&(ca=!1);if(!X(this.target_,M))return!0;if(sb(this)&&!lb(this,{object:this.proxy_||this.target_,name:M,type:"remove"}))return null;try{var ua,Ga;Nb();var La=Mb(this),fb=this.values_.get(M),vb=void 0;if(!fb&&La){var Wb;vb=null==(Wb=tl(this.target_,M))?void 0:Wb.value}if(ca){if(!Reflect.deleteProperty(this.target_,M))return!1}else delete this.target_[M];fb&&(this.values_["delete"](M),
fb instanceof po&&(vb=fb.value_),ub(fb));this.keysAtom_.reportChanged();null==(ua=this.pendingKeys_)?void 0:null==(Ga=ua.get(M))?void 0:Ga.set(M in this.target_);if(La){var oc={type:"remove",observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:vb,name:M};La&&hc(this,oc)}}finally{Cb()}return!0};m.observe_=function(M,ca){return Ib(this,M)};m.intercept_=function(M){return Gb(this,M)};m.notifyPropertyAddition_=function(M,ca){var ua,Ga,La=Mb(this);La&&(ca=La?{type:"add",
observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:M,newValue:ca}:null,La&&hc(this,ca));null==(ua=this.pendingKeys_)?void 0:null==(Ga=ua.get(M))?void 0:Ga.set(!0);this.keysAtom_.reportChanged()};m.ownKeys_=function(){this.keysAtom_.reportObserved();return yr(this.target_)};m.keys_=function(){this.keysAtom_.reportObserved();return Object.keys(this.target_)};return c}(),Dz=I("ObservableObjectAdministration",Cv),Ez=Aa(0),at=0,Dv=function(){};(function(c,m){Object.setPrototypeOf?
Object.setPrototypeOf(c.prototype,m):void 0!==c.prototype.__proto__?c.prototype.__proto__=m:c.prototype=m})(Dv,Array.prototype);var bt=function(c,m,M){function ca(Ga,La,fb,vb){void 0===fb&&(fb="ObservableArray");void 0===vb&&(vb=!1);var Wb=c.call(this)||this;La=new $s(fb,La,vb,!0);La.proxy_=fa(Wb);L(fa(Wb),Eh,La);Ga&&Ga.length&&(La=Uc(!0),Wb.spliceWithArray(0,0,Ga),$f.allowStateChanges=La);Object.defineProperty(fa(Wb),"0",Ez);return Wb}ha(ca,c);var ua=ca.prototype;ua.concat=function(){this[Eh].atom_.reportObserved();
for(var Ga=arguments.length,La=Array(Ga),fb=0;fb<Ga;fb++)La[fb]=arguments[fb];return Array.prototype.concat.apply(this.slice(),La.map(function(vb){return Lc(vb)?vb.slice():vb}))};ua[M]=function(){var Ga=this,La=0;return $a({next:function(){return La<Ga.length?{value:Ga[La++],done:!1}:{done:!0,value:void 0}}})};aa(ca,[{key:"length",get:function(){return this[Eh].getArrayLength_()},set:function(Ga){this[Eh].setArrayLength_(Ga)}},{key:m,get:function(){return"Array"}}]);return ca}(Dv,Symbol.toStringTag,
Symbol.iterator);Object.entries(Er).forEach(function(c){var m=c[0];c=c[1];"concat"!==m&&t(bt.prototype,m,c)});qa(1E3);var Ev=yq.toString;["Symbol","Map","Set"].forEach(function(c){"undefined"===typeof H()[c]&&e("MobX requires global '"+c+"' to be available or polyfilled")});"object"===typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:cc,extras:{getDebugName:Ka},$mobx:Eh});var Fz=ea(581),Oj=class{constructor(c){wb(this,"props");wb(this,"aspectRatio");wb(this,"type");
wb(this,"hideCloneHandles",!1);wb(this,"hideResizeHandles",!1);wb(this,"hideRotateHandle",!1);wb(this,"hideContextBar",!1);wb(this,"hideSelectionDetail",!1);wb(this,"hideSelection",!1);wb(this,"canChangeAspectRatio",!0);wb(this,"canUnmount",!0);wb(this,"canResize",[!0,!0]);wb(this,"canScale",!0);wb(this,"canFlip",!0);wb(this,"canEdit",!1);wb(this,"canBind",!1);wb(this,"nonce");wb(this,"bindingDistance",4);wb(this,"isDirty",!1);wb(this,"lastSerialized");wb(this,"getCenter",()=>Me.getBoundsCenter(this.bounds));
wb(this,"getRotatedBounds",()=>{const {bounds:Ga,props:{rotation:La}}=this;return La?Me.getBoundsFromPoints(Me.getRotatedCorners(Ga,La)):Ga});wb(this,"hitTestPoint",Ga=>{var La=this.rotatedBounds;if(!this.props.rotation)return vh.pointInBounds(Ga,La);La=Me.getRotatedCorners(La,this.props.rotation);return vh.pointInPolygon(Ga,La)});wb(this,"hitTestLineSegment",(Ga,La)=>{const fb=Me.getBoundsFromPoints([Ga,La]),{rotatedBounds:vb,props:{rotation:Wb=0}}=this;return Me.boundsContain(vb,fb)||Wb?l(Ga,La,
Me.getRotatedCorners(this.bounds)).didIntersect:0<g(vb,Ga,La).length});wb(this,"hitTestBounds",Ga=>{const {rotatedBounds:La,props:{rotation:fb=0}}=this,vb=Me.getRotatedCorners(this.bounds,fb);return Me.boundsContain(Ga,La)||0<x([Ga.minX,Ga.minY],[Ga.width,Ga.height],vb).length});wb(this,"getExpandedBounds",()=>Me.expandBounds(this.getBounds(),this.bindingDistance));wb(this,"getBindingPoint",(Ga,La,fb,vb)=>{var Wb=this.getBounds(),oc=this.getExpandedBounds();if(vh.pointInBounds(Ga,oc)){var uc=G(La,
fb,oc).filter(Sc=>Sc.didIntersect).map(Sc=>Sc.points[0]);if(uc.length)return fb=this.getCenter(),uc=uc.sort((Sc,kd)=>ne.dist(kd,La)-ne.dist(Sc,La))[0],uc=ne.med(Ga,uc),vb?(vb=2>ne.dist(Ga,fb)?fb:Ga,Wb=0):(vb=2>ne.distanceToLineSegment(Ga,uc,fb)?fb:uc,Wb=vh.pointInBounds(Ga,Wb)?this.bindingDistance:Math.max(this.bindingDistance,Me.getBoundsSides(Wb).map(Sc=>ne.distanceToLineSegment(Sc[1][0],Sc[1][1],Ga)).sort((Sc,kd)=>Sc-kd)[0])),oc=ne.divV(ne.sub(vb,[oc.minX,oc.minY]),[oc.width,oc.height]),{point:ne.clampV(oc,
0,1),distance:Wb}}});wb(this,"getSerialized",()=>Ab(ng(Gf({},this.props),{type:this.type,nonce:this.nonce})));wb(this,"getCachedSerialized",()=>{!this.isDirty&&this.lastSerialized||tc(()=>{this.setIsDirty(!1);this.setLastSerialized(this.getSerialized())});if(this.lastSerialized)return this.lastSerialized;throw Error("Should not get here for getCachedSerialized");});wb(this,"validateProps",Ga=>Ga);wb(this,"update",(Ga,La=!1,fb=!1)=>{La||this.isDirty||this.setIsDirty(!0);La||fb||this.incNonce();Object.assign(this.props,
this.validateProps(Ga));return this});wb(this,"clone",()=>new this.constructor(this.serialized));wb(this,"onResetBounds",Ga=>this);wb(this,"scale",[1,1]);wb(this,"onResizeStart",Ga=>{var La;this.scale=[...(null!=(La=this.props.scale)?La:[1,1])];return this});wb(this,"onResize",(Ga,La)=>{const {bounds:fb,rotation:vb,scale:[Wb,oc]}=La;Ga=[...this.scale];0>Wb&&(Ga[0]*=-1);0>oc&&(Ga[1]*=-1);this.update({point:[fb.minX,fb.minY],scale:Ga,rotation:vb});return this});wb(this,"onHandleChange",(Ga,{id:La,delta:fb})=>
{if(void 0!==Ga.handles){var vb=to(Ga.handles);vb[La]=ng(Gf({},vb[La]),{point:ne.add(fb,Ga.handles[La].point)});var Wb=Me.getCommonTopLeft(Object.values(vb).map(oc=>oc.point));Object.values(vb).forEach(oc=>{oc.point=ne.sub(oc.point,Wb)});this.update({point:ne.add(Ga.point,Wb),handles:vb})}});var m,M;const ca=this.constructor.id,ua=null!=(m=this.constructor.defaultProps)?m:{};this.type=ca;this.props=Gf(Gf({scale:[1,1]},ua),c);this.nonce=null!=(M=c.nonce)?M:Date.now();Cc(this)}get id(){return this.props.id}setNonce(c){this.nonce=
c}incNonce(){this.nonce++}setIsDirty(c){this.isDirty=c}setLastSerialized(c){this.lastSerialized=c}get center(){return this.getCenter()}get bounds(){return this.getBounds()}get rotatedBounds(){return this.getRotatedBounds()}get serialized(){return this.getCachedSerialized()}getShapeSVGJsx(c){c=this.getBounds();const {stroke:m,strokeWidth:M,strokeType:ca,opacity:ua,fill:Ga,noFill:La,borderRadius:fb}=this.props;return(0,Fz.jsx)("rect",{fill:La?"none":Df(Ga,"background"),stroke:Df(m,"stroke"),strokeWidth:null!=
M?M:2,strokeDasharray:"dashed"===ca?"8 2":void 0,fillOpacity:null!=ua?ua:.2,width:c.width,height:c.height,rx:fb,ry:fb})}};wb(Oj,"type");pe([Rg],Oj.prototype,"props",2);pe([Rg],Oj.prototype,"canResize",2);pe([Rg],Oj.prototype,"nonce",2);pe([Rg],Oj.prototype,"isDirty",2);pe([Rg],Oj.prototype,"lastSerialized",2);pe([$g],Oj.prototype,"id",1);pe([Ag],Oj.prototype,"setNonce",1);pe([Ag],Oj.prototype,"incNonce",1);pe([Ag],Oj.prototype,"setIsDirty",1);pe([Ag],Oj.prototype,"setLastSerialized",1);pe([$g],Oj.prototype,
"center",1);pe([$g],Oj.prototype,"bounds",1);pe([$g],Oj.prototype,"rotatedBounds",1);pe([$g],Oj.prototype,"serialized",1);pe([Ag],Oj.prototype,"update",2);var ok=class extends Oj{constructor(c={}){super(c);wb(this,"canBind",!0);wb(this,"getBounds",()=>{const [m,M]=this.props.point,[ca,ua]=this.props.size;return{minX:m,minY:M,maxX:m+ca,maxY:M+ua,width:ca,height:ua}});wb(this,"getRotatedBounds",()=>Me.getBoundsFromPoints(Me.getRotatedCorners(this.bounds,this.props.rotation)));wb(this,"onResize",(m,
M)=>{const {bounds:ca,rotation:ua,scale:[Ga,La]}=M;m=[...this.scale];0>Ga&&(m[0]*=-1);0>La&&(m[1]*=-1);this.update({point:[ca.minX,ca.minY],scale:m,rotation:ua});return this.update({rotation:ua,point:[ca.minX,ca.minY],size:[Math.max(1,ca.width),Math.max(1,ca.height)],scale:m})});wb(this,"validateProps",m=>{void 0!==m.size&&(m.size[0]=Math.max(m.size[0],1),m.size[1]=Math.max(m.size[1],1));return m});Cc(this)}};wb(ok,"id","box");wb(ok,"defaultProps",{id:"box",type:"box",parentId:"page",point:[0,0],
size:[100,100]});var lp=class extends Oj{constructor(c={}){super(c);wb(this,"getBounds",()=>{const {pointBounds:m,props:{point:M}}=this;return Me.translateBounds(m,M)});wb(this,"getRotatedBounds",()=>{const {props:{rotation:m,point:M},bounds:ca,rotatedPoints:ua}=this;return m?Me.translateBounds(Me.getBoundsFromPoints(ua),M):ca});wb(this,"normalizedPoints",[]);wb(this,"isResizeFlippedX",!1);wb(this,"isResizeFlippedY",!1);wb(this,"onResizeStart",()=>{var m;const {bounds:M,props:{points:ca}}=this;this.scale=
[...(null!=(m=this.props.scale)?m:[1,1])];const ua=[M.width,M.height];this.normalizedPoints=ca.map(Ga=>yd.divV(Ga,ua));return this});wb(this,"onResize",(m,M)=>{const {bounds:ca,scale:[ua,Ga]}=M,La=[ca.width,ca.height];m=[...this.scale];0>ua&&(m[0]*=-1);0>Ga&&(m[1]*=-1);return this.update(ua||Ga?{point:[ca.minX,ca.minY],points:this.normalizedPoints.map(fb=>yd.mulV(fb,La).concat(fb[2])),scale:m}:{point:[ca.minX,ca.minY],points:this.normalizedPoints.map(fb=>yd.mulV(fb,La).concat(fb[2]))})});wb(this,
"hitTestPoint",m=>{const {props:{points:M,point:ca}}=this;return vh.pointNearToPolyline(yd.sub(m,ca),M)});wb(this,"hitTestLineSegment",(m,M)=>{const {bounds:ca,props:{points:ua,point:Ga}}=this;if(vh.pointInBounds(m,ca)||vh.pointInBounds(M,ca)||0<g(ca,m,M).length){const La=yd.sub(m,Ga),fb=yd.sub(M,Ga);return l(La,fb,ua).didIntersect||!!ua.find(vb=>5>yd.dist(La,vb)||5>yd.dist(fb,vb))}return!1});wb(this,"hitTestBounds",m=>{const {rotatedBounds:M,props:{points:ca,point:ua}}=this,Ga=Me.translateBounds(m,
yd.neg(ua));return Me.boundsContain(m,M)||ca.every(La=>vh.pointInBounds(La,Ga))||Me.boundsCollide(m,M)&&0<C([Ga.minX,Ga.minY],[Ga.width,Ga.height],ca).length});Cc(this)}get pointBounds(){const {props:{points:c}}=this;return Me.getBoundsFromPoints(c)}get rotatedPoints(){const {props:{point:c,points:m,rotation:M},center:ca}=this;if(!M)return m;const ua=yd.sub(ca,c);return m.map(Ga=>yd.rotWith(Ga,ua,M))}};wb(lp,"id","draw");wb(lp,"defaultProps",{id:"draw",type:"draw",parentId:"page",point:[0,0],points:[],
isComplete:!1});pe([$g],lp.prototype,"pointBounds",1);pe([$g],lp.prototype,"rotatedPoints",1);var ct=class extends ok{constructor(c={}){super(c);wb(this,"getBounds",()=>{const {props:{point:[m,M],size:[ca,ua]}}=this;return Me.getRotatedEllipseBounds(m,M,ca/2,ua/2,0)});wb(this,"getRotatedBounds",()=>{const {props:{point:[m,M],size:[ca,ua],rotation:Ga}}=this;return Me.getRotatedEllipseBounds(m,M,ca/2,ua/2,Ga)});wb(this,"hitTestPoint",m=>{const {props:{size:M,rotation:ca},center:ua}=this;return vh.pointInEllipse(m,
ua,M[0],M[1],ca||0)});wb(this,"hitTestLineSegment",(m,M)=>{const {props:{size:[ca,ua],rotation:Ga=0},center:La}=this;return k(m,M,La,ca,ua,Ga).didIntersect});wb(this,"hitTestBounds",m=>{const {props:{size:[M,ca],rotation:ua=0},rotatedBounds:Ga}=this;var La;if(!(La=Me.boundsContain(m,Ga))){const {minX:fb,minY:vb,width:Wb,height:oc}=m;La=0<u(this.center,M/2,ca/2,ua,[fb,vb],[Wb,oc]).length}return La});Cc(this)}};wb(ct,"id","ellipse");wb(ct,"defaultProps",{id:"ellipse",type:"ellipse",parentId:"page",
point:[0,0],size:[100,100]});var dt=class extends ok{constructor(c={}){super(c);wb(this,"onResetBounds",m=>{const {clipping:M,size:ca,point:ua}=this.props;if(M){const [Ga,La,fb,vb]=Array.isArray(M)?M:[M,M,M,M];return this.update({clipping:0,point:[ua[0]-vb,ua[1]-Ga],size:[ca[0]+(vb-La),ca[1]+(Ga-fb)]})}if(m.asset){const {size:[Ga,La]}=m.asset;this.update({clipping:0,point:[ua[0]+ca[0]/2-Ga/2,ua[1]+ca[1]/2-La/2],size:[Ga,La]})}return this});wb(this,"onResize",(m,M)=>{const {bounds:ca,clip:ua,scale:Ga}=
M;({clipping:M}=this.props);const {clipping:La}=m;if(ua){const {point:[fb,vb],size:[Wb,oc]}=m,[uc,Sc,kd,fd]=La?Array.isArray(La)?La:[La,La,La,La]:[0,0,0,0];M=[uc+(ca.minY-vb),Sc+(ca.maxX-(fb+Wb)),kd+(ca.maxY-(vb+oc)),fd+(ca.minX-fb)]}else void 0!==La&&(M=Array.isArray(La)?La:[La,La,La,La],M=[M[0]*Ga[1],M[1]*Ga[0],M[2]*Ga[1],M[3]*Ga[0]]);if(M&&Array.isArray(M)){const fb=M;fb.every((vb,Wb)=>0===Wb||vb===fb[Wb-1])&&(M=fb[0])}return this.update({point:[ca.minX,ca.minY],size:[Math.max(1,ca.width),Math.max(1,
ca.height)],clipping:M})});Cc(this)}};wb(dt,"id","ellipse");wb(dt,"defaultProps",{id:"ellipse",type:"ellipse",parentId:"page",point:[0,0],size:[100,100],clipping:0,objectFit:"none",assetId:""});var Fv=class extends Oj{constructor(c={}){super(c);wb(this,"getBounds",()=>{const {points:m,props:{point:M}}=this;return Me.translateBounds(Me.getBoundsFromPoints(m),M)});wb(this,"getRotatedBounds",()=>{const {rotatedPoints:m,props:{point:M}}=this;return Me.translateBounds(Me.getBoundsFromPoints(m),M)});wb(this,
"normalizedHandles",[]);wb(this,"onResizeStart",()=>{var m;const {props:{handles:M},bounds:ca}=this;this.scale=[...(null!=(m=this.props.scale)?m:[1,1])];const ua=[ca.width,ca.height];this.normalizedHandles=Object.values(M).map(Ga=>yd.divV(Ga.point,ua));return this});wb(this,"onResize",(m,M)=>{const {bounds:ca,scale:[ua,Ga]}=M,{props:{handles:La},normalizedHandles:fb}=this,vb=[ca.width,ca.height];m=[...this.scale];0>ua&&(m[0]*=-1);0>Ga&&(m[1]*=-1);return this.update({point:[ca.minX,ca.minY],handles:Object.values(La).map((Wb,
oc)=>ng(Gf({},Wb),{point:yd.mulV(fb[oc],vb)})),scale:m})});wb(this,"hitTestPoint",m=>{const {points:M}=this;return vh.pointNearToPolyline(yd.sub(m,this.props.point),M)});wb(this,"hitTestLineSegment",(m,M)=>{const {bounds:ca,points:ua,props:{point:Ga}}=this;if(vh.pointInBounds(m,ca)||vh.pointInBounds(M,ca)||0<g(ca,m,M).length){const La=yd.sub(m,Ga),fb=yd.sub(M,Ga);return l(La,fb,ua).didIntersect||!!ua.find(vb=>5>yd.dist(La,vb)||5>yd.dist(fb,vb))}return!1});wb(this,"hitTestBounds",m=>{const {rotatedBounds:M,
points:ca,props:{point:ua}}=this,Ga=Me.translateBounds(m,yd.neg(ua));return Me.boundsContain(m,M)||ca.every(La=>vh.pointInBounds(La,Ga))||Me.boundsCollide(m,M)&&0<C([Ga.minX,Ga.minY],[Ga.width,Ga.height],ca).length});wb(this,"validateProps",m=>{m.point&&(m.point=[0,0]);void 0!==m.handles&&1>Object.values(m.handles).length&&(m.handles=Fv.defaultProps.handles);return m});Cc(this)}get points(){return Object.values(this.props.handles).map(c=>c.point)}get centroid(){const {points:c}=this;return ki.getPolygonCentroid(c)}get rotatedPoints(){const {centroid:c,
props:{handles:m,rotation:M}}=this;return M?Object.values(m).map(ca=>yd.rotWith(ca.point,c,M)):this.points}},mp=Fv;wb(mp,"id","polyline");wb(mp,"defaultProps",{id:"polyline",type:"polyline",parentId:"page",point:[0,0],handles:{}});pe([$g],mp.prototype,"points",1);pe([$g],mp.prototype,"centroid",1);pe([$g],mp.prototype,"rotatedPoints",1);var Gv=class extends mp{constructor(c={}){super(c);wb(this,"hideResizeHandles",!0);wb(this,"hideRotateHandle",!0);wb(this,"validateProps",m=>{m.point&&(m.point=[0,
0]);void 0!==m.handles&&1>Object.values(m.handles).length&&(m.handles=Gv.defaultProps.handles);return m});wb(this,"getHandlesChange",(m,M)=>{var ca=vi(m.handles,M);ca=vi(ca,{start:{point:ne.toFixed(ca.start.point)},end:{point:ne.toFixed(ca.end.point)}});if(!ne.isEqual(ca.start.point,ca.end.point)){M={point:m.point,handles:to(ca)};m=m.point;ca=Me.translateBounds(Me.getBoundsFromPoints(Object.values(ca).map(Ga=>Ga.point)),M.point);var ua=ne.sub([ca.minX,ca.minY],m);ne.isEqual(ua,[0,0])||(Object.values(M.handles).forEach(Ga=>
{Ga.point=ne.toFixed(ne.sub(Ga.point,ua))}),M.point=ne.toFixed(ne.add(M.point,ua)));return M}});Cc(this)}},Fq=Gv;wb(Fq,"id","line");wb(Fq,"defaultProps",{id:"line",type:"line",parentId:"page",point:[0,0],handles:{start:{id:"start",canBind:!0,point:[0,0]},end:{id:"end",canBind:!0,point:[1,1]}}});var ln=class extends ok{constructor(c={}){super(c);wb(this,"getRotatedBounds",()=>{const {rotatedVertices:m,props:{point:M},offset:ca}=this;return Me.translateBounds(Me.getBoundsFromPoints(m),yd.add(M,ca))});
wb(this,"hitTestPoint",m=>{const {vertices:M}=this;return vh.pointInPolygon(yd.add(m,this.props.point),M)});wb(this,"hitTestLineSegment",(m,M)=>{const {vertices:ca,props:{point:ua}}=this;return l(yd.sub(m,ua),yd.sub(M,ua),ca).didIntersect});wb(this,"hitTestBounds",m=>{const {rotatedBounds:M,offset:ca,rotatedVertices:ua,props:{point:Ga}}=this,La=Me.translateBounds(m,yd.neg(yd.add(Ga,ca)));return Me.boundsContain(m,M)||ua.every(fb=>vh.pointInBounds(fb,La))||0<x([La.minX,La.minY],[La.width,La.height],
ua).length});wb(this,"validateProps",m=>{m.point&&(m.point=[0,0]);void 0!==m.sides&&3>m.sides&&(m.sides=3);return m});Cc(this)}get vertices(){return this.getVertices()}get pageVertices(){const {props:{point:c},vertices:m}=this;return m.map(M=>yd.add(M,c))}get centroid(){const {vertices:c}=this;return ki.getPolygonCentroid(c)}get rotatedVertices(){const {vertices:c,centroid:m,props:{rotation:M}}=this;return M?c.map(ca=>yd.rotWith(ca,m,M)):c}get offset(){const {props:{size:[c,m]}}=this,M=Me.getBoundsCenter(Me.getBoundsFromPoints(this.vertices));
return yd.sub(yd.div([c,m],2),M)}getVertices(c=0){const {ratio:m,sides:M,size:ca}=this.props;return 3===M?ki.getTriangleVertices(ca,c,m):ki.getPolygonVertices(ca,M,c,m)}};wb(ln,"id","polygon");wb(ln,"defaultProps",{id:"polygon",type:"polygon",parentId:"page",point:[0,0],size:[100,100],sides:5,ratio:1,isFlippedY:!1});pe([$g],ln.prototype,"vertices",1);pe([$g],ln.prototype,"pageVertices",1);pe([$g],ln.prototype,"centroid",1);pe([$g],ln.prototype,"rotatedVertices",1);pe([$g],ln.prototype,"offset",1);
var et=class extends ok{constructor(c={}){super(c);wb(this,"canEdit",!0);wb(this,"canFlip",!1);Cc(this)}};wb(et,"id","text");wb(et,"defaultProps",{id:"text",type:"text",parentId:"page",isSizeLocked:!0,point:[0,0],size:[16,32],text:""});var Fr=class extends ok{constructor(c={}){super(c);wb(this,"canEdit",!1);wb(this,"canFlip",!1);wb(this,"getBounds",()=>0===this.shapes.length?(Ve().deleteShapes([this.id]),{minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}):Me.getCommonBounds(this.shapes.map(m=>m.getBounds())));
Cc(this);this.canResize=[!1,!1]}getShapes(){throw Error("will be implemented other places");}get shapes(){return this.getShapes()}};wb(Fr,"id","group");wb(Fr,"defaultProps",{id:"group",type:"group",parentId:"page",point:[0,0],size:[0,0],children:[]});pe([$g],Fr.prototype,"shapes",1);var np=class{constructor(){wb(this,"_id");wb(this,"_initial");wb(this,"_states");wb(this,"_isActive",!1);wb(this,"cursor");wb(this,"_disposables",[]);wb(this,"children",new Map([]));wb(this,"registerStates",M=>{M.forEach(ca=>
this.children.set(ca.id,new ca(this,this)));return this});wb(this,"deregisterStates",M=>{M.forEach(ca=>{var ua;null==(ua=this.children.get(ca.id))?void 0:ua.dispose();this.children.delete(ca.id)});return this});wb(this,"currentState",{});wb(this,"transition",(M,ca={})=>{if(0===this.children.size)throw Error(`Tool ${this.id} has no states, cannot transition to ${M}.`);const ua=this.children.get(M),Ga=this.currentState;if(!ua)throw Error(`Could not find a state named ${M}.`);tc(()=>{this.currentState?
(Ga._events.onExit(ng(Gf({},ca),{toId:M})),Ga.dispose(),this.setCurrentState(ua),this._events.onTransition(ng(Gf({},ca),{fromId:Ga.id,toId:M})),ua._events.onEnter(ng(Gf({},ca),{fromId:Ga.id}))):(this.currentState=ua,ua._events.onEnter(ng(Gf({},ca),{fromId:""})))});return this});wb(this,"isIn",M=>{M=M.split(".").reverse();let ca=this;for(;0<M.length;){const ua=M.pop();if(!ua)return!0;if(ca.currentState.id===ua){if(0===M.length)return!0;ca=ca.currentState}else break}return!1});wb(this,"isInAny",(...M)=>
M.some(this.isIn));wb(this,"forwardEvent",(M,...ca)=>{var ua,Ga;(null==(Ga=null==(ua=this.currentState)?void 0:ua._events)?0:Ga[M])&&tc(()=>{var La;return null==(La=this.currentState._events)?void 0:La[M](...ca)})});wb(this,"_events",{onTransition:M=>{var ca;null==(ca=this.onTransition)?void 0:ca.call(this,M)},onEnter:M=>{var ca;this._isActive=!0;this.initial&&this.transition(this.initial,M);null==(ca=this.onEnter)?void 0:ca.call(this,M)},onExit:M=>{var ca,ua,Ga;this._isActive=!1;null==(ua=null==
(ca=this.currentState)?void 0:ca.onExit)?void 0:ua.call(ca,{toId:"parent"});null==(Ga=this.onExit)?void 0:Ga.call(this,M)},onPointerDown:(M,ca)=>{var ua;null==(ua=this.onPointerDown)?void 0:ua.call(this,M,ca);this.forwardEvent("onPointerDown",M,ca)},onPointerUp:(M,ca)=>{var ua;null==(ua=this.onPointerUp)?void 0:ua.call(this,M,ca);this.forwardEvent("onPointerUp",M,ca)},onPointerMove:(M,ca)=>{var ua;null==(ua=this.onPointerMove)?void 0:ua.call(this,M,ca);this.forwardEvent("onPointerMove",M,ca)},onPointerEnter:(M,
ca)=>{var ua;null==(ua=this.onPointerEnter)?void 0:ua.call(this,M,ca);this.forwardEvent("onPointerEnter",M,ca)},onPointerLeave:(M,ca)=>{var ua;null==(ua=this.onPointerLeave)?void 0:ua.call(this,M,ca);this.forwardEvent("onPointerLeave",M,ca)},onDoubleClick:(M,ca)=>{var ua;null==(ua=this.onDoubleClick)?void 0:ua.call(this,M,ca);this.forwardEvent("onDoubleClick",M,ca)},onKeyDown:(M,ca)=>{var ua;this._events.onModifierKey(M,ca);null==(ua=this.onKeyDown)?void 0:ua.call(this,M,ca);this.forwardEvent("onKeyDown",
M,ca)},onKeyUp:(M,ca)=>{var ua;this._events.onModifierKey(M,ca);null==(ua=this.onKeyUp)?void 0:ua.call(this,M,ca);this.forwardEvent("onKeyUp",M,ca)},onPinchStart:(M,ca)=>{var ua;null==(ua=this.onPinchStart)?void 0:ua.call(this,M,ca);this.forwardEvent("onPinchStart",M,ca)},onPinch:(M,ca)=>{var ua;null==(ua=this.onPinch)?void 0:ua.call(this,M,ca);this.forwardEvent("onPinch",M,ca)},onPinchEnd:(M,ca)=>{var ua;null==(ua=this.onPinchEnd)?void 0:ua.call(this,M,ca);this.forwardEvent("onPinchEnd",M,ca)},onModifierKey:(M,
ca)=>{switch(ca.key){case "Shift":case "Alt":case "Ctrl":case "Meta":this._events.onPointerMove(M,ca)}}});wb(this,"onEnter");wb(this,"onExit");wb(this,"onTransition");wb(this,"onPointerDown");wb(this,"onPointerUp");wb(this,"onPointerMove");wb(this,"onPointerEnter");wb(this,"onPointerLeave");wb(this,"onDoubleClick");wb(this,"onKeyDown");wb(this,"onKeyUp");wb(this,"onPinchStart");wb(this,"onPinch");wb(this,"onPinchEnd");const c=this.constructor.initial,m=this.constructor.states;this._id=this.constructor.id;
this._initial=c;this._states=m}dispose(){this._disposables.forEach(c=>c());this._disposables=[];return this}get initial(){return this._initial}get states(){return this._states}get id(){return this._id}get isActive(){return this._isActive}get ascendants(){return[this]}get descendants(){return Array.from(this.children.values()).flatMap(c=>[c,...c.descendants])}setCurrentState(c){this.currentState=c}};wb(np,"id");wb(np,"shortcuts");pe([Rg],np.prototype,"currentState",2);pe([Ag],np.prototype,"setCurrentState",
1);var ft=class extends np{constructor(c,m){var M,ca;super();wb(this,"_root");wb(this,"_parent");wb(this,"children",new Map([]));wb(this,"registerStates",ua=>{ua.forEach(Ga=>this.children.set(Ga.id,new Ga(this,this._root)));return this});wb(this,"deregisterStates",ua=>{ua.forEach(Ga=>{var La;null==(La=this.children.get(Ga.id))?void 0:La.dispose();this.children.delete(Ga.id)});return this});this._parent=c;this._root=m;this.states&&0<this.states.length&&(this.registerStates(this.states),c=null!=(M=
this.initial)?M:this.states[0].id,M=this.children.get(c))&&(this.setCurrentState(M),null==(ca=this.currentState)?void 0:ca._events.onEnter({fromId:"initial"}));Cc(this)}get root(){return this._root}get parent(){return this._parent}get ascendants(){return this.parent?"ascendants"in this.parent?[...this.parent.ascendants,this]:[this.parent,this]:[this]}};wb(ft,"cursor");var mn=class extends ft{constructor(){super(...arguments);wb(this,"isLocked",!1);wb(this,"previous");wb(this,"onEnter",({fromId:c})=>
{this.previous=c;this.cursor&&this.app.cursors.setCursor(this.cursor)});wb(this,"onTransition",c=>{({toId:c}=c);c=this.children.get(c);this.app.cursors.reset();c.cursor?this.app.cursors.setCursor(c.cursor):this.cursor&&this.app.cursors.setCursor(this.cursor)})}get app(){return this.root}},ei=class extends ft{get app(){return this.root}get tool(){return this.parent}},Hv=class extends ei{constructor(){super(...arguments);wb(this,"cursor","crosshair");wb(this,"creatingShape");wb(this,"aspectRatio");
wb(this,"initialBounds",{});wb(this,"onEnter",()=>{const {currentPage:c,inputs:{originPoint:m,currentPoint:M}}=this.app;var {Shape:ca}=this.tool;ca=new ca({id:Re(),type:ca.id,parentId:c.id,point:[...m],fill:this.app.settings.color,stroke:this.app.settings.color,size:ne.abs(ne.sub(M,m))});this.initialBounds={minX:m[0],minY:m[1],maxX:m[0]+1,maxY:m[1]+1,width:1,height:1};ca.canChangeAspectRatio||(ca.aspectRatio?(this.aspectRatio=ca.aspectRatio,this.initialBounds.height=this.aspectRatio):(this.aspectRatio=
1,this.initialBounds.height=1),this.initialBounds.width=1,this.initialBounds.maxY=this.initialBounds.minY+this.initialBounds.height);this.creatingShape=ca;this.creatingShape.setScaleLevel(this.app.settings.scaleLevel);this.app.currentPage.addShapes(ca);this.app.setSelectedShapes([ca])});wb(this,"onPointerMove",c=>{if(!c.order){if(!this.creatingShape)throw Error("Expected a creating shape.");var {initialBounds:m}=this,{currentPoint:M,originPoint:ca,shiftKey:ua}=this.app.inputs;c=ua||this.creatingShape.props.isAspectRatioLocked||
!this.creatingShape.canChangeAspectRatio;m=Me.getTransformedBoundingBox(m,"bottom_right_corner",ne.sub(M,ca),0,c);this.app.settings.snapToGrid&&!c&&(m=Me.snapBoundsToGrid(m,8));this.creatingShape.update({point:[m.minX,m.minY],size:[m.width,m.height]})}});wb(this,"onPointerUp",()=>{this.tool.transition("idle");this.creatingShape?(this.app.setSelectedShapes([this.creatingShape]),this.app.api.editShape(this.creatingShape)):this.app.transition("select");this.app.persist()});wb(this,"onKeyDown",(c,m)=>
{switch(m.key){case "Escape":if(!this.creatingShape)throw Error("Expected a creating shape.");this.app.deleteShapes([this.creatingShape]);this.tool.transition("idle")}})}};wb(Hv,"id","creating");var Iv=class extends ei{constructor(){super(...arguments);wb(this,"onPointerDown",(c,m)=>{c.order||this.tool.transition("pointing")});wb(this,"onPinchStart",(...c)=>{var m,M;this.app.transition("select",{returnTo:this.app.currentState.id});null==(M=(m=this.app._events).onPinchStart)?void 0:M.call(m,...c)});
wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.transition("select")}})}};wb(Iv,"id","idle");var Jv=class extends ei{constructor(){super(...arguments);wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&!this.app.readOnly&&(this.tool.transition("creating"),this.app.setSelectedShapes(this.app.currentPage.shapes))});wb(this,"onPointerUp",()=>{this.tool.transition("idle")})}};wb(Jv,"id","pointing");var Em=class extends mn{constructor(){super(...arguments);
wb(this,"cursor","crosshair")}};wb(Em,"id","box");wb(Em,"states",[Iv,Jv,Hv]);wb(Em,"initial","idle");var Kv=class extends ei{constructor(){super(...arguments);wb(this,"shape",{});wb(this,"points",[[0,0,.5]]);wb(this,"persistDebounced",og(this.app.persist,200));wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})});wb(this,"onEnter",()=>{var c;const {Shape:m,previousShape:M}=this.tool;var {originPoint:ca}=this.app.inputs;this.app.history.pause();if(this.app.inputs.shiftKey&&
M){this.shape=M;var {shape:ua}=this;var Ga=ua.props.points[ua.props.points.length-1];const fb=yd.sub(ca,ua.props.point).concat(null!=(c=ca[2])?c:.5);this.points=[...ua.props.points,Ga,Ga];const vb=Math.ceil(yd.dist(Ga,ca)/16);for(let Wb=0,oc=Wb/(vb-1);Wb<vb;Wb++){c=this.points;ca=c.push;ua=yd.lrp(Ga,fb,oc);var La=Ga[2];ca.call(c,ua.concat.call(ua,La+(fb[2]-La)*oc))}this.addNextPoint(fb)}else this.tool.previousShape=void 0,this.points=[[0,0,null!=(Ga=ca[2])?Ga:.5]],this.shape=new m({id:Re(),type:m.id,
parentId:this.app.currentPage.id,point:ca.slice(0,2),points:this.points,isComplete:!1,fill:this.app.settings.color,stroke:this.app.settings.color}),this.shape.setScaleLevel(this.app.settings.scaleLevel),this.app.currentPage.addShapes(this.shape)});wb(this,"onPointerMove",()=>{const {shape:c}=this,{currentPoint:m,previousPoint:M}=this.app.inputs;yd.isEqual(M,m)||this.addNextPoint(yd.sub(m,c.props.point).concat(m[2]))});wb(this,"onPointerUp",()=>{if(!this.shape)throw Error("Expected a creating shape.");
this.app.history.resume();this.shape.update({isComplete:!0,points:this.tool.simplify?vh.simplify2(this.points,this.tool.simplifyTolerance):this.shape.props.points});this.tool.previousShape=this.shape;this.tool.transition("idle");let c=this.app.selectedTool.id;"pencil"===c||"highlighter"===c?this.persistDebounced():this.app.persist()});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":if(!this.shape)throw Error("Expected a creating shape.");this.app.deleteShapes([this.shape]);this.tool.transition("idle")}})}addNextPoint(c){const {shape:m}=
this,M=yd.min(c,[0,0]);this.points.push(c);0>M[0]||0>M[1]?(this.points=this.points.map(ca=>yd.sub(ca,M).concat(ca[2])),m.update({point:yd.add(m.props.point,M),points:this.points})):m.update({points:this.points})}};wb(Kv,"id","creating");var Lv=class extends ei{constructor(){super(...arguments);wb(this,"onPointerDown",(c,m)=>{c.order||this.app.readOnly||this.tool.transition("creating")});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.transition("select")}})}};
wb(Lv,"id","idle");var Mv=class extends ei{constructor(){super(...arguments);wb(this,"origin",[0,0]);wb(this,"prevDelta",[0,0]);wb(this,"onEnter",c=>{this.prevDelta=c.info.delta;this.origin=c.info.point});wb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});wb(this,"onPinchEnd",()=>{this.tool.transition("idle")})}};wb(Mv,"id","pinching");var Gq=class extends mn{constructor(){super(...arguments);wb(this,"cursor","crosshair");wb(this,"simplify",!0);wb(this,"simplifyTolerance",
1);wb(this,"previousShape");wb(this,"onPinchStart",(c,m)=>{this.transition("pinching",{info:c,event:m})})}};wb(Gq,"id","draw");wb(Gq,"states",[Lv,Kv,Mv]);wb(Gq,"initial","idle");var Nv=class extends ei{constructor(){super(...arguments);wb(this,"points",[[0,0,.5]]);wb(this,"hitShapes",new Set);wb(this,"onEnter",()=>{const {originPoint:c}=this.app.inputs;this.points=[c];this.hitShapes.clear()});wb(this,"onPointerMove",()=>{const {currentPoint:c,previousPoint:m}=this.app.inputs;yd.isEqual(m,c)||(this.points.push(c),
this.app.shapesInViewport.filter(M=>M.hitTestLineSegment(m,c)).forEach(M=>this.hitShapes.add(M)),this.app.setErasingShapes(Array.from(this.hitShapes.values())))});wb(this,"onPointerUp",()=>{this.app.deleteShapes(Array.from(this.hitShapes.values()));this.tool.transition("idle")});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.setErasingShapes([]),this.tool.transition("idle")}})}};wb(Nv,"id","erasing");var Ov=class extends ei{constructor(){super(...arguments);wb(this,"onPointerDown",
(c,m)=>{c.order||this.tool.transition("pointing")});wb(this,"onPinchStart",(...c)=>{var m,M;this.app.transition("select",{returnTo:this.app.currentState.id});null==(M=(m=this.app._events).onPinchStart)?void 0:M.call(m,...c)});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.transition("select")}})}};wb(Ov,"id","idle");var Pv=class extends ei{constructor(){super(...arguments);wb(this,"onEnter",()=>{const {currentPoint:c}=this.app.inputs;this.app.setErasingShapes(this.app.shapesInViewport.filter(m=>
m.hitTestPoint(c)))});wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&(this.tool.transition("erasing"),this.app.setSelectedShapes([]))});wb(this,"onPointerUp",()=>{const c=[...this.app.erasingShapes];this.app.setErasingShapes([]);this.app.deleteShapes(c);this.tool.transition("idle")})}};wb(Pv,"id","pointing");var Gr=class extends mn{constructor(){super(...arguments);wb(this,"cursor","crosshair")}};wb(Gr,"id","erase");wb(Gr,"states",[Ov,Pv,Nv]);wb(Gr,
"initial","idle");var gt=class extends ei{constructor(){super(...arguments);wb(this,"handle",{});wb(this,"handleId","end");wb(this,"currentShape",{});wb(this,"initialShape",{});wb(this,"bindableShapeIds",[]);wb(this,"startBindingShapeId");wb(this,"newStartBindingId","");wb(this,"draggedBindingId","");wb(this,"onPointerMove",()=>{const {inputs:{shiftKey:c,previousPoint:m,originPoint:M,currentPoint:ca,modKey:ua,altKey:Ga},settings:{snapToGrid:La}}=this.app;var fb=this.app.getShapeById(this.initialShape.id),
{handles:vb}=this.initialShape,Wb=this.handleId,oc="start"===this.handleId?"end":"start";if(!ne.isEqual(m,ca)){var uc=ne.sub(ca,M);if(c){var Sc=vb[oc].point,kd=ne.add(vb[Wb].point,uc),fd=ne.angle(Sc,kd);Sc=ne.rotWith(kd,Sc,Dh.snapAngleToSegments(fd,24)-fd);uc=ne.add(uc,ne.sub(Sc,kd))}uc=ne.add(vb[Wb].point,uc);vb={[Wb]:ng(Gf({},vb[Wb]),{point:La?ne.snap(uc,8):ne.toFixed(uc),bindingId:void 0})};var xd=this.currentShape.getHandlesChange(this.initialShape,vb);if(xd){vb=vi(fb.props,xd);var Jd={},$c;Wb=
vb.handles[Wb];oc=vb.handles[oc];if(this.startBindingShapeId){var hd;if(uc=this.app.getShapeById(this.startBindingShapeId)){kd=uc.getCenter();Sc=vb.handles.end;var od=ne.add(vb.handles.start.point,vb.point);ne.isEqual(od,kd)&&od[1]++;fd=uc.hitTestPoint(ca);od=ne.uni(ne.sub(od,kd));const Kd=void 0!==this.app.currentPage.bindings[this.newStartBindingId];ua||uc.hitTestPoint(ne.add(vb.point,Sc.point))||(hd=ad(fb.props,uc,"start",this.newStartBindingId,kd,kd,od,fd));hd&&!Kd?(Jd[this.newStartBindingId]=
hd,vb.handles.start.bindingId=hd.id):!hd&&Kd&&(console.log("removing start binding"),delete Jd[this.newStartBindingId],vb.handles.start.bindingId=void 0)}}if(!ua){hd=ne.add(oc.point,vb.point);oc=ne.add(Wb.point,vb.point);Wb=ne.uni(ne.sub(oc,hd));const Kd=ne.add(vb.point,vb.handles.start.point),zd=ne.add(vb.point,vb.handles.end.point);uc=this.bindableShapeIds.map(Te=>this.app.getShapeById(Te)).sort((Te,We)=>We.nonce-Te.nonce).filter(Te=>![Kd,zd].every(We=>Te.hitTestPoint(We)));for(const Te of uc)if($c=
ad(fb.props,Te,this.handleId,this.draggedBindingId,oc,hd,Wb,Ga))break}$c?(Jd[this.draggedBindingId]=$c,vb=vi(vb,{handles:{[this.handleId]:{bindingId:this.draggedBindingId}}})):(fb=fb.props.handles[this.handleId].bindingId,void 0!==fb&&(delete Jd[fb],vb=vi(vb,{handles:{[this.handleId]:{bindingId:void 0}}})));xd=this.currentShape.getHandlesChange(vb,vb.handles);tc(()=>{var Kd;if(xd){this.currentShape.update(xd);this.app.currentPage.updateBindings(Jd);const zd=Object.values(null!=(Kd=xd.handles)?Kd:
{}).map(Te=>Te.bindingId).map(Te=>this.app.currentPage.bindings[Te]).filter(Boolean).flatMap(Te=>[Te.toId,Te.fromId].filter(Boolean));this.app.setBindingShapes(zd)}})}}});wb(this,"onPointerUp",()=>{this.tool.transition("idle");this.currentShape&&this.app.setSelectedShapes([this.currentShape]);this.app.transition("select");this.app.persist()});wb(this,"onExit",()=>{this.app.clearBindingShape();this.app.history.resume();this.app.persist()});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.deleteShapes([this.currentShape]),
this.tool.transition("idle")}})}};wb(gt,"id","creating");var Qv=class extends gt{constructor(){super(...arguments);wb(this,"onEnter",()=>{var c;this.app.history.pause();this.newStartBindingId=Re();this.draggedBindingId=Re();this.bindableShapeIds=this.app.currentPage.getBindableShapes();var {Shape:m}=this.tool;const {originPoint:M}=this.app.inputs;m=new m(ng(Gf({},m.defaultProps),{id:Re(),type:m.id,parentId:this.app.currentPage.id,point:this.app.settings.snapToGrid?ne.snap(M,8):M,fill:this.app.settings.color,
stroke:this.app.settings.color,scaleLevel:this.app.settings.scaleLevel}));this.initialShape=Ab(m.props);this.currentShape=m;this.app.currentPage.addShapes(m);this.app.setSelectedShapes([m]);if(this.startBindingShapeId=null==(c=this.bindableShapeIds.map(ca=>this.app.getShapeById(ca)).filter(ca=>vh.pointInBounds(M,ca.bounds))[0])?void 0:c.id)this.bindableShapeIds.splice(this.bindableShapeIds.indexOf(this.startBindingShapeId),1),this.app.setBindingShapes([this.startBindingShapeId])})}};wb(Qv,"id","creating");
var Rv=class extends ei{constructor(){super(...arguments);wb(this,"onPointerDown",(c,m)=>{c.order||this.tool.transition("pointing")});wb(this,"onPinchStart",(...c)=>{var m,M;this.app.transition("select",{returnTo:this.app.currentState.id});null==(M=(m=this.app._events).onPinchStart)?void 0:M.call(m,...c)});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.transition("select")}});wb(this,"onPointerEnter",c=>{if(!c.order)switch(c.type){case "shape":this.app.setHoveredShape(c.shape.id);
break;case "selection":"background"!==c.handle&&"center"!==c.handle&&this.tool.transition("hoveringSelectionHandle",c)}});wb(this,"onPointerLeave",c=>{c.order||"shape"===c.type&&this.app.hoveredId&&this.app.setHoveredShape(void 0)})}};wb(Rv,"id","idle");var Sv=class extends ei{constructor(){super(...arguments);wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&!this.app.readOnly&&(this.tool.transition("creating"),this.app.setSelectedShapes(this.app.currentPage.shapes))})}};
wb(Sv,"id","pointing");var Hr=class extends mn{constructor(){super(...arguments);wb(this,"cursor","crosshair")}};wb(Hr,"id","line");wb(Hr,"states",[Rv,Sv,Qv]);wb(Hr,"initial","idle");var Tv=class extends ei{constructor(){super(...arguments);wb(this,"cursor","crosshair");wb(this,"creatingShape");wb(this,"aspectRatio");wb(this,"initialBounds",{});wb(this,"onEnter",()=>{const {currentPage:c,inputs:{originPoint:m}}=this.app,{Shape:M}=this.tool,ca=new M({id:Re(),type:M.id,parentId:c.id,point:[...m],text:"",
size:[16,32],isSizeLocked:!0,fill:this.app.settings.color,stroke:this.app.settings.color});this.creatingShape=ca;this.creatingShape.setScaleLevel(this.app.settings.scaleLevel);tc(()=>{this.app.currentPage.addShapes(ca);const ua=this.app.settings.snapToGrid?ne.snap([...m],8):m,{bounds:Ga}=ca;ca.update({point:ne.sub(ua,[Ga.width/2,Ga.height/2])});this.app.transition("select");this.app.setSelectedShapes([ca]);this.app.currentState.transition("editingShape",{type:"shape",shape:this.creatingShape,order:0})})})}};
wb(Tv,"id","creating");var Uv=class extends ei{constructor(){super(...arguments);wb(this,"onPointerDown",(c,m)=>{c.order||this.app.readOnly||this.tool.transition("creating")});wb(this,"onPinchStart",(...c)=>{var m,M;this.app.transition("select",{returnTo:this.app.currentState.id});null==(M=(m=this.app._events).onPinchStart)?void 0:M.call(m,...c)});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.transition("select")}})}};wb(Uv,"id","idle");var Ir=class extends mn{constructor(){super(...arguments);
wb(this,"cursor","crosshair")}};wb(Ir,"id","box");wb(Ir,"states",[Uv,Tv]);wb(Ir,"initial","idle");var Gz=Qf(D()),Hz=class extends Gz.default{constructor(){super(...arguments);wb(this,"toBBox",c=>c.rotatedBounds)}},Vv=class extends ei{constructor(){super(...arguments);wb(this,"initialSelectedIds",[]);wb(this,"initialSelectedShapes",[]);wb(this,"tree",new Hz);wb(this,"onEnter",()=>{const {selectedShapes:c,currentPage:m,selectedIds:M}=this.app;this.initialSelectedIds=Array.from(M.values());this.initialSelectedShapes=
Array.from(c.values());this.tree.load(m.shapes)});wb(this,"onExit",()=>{this.initialSelectedIds=[];this.tree.clear();this.app.setBrush(void 0)});wb(this,"onPointerMove",()=>{const {inputs:{shiftKey:c,ctrlKey:m,originPoint:M,currentPoint:ca}}=this.app,ua=Me.getBoundsFromPoints([ca,M],0);this.app.setBrush(ua);const Ga=[...(new Set(this.tree.search(ua).filter(La=>m?Me.boundsContain(ua,La.rotatedBounds):La.hitTestBounds(ua)).filter(La=>"group"!==La.type).map(La=>{var fb;return null!=(fb=this.app.getParentGroup(La))?
fb:La})))];c?Ga.every(La=>this.initialSelectedShapes.includes(La))?this.app.setSelectedShapes(this.initialSelectedShapes.filter(La=>!Ga.includes(La))):this.app.setSelectedShapes([...(new Set([...this.initialSelectedShapes,...Ga]))]):this.app.setSelectedShapes(Ga);this.app.viewport.panToPointWhenNearBounds(ca)});wb(this,"onPointerUp",()=>{this.app.setBrush(void 0);this.tool.transition("idle")});wb(this,"handleModifierKey",(c,m)=>{switch(m.key){case "Escape":this.app.setBrush(void 0),this.app.setSelectedShapes(this.initialSelectedIds),
this.tool.transition("idle")}})}};wb(Vv,"id","brushing");var Wv=class extends ei{constructor(){super(...arguments);wb(this,"onEnter",c=>{var m;const {selectedIds:M,inputs:{shiftKey:ca}}=this.app;if("shape"===c.type&&!M.has(c.shape.id)){const ua=null!=(m=this.app.getParentGroup(c.shape))?m:c.shape;ca?this.app.setSelectedShapes([...Array.from(M.values()),ua.id]):this.app.setSelectedShapes([ua])}});wb(this,"onPointerDown",()=>{this.tool.transition("idle")})}};wb(Wv,"id","contextMenu");var Xv=class extends ei{constructor(){super(...arguments);
wb(this,"onEnter",c=>{"pinching"===c.fromId&&this.parent.returnTo&&this.app.transition(this.parent.returnTo)});wb(this,"onExit",()=>{});wb(this,"onPointerEnter",c=>{if(!c.order)switch(c.type){case "shape":this.app.setHoveredShape(c.shape.id);break;case "selection":"background"!==c.handle&&"center"!==c.handle&&this.tool.transition("hoveringSelectionHandle",c);break;case "canvas":this.app.setHoveredShape(void 0)}});wb(this,"onPointerDown",(c,m)=>{const {selectedShapes:M,inputs:{ctrlKey:ca}}=this.app;
if(2===m.button)this.tool.transition("contextMenu",c);else if(ca)this.tool.transition("pointingCanvas");else switch(c.type){case "selection":switch(c.handle){case "center":break;case "background":this.tool.transition("pointingBoundsBackground");break;case "rotate":this.tool.transition("pointingRotateHandle");break;default:this.tool.transition("pointingResizeHandle",c)}break;case "shape":if(M.has(c.shape))this.tool.transition("pointingSelectedShape",c);else{const {selectionBounds:ua,inputs:Ga}=this.app;
ua&&vh.pointInBounds(Ga.currentPoint,ua)?this.tool.transition("pointingShapeBehindBounds",c):this.tool.transition("pointingShape",c)}break;case "handle":this.tool.transition("pointingHandle",c);break;case "canvas":this.tool.transition("pointingCanvas");break;case "minimap":this.tool.transition("pointingMinimap",Gf(Gf({},m),c))}});wb(this,"onPointerLeave",c=>{c.order||"shape"===c.type&&this.app.hoveredId&&this.app.setHoveredShape(void 0)});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",
{info:c,event:m})});wb(this,"onDoubleClick",c=>{if(!c.order&&1===this.app.selectedShapesArray.length&&!this.app.readOnly){var m=this.app.selectedShapesArray[0];if(m.canEdit&&!m.props.isLocked)switch(c.type){case "shape":this.tool.transition("editingShape",c);break;case "selection":1===this.app.selectedShapesArray.length&&this.tool.transition("editingShape",{type:"shape",target:m})}}});wb(this,"onKeyDown",(c,m)=>{({selectedShapesArray:c}=this.app);switch(m.key){case "Enter":1===c.length&&c[0].canEdit&&
!this.app.readOnly&&this.tool.transition("editingShape",{type:"shape",shape:c[0],order:0});break;case "Escape":c.length&&this.app.setSelectedShapes([])}})}};wb(Xv,"id","idle");var Yv=class extends ei{constructor(){super(...arguments);wb(this,"onEnter",c=>{var m;const {selectedIds:M,inputs:{shiftKey:ca}}=this.app,ua=null!=(m=this.app.getParentGroup(c.shape))?m:c.shape;ca?this.app.setSelectedShapes([...Array.from(M.values()),ua.id]):this.app.setSelectedShapes([ua])});wb(this,"onPointerMove",()=>{const {currentPoint:c,
originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&!this.app.readOnly&&this.tool.transition("translating")});wb(this,"onPointerUp",()=>{this.tool.transition("idle")});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})})}};wb(Yv,"id","pointingShape");var Zv=class extends ei{constructor(){super(...arguments);wb(this,"cursor","move");wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&!this.app.readOnly&&this.tool.transition("translating")});
wb(this,"onPointerUp",()=>{this.app.setSelectedShapes([]);this.tool.transition("idle")});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})})}};wb(Zv,"id","pointingBoundsBackground");var $v=class extends ei{constructor(){super(...arguments);wb(this,"onEnter",()=>{var c;const {shiftKey:m}=this.app.inputs;m||(this.app.setSelectedShapes([]),this.app.setEditingShape(),null==(c=window.getSelection())?void 0:c.removeAllRanges())});wb(this,"onPointerMove",()=>{const {currentPoint:c,
originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&this.tool.transition("brushing")});wb(this,"onPointerUp",()=>{this.app.inputs.shiftKey||this.app.setSelectedShapes([]);this.tool.transition("idle")});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})});wb(this,"onDoubleClick",()=>{this.app.notify("canvas-dbclick",{point:this.app.inputs.originPoint})})}};wb($v,"id","pointingCanvas");var aw=class extends ei{constructor(){super(...arguments);wb(this,"cursor","move");wb(this,
"isCloning",!1);wb(this,"didClone",!1);wb(this,"initialPoints",{});wb(this,"initialShapePoints",{});wb(this,"initialClonePoints",{});wb(this,"clones",[]);wb(this,"onEnter",()=>{var c;this.app.history.pause();const {allSelectedShapesArray:m,inputs:M}=this.app;this.initialPoints=this.initialShapePoints=Object.fromEntries(m.map(({id:ca,props:{point:ua}})=>[ca,ua.slice()]));document.querySelectorAll("input,textarea").forEach(ca=>ca.blur());null==(c=document.getSelection())?void 0:c.empty();M.altKey?this.startCloning():
this.moveSelectedShapesToPointer()});wb(this,"onExit",()=>{this.app.history.resume();this.isCloning=this.didClone=!1;this.clones=[];this.initialPoints={};this.initialShapePoints={};this.initialClonePoints={}});wb(this,"onPointerMove",()=>{const {inputs:{currentPoint:c}}=this.app;this.moveSelectedShapesToPointer();this.app.viewport.panToPointWhenNearBounds(c)});wb(this,"onPointerDown",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});wb(this,"onPointerUp",()=>{this.app.history.resume();
this.app.persist();this.tool.transition("idle")});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Alt":this.startCloning();break;case "Escape":this.app.allSelectedShapes.forEach(M=>{M.update({point:this.initialPoints[M.id]})}),this.tool.transition("idle")}});wb(this,"onKeyUp",(c,m)=>{switch(m.key){case "Alt":if(!this.isCloning)throw Error("Expected to be cloning.");const {currentPage:M,allSelectedShapes:ca}=this.app;M.removeShapes(...ca);this.initialPoints=this.initialShapePoints;this.app.setSelectedShapes(Object.keys(this.initialPoints));
this.moveSelectedShapesToPointer();this.isCloning=!1}})}moveSelectedShapesToPointer(){const {inputs:{shiftKey:c,originPoint:m,currentPoint:M}}=this.app,{initialPoints:ca}=this,ua=yd.sub(M,m);c&&(Math.abs(ua[0])<Math.abs(ua[1])?ua[0]=0:ua[1]=0);tc(()=>{this.app.allSelectedShapesArray.filter(Ga=>!Ga.props.isLocked).forEach(Ga=>{let La=yd.add(ca[Ga.id],ua);this.app.settings.snapToGrid&&(La=yd.snap(La,8));Ga.update({point:La})})})}startCloning(){this.didClone||(this.clones=this.app.allSelectedShapesArray.map(c=>
{const m=this.app.getShapeClass(c.type);if(!m)throw Error("Could not find that shape class.");return new m(ng(Gf({},c.serialized),{id:Re(),type:c.type,point:this.initialPoints[c.id],rotation:c.props.rotation,isLocked:!1}))}),this.initialClonePoints=Object.fromEntries(this.clones.map(({id:c,props:{point:m}})=>[c,m.slice()])),this.didClone=!0);this.app.allSelectedShapes.forEach(c=>{c.update({point:this.initialPoints[c.id]})});this.initialPoints=this.initialClonePoints;this.app.currentPage.addShapes(...this.clones);
this.app.setSelectedShapes(Object.keys(this.initialClonePoints));this.moveSelectedShapesToPointer();this.isCloning=!0}};wb(aw,"id","translating");var bw=class extends ei{constructor(){super(...arguments);wb(this,"pointedSelectedShape");wb(this,"onEnter",c=>{this.pointedSelectedShape=c.shape});wb(this,"onExit",()=>{this.pointedSelectedShape=void 0});wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&!this.app.readOnly&&this.tool.transition("translating")});
wb(this,"onPointerUp",()=>{const {shiftKey:c,currentPoint:m}=this.app.inputs;var {selectedShapesArray:M}=this.app;if(!this.pointedSelectedShape)throw Error("Expected a pointed selected shape");if(c)({selectedIds:M}=this.app),M=Array.from(M.values()),M.splice(M.indexOf(this.pointedSelectedShape.id),1),this.app.setSelectedShapes(M);else{if(1===M.length&&this.pointedSelectedShape.canEdit&&!this.app.readOnly&&!this.pointedSelectedShape.props.isLocked&&this.pointedSelectedShape instanceof ok&&vh.pointInBounds(m,
this.pointedSelectedShape.bounds)){this.tool.transition("editingShape",{shape:this.pointedSelectedShape,order:0,type:"shape"});return}this.app.setSelectedShapes([this.pointedSelectedShape.id])}this.tool.transition("idle")});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})})}};wb(bw,"id","pointingSelectedShape");var cw=class extends ei{constructor(){super(...arguments);wb(this,"info",{});wb(this,"onEnter",c=>{this.info=c;this.updateCursor()});wb(this,"onExit",()=>{this.app.cursors.reset()});
wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&this.tool.transition("resizing",this.info)});wb(this,"onPointerUp",()=>{this.tool.transition("hoveringSelectionHandle",this.info)});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})})}updateCursor(){this.app.cursors.setCursor(di[this.info.handle],this.app.selectionBounds.rotation)}};wb(cw,"id","pointingResizeHandle");var dw=class extends ei{constructor(){super(...arguments);
wb(this,"isSingle",!1);wb(this,"handle","bottom_right_corner");wb(this,"snapshots",{});wb(this,"initialCommonBounds",{});wb(this,"selectionRotation",0);wb(this,"resizeType","corner");wb(this,"onEnter",c=>{var m,M;const {history:ca,selectedShapesArray:ua,selectionBounds:Ga}=this.app;if(!Ga)throw Error("Expected a selected bounds.");this.handle=c.handle;this.resizeType="left_edge"===c.handle||"right_edge"===c.handle?"horizontal-edge":"top_edge"===c.handle||"bottom_edge"===c.handle?"vertical-edge":"corner";
this.app.cursors.setCursor(dw.CURSORS[c.handle],null==(m=this.app.selectionBounds)?void 0:m.rotation);ca.pause();const La=Me.getBoundsFromPoints(ua.map(fb=>Me.getBoundsCenter(fb.bounds)));this.selectionRotation=(this.isSingle=1===ua.length)?null!=(M=ua[0].props.rotation)?M:0:0;this.initialCommonBounds=Gf({},Ga);this.snapshots=Object.fromEntries(ua.map(fb=>{const vb=Gf({},fb.bounds),[Wb,oc]=Me.getBoundsCenter(vb);return[fb.id,{props:fb.serialized,bounds:vb,transformOrigin:[(Wb-this.initialCommonBounds.minX)/
this.initialCommonBounds.width,(oc-this.initialCommonBounds.minY)/this.initialCommonBounds.height],innerTransformOrigin:[(Wb-La.minX)/La.width,(oc-La.minY)/La.height],isAspectRatioLocked:fb.props.isAspectRatioLocked||!(fb.canChangeAspectRatio&&!fb.props.rotation)}]}));ua.forEach(fb=>{var vb;null==(vb=fb.onResizeStart)?void 0:vb.call(fb,{isSingle:this.isSingle})})});wb(this,"onExit",()=>{this.app.cursors.reset();this.snapshots={};this.initialCommonBounds={};this.selectionRotation=0;this.app.history.resume()});
wb(this,"onPointerMove",()=>{const {inputs:{altKey:c,shiftKey:m,ctrlKey:M,originPoint:ca,currentPoint:ua}}=this.app,{handle:Ga,snapshots:La,initialCommonBounds:fb}=this;let vb=yd.sub(ua,ca);c&&(vb=yd.mul(vb,2));const Wb=this.app.selectedShapes.values().next().value;let oc=Me.getTransformedBoundingBox(fb,Ga,vb,this.selectionRotation,m||this.isSingle&&(M?!("clipping"in Wb.props):!Wb.canChangeAspectRatio||Wb.props.isAspectRatioLocked));c&&(oc=Gf(Gf({},oc),Me.centerBounds(oc,Me.getBoundsCenter(fb))));
const {scaleX:uc,scaleY:Sc}=oc;this.app.selectedShapes.forEach(kd=>{var fd,xd;const {isAspectRatioLocked:Jd,props:$c,bounds:hd,transformOrigin:od}=La[kd.id];let Kd=Me.getRelativeTransformedBoundingBox(oc,fb,hd,0>uc,0>Sc);if(kd.canResize.some(We=>We)||kd.props.isSizeLocked||!this.isSingle){var zd=[uc,Sc],Te=null!=(fd=$c.rotation)?fd:0;fd=Me.getBoundsCenter(Kd);kd.canFlip||(zd=yd.abs(zd));kd.canScale||(zd=null!=(xd=$c.scale)?xd:[1,1]);if(Te&&0>uc&&0<=Sc||0>Sc&&0<=uc)Te*=-1;this.app.settings.snapToGrid&&
!Jd&&(Kd=Me.snapBoundsToGrid(Kd,8));kd.onResize($c,{center:fd,rotation:Te,scale:zd,bounds:Kd,type:Ga,clip:M,transformOrigin:od})}});this.updateCursor(uc,Sc);this.app.viewport.panToPointWhenNearBounds(ua)});wb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.selectedShapes.forEach(M=>{M.update(Gf({},this.snapshots[M.id].props))}),this.tool.transition("idle")}})}updateCursor(c,m){var M,
ca,ua,Ga;const La=0>c&&0<=m;c=0>m&&0<=c;switch(this.handle){case "top_left_corner":case "bottom_right_corner":La||c?"nwse-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nesw-resize",null==(M=this.app.selectionBounds)?void 0:M.rotation):"nesw-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nwse-resize",null==(ca=this.app.selectionBounds)?void 0:ca.rotation);break;case "top_right_corner":case "bottom_left_corner":La||c?"nesw-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nwse-resize",
null==(ua=this.app.selectionBounds)?void 0:ua.rotation):"nwse-resize"===this.app.cursors.cursor&&this.app.cursors.setCursor("nesw-resize",null==(Ga=this.app.selectionBounds)?void 0:Ga.rotation)}}},ht=dw;wb(ht,"id","resizing");wb(ht,"CURSORS",{bottom_edge:"ns-resize",top_edge:"ns-resize",left_edge:"ew-resize",right_edge:"ew-resize",bottom_left_corner:"nesw-resize",bottom_right_corner:"nwse-resize",top_left_corner:"nwse-resize",top_right_corner:"nesw-resize"});var ew=class extends ei{constructor(){super(...arguments);
wb(this,"cursor","rotate");wb(this,"handle","");wb(this,"onEnter",c=>{this.app.history.pause();this.handle=c.handle;this.updateCursor()});wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&this.tool.transition("rotating",{handle:this.handle})});wb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})})}updateCursor(){this.app.cursors.setCursor(di[this.handle],
this.app.selectionRotation)}};wb(ew,"id","pointingRotateHandle");var fw=class extends ei{constructor(){super(...arguments);wb(this,"info",{});wb(this,"onEnter",c=>{this.info=c});wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&!this.app.readOnly&&this.tool.transition("translating")});wb(this,"onPointerUp",()=>{const {selectedIds:c,inputs:{shiftKey:m}}=this.app;m?this.app.setSelectedShapes([...Array.from(c.values()),this.info.shape.id]):this.app.setSelectedShapes([this.info.shape.id]);
this.tool.transition("idle")});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})})}};wb(fw,"id","pointingShapeBehindBounds");var it=class extends ei{constructor(){super(...arguments);wb(this,"cursor","rotate");wb(this,"snapshot",{});wb(this,"initialCommonCenter",[0,0]);wb(this,"initialCommonBounds",{});wb(this,"initialAngle",0);wb(this,"initialSelectionRotation",0);wb(this,"handle","");wb(this,"onEnter",c=>{const {history:m,selectedShapesArray:M,selectionBounds:ca}=
this.app;if(!ca)throw Error("Expected selected bounds.");m.pause();this.handle=c.handle;this.initialSelectionRotation=this.app.selectionRotation;this.initialCommonBounds=Gf({},ca);this.initialCommonCenter=Me.getBoundsCenter(ca);this.initialAngle=yd.angle(this.initialCommonCenter,this.app.inputs.currentPoint);this.snapshot=Object.fromEntries(M.map(ua=>[ua.id,{point:[...ua.props.point],center:[...ua.center],rotation:ua.props.rotation,handles:"handles"in ua?to(ua.handles):void 0}]));this.updateCursor()});
wb(this,"onExit",()=>{this.app.history.resume();this.snapshot={}});wb(this,"onPointerMove",()=>{const {selectedShapes:c,inputs:{shiftKey:m,currentPoint:M}}=this.app,{snapshot:ca,initialCommonCenter:ua,initialAngle:Ga,initialSelectionRotation:La}=this;let fb=yd.angle(ua,M)-Ga;m&&(fb=Dh.snapAngleToSegments(fb,24));c.forEach(Wb=>{var oc=ca[Wb.id];let uc=0;if(m){var {rotation:Sc=0}=oc;uc=Dh.snapAngleToSegments(Sc,24)-Sc}const kd=yd.sub(oc.center,oc.point);Sc=yd.rotWith(oc.center,ua,fb);if("handles"in
Wb){oc=oc.handles;const fd=oc.map(Jd=>yd.rotWith(Jd.point,kd,fb)),xd=Me.getCommonTopLeft(fd);Wb.update({point:yd.add(xd,yd.sub(Sc,kd)),handles:oc.map((Jd,$c)=>ng(Gf({},Jd),{point:yd.sub(fd[$c],xd)}))})}else Wb.update({point:yd.sub(Sc,kd),rotation:Dh.clampRadians((oc.rotation||0)+fb+uc)})});const vb=Dh.clampRadians(La+fb);this.app.setSelectionRotation(m?Dh.snapAngleToSegments(vb,24):vb);this.updateCursor()});wb(this,"onPointerUp",()=>{this.app.history.resume();this.app.persist();this.tool.transition("idle")});
wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.selectedShapes.forEach(M=>{M.update(this.snapshot[M.id])}),this.tool.transition("idle")}})}updateCursor(){this.app.cursors.setCursor(di[this.handle],this.app.selectionRotation)}};wb(it,"id","rotating");var gw=class extends ei{constructor(){super(...arguments);wb(this,"onPinch",(c,m)=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});wb(this,"onPinchEnd",()=>{this.tool.transition("idle")});wb(this,"onPointerDown",()=>{this.tool.transition("idle")})}};
wb(gw,"id","pinching");var hw=class extends gt{constructor(){super(...arguments);wb(this,"cursor","grabbing");wb(this,"onEnter",c=>{this.app.history.pause();this.newStartBindingId=Re();this.draggedBindingId=Re();this.bindableShapeIds=this.app.currentPage.getBindableShapes();this.handleId=c.id;this.currentShape=c.shape;this.initialShape=Ab(this.currentShape.props);this.app.setSelectedShapes([this.currentShape])})}};wb(hw,"id","translatingHandle");var iw=class extends ei{constructor(){super(...arguments);
wb(this,"cursor","grabbing");wb(this,"info",{});wb(this,"onEnter",c=>{this.info=c});wb(this,"onPointerMove",()=>{const {currentPoint:c,originPoint:m}=this.app.inputs;5<yd.dist(c,m)&&this.tool.transition("translatingHandle",this.info)});wb(this,"onPointerUp",()=>{this.tool.transition("idle")});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})})}};wb(iw,"id","pointingHandle");var jw=class extends ei{constructor(){super(...arguments);wb(this,"handle");wb(this,"onEnter",
c=>{var m;this.app.cursors.setCursor(di[c.handle],null!=(m=this.app.selectionBounds.rotation)?m:0);this.handle=c.handle});wb(this,"onExit",()=>{this.app.cursors.reset()});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})});wb(this,"onPointerDown",c=>{switch(c.type){case "selection":switch(c.handle){case "center":break;case "background":break;case "top_left_resize_corner":case "top_right_resize_corner":case "bottom_right_resize_corner":case "bottom_left_resize_corner":this.tool.transition("pointingRotateHandle",
c);break;default:this.tool.transition("pointingResizeHandle",c)}}});wb(this,"onPointerLeave",()=>{this.tool.transition("idle")});wb(this,"onDoubleClick",c=>{var m;if(!c.order&&1===this.app.selectedShapes.size){var M=this.app.selectedShapes.values().next().value;if(!M.canEdit||this.app.readOnly||M.props.isLocked)M.onResetBounds({asset:M.props.assetId?this.app.assets[M.props.assetId]:void 0,zoom:this.app.viewport.camera.zoom}),this.tool.transition("idle");else switch(c.type){case "shape":this.tool.transition("editingShape",
c);break;case "selection":null==(m=M.onResetBounds)?void 0:m.call(M,{zoom:this.app.viewport.camera.zoom}),1===this.app.selectedShapesArray.length&&this.tool.transition("editingShape",{type:"shape",target:M})}}})}};wb(jw,"id","hoveringSelectionHandle");var kw=class extends ei{constructor(){super(...arguments);wb(this,"editingShape",{});wb(this,"onEnter",c=>{this.editingShape=c.shape;this.app.setEditingShape(c.shape)});wb(this,"onExit",()=>{var c;if(this.editingShape&&"text"in this.editingShape.props){const m=
this.editingShape.props.text.trim();""===m&&"text"===this.editingShape.props.type?this.app.deleteShapes([this.editingShape]):(this.editingShape.onResetBounds(),this.editingShape.update({text:m}))}this.app.persist();this.app.setEditingShape();null==(c=document.querySelector(".tl-canvas"))?void 0:c.focus()});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})});wb(this,"onPointerDown",c=>{switch(c.type){case "shape":if(c.shape===this.editingShape)break;this.tool.transition("idle",
c);break;case "canvas":c.order||this.tool.transition("idle",c)}});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":tc(()=>{m.stopPropagation();this.app.setSelectedShapes([this.editingShape]);this.tool.transition("idle")})}})}};wb(kw,"id","editingShape");var lw=class extends ei{constructor(){super(...arguments);wb(this,"minimapZoom",1);wb(this,"minimapRect",{minX:0,minY:0,maxX:0,maxY:0,width:0,height:0});wb(this,"getCameraPoint",c=>{const m=document.querySelector(".tl-preview-minimap svg");
var M=document.querySelector(".tl-preview-minimap #minimap-camera-rect");if(m&&M){const ca=m.getBoundingClientRect();this.minimapRect.height=ca.height;this.minimapRect.width=ca.width;this.minimapRect.minX=ca.left;this.minimapRect.minY=ca.top;this.minimapRect.maxX=ca.right;this.minimapRect.maxY=ca.bottom;this.minimapZoom=+m.dataset.commonBoundWidth/this.minimapRect.width;c=yd.sub(c,[this.minimapRect.minX,this.minimapRect.minY]);M=M.getBoundingClientRect();M=yd.mul(yd.sub(c,[M.left+M.width/2,M.top+
M.height/2]),this.minimapZoom);return yd.sub(this.app.viewport.camera.point,M)}});wb(this,"onEnter",c=>{(c=this.getCameraPoint([c.clientX,c.clientY]))?this.app.viewport.update({point:c}):this.tool.transition("idle")});wb(this,"onPointerMove",(c,m)=>{"clientX"in m&&(c=this.getCameraPoint([m.clientX,m.clientY]))&&this.app.viewport.update({point:c})});wb(this,"onPointerUp",()=>{this.tool.transition("idle")})}};wb(lw,"id","pointingMinimap");var op=class extends mn{constructor(){super(...arguments);wb(this,
"returnTo","");wb(this,"onEnter",c=>{this.returnTo=null==c?void 0:c.returnTo})}};wb(op,"id","select");wb(op,"initial","idle");wb(op,"shortcut","whiteboard/select");wb(op,"states",[Xv,Vv,Wv,$v,Yv,fw,bw,Zv,jw,cw,ew,lw,iw,hw,aw,ht,it,it,gw,kw]);var mw=class extends ei{constructor(){super(...arguments);wb(this,"cursor","grabbing");wb(this,"originalScreenPoint",[]);wb(this,"originalCameraPoint",[]);wb(this,"prevState","idle");wb(this,"onEnter",c=>{this.prevState=null==c?void 0:c.prevState;this.originalScreenPoint=
this.app.inputs.currentScreenPoint;this.originalCameraPoint=this.app.viewport.camera.point});wb(this,"onPointerMove",(c,m)=>{c=ne.sub(this.originalScreenPoint,this.app.inputs.currentScreenPoint);this.app.viewport.update({point:ne.sub(this.originalCameraPoint,ne.div(c,this.app.viewport.camera.zoom))})});wb(this,"onPointerUp",()=>{var c;this.tool.transition(null!=(c=this.prevState)?c:"idle")})}};wb(mw,"id","panning");var nw=class extends ei{constructor(){super(...arguments);wb(this,"onEnter",c=>{this.parent.prevTool&&
c.exit&&(this.app.setCurrentState(this.parent.prevTool),setTimeout(()=>{this.app.cursors.reset();this.app.cursors.setCursor(this.parent.prevTool.cursor)}))});wb(this,"onPointerDown",(c,m)=>{c.order||this.tool.transition("panning")})}};wb(nw,"id","idle");var ow=class extends ei{constructor(){super(...arguments);wb(this,"onPointerDown",(c,m)=>{c.order||this.tool.transition("panning",{prevState:"idleHold"})});wb(this,"onPinchStart",(c,m)=>{this.tool.transition("pinching",{info:c,event:m})})}};wb(ow,
"id","idleHold");var pw=class extends ei{constructor(){super(...arguments);wb(this,"origin",[0,0]);wb(this,"prevDelta",[0,0]);wb(this,"onEnter",c=>{this.prevDelta=c.info.delta;this.origin=c.info.point});wb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])});wb(this,"onPinchEnd",()=>{this.tool.transition("idle")})}};wb(pw,"id","pinching");var pp=class extends mn{constructor(){super(...arguments);wb(this,"cursor","grab");wb(this,"prevTool",null);wb(this,"onEnter",c=>{this.prevTool=
null==c?void 0:c.prevTool});wb(this,"onKeyDown",(c,m)=>{switch(m.key){case "Escape":this.app.transition("select")}});wb(this,"onPinchStart",(c,m)=>{this.transition("pinching",{info:c,event:m})})}};wb(pp,"id","move");wb(pp,"shortcut","whiteboard/pan");wb(pp,"states",[nw,ow,mw,pw]);wb(pp,"initial","idle");var Pj=class{constructor(c,m={}){wb(this,"lastShapesNounces",null);wb(this,"app");wb(this,"id");wb(this,"name");wb(this,"shapes",[]);wb(this,"bindings",{});wb(this,"nonce",0);wb(this,"bringForward",
fb=>{this.bringToFront(fb);return this});wb(this,"sendBackward",fb=>{this.sendToBack(fb);return this});wb(this,"bringToFront",fb=>{const vb=this.parseShapesArg(fb);fb=this.shapes.filter(Wb=>!vb.includes(Wb));this.shapes=fb.concat(vb);fb={op:"bringToFront",shapes:vb,before:fb[fb.length-1]};this.app.persist(fb);this.persistInfo=fb;return this});wb(this,"sendToBack",fb=>{const vb=this.parseShapesArg(fb);fb=this.shapes.filter(Wb=>!vb.includes(Wb));this.shapes=vb.concat(fb);this.app.persist({op:"sendToBack",
shapes:vb,next:fb[0]});return this});wb(this,"flip",(fb,vb)=>{fb=this.parseShapesArg(fb);const Wb=Me.getCommonBounds(fb.map(oc=>oc.bounds));fb.forEach(oc=>{var uc;const Sc=Me.getRelativeTransformedBoundingBox(Wb,Wb,oc.bounds,"horizontal"===vb,"vertical"===vb);if(oc.serialized)oc.onResize(oc.serialized,{bounds:Sc,center:Me.getBoundsCenter(Sc),rotation:null!=(uc=oc.props.rotation)?uc:-0,type:"top_left_corner",scale:oc.canFlip&&oc.props.scale?"horizontal"===vb?[-oc.props.scale[0],1]:[1,-oc.props.scale[1]]:
[1,1],clip:!1,transformOrigin:[.5,.5]})});this.app.persist();return this});wb(this,"getShapeById",fb=>this.shapes.find(vb=>vb.id===fb));wb(this,"cleanup",fb=>{fb=rc(this.bindings,fb);const vb=new Set;let Wb=!1;const oc=to(this.bindings);fb.forEach(uc=>{var Sc;if(this.bindings[uc.id]){var kd=this.getShapeById(uc.toId),fd=this.getShapeById(uc.fromId);kd&&fd?vb.has(fd.id)||(uc=this.updateArrowBindings(fd),vb.add(fd.id),uc&&(kd=Gf(Gf({},fd.props),uc),null==(Sc=this.getShapeById(kd.id))?void 0:Sc.update(kd,
!1,(0,Yz.default)(null==uc?void 0:uc.handles,null==fd?void 0:fd.props.handles)))):(delete oc[uc.id],Wb=!0)}});Object.keys(oc).forEach(uc=>{const Sc=this.bindings[uc];0===this.shapes.filter(kd=>kd.id===Sc.fromId||kd.id===Sc.toId).length&&(delete oc[uc],Wb=!0)});Wb&&this.update({bindings:oc})});wb(this,"updateArrowBindings",fb=>{var vb,Wb,oc,uc={start:to(fb.props.handles.start),end:to(fb.props.handles.end)},Sc={isBound:!1,handle:fb.props.handles.start,point:ne.add(fb.props.handles.start.point,fb.props.point)},
kd={isBound:!1,handle:fb.props.handles.end,point:ne.add(fb.props.handles.end.point,fb.props.point)};if(fb.props.handles.start.bindingId){var fd=void 0!==(null==(vb=fb.props.decorations)?void 0:vb.start);vb=fb.props.handles.start;var xd=this.bindings[fb.props.handles.start.bindingId],Jd=this.getShapeById(null==xd?void 0:xd.toId);if(Jd){Sc=Jd.getBounds();var $c=Jd.getExpandedBounds(),hd=Me.expandBounds(Sc,fd?xd.distance:1);const {minX:od,minY:Kd,width:zd,height:Te}=$c,We=ne.add([od,Kd],ne.mulV([zd,
Te],ne.rotWith(xd.point,[.5,.5],Jd.props.rotation||0)));Sc={isBound:!0,hasDecoration:fd,binding:xd,handle:vb,point:We,target:Jd,bounds:Sc,expandedBounds:$c,intersectBounds:hd,center:Jd.getCenter()}}}if(fb.props.handles.end.bindingId&&(fd=void 0!==(null==(Wb=fb.props.decorations)?void 0:Wb.end),Wb=fb.props.handles.end,vb=this.bindings[fb.props.handles.end.bindingId],xd=this.getShapeById(null==vb?void 0:vb.toId))){kd=xd.getBounds();Jd=xd.getExpandedBounds();$c=fd?Me.expandBounds(kd,vb.distance):kd;
const {minX:od,minY:Kd,width:zd,height:Te}=Jd;hd=ne.add([od,Kd],ne.mulV([zd,Te],ne.rotWith(vb.point,[.5,.5],xd.props.rotation||0)));kd={isBound:!0,hasDecoration:fd,binding:vb,handle:Wb,point:hd,target:xd,bounds:kd,expandedBounds:Jd,intersectBounds:$c,center:xd.getCenter()}}for(const od of["end","start"]){Wb="start"===od?Sc:kd;const Kd="start"===od?kd:Sc;if(Wb.isBound)if(Wb.binding.distance){if(fd=ne.uni(ne.sub(Wb.point,Kd.point)),vb=G(Kd.point,fd,Wb.intersectBounds,Wb.target.props.rotation).filter(zd=>
zd.didIntersect).map(zd=>zd.points[0]).sort((zd,Te)=>ne.dist(zd,Kd.point)-ne.dist(Te,Kd.point)),vb[0])if(xd=void 0,Kd.isBound&&(xd=G(Kd.point,fd,Kd.intersectBounds,Kd.target.props.rotation).filter(zd=>zd.didIntersect).map(zd=>zd.points[0]).sort((zd,Te)=>ne.dist(zd,Kd.point)-ne.dist(Te,Kd.point))[0]),Kd.isBound&&(2>vb.length||xd&&vb[0]&&10>Math.ceil(ne.dist(vb[0],xd))||Me.boundsContain(Wb.expandedBounds,Kd.expandedBounds)||Me.boundsCollide(Wb.expandedBounds,Kd.expandedBounds)))fd=ne.uni(ne.sub(Kd.point,
Wb.point)),vb=G(Wb.point,fd,Wb.bounds,Wb.target.props.rotation).filter(zd=>zd.didIntersect).map(zd=>zd.points[0]),vb[0]&&(uc[od].point=ne.toFixed(ne.sub(vb[0],fb.props.point)),uc["start"===od?"end":"start"].point=ne.toFixed(ne.add(ne.sub(vb[0],fb.props.point),ne.mul(fd,Math.min(ne.dist(vb[0],Kd.point),10*(Me.boundsContain(Kd.bounds,Wb.intersectBounds)?-1:1))))));else{if(!Kd.isBound&&(vb[0]&&10>ne.dist(vb[0],Kd.point)||vh.pointInBounds(Kd.point,Wb.intersectBounds)))return uc=ne.uni(ne.sub(Wb.center,
Kd.point)),null==(oc=fb.getHandlesChange)?void 0:oc.call(fb,fb.props,{[od]:ng(Gf({},fb.props.handles[od]),{point:ne.toFixed(ne.add(ne.sub(Kd.point,fb.props.point),ne.mul(uc,10)))})});vb[0]&&(uc[od].point=ne.toFixed(ne.sub(vb[0],fb.props.point)))}}else uc[od].point=ne.sub(Wb.point,fb.props.point)}return fb.getHandlesChange(fb.props,uc)});const {id:M,name:ca,shapes:ua=[],bindings:Ga={},nonce:La}=m;this.id=M;this.name=ca;this.bindings=Object.assign({},Ga);this.app=c;this.nonce=La||0;this.persistInfo=
null;this.addShapes(...ua);Cc(this);nc(()=>{const fb=0<this.shapes.length?Object.fromEntries(this.shapes.map(vb=>[vb.id,vb.nonce])):null;if(this.lastShapesNounces&&fb){const vb=this.lastShapesNounces,Wb=[...(new Set([...Object.keys(fb),...Object.keys(vb)]))].filter(oc=>vb[oc]!==fb[oc]);requestAnimationFrame(()=>{this.cleanup(Wb)})}fb&&(this.lastShapesNounces=fb)})}get serialized(){return{id:this.id,name:this.name,shapes:this.shapes.map(c=>c.serialized).filter(c=>!!c).map(c=>Ab(c)),bindings:to(this.bindings),
nonce:this.nonce}}get shapesById(){return Object.fromEntries(this.shapes.map(c=>[c.id,c]))}update(c){Object.assign(this,c);return this}updateBindings(c){Object.assign(this.bindings,c);return this}updateShapesIndex(c){this.shapes.sort((m,M)=>c.indexOf(m.id)-c.indexOf(M.id));return this}addShapes(...c){if(0!==c.length)return c="getBounds"in c[0]?c:c.map(m=>new (this.app.getShapeClass(m.type))(m)),this.shapes.push(...c),c}parseShapesArg(c){return"string"===typeof c[0]?this.shapes.filter(m=>c.includes(m.id)):
c}removeShapes(...c){const m=this.parseShapesArg(c);this.shapes=this.shapes.filter(M=>!m.includes(M));return m}getBindableShapes(){return this.shapes.filter(c=>c.canBind).sort((c,m)=>m.nonce-c.nonce).map(c=>c.id)}};pe([Rg],Pj.prototype,"id",2);pe([Rg],Pj.prototype,"name",2);pe([Rg],Pj.prototype,"shapes",2);pe([Rg],Pj.prototype,"bindings",2);pe([$g],Pj.prototype,"serialized",1);pe([$g],Pj.prototype,"shapesById",1);pe([Rg],Pj.prototype,"nonce",2);pe([Ag],Pj.prototype,"update",1);pe([Ag],Pj.prototype,
"updateBindings",1);pe([Ag],Pj.prototype,"updateShapesIndex",1);pe([Ag],Pj.prototype,"addShapes",1);pe([Ag],Pj.prototype,"removeShapes",1);pe([Ag],Pj.prototype,"bringForward",2);pe([Ag],Pj.prototype,"sendBackward",2);pe([Ag],Pj.prototype,"bringToFront",2);pe([Ag],Pj.prototype,"sendToBack",2);pe([Ag],Pj.prototype,"cleanup",2);var dj=class{constructor(){wb(this,"shiftKey",!1);wb(this,"ctrlKey",!1);wb(this,"modKey",!1);wb(this,"altKey",!1);wb(this,"spaceKey",!1);wb(this,"isPinching",!1);wb(this,"currentScreenPoint",
[0,0]);wb(this,"currentPoint",[0,0]);wb(this,"previousScreenPoint",[0,0]);wb(this,"previousPoint",[0,0]);wb(this,"originScreenPoint",[0,0]);wb(this,"originPoint",[0,0]);wb(this,"pointerIds",new Set);wb(this,"state","idle");wb(this,"containerOffset",[0,0]);wb(this,"onPointerDown",(c,m)=>{this.pointerIds.add(m.pointerId);this.updateModifiers(m);this.originScreenPoint=this.currentScreenPoint;this.originPoint=c;this.state="pointing"});wb(this,"onPointerMove",(c,m)=>{"pinching"!==this.state&&("panning"===
this.state&&(this.state="idle"),this.updateModifiers(m),this.previousPoint=this.currentPoint,this.currentPoint=c)});wb(this,"onPointerUp",(c,m)=>{this.pointerIds.clear();this.updateModifiers(m);this.state="idle"});wb(this,"onKeyDown",c=>{this.updateModifiers(c);switch(c.key){case " ":this.spaceKey=!0}});wb(this,"onKeyUp",c=>{this.updateModifiers(c);switch(c.key){case " ":this.spaceKey=!1}});wb(this,"onPinchStart",(c,m)=>{this.updateModifiers(m);this.state="pinching"});wb(this,"onPinch",(c,m)=>{"pinching"===
this.state&&this.updateModifiers(m)});wb(this,"onPinchEnd",(c,m)=>{"pinching"===this.state&&(this.updateModifiers(m),this.state="idle")});Cc(this)}updateContainerOffset(c){Object.assign(this.containerOffset,c)}updateModifiers(c){c.isPrimary&&("clientX"in c&&(this.previousScreenPoint=this.currentScreenPoint,this.currentScreenPoint=ne.sub([c.clientX,c.clientY],this.containerOffset)),"shiftKey"in c&&(this.shiftKey=c.shiftKey,this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.modKey=Ub()?c.metaKey:c.ctrlKey))}};
pe([Rg],dj.prototype,"shiftKey",2);pe([Rg],dj.prototype,"ctrlKey",2);pe([Rg],dj.prototype,"modKey",2);pe([Rg],dj.prototype,"altKey",2);pe([Rg],dj.prototype,"spaceKey",2);pe([Rg],dj.prototype,"isPinching",2);pe([Rg],dj.prototype,"currentScreenPoint",2);pe([Rg],dj.prototype,"currentPoint",2);pe([Rg],dj.prototype,"previousScreenPoint",2);pe([Rg],dj.prototype,"previousPoint",2);pe([Rg],dj.prototype,"originScreenPoint",2);pe([Rg],dj.prototype,"originPoint",2);pe([Rg],dj.prototype,"state",2);pe([Rg],dj.prototype,
"containerOffset",2);pe([Ag],dj.prototype,"updateContainerOffset",1);pe([Ag],dj.prototype,"updateModifiers",1);pe([Ag],dj.prototype,"onPointerDown",2);pe([Ag],dj.prototype,"onPointerMove",2);pe([Ag],dj.prototype,"onPointerUp",2);pe([Ag],dj.prototype,"onKeyDown",2);pe([Ag],dj.prototype,"onKeyUp",2);pe([Ag],dj.prototype,"onPinchStart",2);pe([Ag],dj.prototype,"onPinch",2);pe([Ag],dj.prototype,"onPinchEnd",2);var Iz=(c,m=100)=>-(Math.cos(Math.PI*yd.clamp(c/m,0,1))-1)/2,so=class{constructor(){wb(this,
"bounds",{minX:0,minY:0,maxX:1080,maxY:720,width:1080,height:720});wb(this,"camera",{point:[0,0],zoom:1});wb(this,"updateBounds",c=>{this.bounds=c;return this});wb(this,"panCamera",c=>this.update({point:yd.sub(this.camera.point,yd.div(c,this.camera.zoom))}));wb(this,"panToPointWhenNearBounds",c=>{const m=yd.div([so.panThreshold,so.panThreshold],this.camera.zoom),M=yd.sub([this.currentView.maxX,this.currentView.maxY],yd.add(c,m));c=yd.sub([this.currentView.minX,this.currentView.minY],yd.sub(c,m));
this.panCamera(yd.mul([0>M[0]?M[0]:0<c[0]?c[0]:0,0>M[1]?M[1]:0<c[1]?c[1]:0],-so.panMultiplier*this.camera.zoom))});wb(this,"update",({point:c,zoom:m})=>{void 0===c||isNaN(c[0])||isNaN(c[1])||(this.camera.point=c);void 0===m||isNaN(m)||(this.camera.zoom=Math.min(4,Math.max(.1,m)));return this});wb(this,"getPagePoint",c=>{const {camera:m,bounds:M}=this;return yd.sub(yd.div(yd.sub(c,[M.minX,M.minY]),m.zoom),m.point)});wb(this,"getScreenPoint",c=>{const {camera:m}=this;return yd.mul(yd.add(c,m.point),
m.zoom)});wb(this,"onZoom",(c,m,M=!1)=>this.pinchZoom(c,[0,0],m,M));wb(this,"pinchZoom",(c,m,M,ca=!1)=>{var {camera:ua}=this;m=yd.sub(ua.point,yd.div(m,ua.zoom));M=yd.clamp(M,so.minZoom,so.maxZoom);ua=yd.div(c,ua.zoom);c=yd.div(c,M);c=yd.toFixed(yd.add(m,yd.sub(c,ua)));ca?this.animateCamera({point:c,zoom:M}):this.update({point:c,zoom:M});return this});wb(this,"setZoom",(c,m=!1)=>{const {bounds:M}=this;this.onZoom([M.width/2,M.height/2],c,m)});wb(this,"zoomIn",()=>{const {camera:c}=this;this.setZoom(c.zoom/
.8,!0)});wb(this,"zoomOut",()=>{const {camera:c}=this;this.setZoom(.8*c.zoom,!0)});wb(this,"resetZoom",()=>{this.setZoom(1,!0);return this});wb(this,"animateCamera",({point:c,zoom:m})=>this.animateToViewport({minX:-c[0],minY:-c[1],maxX:this.bounds.width/m-c[0],maxY:this.bounds.height/m-c[1],width:this.bounds.width/m,height:this.bounds.height/m}));wb(this,"animateToViewport",c=>{const m=performance.now(),M=Gf({},this.currentView),ca=()=>{var ua=performance.now()-m;ua=Iz(ua);var Ga=M.minX+(c.minX-M.minX)*
ua;this.update({point:[-Ga,-(M.minY+(c.minY-M.minY)*ua)],zoom:this.bounds.width/(M.maxX+(c.maxX-M.maxX)*ua-Ga)});1>ua&&requestAnimationFrame(ca)};ca()});wb(this,"zoomToBounds",({width:c,height:m,minX:M,minY:ca})=>{const {bounds:ua,camera:Ga}=this;let La=Math.min((ua.width-100)/c,(ua.height-100)/m);La=Math.min(1,Math.max(so.minZoom,Ga.zoom===La||1>Ga.zoom?Math.min(1,La):La));c=yd.add([-M,-ca],[(ua.width-c*La)/2/La,(ua.height-m*La)/2/La]);this.animateCamera({point:c,zoom:La})});Cc(this)}get currentView(){const {bounds:c,
camera:{point:m,zoom:M}}=this,ca=c.width/M,ua=c.height/M;return{minX:-m[0],minY:-m[1],maxX:ca-m[0],maxY:ua-m[1],width:ca,height:ua}}},ul=so;wb(ul,"minZoom",.1);wb(ul,"maxZoom",4);wb(ul,"panMultiplier",.05);wb(ul,"panThreshold",100);pe([Rg],ul.prototype,"bounds",2);pe([Rg],ul.prototype,"camera",2);pe([Ag],ul.prototype,"updateBounds",2);pe([Ag],ul.prototype,"update",2);pe([$g],ul.prototype,"currentView",1);var Jz=class{constructor(c){wb(this,"app");wb(this,"editShape",m=>{(null==m?0:m.props.isLocked)||
this.app.transition("select").selectedTool.transition("editingShape",{shape:m});return this});wb(this,"hoverShape",m=>{this.app.setHoveredShape(m);return this});wb(this,"createShapes",(...m)=>{this.app.createShapes(m);return this});wb(this,"updateShapes",(...m)=>{this.app.updateShapes(m);return this});wb(this,"deleteShapes",(...m)=>{this.app.deleteShapes(m.length?m:this.app.selectedShapesArray);return this});wb(this,"selectShapes",(...m)=>{this.app.setSelectedShapes(m);return this});wb(this,"deselectShapes",
(...m)=>{const M="string"===typeof m[0]?m:m.map(ca=>ca.id);this.app.setSelectedShapes(this.app.selectedShapesArray.filter(ca=>!M.includes(ca.id)));return this});wb(this,"flipHorizontal",(...m)=>{this.app.flipHorizontal(m);return this});wb(this,"flipVertical",(...m)=>{this.app.flipVertical(m);return this});wb(this,"selectAll",()=>{this.app.setSelectedShapes(this.app.currentPage.shapes.filter(m=>!this.app.shapesInGroups().includes(m)));return this});wb(this,"deselectAll",()=>{this.app.setSelectedShapes([]);
return this});wb(this,"zoomIn",()=>{this.app.viewport.zoomIn();return this});wb(this,"zoomOut",()=>{this.app.viewport.zoomOut();return this});wb(this,"resetZoom",()=>{this.app.viewport.resetZoom();return this});wb(this,"zoomToFit",()=>{var {shapes:m}=this.app.currentPage;if(0===m.length)return this;m=Me.getCommonBounds(m.map(M=>M.bounds));this.app.viewport.zoomToBounds(m);return this});wb(this,"cameraToCenter",()=>{var {shapes:m}=this.app.currentPage;if(0===m.length)return this;m=Me.getCommonBounds(m.map(M=>
M.bounds));this.app.viewport.update({point:ne.add(ne.neg(Me.getBoundsCenter(m)),[this.app.viewport.currentView.width/2,this.app.viewport.currentView.height/2])});return this});wb(this,"zoomToSelection",()=>{const {selectionBounds:m}=this.app;if(!m)return this;this.app.viewport.zoomToBounds(m);return this});wb(this,"resetZoomToCursor",()=>{this.app.viewport.animateCamera({zoom:1,point:ne.sub(this.app.inputs.originScreenPoint,this.app.inputs.originPoint)});return this});wb(this,"toggleGrid",()=>{const {settings:m}=
this.app;m.update({showGrid:!m.showGrid});return this});wb(this,"toggleSnapToGrid",()=>{const {settings:m}=this.app;m.update({snapToGrid:!m.snapToGrid});return this});wb(this,"togglePenMode",()=>{const {settings:m}=this.app;m.update({penMode:!m.penMode});return this});wb(this,"setColor",m=>{const {settings:M}=this.app;M.update({color:m});this.app.selectedShapesArray.forEach(ca=>{ca.props.isLocked||ca.update({fill:m,stroke:m})});this.app.persist();return this});wb(this,"setScaleLevel",m=>{const {settings:M}=
this.app;M.update({scaleLevel:m});this.app.selectedShapes.forEach(ca=>{ca.props.isLocked||ca.setScaleLevel(m)});this.app.persist();return this});wb(this,"undo",()=>{this.app.undo();return this});wb(this,"redo",()=>{this.app.redo();return this});wb(this,"persist",()=>{this.app.persist();return this});wb(this,"createNewLineBinding",(m,M)=>this.app.createNewLineBinding(m,M));wb(this,"clone",m=>{if(!this.app.readOnly&&1===this.app.selectedShapesArray.length&&Object.values(nb).some(Sc=>Sc===this.app.selectedShapesArray[0].type)){var M=
this.app.allSelectedShapesArray[0],ca=this.app.getShapeClass(M.type),{minX:ua,minY:Ga,maxX:La,maxY:fb,width:vb,height:Wb}=M.bounds,oc=[0,0];switch(m){case "down":oc=[ua,fb+100];break;case "up":oc=[ua,Ga-100-Wb];break;case "left":oc=[ua-100-vb,Ga];break;case "right":oc=[La+100,Ga]}var uc=new ca(ng(Gf({},M.serialized),{id:Re(),nonce:Date.now(),refs:[],label:"",point:oc}));this.app.history.pause();this.app.currentPage.addShapes(uc);this.app.createNewLineBinding(M,uc);this.app.history.resume();this.app.persist();
setTimeout(()=>this.editShape(uc))}});wb(this,"cloneShapes",({shapes:m,assets:M,bindings:ca,point:ua=[0,0]})=>{const Ga=Me.getCommonBounds(m.filter(vb=>"group"!==vb.type).map(vb=>{var Wb,oc,uc,Sc,kd,fd,xd,Jd,$c,hd,od,Kd,zd,Te,We,eg;return{minX:null!=(oc=null==(Wb=vb.point)?void 0:Wb[0])?oc:ua[0],minY:null!=(Sc=null==(uc=vb.point)?void 0:uc[1])?Sc:ua[1],width:null!=(fd=null==(kd=vb.size)?void 0:kd[0])?fd:4,height:null!=(Jd=null==(xd=vb.size)?void 0:xd[1])?Jd:4,maxX:(null!=(hd=null==($c=vb.point)?void 0:
$c[0])?hd:ua[0])+(null!=(Kd=null==(od=vb.size)?void 0:od[0])?Kd:4),maxY:(null!=(Te=null==(zd=vb.point)?void 0:zd[1])?Te:ua[1])+(null!=(eg=null==(We=vb.size)?void 0:We[1])?eg:4)}})),La=m.map(vb=>ng(Gf({},vb),{id:Re(),point:[ua[0]+vb.point[0]-Ga.minX,ua[1]+vb.point[1]-Ga.minY]}));La.forEach(vb=>{var Wb;vb.children&&0<(null==(Wb=vb.children)?void 0:Wb.length)&&(vb.children=vb.children.map(oc=>{var uc;return null==(uc=La[m.findIndex(Sc=>Sc.id===oc)])?void 0:uc.id}).filter(Hc))});const fb=[];La.flatMap(vb=>
{var Wb;return Object.values(null!=(Wb=vb.handles)?Wb:{})}).forEach(vb=>{if(vb.bindingId){var Wb=ca[vb.bindingId];if(Wb){var oc=m.findIndex(Sc=>Sc.id===Wb.fromId);const uc=m.findIndex(Sc=>Sc.id===Wb.toId);Wb&&-1!==oc&&-1!==uc?(oc=ng(Gf({},Wb),{id:Re(),fromId:La[oc].id,toId:La[uc].id}),fb.push(oc),vb.bindingId=oc.id):vb.bindingId=void 0}else console.warn("binding not found",vb.bindingId)}});M=M.filter(vb=>La.some(Wb=>Wb.assetId===vb.id));return{shapes:La,assets:M,bindings:fb}});wb(this,"getClonedShapesFromTldrString",
(m,M)=>{try{{var ca;const Wb=null==(ca=m.match(/<whiteboard-tldr>(.*)<\/whiteboard-tldr>/))?void 0:ca[1];if(Wb){try{var ua=JSON.parse(Wb)}catch(oc){ua=null}var Ga=ua}else Ga=void 0}m=Ga;if(!m)return null;const {shapes:La,bindings:fb,assets:vb}=m;return this.cloneShapes({shapes:La,bindings:fb,assets:vb,point:M})}catch(La){console.log(La)}return null});wb(this,"cloneShapesIntoCurrentPage",m=>{(m=this.cloneShapes(m))&&this.addClonedShapes(m);return this});wb(this,"addClonedShapes",m=>{const {shapes:M,
assets:ca,bindings:ua}=m;0<ca.length&&this.app.createAssets(ca);0<M.length&&this.app.createShapes(M);this.app.currentPage.updateBindings(Object.fromEntries(ua.map(Ga=>[Ga.id,Ga])));this.app.selectedTool.transition("idle");return this});wb(this,"addClonedShapesFromTldrString",(m,M)=>{(m=this.getClonedShapesFromTldrString(m,M))&&this.addClonedShapes(m);return this});wb(this,"doGroup",(m=this.app.allSelectedShapesArray)=>{if(!this.app.readOnly){this.app.history.pause();var M=[...m.filter(ca=>"group"===
ca.type),...m.map(ca=>this.app.getParentGroup(ca))].filter(Hc);this.app.currentPage.removeShapes(...M);m=m.filter(ca=>"group"!==ca.type);1<m.length&&(M=this.app.getShapeClass("group"),M=new M({id:Re(),type:M.id,parentId:this.app.currentPage.id,children:m.map(ca=>ca.id)}),this.app.currentPage.addShapes(M),this.app.setSelectedShapes([M]),m.push(M),this.app.bringForward(m));this.app.history.resume();this.app.persist(this.app.currentPage.persistInfo)}});wb(this,"unGroup",(m=this.app.allSelectedShapesArray)=>
{if(!this.app.readOnly){m=[...m.filter(ca=>"group"===ca.type),...m.map(ca=>this.app.getParentGroup(ca))].filter(Hc);var M=this.app.shapesInGroups(m);0<m.length&&(this.app.currentPage.removeShapes(...m),this.app.persist(),this.app.setSelectedShapes(M))}});wb(this,"convertShapes",(m,M=this.app.allSelectedShapesArray)=>{const ca=this.app.getShapeClass(m);this.app.currentPage.removeShapes(...M);M=M.map(ua=>new ca(ng(Gf({},ua.serialized),{type:m,nonce:Date.now()})));this.app.currentPage.addShapes(...M);
this.app.persist();this.app.setSelectedShapes(M)});wb(this,"setCollapsed",(m,M=this.app.allSelectedShapesArray)=>{M.forEach(ca=>{"logseq-portal"===ca.props.type&&ca.setCollapsed(m)});this.app.persist()});this.app=c}},qp=class{constructor(){wb(this,"cursor","default");wb(this,"rotation",0);wb(this,"reset",()=>{this.cursor="default"});wb(this,"setCursor",(c,m=0)=>{if(c!==this.cursor||m!==this.rotation)this.cursor=c,this.rotation=m});wb(this,"setRotation",c=>{c!==this.rotation&&(this.rotation=c)});Cc(this)}};
pe([Rg],qp.prototype,"cursor",2);pe([Rg],qp.prototype,"rotation",2);pe([Ag],qp.prototype,"reset",2);pe([Ag],qp.prototype,"setCursor",2);pe([Ag],qp.prototype,"setRotation",2);var rp=class{constructor(c){wb(this,"app");wb(this,"stack",[]);wb(this,"isPaused",!0);wb(this,"pause",()=>{this.isPaused||(this.isPaused=!0)});wb(this,"resume",()=>{this.isPaused&&(this.isPaused=!1)});wb(this,"persist",m=>{this.isPaused||this.creating||this.app.notify("persist",m)});wb(this,"undo",()=>{this.isPaused||"idle"===
this.app.selectedTool.currentState.id&&this.app.appUndo&&this.app.appUndo()});wb(this,"redo",()=>{this.isPaused||"idle"===this.app.selectedTool.currentState.id&&this.app.appRedo&&this.app.appRedo()});wb(this,"instantiateShape",m=>new (this.app.getShapeClass(m.type))(m));wb(this,"deserialize",m=>{tc(()=>{var M,{pages:ca}=m;const ua=this.isPaused;this.pause();const Ga=[...this.app.selectedIds];try{const La=new Map(this.app.pages),fb=[];for(const vb of ca){const Wb=La.get(vb.id);if(void 0!==Wb){const oc=
new Map(Wb.shapes.map(uc=>[uc.props.id,uc]));ca=[];for(const uc of vb.shapes){const Sc=oc.get(uc.id);void 0!==Sc?(Sc.nonce!==uc.nonce&&(Sc.update(uc,!0),Sc.nonce=uc.nonce,Sc.setLastSerialized(uc)),oc.delete(uc.id)):ca.push(this.instantiateShape(uc))}0<oc.size&&!this.app.selectedTool.isInAny("creating","editingShape")&&Wb.removeShapes(...oc.values());0<ca.length&&Wb.addShapes(...ca);La.delete(vb.id);Wb.updateBindings(vb.bindings);Wb.nonce=null!=(M=vb.nonce)?M:0}else{const {id:oc,name:uc,shapes:Sc,
bindings:kd,nonce:fd}=vb;fb.push(new Pj(this.app,{id:oc,name:uc,nonce:fd,bindings:kd,shapes:Sc.map(xd=>this.instantiateShape(xd))}))}}0<fb.length&&this.app.addPages(fb);0<La.size&&this.app.removePages(Array.from(La.values()));this.app.setSelectedShapes(Ga).setErasingShapes([])}catch(La){console.warn(La)}ua||this.resume()})});this.app=c;Cc(this)}get creating(){return"creating"===this.app.selectedTool.currentState.id}};pe([Rg],rp.prototype,"stack",2);pe([Ag],rp.prototype,"persist",2);pe([Ag],rp.prototype,
"undo",2);pe([Ag],rp.prototype,"redo",2);pe([Ag],rp.prototype,"deserialize",2);var nn=class{constructor(){wb(this,"mode","light");wb(this,"showGrid",!0);wb(this,"snapToGrid",!1);wb(this,"penMode",!1);wb(this,"scaleLevel","md");wb(this,"color","");Cc(this)}update(c){Object.assign(this,c)}};pe([Rg],nn.prototype,"mode",2);pe([Rg],nn.prototype,"showGrid",2);pe([Rg],nn.prototype,"snapToGrid",2);pe([Rg],nn.prototype,"penMode",2);pe([Rg],nn.prototype,"scaleLevel",2);pe([Rg],nn.prototype,"color",2);pe([Ag],
nn.prototype,"update",1);var nh=class extends np{constructor(c,m,M,ca){var ua,Ga;super();wb(this,"uuid",Re());wb(this,"readOnly");wb(this,"api");wb(this,"inputs",new dj);wb(this,"cursors",new qp);wb(this,"viewport",new ul);wb(this,"settings",new nn);wb(this,"Tools",[]);wb(this,"history",new rp(this));wb(this,"persist",this.history.persist);wb(this,"undo",this.history.undo);wb(this,"redo",this.history.redo);wb(this,"saving",!1);wb(this,"saveState",()=>{this.history.isPaused||(this.saving=!0,requestAnimationFrame(()=>
{this.saving&&(this.persist(),this.saving=!1)}))});wb(this,"load",()=>{this.notify("load",null);return this});wb(this,"save",()=>{this.notify("save",null);return this});wb(this,"pages",new Map([["page",new Pj(this,{id:"page",name:"page",shapes:[],bindings:{}})]]));wb(this,"getPageById",La=>{const fb=this.pages.get(La);if(!fb)throw Error(`Could not find a page named ${La}.`);return fb});wb(this,"getShapeById",(La,fb=this.currentPage.id)=>{var vb;return null==(vb=this.getPageById(fb))?void 0:vb.shapesById[La]});
wb(this,"createShapes",La=>{if(this.readOnly)return this;(La=this.currentPage.addShapes(...La))&&this.notify("create-shapes",La);this.persist();return this});wb(this,"updateShapes",La=>{if(this.readOnly)return this;La.forEach(fb=>{const vb=this.getShapeById(fb.id);null==vb?void 0:vb.update(fb);fb.type!==(null==vb?void 0:vb.type)&&this.api.convertShapes(fb.type,[vb])});this.persist();return this});wb(this,"deleteShapes",La=>{if(0===La.length||this.readOnly)return this;La=La.map(oc=>"string"===typeof oc?
this.getShapeById(oc):oc).filter(Hc).filter(oc=>!oc.props.isLocked);const fb=this.shapesInGroups(La);La.forEach(oc=>{this.getParentGroup(oc)&&fb.push(oc)});let vb=new Set([...La,...fb].map(oc=>oc.id));fb.forEach(oc=>{var uc;const Sc=this.getParentGroup(oc);if(Sc){const kd=null==(uc=Sc.props.children)?void 0:uc.filter(fd=>fd!==oc.id);!kd||1>=(null==kd?void 0:kd.length)?vb.add(Sc.id):Sc.update({children:kd})}});const Wb=(oc,uc)=>{var Sc;[...vb].includes(oc)&&"line"===(null==(Sc=this.getShapeById(uc))?
void 0:Sc.type)&&vb.add(uc)};this.currentPage.shapes.filter(oc=>!oc.props.isLocked).flatMap(oc=>{var uc;return Object.values(null!=(uc=oc.props.handles)?uc:{})}).flatMap(oc=>oc.bindingId).filter(Hc).map(oc=>{var uc,Sc;const kd=null==(uc=this.currentPage.bindings[oc])?void 0:uc.toId;oc=null==(Sc=this.currentPage.bindings[oc])?void 0:Sc.fromId;kd&&oc&&(Wb(kd,oc),Wb(oc,kd))});La=[...vb].map(oc=>this.getShapeById(oc));this.setSelectedShapes(this.selectedShapesArray.filter(oc=>!vb.has(oc.id)));(La=this.currentPage.removeShapes(...La))&&
this.notify("delete-shapes",La);this.persist();return this});wb(this,"bringForward",(La=this.selectedShapesArray)=>{0<La.length&&!this.readOnly&&this.currentPage.bringForward(La);return this});wb(this,"sendBackward",(La=this.selectedShapesArray)=>{0<La.length&&!this.readOnly&&this.currentPage.sendBackward(La);return this});wb(this,"sendToBack",(La=this.selectedShapesArray)=>{0<La.length&&!this.readOnly&&this.currentPage.sendToBack(La);return this});wb(this,"bringToFront",(La=this.selectedShapesArray)=>
{0<La.length&&!this.readOnly&&this.currentPage.bringToFront(La);return this});wb(this,"flipHorizontal",(La=this.selectedShapesArray)=>{this.currentPage.flip(La,"horizontal");return this});wb(this,"flipVertical",(La=this.selectedShapesArray)=>{this.currentPage.flip(La,"vertical");return this});wb(this,"align",(La,fb=this.selectedShapesArray)=>{if(2>fb.length||this.readOnly)return this;const vb=fb.map(kd=>{const fd=kd.getBounds();return{id:kd.id,point:[fd.minX,fd.minY],bounds:fd}}),Wb=Me.getCommonBounds(vb.map(({bounds:kd})=>
kd)),oc=Wb.minX+Wb.width/2,uc=Wb.minY+Wb.height/2,Sc=Object.fromEntries(vb.map(({id:kd,point:fd,bounds:xd})=>[kd,{prev:fd,next:{top:[fd[0],Wb.minY],centerVertical:[fd[0],uc-xd.height/2],bottom:[fd[0],Wb.maxY-xd.height],left:[Wb.minX,fd[1]],centerHorizontal:[oc-xd.width/2,fd[1]],right:[Wb.maxX-xd.width,fd[1]]}[La]}]));fb.forEach(kd=>{Sc[kd.id]&&kd.update({point:Sc[kd.id].next})});this.persist();return this});wb(this,"distribute",(La,fb=this.selectedShapesArray)=>{if(2>fb.length||this.readOnly)return this;
const vb=Object.fromEntries(Me.getDistributions(fb,La).map(Wb=>[Wb.id,Wb]));fb.forEach(Wb=>{vb[Wb.id]&&Wb.update({point:vb[Wb.id].next})});this.persist();return this});wb(this,"packIntoRectangle",(La=this.selectedShapesArray)=>{if(2>La.length||this.readOnly)return this;const fb=Object.fromEntries(Me.getPackedDistributions(La).map(vb=>[vb.id,vb]));La.forEach(vb=>{fb[vb.id]&&vb.update({point:fb[vb.id].next})});this.persist();return this});wb(this,"setLocked",La=>{if(0===this.selectedShapesArray.length||
this.readOnly)return this;this.selectedShapesArray.forEach(fb=>{fb.update({isLocked:La})});this.persist();return this});wb(this,"assets",{});wb(this,"removeUnusedAssets",()=>{const La=this.getCleanUpAssets();Object.keys(this.assets).forEach(fb=>{La.some(vb=>vb.id===fb)||delete this.assets[fb]});this.persist();return this});wb(this,"copy",()=>{if(0<this.selectedShapesArray.length&&!this.editingShape){const fb=this.allSelectedShapesArray;var La=JSON.stringify({shapes:fb.map(Wb=>Wb.serialized),assets:this.getCleanUpAssets().filter(Wb=>
fb.some(oc=>oc.props.assetId===Wb.id)),bindings:Ab(this.currentPage.bindings)});La=encodeURIComponent(`<whiteboard-tldr>${La}</whiteboard-tldr>`);const vb=this.selectedShapesArray.map(Wb=>`((${Wb.props.id}))`).join(" ");this.notify("copy",{text:vb,html:La})}});wb(this,"paste",(La,fb)=>{var vb;this.editingShape||this.readOnly||this.notify("paste",{point:this.inputs.currentPoint,shiftKey:!!fb,dataTransfer:null!=(vb=null==La?void 0:La.clipboardData)?vb:void 0})});wb(this,"cut",()=>{this.copy();this.api.deleteShapes()});
wb(this,"drop",(La,fb)=>{this.notify("drop",{dataTransfer:La,point:fb?this.viewport.getPagePoint(fb):Me.getBoundsCenter(this.viewport.currentView)})});wb(this,"selectTool",(La,fb={})=>{this.readOnly&&!["select","move"].includes(La)||this.transition(La,fb)});wb(this,"editingId");wb(this,"setEditingShape",La=>{this.editingId="string"===typeof La?La:null==La?void 0:La.id;return this});wb(this,"clearEditingState",()=>{this.selectedTool.transition("idle");return this.setEditingShape()});wb(this,"hoveredId");
wb(this,"setHoveredShape",La=>{this.hoveredId="string"===typeof La?La:null==La?void 0:La.id;return this});wb(this,"selectedIds",new Set);wb(this,"selectedShapes",new Set);wb(this,"selectionRotation",0);wb(this,"setSelectedShapes",La=>{var fb;const {selectedIds:vb,selectedShapes:Wb}=this;vb.clear();Wb.clear();La[0]&&"string"===typeof La[0]?La.forEach(uc=>vb.add(uc)):La.forEach(uc=>vb.add(uc.id));const oc=this.currentPage.shapes.filter(uc=>vb.has(uc.id));oc.forEach(uc=>Wb.add(uc));this.selectionRotation=
1===oc.length?null!=(fb=oc[0].props.rotation)?fb:0:0;0===La.length&&this.setEditingShape();return this});wb(this,"erasingIds",new Set);wb(this,"erasingShapes",new Set);wb(this,"setErasingShapes",La=>{const {erasingIds:fb,erasingShapes:vb}=this;fb.clear();vb.clear();La[0]&&"string"===typeof La[0]?La.forEach(Wb=>fb.add(Wb)):La.forEach(Wb=>fb.add(Wb.id));this.currentPage.shapes.filter(Wb=>fb.has(Wb.id)).forEach(Wb=>vb.add(Wb));return this});wb(this,"bindingIds");wb(this,"setBindingShapes",La=>{this.bindingIds=
La;return this});wb(this,"clearBindingShape",()=>this.setBindingShapes());wb(this,"createNewLineBinding",(La,fb)=>{La="string"===typeof La?this.getShapeById(La):La;fb="string"===typeof fb?this.getShapeById(fb):fb;if((null==La?0:La.canBind)&&(null==fb?0:fb.canBind)&&(fb=sd(La,fb))){const [vb,Wb]=fb;this.createShapes([vb]);this.currentPage.updateBindings(Object.fromEntries(Wb.map(oc=>[oc.id,oc])));this.persist();return!0}return!1});wb(this,"brush");wb(this,"setBrush",La=>{this.brush=La;return this});
wb(this,"setCamera",(La,fb)=>{this.viewport.update({point:La,zoom:fb});return this});wb(this,"getPagePoint",La=>{const {camera:fb}=this.viewport;return yd.sub(yd.div(La,fb.zoom),fb.point)});wb(this,"getScreenPoint",La=>{const {camera:fb}=this.viewport;return yd.mul(yd.add(La,fb.point),fb.zoom)});wb(this,"Shapes",new Map);wb(this,"registerShapes",La=>{La.forEach(fb=>{if("group"===fb.id){const vb=this;fb.prototype.getShapes=function(){var Wb,oc;return null!=(oc=null==(Wb=this.props.children)?void 0:
Wb.map(uc=>vb.getShapeById(uc)).filter(Boolean))?oc:[]}}return this.Shapes.set(fb.id,fb)})});wb(this,"deregisterShapes",La=>{La.forEach(fb=>this.Shapes.delete(fb.id))});wb(this,"getShapeClass",La=>{if(!La)throw Error("No shape type provided.");const fb=this.Shapes.get(La);if(!fb)throw Error(`Could not find shape class for ${La}`);return fb});wb(this,"wrapUpdate",La=>{tc(()=>{const fb=!this.history.isPaused;fb&&this.history.pause();La();fb&&(this.history.resume(),this.persist())})});wb(this,"subscriptions",
new Set([]));wb(this,"subscribe",(La,fb)=>{if(void 0===fb)throw Error("Callback is required.");const vb={event:La,callback:fb};this.subscriptions.add(vb);return()=>this.unsubscribe(vb)});wb(this,"unsubscribe",La=>{this.subscriptions.delete(La);return this});wb(this,"notify",(La,fb)=>{this.subscriptions.forEach(vb=>{vb.event===La&&vb.callback(this,fb)});return this});wb(this,"onTransition",()=>{});wb(this,"onPointerDown",(La,fb)=>{if(!this.editingShape&&1===fb.button&&!this.isIn("move"))this.temporaryTransitionToMove(fb);
else if(2===fb.button&&!this.editingShape)fb.preventDefault(),this.transition("select");else if("clientX"in fb)this.inputs.onPointerDown([...this.viewport.getPagePoint([fb.clientX,fb.clientY]),fb.pressure],fb)});wb(this,"onPointerUp",(La,fb)=>{if(!this.editingShape&&1===fb.button&&this.isIn("move"))this.selectedTool.transition("idle",{exit:!0}),fb.stopPropagation(),fb.preventDefault();else if("clientX"in fb)this.inputs.onPointerUp([...this.viewport.getPagePoint([fb.clientX,fb.clientY]),fb.pressure],
fb)});wb(this,"onPointerMove",(La,fb)=>{if("clientX"in fb)this.inputs.onPointerMove([...this.viewport.getPagePoint([fb.clientX,fb.clientY]),fb.pressure],fb)});wb(this,"onKeyDown",(La,fb)=>{if(this.editingShape||" "!==fb.key||this.isIn("move"))this.inputs.onKeyDown(fb);else this.temporaryTransitionToMove(fb)});wb(this,"onKeyUp",(La,fb)=>{if(!this.editingShape&&" "===fb.key&&this.isIn("move"))this.selectedTool.transition("idle",{exit:!0}),fb.stopPropagation(),fb.preventDefault();else this.inputs.onKeyUp(fb)});
wb(this,"onPinchStart",(La,fb)=>{this.inputs.onPinchStart([...this.viewport.getPagePoint(La.point),.5],fb)});wb(this,"onPinch",(La,fb)=>{this.inputs.onPinch([...this.viewport.getPagePoint(La.point),.5],fb)});wb(this,"onPinchEnd",(La,fb)=>{this.inputs.onPinchEnd([...this.viewport.getPagePoint(La.point),.5],fb)});this._states=[op,pp];this.readOnly=ca;this.history.pause();this.states&&0<this.states.length&&(this.registerStates(this.states),ca=null!=(ua=this.initial)?ua:this.states[0].id,ua=this.children.get(ca))&&
(this.currentState=ua,null==(Ga=this.currentState)?void 0:Ga._events.onEnter({fromId:"initial"}));m&&this.registerShapes(m);M&&this.registerTools(M);this.history.resume();c&&this.history.deserialize(c);this.api=new Jz(this);Cc(this);this.notify("mount",null)}loadDocumentModel(c){this.history.deserialize(c);c.assets&&0<c.assets.length&&this.addAssets(c.assets);return this}get serialized(){return{}}get currentPageId(){return this.pages.keys().next().value}get currentPage(){return this.getPageById(this.currentPageId)}addPages(c){c.forEach(m=>
this.pages.set(m.id,m));this.persist();return this}removePages(c){c.forEach(m=>this.pages.delete(m.id));this.persist();return this}shapesInGroups(c=this.shapes){return c.flatMap(m=>m.props.children).filter(Hc).map(m=>this.getShapeById(m)).filter(Hc)}getParentGroup(c){return this.shapes.find(m=>{var M;return null==(M=m.props.children)?void 0:M.includes(c.id)})}addAssets(c){c.forEach(m=>this.assets[m.id]=m);return this}removeAssets(c){"string"===typeof c[0]?c.forEach(m=>delete this.assets[m]):c.forEach(m=>
delete this.assets[m.id]);this.persist();return this}getCleanUpAssets(){const c=new Set;this.pages.forEach(m=>m.shapes.forEach(M=>{M.props.assetId&&this.assets[M.props.assetId]&&c.add(this.assets[M.props.assetId])}));return Array.from(c)}createAssets(c){this.addAssets(c);this.notify("create-assets",{assets:c});this.persist();return this}get selectedTool(){return this.currentState}registerTools(c){this.Tools=c;return this.registerStates(c)}get editingShape(){const {editingId:c,currentPage:m}=this;
return c?m.shapes.find(M=>M.id===c):void 0}get hoveredShape(){const {hoveredId:c,currentPage:m}=this;return c?m.shapes.find(M=>M.id===c):void 0}get hoveredGroup(){const {hoveredShape:c}=this;return c?this.shapes.find(m=>{var M;return"group"===m.type&&(null==(M=m.props.children)?void 0:M.includes(c.id))}):void 0}get selectedShapesArray(){const {selectedShapes:c,selectedTool:m}=this;return"select"!==m.id?[]:Array.from(c.values())}get allSelectedShapes(){return new Set(this.allSelectedShapesArray)}get allSelectedShapesArray(){const {selectedShapesArray:c}=
this;return[...(new Set([...c,...this.shapesInGroups(c)]))]}setSelectionRotation(c){this.selectionRotation=c}get erasingShapesArray(){return Array.from(this.erasingShapes.values())}get bindingShapes(){var c;const m=1===this.selectedShapesArray.length?this.selectedShapesArray.flatMap(ca=>{var ua;return Object.values(null!=(ua=ca.props.handles)?ua:{})}).flatMap(ca=>ca.bindingId).filter(Hc).flatMap(ca=>{var ua,Ga;return[null==(ua=this.currentPage.bindings[ca])?void 0:ua.fromId,null==(Ga=this.currentPage.bindings[ca])?
void 0:Ga.toId]}).filter(Hc):[],M=[...(null!=(c=this.bindingIds)?c:[]),...m];return M?this.currentPage.shapes.filter(ca=>null==M?void 0:M.includes(ca.id)):void 0}get currentGrid(){const {zoom:c}=this.viewport.camera;return.15>c?128:1>c?32:8}get shapes(){const {currentPage:{shapes:c}}=this;return Array.from(c.values())}get shapesInViewport(){const {selectedShapes:c,currentPage:m,viewport:{currentView:M}}=this;return m.shapes.filter(ca=>!ca.canUnmount||c.has(ca)||Me.boundsContain(M,ca.rotatedBounds)||
Me.boundsCollide(M,ca.rotatedBounds))}get selectionDirectionHint(){const {selectionBounds:c,viewport:{currentView:m}}=this;if(c&&!Me.boundsContain(m,c)&&!Me.boundsCollide(m,c)){var M=Me.getBoundsCenter(c);return yd.clampV([(M[0]-m.minX-m.width/2)/m.width,(M[1]-m.minY-m.height/2)/m.height],-1,1)}}get selectionBounds(){const {selectedShapesArray:c}=this;if(0!==c.length)return 1===c.length?ng(Gf({},c[0].bounds),{rotation:c[0].props.rotation}):Me.getCommonBounds(this.selectedShapesArray.map(m=>m.rotatedBounds))}get showSelection(){var c;
const {selectedShapesArray:m}=this;return this.isIn("select")&&!this.isInAny("select.translating","select.pinching","select.rotating")&&(1===m.length&&!(null==(c=m[0])?0:c.hideSelection)||1<m.length)}get showSelectionDetail(){return this.isIn("select")&&!this.isInAny("select.translating","select.pinching")&&0<this.selectedShapes.size&&!this.selectedShapesArray.every(c=>c.hideSelectionDetail)&&!1}get showSelectionRotation(){return this.showSelectionDetail&&this.isInAny("select.rotating","select.pointingRotateHandle")}get showContextBar(){const {selectedShapesArray:c}=
this;return this.isInAny("select.idle","select.hoveringSelectionHandle")&&!this.isIn("select.contextMenu")&&0<c.length&&!this.readOnly&&!c.every(m=>m.hideContextBar)}get showRotateHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle","select.hoveringSelectionHandle","select.pointingRotateHandle","select.pointingResizeHandle")&&0<c.length&&!this.readOnly&&!c.some(m=>m.hideRotateHandle)}get showResizeHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle",
"select.hoveringSelectionHandle","select.pointingShape","select.pointingSelectedShape","select.pointingRotateHandle","select.pointingResizeHandle")&&1===c.length&&!this.readOnly&&!c.every(m=>m.hideResizeHandles)}get showCloneHandles(){const {selectedShapesArray:c}=this;return this.isInAny("select.idle","select.hoveringSelectionHandle","select.pointingShape","select.pointingSelectedShape")&&1===c.length&&Object.values(nb).some(m=>m===this.selectedShapesArray[0].type)&&!this.readOnly}temporaryTransitionToMove(c){c.stopPropagation();
c.preventDefault();this.transition("move",{prevTool:this.selectedTool});this.selectedTool.transition("idleHold")}};wb(nh,"id","app");wb(nh,"initial","select");pe([$g],nh.prototype,"serialized",1);pe([Rg],nh.prototype,"pages",2);pe([$g],nh.prototype,"currentPageId",1);pe([$g],nh.prototype,"currentPage",1);pe([Ag],nh.prototype,"addPages",1);pe([Ag],nh.prototype,"removePages",1);pe([Ag],nh.prototype,"createShapes",2);pe([Ag],nh.prototype,"updateShapes",2);pe([Ag],nh.prototype,"deleteShapes",2);pe([Rg],
nh.prototype,"assets",2);pe([Ag],nh.prototype,"addAssets",1);pe([Ag],nh.prototype,"removeAssets",1);pe([Ag],nh.prototype,"removeUnusedAssets",2);pe([$g],nh.prototype,"selectedTool",1);pe([Rg],nh.prototype,"editingId",2);pe([$g],nh.prototype,"editingShape",1);pe([Ag],nh.prototype,"setEditingShape",2);pe([Rg],nh.prototype,"hoveredId",2);pe([$g],nh.prototype,"hoveredShape",1);pe([$g],nh.prototype,"hoveredGroup",1);pe([Ag],nh.prototype,"setHoveredShape",2);pe([Rg],nh.prototype,"selectedIds",2);pe([Rg],
nh.prototype,"selectedShapes",2);pe([Rg],nh.prototype,"selectionRotation",2);pe([$g],nh.prototype,"selectedShapesArray",1);pe([$g],nh.prototype,"allSelectedShapes",1);pe([$g],nh.prototype,"allSelectedShapesArray",1);pe([Ag],nh.prototype,"setSelectedShapes",2);pe([Ag],nh.prototype,"setSelectionRotation",1);pe([Rg],nh.prototype,"erasingIds",2);pe([Rg],nh.prototype,"erasingShapes",2);pe([$g],nh.prototype,"erasingShapesArray",1);pe([Ag],nh.prototype,"setErasingShapes",2);pe([Rg],nh.prototype,"bindingIds",
2);pe([$g],nh.prototype,"bindingShapes",1);pe([Ag],nh.prototype,"setBindingShapes",2);pe([Ag],nh.prototype,"createNewLineBinding",2);pe([Rg],nh.prototype,"brush",2);pe([Ag],nh.prototype,"setBrush",2);pe([Ag],nh.prototype,"setCamera",2);pe([$g],nh.prototype,"currentGrid",1);pe([$g],nh.prototype,"shapes",1);pe([$g],nh.prototype,"shapesInViewport",1);pe([$g],nh.prototype,"selectionDirectionHint",1);pe([$g],nh.prototype,"selectionBounds",1);pe([$g],nh.prototype,"showSelection",1);pe([$g],nh.prototype,
"showSelectionDetail",1);pe([$g],nh.prototype,"showSelectionRotation",1);pe([$g],nh.prototype,"showContextBar",1);pe([$g],nh.prototype,"showRotateHandles",1);pe([$g],nh.prototype,"showResizeHandles",1);pe([$g],nh.prototype,"showCloneHandles",1);var Kz=Function.prototype.toString,jt=Object.create,Lz=Object.prototype.toString,Mz=function(){function c(){this._keys=[];this._values=[]}c.prototype.has=function(m){return!!~this._keys.indexOf(m)};c.prototype.get=function(m){return this._values[this._keys.indexOf(m)]};
c.prototype.set=function(m,M){this._keys.push(m);this._values.push(M)};return c}(),Nz="undefined"!==typeof WeakMap?De:he,Oz="g"===/test/g.flags?gf:Ff,Pz="undefined"!==typeof Symbol?rf:hf,Qz=Object.defineProperty,Rz=Object.getOwnPropertyDescriptor,qw=Object.getOwnPropertyNames,kt=Object.getOwnPropertySymbols,rw=Object.prototype,sw=rw.hasOwnProperty,Sz=rw.propertyIsEnumerable,tw="function"===typeof kt,Tz=tw?vg:qw,Uz=Array.isArray,lt=Object.assign,Vz=Object.getPrototypeOf,uw={array:function(c,m){var M=
new m.Constructor;m.cache.set(c,M);for(var ca=0,ua=c.length;ca<ua;++ca)M[ca]=m.copier(c[ca],m);return M},arrayBuffer:function(c,m){return c.slice(0)},blob:function(c,m){return c.slice(0,c.size,c.type)},dataView:function(c,m){return new m.Constructor(c.buffer.slice(0))},date:function(c,m){return new m.Constructor(c.getTime())},error:gh,map:Gg,object:tw?Hg:Vf,regExp:function(c,m){m=new m.Constructor(c.source,Oz(c));m.lastIndex=c.lastIndex;return m},set:Sh},Wz=lt({},uw,{array:function(c,m){var M=new m.Constructor;
m.cache.set(c,M);return Cg(c,M,m)},map:function(c,m){return Cg(c,Gg(c,m),m)},object:function(c,m){var M=Je(m.prototype);m.cache.set(c,M);return Cg(c,M,m)},set:function(c,m){return Cg(c,Sh(c,m),m)}});Xh(lt({},Wz,{}));var Xz=Xh({}),Yz=Qf(ba()),Zz=Qf(Ba()),to=Xz,Uk=class{static insertTextFirefox(c,m){c.setRangeText(m,c.selectionStart||0,c.selectionEnd||0,"end");c.dispatchEvent(new InputEvent("input",{data:m,inputType:"insertText",isComposing:!1}))}static insert(c,m){const M=c.ownerDocument,ca=M.activeElement;
ca!==c&&c.focus();M.execCommand("insertText",!1,m)||Uk.insertTextFirefox(c,m);ca===M.body?c.blur():ca instanceof HTMLElement&&ca!==c&&ca.focus()}static set(c,m){c.select();Uk.insert(c,m)}static getSelection(c){const {selectionStart:m,selectionEnd:M}=c;return c.value.slice(m?m:void 0,M?M:void 0)}static wrapSelection(c,m,M){const {selectionStart:ca,selectionEnd:ua}=c,Ga=Uk.getSelection(c);Uk.insert(c,m+Ga+(null!=M?M:m));c.selectionStart=(ca||0)+m.length;c.selectionEnd=(ua||0)+m.length}static replace(c,
m,M){let ca=0;c.value.replace(m,(...ua)=>{const Ga=ca+ua[ua.length-2],La=ua[0].length;c.selectionStart=Ga;c.selectionEnd=Ga+La;ua="string"===typeof M?M:M(...ua);Uk.insert(c,ua);c.selectionStart=Ga;ca+=ua.length-La;return ua})}static findLineEnd(c,m){const M=c.lastIndexOf("\n",m-1)+1;return"\t"!==c.charAt(M)?m:M+1}static indent(c){var m;const {selectionStart:M,selectionEnd:ca,value:ua}=c;var Ga=ua.slice(M,ca);if((Ga=null==(m=/\n/g.exec(Ga))?void 0:m.length)&&0<Ga){m=ua.lastIndexOf("\n",M-1)+1;var La=
c.value.slice(m,ca-1);Ga=La.replace(/^|\n/g,`$&${Uk.INDENT}`);La=Ga.length-La.length;c.setSelectionRange(m,ca-1);Uk.insert(c,Ga);c.setSelectionRange(M+1,ca+La)}else Uk.insert(c,Uk.INDENT)}static unindent(c){const {selectionStart:m,selectionEnd:M,value:ca}=c;var ua=ca.lastIndexOf("\n",m-1)+1;const Ga=Uk.findLineEnd(ca,M);var La=c.value.slice(ua,Ga);const fb=La.replace(/(^|\n)(\t| {1,2})/g,"$1");La=La.length-fb.length;c.setSelectionRange(ua,Ga);Uk.insert(c,fb);ua=(ua=/\t| {1,2}/.exec(ca.slice(ua,m)))?
ua[0].length:0;c.setSelectionRange(m-ua,Math.max(m-ua,M-La))}static normalizeText(c){return c.replace(Uk.fixNewLines,"\n")}},sp=Uk;wb(sp,"fixNewLines",/\r?\n|\r/g);wb(sp,"INDENT","  ");var on;"undefined"!==typeof window&&(on=mg());var mt=new Map,vw=Ub()?"⌘":"ctrl",$z=class extends nh{},ww=Qf(ea(22)),aA=()=>{};/^((?!chrome|android).)*safari/i.test(navigator.userAgent);var xw=Qf(ea(22)),nt={},Hq=Qf(ea(22)),bA=c=>{for(c=c.parentElement;c&&c!==document.body;){const {overflowY:m}=window.getComputedStyle(c);
if(c.scrollHeight>c.clientHeight&&("auto"===m||"scroll"===m||"overlay"===m))return c;c=c.parentElement}return document},ot=Qf(ea(22)),pt=new Map,cA={accent:"var(--lx-accent-09, hsl(var(--primary)))",brushFill:"var(--ls-scrollbar-background-color, rgba(0, 0, 0, .05))",brushStroke:"var(--ls-scrollbar-thumb-hover-color, rgba(0, 0, 0, .05))",selectStroke:"var(--color-selectedStroke)",selectFill:"var(--color-selectedFill)",binding:"var(--color-binding, rgba(65, 132, 244, 0.5))",background:"var(--ls-primary-background-color, hsl(var(--background)))",
foreground:"var(--ls-primary-text-color, hsl(var(--foreground)))",grid:"var(--ls-quaternary-background-color, hsl(var(--secondary)))"},dA=((c,...m)=>c.reduce((M,ca,ua)=>M+ca+(ua<m.length?m[ua]:""),""))`
  .tl-container {
    --tl-zoom: 1;
    --tl-scale: calc(1 / var(--tl-zoom));
    --tl-padding: calc(64px / var(--tl-zoom));;
    --tl-shadow-color: 0deg 0% 0%;
    --tl-binding-distance: ${4}px;
    --tl-shadow-elevation-low: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0px 0.6px 0.8px -0.7px hsl(var(--tl-shadow-color) / 0.06),
      0.1px 1.2px 1.5px -1.4px hsl(var(--tl-shadow-color) / 0.08);
    --tl-shadow-elevation-medium: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0.1px 1.3px 1.7px -0.5px hsl(var(--tl-shadow-color) / 0.06),
      0.1px 2.8px 3.6px -1px hsl(var(--tl-shadow-color) / 0.07),
      0.3px 6.1px 7.8px -1.4px hsl(var(--tl-shadow-color) / 0.09);
    --tl-shadow-elevation-high: 0px 0.4px 0.5px hsl(var(--tl-shadow-color) / 0.04),
      0.1px 2.3px 3px -0.2px hsl(var(--tl-shadow-color) / 0.05),
      0.2px 4.1px 5.3px -0.5px hsl(var(--tl-shadow-color) / 0.06),
      0.4px 6.6px 8.5px -0.7px hsl(var(--tl-shadow-color) / 0.07),
      0.6px 10.3px 13.2px -1px hsl(var(--tl-shadow-color) / 0.08),
      0.9px 16px 20.6px -1.2px hsl(var(--tl-shadow-color) / 0.09),
      1.3px 24.3px 31.2px -1.4px hsl(var(--tl-shadow-color) / 0.1);
    box-sizing: border-box;
    position: relative;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    box-sizing: border-box;
    padding: 0px;
    margin: 0px;
    outline: none;
    z-index: 100;
    user-select: none;
    touch-action: none;
    overscroll-behavior: none;
    background-color: var(--tl-background);
    cursor: inherit;
    box-sizing: border-box;
    color: var(--tl-foreground);
    -webkit-user-select: none;
    -webkit-user-drag: none;
  }

  .tl-overlay {
    background: none;
    fill: transparent;
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: none;
  }

  .tl-snap-line {
    stroke: var(--tl-accent);
    stroke-width: calc(1px * var(--tl-scale));
  }

  .tl-snap-point {
    stroke: var(--tl-accent);
    stroke-width: calc(1px * var(--tl-scale));
  }

  .tl-canvas {
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: all;
    overflow: clip;
    outline: none;
  }

  .tl-layer {
    position: absolute;
    top: 0px;
    left: 0px;
    height: 0px;
    width: 0px;
    contain: layout style size;
  }

  .tl-absolute {
    position: absolute;
    top: 0px;
    left: 0px;
    transform-origin: center center;
    contain: layout style size;
  }

  .tl-positioned {
    position: absolute;
    transform-origin: center center;
    pointer-events: none;
    display: flex;
    align-items: center;
    justify-content: center;
    contain: layout style size;
  }

  .tl-positioned-svg {
    width: 100%;
    height: 100%;
    overflow: hidden;
    contain: layout style size;
    pointer-events: none;
  }

  .tl-positioned-div {
    position: relative;
    width: 100%;
    height: 100%;
    padding: var(--tl-padding);
    contain: layout style size;
  }

  .tl-positioned-inner {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .tl-counter-scaled {
    transform: scale(var(--tl-scale));
  }

  .tl-dashed {
    stroke-dasharray: calc(2px * var(--tl-scale)), calc(2px * var(--tl-scale));
  }

  .tl-transparent {
    fill: transparent;
    stroke: transparent;
  }

  .tl-corner-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-rotate-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-clone-handle {
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-clone-handle:hover {
    fill: var(--tl-selectStroke);
    cursor: pointer;
  }

  .tl-clone-handle:hover line {
    stroke: var(--tl-background);
  }

  .tl-user {
    left: -4px;
    top: -4px;
    height: 8px;
    width: 8px;
    border-radius: 100%;
    pointer-events: none;
  }

  .tl-indicator {
    fill: transparent;
    stroke-width: calc(1.5px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-indicator-container {
    transform-origin: 0 0;
    fill: transparent;
    stroke-width: calc(1.5px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-user-indicator-bounds {
    border-style: solid;
    border-width: calc(1px * var(--tl-scale));
  }

  .tl-selected {
    stroke: var(--tl-selectStroke);
  }

  .tl-hovered {
    stroke: var(--tl-selectStroke);
  }

  .tl-clone-target {
    pointer-events: all;
  }

  .tl-clone-target:hover .tl-clone-button {
    opacity: 1;
  }

  .tl-clone-button-target {
    cursor: pointer;
    pointer-events: all;
  }

  .tl-clone-button-target:hover .tl-clone-button {
    fill: var(--tl-selectStroke);
  }

  .tl-clone-button {
    opacity: 0;
    r: calc(8px * var(--tl-scale));
    stroke-width: calc(1.5px * var(--tl-scale));
    stroke: var(--tl-selectStroke);
    fill: var(--tl-background);
  }

  .tl-bounds {
    pointer-events: none;
    contain: layout style size;
  }

  .tl-bounds-bg {
    stroke: none;
    fill: var(--tl-selectFill);
    pointer-events: all;
    contain: layout style size;
  }

  .tl-bounds-fg {
    fill: transparent;
    stroke: var(--tl-selectStroke);
    stroke-width: calc(1.5px * var(--tl-scale));
  }

  .tl-brush {
    fill: var(--tl-brushFill);
    stroke: var(--tl-brushStroke);
    stroke-width: calc(1px * var(--tl-scale));
    pointer-events: none;
  }

  .tl-dot {
    fill: var(--tl-background);
    stroke: var(--tl-foreground);
    stroke-width: 2px;
  }

  .tl-handle {
    fill: var(--tl-background);
    stroke: var(--tl-selectStroke);
    stroke-width: 1.5px;
    pointer-events: none;
  }

  .tl-handle-bg {
    fill: transparent;
    stroke: none;
    r: calc(16px / max(1, var(--tl-zoom)));
    pointer-events: all;
    cursor: grab;
  }

  .tl-handle-bg:active {
    pointer-events: all;
    fill: none;
  }

  .tl-handle-bg:hover {
    cursor: grab;
    fill: var(--tl-selectFill);
  }

  .tl-binding-indicator {
    fill: transparent;
    stroke: var(--tl-binding);
  }

  .tl-centered {
    display: grid;
    place-content: center;
    place-items: center;
  }

  .tl-centered > * {
    grid-column: 1;
    grid-row: 1;
  }

  .tl-centered-g {
    transform: translate(var(--tl-padding), var(--tl-padding));
  }

  .tl-current-parent > *[data-shy='true'] {
    opacity: 1;
  }

  .tl-binding {
    fill: none;
    stroke: var(--tl-selectStroke);
    stroke-width: calc(2px * var(--tl-scale));
  }

  .tl-counter-scaled-positioned {
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
    padding: 0;
    contain: layout style size;
  }

  .tl-fade-in {
    opacity: 1;
    transition-timing-function: ease-in-out;
    transition-property: opacity;
    transition-duration: 0.12s;
    transition-delay: 0;
  }

  .tl-fade-out {
    opacity: 0;
    transition-timing-function: ease-out;
    transition-property: opacity;
    transition-duration: 0.12s;
    transition-delay: 0;
  }

  .tl-counter-scaled-positioned > .tl-positioned-div {
    user-select: none;
    padding: 64px;
  }

  .tl-context-bar > * {
    grid-column: 1;
    grid-row: 1;
  }

  .tl-bounds-detail {
    padding: 2px 3px;
    border-radius: 1px;
    white-space: nowrap;
    width: fit-content;
    text-align: center;
    font-size: 12px;
    font-weight: 500;
    background-color: var(--tl-selectStroke);
    color: var(--tl-background);
  }

  .tl-grid-canvas {
    position: absolute;
    touch-action: none;
    pointer-events: none;
    user-select: none;
  }

  .tl-grid {
    position: absolute;
    width: 100%;
    height: 100%;
    touch-action: none;
    pointer-events: none;
    user-select: none;
  }

  .tl-grid-dot {
    fill: var(--tl-grid);
  }

  .tl-html-canvas {
    position: absolute;
    top: 0px;
    left: 0px;
    width: 100%;
    height: 100%;
    zindex: 20000;
    pointer-events: none;
    border: 2px solid red;
  }

  .tl-direction-indicator {
    z-index: 100000;
    position: absolute;
    top: 0px;
    left: 0px;
    fill: var(--tl-selectStroke);
  }
`,yw=Qf(ea(22)),zw=Qf(ea(22)),qt={},ej={toVector(c,m){void 0===c&&(c=m);return Array.isArray(c)?c:[c,c]},add(c,m){return[c[0]+m[0],c[1]+m[1]]},sub(c,m){return[c[0]-m[0],c[1]-m[1]]},addTo(c,m){c[0]+=m[0];c[1]+=m[1]},subTo(c,m){c[0]-=m[0];c[1]-=m[1]}},Aw={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}},eA=["enter","leave"],fA=["gotpointercapture","lostpointercapture"],
Bw=class{constructor(c,m,M){this.ctrl=c;this.args=m;this.key=M;this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(c){this.ctrl.state[this.key]=c}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const {state:c,
shared:m,ingKey:M,args:ca}=this;m[M]=c._active=c.active=c._blocked=c._force=!1;c._step=[!1,!1];c.intentional=!1;c._movement=[0,0];c._distance=[0,0];c._direction=[0,0];c._delta=[0,0];c._bounds=[[-Infinity,Infinity],[-Infinity,Infinity]];c.args=ca;c.axis=void 0;c.memo=void 0;c.elapsedTime=0;c.direction=[0,0];c.distance=[0,0];c.overflow=[0,0];c._movementBound=[!1,!1];c.velocity=[0,0];c.movement=[0,0];c.delta=[0,0];c.timeStamp=0}start(c){const m=this.state,M=this.config;m._active||(this.reset(),this.computeInitial(),
m._active=!0,m.target=c.target,m.currentTarget=c.currentTarget,m.lastOffset=M.from?Xe(M.from,m):m.offset,m.offset=m.lastOffset);m.startTime=m.timeStamp=c.timeStamp}computeValues(c){const m=this.state;m._values=c;m.values=this.config.transform(c)}computeInitial(){const c=this.state;c._initial=c._values;c.initial=c.values}compute(c){const {state:m,config:M,shared:ca}=this;m.args=this.args;var ua=0;if(c){m.event=c;M.preventDefault&&c.cancelable&&m.event.preventDefault();m.type=c.type;ca.touches=this.ctrl.pointerIds.size||
this.ctrl.touchIds.size;ca.locked=!!document.pointerLockElement;ua=Object;var Ga=ua.assign,La={};"buttons"in c&&(La.buttons=c.buttons);if("shiftKey"in c){const {shiftKey:Kd,altKey:zd,metaKey:Te,ctrlKey:We}=c;Object.assign(La,{shiftKey:Kd,altKey:zd,metaKey:Te,ctrlKey:We})}Ga.call(ua,ca,La);ca.down=ca.pressed=1===ca.buttons%2||0<ca.touches;ua=c.timeStamp-m.timeStamp;m.timeStamp=c.timeStamp;m.elapsedTime=m.timeStamp-m.startTime}m._active&&(Ga=m._delta.map(Math.abs),ej.addTo(m._distance,Ga));this.axisIntent&&
this.axisIntent(c);const [fb,vb]=m._movement,[Wb,oc]=M.threshold,{_step:uc,values:Sc}=m;M.hasCustomTransform?(!1===uc[0]&&(uc[0]=Math.abs(fb)>=Wb&&Sc[0]),!1===uc[1]&&(uc[1]=Math.abs(vb)>=oc&&Sc[1])):(!1===uc[0]&&(uc[0]=Math.abs(fb)>=Wb&&Math.sign(fb)*Wb),!1===uc[1]&&(uc[1]=Math.abs(vb)>=oc&&Math.sign(vb)*oc));m.intentional=!1!==uc[0]||!1!==uc[1];if(m.intentional){Ga=[0,0];if(M.hasCustomTransform){const [Kd,zd]=Sc;Ga[0]=!1!==uc[0]?Kd-uc[0]:0;Ga[1]=!1!==uc[1]?zd-uc[1]:0}else Ga[0]=!1!==uc[0]?fb-uc[0]:
0,Ga[1]=!1!==uc[1]?vb-uc[1]:0;this.restrictToAxis&&!m._blocked&&this.restrictToAxis(Ga);La=m.offset;var kd=m._active&&!m._blocked||m.active;kd&&(m.first=m._active&&!m.active,m.last=!m._active&&m.active,m.active=ca[this.ingKey]=m._active,c&&(m.first&&("bounds"in M&&(m._bounds=Xe(M.bounds,m)),this.setup&&this.setup()),m.movement=Ga,this.computeOffset()));var [fd,xd]=m.offset,[[Jd,$c],[hd,od]]=m._bounds;m.overflow=[fd<Jd?-1:fd>$c?1:0,xd<hd?-1:xd>od?1:0];m._movementBound[0]=m.overflow[0]?!1===m._movementBound[0]?
m._movement[0]:m._movementBound[0]:!1;m._movementBound[1]=m.overflow[1]?!1===m._movementBound[1]?m._movement[1]:m._movementBound[1]:!1;m.offset=Wf(m._bounds,m.offset,m._active?M.rubberband||[0,0]:[0,0]);m.delta=ej.sub(m.offset,La);this.computeMovement();kd&&(!m.last||32<ua)&&(m.delta=ej.sub(m.offset,La),c=m.delta.map(Math.abs),ej.addTo(m.distance,c),m.direction=m.delta.map(Math.sign),m._direction=m._delta.map(Math.sign),!m.first&&0<ua&&(m.velocity=[c[0]/ua,c[1]/ua]))}}emit(){const c=this.state;var m=
this.shared;const M=this.config;c._active||this.clean();if(!c._blocked&&c.intentional||c._force||M.triggerAllEvents)m=this.handler(Qc(Qc(Qc({},m),c),{},{[this.aliasKey]:c.values})),void 0!==m&&(c.memo=m)}clean(){this.eventStore.clean();this.timeoutStore.clean()}},Iq=class extends Bw{constructor(...c){super(...c);$b(this,"aliasKey","xy")}reset(){super.reset();this.state.axis=void 0}init(){this.state.offset=[0,0];this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=ej.add(this.state.lastOffset,
this.state.movement)}computeMovement(){this.state.movement=ej.sub(this.state.offset,this.state.lastOffset)}axisIntent(c){const m=this.state,M=this.config;!m.axis&&c&&(c="object"===typeof M.axisThreshold?M.axisThreshold[ie(c)]:M.axisThreshold,m.axis=ve(m._movement,c));m._blocked=(M.lockDirection||!!M.axis)&&!m.axis||!!M.axis&&M.axis!==m.axis}restrictToAxis(c){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case "x":c[1]=0;break;case "y":c[0]=0}}},gA=c=>c,Cw={enabled(c=!0){return c},
eventOptions(c,m,M){return Qc(Qc({},M.shared.eventOptions),c)},preventDefault(c=!1){return c},triggerAllEvents(c=!1){return c},rubberband(c=0){switch(c){case !0:return[.15,.15];case !1:return[0,0];default:return ej.toVector(c)}},from(c){if("function"===typeof c)return c;if(null!=c)return ej.toVector(c)},transform(c,m,M){c=c||M.shared.transform;this.hasCustomTransform=!!c;return c||gA},threshold(c){return ej.toVector(c,0)}},uo=Qc(Qc({},Cw),{},{axis(c,m,{axis:M}){this.lockDirection="lock"===M;if(!this.lockDirection)return M},
axisThreshold(c=0){return c},bounds(c={}){if("function"===typeof c)return Ga=>uo.bounds(c(Ga));if("current"in c)return()=>c.current;if("function"===typeof HTMLElement&&c instanceof HTMLElement)return c;const {left:m=-Infinity,right:M=Infinity,top:ca=-Infinity,bottom:ua=Infinity}=c;return[[m,M],[ca,ua]]}}),Dw={ArrowRight:(c=1)=>[10*c,0],ArrowLeft:(c=1)=>[-10*c,0],ArrowUp:(c=1)=>[0,-10*c],ArrowDown:(c=1)=>[0,10*c]},hA=class extends Iq{constructor(...c){super(...c);$b(this,"ingKey","dragging")}reset(){super.reset();
const c=this.state;c._pointerId=void 0;c._pointerActive=!1;c._keyboardActive=!1;c._preventScroll=!1;c._delayed=!1;c.swipe=[0,0];c.tap=!1;c.canceled=!1;c.cancel=this.cancel.bind(this)}setup(){const c=this.state;if(c._bounds instanceof HTMLElement){const m=c._bounds.getBoundingClientRect(),M=c.currentTarget.getBoundingClientRect();c._bounds=uo.bounds({left:m.left-M.left+c.offset[0],right:m.right-M.right+c.offset[0],top:m.top-M.top+c.offset[1],bottom:m.bottom-M.bottom+c.offset[1]})}}cancel(){const c=
this.state;c.canceled||(c.canceled=!0,c._active=!1,setTimeout(()=>{this.compute();this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean();this.state._pointerActive=!1;this.state._keyboardActive=!1;super.clean()}pointerDown(c){const m=this.config,M=this.state;if(null==c.buttons||(Array.isArray(m.pointerButtons)?m.pointerButtons.includes(c.buttons):-1===m.pointerButtons||m.pointerButtons===c.buttons)){var ca=this.ctrl.setEventIds(c);
m.pointerCapture&&c.target.setPointerCapture(c.pointerId);ca&&1<ca.size&&M._pointerActive||(this.start(c),this.setupPointer(c),M._pointerId=ke(c),M._pointerActive=!0,this.computeValues(je(c)),this.computeInitial(),m.preventScrollAxis&&"mouse"!==ie(c)?(M._active=!1,this.setupScrollPrevention(c)):0<m.delay?(this.setupDelayTrigger(c),m.triggerAllEvents&&(this.compute(c),this.emit())):this.startPointerDrag(c))}}startPointerDrag(c){const m=this.state;m._active=!0;m._preventScroll=!0;m._delayed=!1;this.compute(c);
this.emit()}pointerMove(c){const m=this.state,M=this.config;if(m._pointerActive&&(m.type!==c.type||c.timeStamp!==m.timeStamp)){var ca=ke(c);if(void 0===m._pointerId||ca===m._pointerId)ca=je(c),document.pointerLockElement===c.target?m._delta=[c.movementX,c.movementY]:(m._delta=ej.sub(ca,m._values),this.computeValues(ca)),ej.addTo(m._movement,m._delta),this.compute(c),m._delayed&&m.intentional?(this.timeoutStore.remove("dragDelay"),m.active=!1,this.startPointerDrag(c)):M.preventScrollAxis&&!m._preventScroll?
m.axis&&(m.axis===M.preventScrollAxis||"xy"===M.preventScrollAxis?(m._active=!1,this.clean()):(this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(c))):this.emit()}}pointerUp(c){this.ctrl.setEventIds(c);try{this.config.pointerCapture&&c.target.hasPointerCapture(c.pointerId)&&c.target.releasePointerCapture(c.pointerId)}catch(La){}const m=this.state,M=this.config;if(m._active&&m._pointerActive){var ca=ke(c);if(void 0===m._pointerId||ca===m._pointerId){this.state._pointerActive=!1;this.setActive();
this.compute(c);var [ua,Ga]=m._distance;m.tap=ua<=M.tapsThreshold&&Ga<=M.tapsThreshold;if(m.tap&&M.filterTaps)m._force=!0;else{const [La,fb]=m.direction,[vb,Wb]=m.velocity,[oc,uc]=m.movement,[Sc,kd]=M.swipe.velocity,[fd,xd]=M.swipe.distance;m.elapsedTime<M.swipe.duration&&(Math.abs(vb)>Sc&&Math.abs(oc)>fd&&(m.swipe[0]=La),Math.abs(Wb)>kd&&Math.abs(uc)>xd&&(m.swipe[1]=fb))}this.emit()}}}pointerClick(c){!this.state.tap&&0<c.detail&&(c.preventDefault(),c.stopPropagation())}setupPointer(c){const m=this.config,
M=m.device;m.pointerLock&&c.currentTarget.requestPointerLock();m.pointerCapture||(this.eventStore.add(this.sharedConfig.window,M,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,M,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,M,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(c){this.state._preventScroll&&c.cancelable&&
c.preventDefault()}setupScrollPrevention(c){this.state._preventScroll=!1;"persist"in c&&"function"===typeof c.persist&&c.persist();const m=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",m);this.eventStore.add(this.sharedConfig.window,"touch","cancel",m);this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,c)}setupDelayTrigger(c){this.state._delayed=
!0;this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0];this.startPointerDrag(c)},this.config.delay)}keyDown(c){const m=Dw[c.key];if(m){const M=this.state,ca=c.shiftKey?10:c.altKey?.1:1;this.start(c);M._delta=m(ca);M._keyboardActive=!0;ej.addTo(M._movement,M._delta);this.compute(c);this.emit()}}keyUp(c){c.key in Dw&&(this.state._keyboardActive=!1,this.setActive(),this.compute(c),this.emit())}bind(c){const m=this.config.device;c(m,"start",this.pointerDown.bind(this));this.config.pointerCapture&&
(c(m,"change",this.pointerMove.bind(this)),c(m,"end",this.pointerUp.bind(this)),c(m,"cancel",this.pointerUp.bind(this)),c("lostPointerCapture","",this.pointerUp.bind(this)));this.config.keys&&(c("key","down",this.keyDown.bind(this)),c("key","up",this.keyUp.bind(this)));this.config.filterTaps&&c("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}},vo="undefined"!==typeof window&&window.document&&window.document.createElement;try{var Ew="constructor"in GestureEvent}catch(c){Ew=!1}var iA=
Ew,Jq=vo&&"ontouchstart"in window||vo&&1<window.navigator.maxTouchPoints,Fw=vo&&"ontouchstart"in window||vo&&1<window.navigator.maxTouchPoints,Gw=vo&&"onpointerdown"in window,jA=vo&&"exitPointerLock"in window.document,Hw={mouse:0,touch:0,pen:8},kA=Qc(Qc({},uo),{},{device(c,m,{pointer:{touch:M=!1,lock:ca=!1,mouse:ua=!1}={}}){this.pointerLock=ca&&jA;return Jq&&M?"touch":this.pointerLock?"mouse":Gw&&!ua?"pointer":Jq?"touch":"mouse"},preventScrollAxis(c,m,{preventScroll:M}){this.preventScrollDelay="number"===
typeof M?M:M||void 0===M&&c?250:void 0;if(Fw&&!1!==M)return c?c:void 0!==M?"y":void 0},pointerCapture(c,m,{pointer:{capture:M=!0,buttons:ca=1,keys:ua=!0}={}}){this.pointerButtons=ca;this.keys=ua;return!this.pointerLock&&"pointer"===this.device&&M},threshold(c,m,{filterTaps:M=!1,tapsThreshold:ca=3,axis:ua}){c=ej.toVector(c,M?ca:ua?1:0);this.filterTaps=M;this.tapsThreshold=ca;return c},swipe({velocity:c=.5,distance:m=50,duration:M=250}={}){return{velocity:this.transform(ej.toVector(c)),distance:this.transform(ej.toVector(m)),
duration:M}},delay(c=0){switch(c){case !0:return 180;case !1:return 0;default:return c}},axisThreshold(c){return c?Qc(Qc({},Hw),c):Hw}}),lA=class extends Bw{constructor(...c){super(...c);$b(this,"ingKey","pinching");$b(this,"aliasKey","da")}init(){this.state.offset=[1,0];this.state.lastOffset=[1,0];this.state._pointerEvents=new Map}reset(){super.reset();const c=this.state;c._touchIds=[];c.canceled=!1;c.cancel=this.cancel.bind(this);c.turns=0}computeOffset(){const {type:c,movement:m,lastOffset:M}=
this.state;this.state.offset="wheel"===c?ej.add(m,M):[(1+m[0])*M[0],m[1]+M[1]]}computeMovement(){const {offset:c,lastOffset:m}=this.state;this.state.movement=[c[0]/m[0],c[1]-m[1]]}axisIntent(){const c=this.state,[m,M]=c._movement;if(!c.axis){const ca=30*Math.abs(m)-Math.abs(M);0>ca?c.axis="angle":0<ca&&(c.axis="scale")}}restrictToAxis(c){this.config.lockDirection&&("scale"===this.state.axis?c[1]=0:"angle"===this.state.axis&&(c[0]=0))}cancel(){const c=this.state;c.canceled||setTimeout(()=>{c.canceled=
!0;c._active=!1;this.compute();this.emit()},0)}touchStart(c){this.ctrl.setEventIds(c);var m=this.state;const M=this.ctrl.touchIds;m._active&&m._touchIds.every(ca=>M.has(ca))||2>M.size||(this.start(c),m._touchIds=Array.from(M).slice(0,2),m=de(c,m._touchIds),this.pinchStart(c,m))}pointerStart(c){if(null==c.buttons||1===c.buttons%2){this.ctrl.setEventIds(c);c.target.setPointerCapture(c.pointerId);var m=this.state,M=m._pointerEvents,ca=this.ctrl.pointerIds;m._active&&Array.from(M.keys()).every(ua=>ca.has(ua))||
(2>M.size&&M.set(c.pointerId,c),2>m._pointerEvents.size||(this.start(c),m=Yd(...Array.from(M.values())),this.pinchStart(c,m)))}}pinchStart(c,m){this.state.origin=m.origin;this.computeValues([m.distance,m.angle]);this.computeInitial();this.compute(c);this.emit()}touchMove(c){if(this.state._active){var m=de(c,this.state._touchIds);this.pinchMove(c,m)}}pointerMove(c){var m=this.state._pointerEvents;m.has(c.pointerId)&&m.set(c.pointerId,c);this.state._active&&(m=Yd(...Array.from(m.values())),this.pinchMove(c,
m))}pinchMove(c,m){const M=this.state,ca=m.angle-M._values[1];let ua=0;270<Math.abs(ca)&&(ua+=Math.sign(ca));this.computeValues([m.distance,m.angle-360*ua]);M.origin=m.origin;M.turns=ua;M._movement=[M._values[0]/M._initial[0]-1,M._values[1]-M._initial[1]];this.compute(c);this.emit()}touchEnd(c){this.ctrl.setEventIds(c);this.state._active&&this.state._touchIds.some(m=>!this.ctrl.touchIds.has(m))&&(this.state._active=!1,this.compute(c),this.emit())}pointerEnd(c){const m=this.state;this.ctrl.setEventIds(c);
try{c.target.releasePointerCapture(c.pointerId)}catch(M){}m._pointerEvents.has(c.pointerId)&&m._pointerEvents.delete(c.pointerId);m._active&&2>m._pointerEvents.size&&(m._active=!1,this.compute(c),this.emit())}gestureStart(c){c.cancelable&&c.preventDefault();const m=this.state;m._active||(this.start(c),this.computeValues([c.scale,c.rotation]),m.origin=[c.clientX,c.clientY],this.compute(c),this.emit())}gestureMove(c){c.cancelable&&c.preventDefault();if(this.state._active){var m=this.state;this.computeValues([c.scale,
c.rotation]);m.origin=[c.clientX,c.clientY];var M=m._movement;m._movement=[c.scale-1,c.rotation];m._delta=ej.sub(m._movement,M);this.compute(c);this.emit()}}gestureEnd(c){this.state._active&&(this.state._active=!1,this.compute(c),this.emit())}wheel(c){const m=this.config.modifierKey;if(!m||c[m])this.state._active?this.wheelChange(c):this.wheelStart(c),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelStart(c){this.start(c);this.wheelChange(c)}wheelChange(c){"uv"in c||c.cancelable&&c.preventDefault();
const m=this.state;m._delta=[-Se(c)[1]/100*m.offset[0],0];ej.addTo(m._movement,m._delta);dg(m);this.state.origin=[c.clientX,c.clientY];this.compute(c);this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(c){const m=this.config.device;m&&(c(m,"start",this[m+"Start"].bind(this)),c(m,"change",this[m+"Move"].bind(this)),c(m,"end",this[m+"End"].bind(this)),c(m,"cancel",this[m+"End"].bind(this)));this.config.pinchOnWheel&&c("wheel","",this.wheel.bind(this),
{passive:!1})}},mA=Qc(Qc({},Cw),{},{device(c,m,{shared:M,pointer:{touch:ca=!1}={}}){if(M.target&&!Jq&&iA)return"gesture";if(Jq&&ca)return"touch";if(Fw){if(Gw)return"pointer";if(Jq)return"touch"}},bounds(c,m,{scaleBounds:M={},angleBounds:ca={}}){const ua=La=>{La=Xe(M,La);La=Object.assign({},{min:-Infinity,max:Infinity},La||{});return[La.min,La.max]},Ga=La=>{La=Xe(ca,La);La=Object.assign({},{min:-Infinity,max:Infinity},La||{});return[La.min,La.max]};return"function"!==typeof M&&"function"!==typeof ca?
[ua(),Ga()]:La=>[ua(La),Ga(La)]},threshold(c,m,M){this.lockDirection="lock"===M.axis;return ej.toVector(c,this.lockDirection?[.1,3]:0)},modifierKey(c){return void 0===c?"ctrlKey":c},pinchOnWheel(c=!0){return c}}),nA=class extends Iq{constructor(...c){super(...c);$b(this,"ingKey","moving")}move(c){this.config.mouseOnly&&"mouse"!==c.pointerType||(this.state._active?this.moveChange(c):this.moveStart(c),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(c){this.start(c);this.computeValues(je(c));
this.compute(c);this.computeInitial();this.emit()}moveChange(c){if(this.state._active){var m=je(c),M=this.state;M._delta=ej.sub(m,M._values);ej.addTo(M._movement,M._delta);this.computeValues(m);this.compute(c);this.emit()}}moveEnd(c){this.state._active&&(this.state._active=!1,this.compute(c),this.emit())}bind(c){c("pointer","change",this.move.bind(this));c("pointer","leave",this.moveEnd.bind(this))}},oA=Qc(Qc({},uo),{},{mouseOnly:(c=!0)=>c}),pA=class extends Iq{constructor(...c){super(...c);$b(this,
"ingKey","scrolling")}scroll(c){this.state._active||this.start(c);this.scrollChange(c);this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(c){c.cancelable&&c.preventDefault();const m=this.state;var M,ca;const {scrollX:ua,scrollY:Ga,scrollLeft:La,scrollTop:fb}=c.currentTarget;var vb=[null!==(M=null!==ua&&void 0!==ua?ua:La)&&void 0!==M?M:0,null!==(ca=null!==Ga&&void 0!==Ga?Ga:fb)&&void 0!==ca?ca:0];m._delta=ej.sub(vb,m._values);ej.addTo(m._movement,m._delta);this.computeValues(vb);
this.compute(c);this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(c){c("scroll","",this.scroll.bind(this))}},qA=uo,rA=class extends Iq{constructor(...c){super(...c);$b(this,"ingKey","wheeling")}wheel(c){this.state._active||this.start(c);this.wheelChange(c);this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(c){const m=this.state;m._delta=Se(c);ej.addTo(m._movement,m._delta);dg(m);this.compute(c);this.emit()}wheelEnd(){this.state._active&&
(this.state._active=!1,this.compute(),this.emit())}bind(c){c("wheel","",this.wheel.bind(this))}},sA=uo,tA=class extends Iq{constructor(...c){super(...c);$b(this,"ingKey","hovering")}enter(c){this.config.mouseOnly&&"mouse"!==c.pointerType||(this.start(c),this.computeValues(je(c)),this.compute(c),this.emit())}leave(c){if(!this.config.mouseOnly||"mouse"===c.pointerType){var m=this.state;if(m._active){m._active=!1;var M=je(c);m._movement=m._delta=ej.sub(M,m._values);this.computeValues(M);this.compute(c);
m.delta=m.movement;this.emit()}}}bind(c){c("pointer","enter",this.enter.bind(this));c("pointer","leave",this.leave.bind(this))}},uA=Qc(Qc({},uo),{},{mouseOnly:(c=!0)=>c}),rt=new Map,st=new Map,vA={key:"drag",engine:hA,resolver:kA},wA={key:"hover",engine:tA,resolver:uA},xA={key:"move",engine:nA,resolver:oA},yA={key:"pinch",engine:lA,resolver:mA},zA={key:"scroll",engine:pA,resolver:qA},AA={key:"wheel",engine:rA,resolver:sA},tt=Qf(ea(22)),BA={target(c){if(c)return()=>"current"in c?c.current:c},enabled(c=
!0){return c},window(c=vo?window:void 0){return c},eventOptions({passive:c=!0,capture:m=!1}={}){return{passive:c,capture:m}},transform(c){return c}},CA=["target","eventOptions","window","enabled","transform"],Iw=class{constructor(c,m){$b(this,"_listeners",new Set);this._ctrl=c;this._gestureKey=m}add(c,m,M,ca,ua){const Ga=this._listeners,La=te(m,M),fb=Qc(Qc({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),ua);c.addEventListener(La,ca,fb);const vb=()=>{c.removeEventListener(La,
ca,fb);Ga.delete(vb)};Ga.add(vb);return vb}clean(){this._listeners.forEach(c=>c());this._listeners.clear()}},DA=class{constructor(){$b(this,"_timeouts",new Map)}add(c,m,M=140,...ca){this.remove(c);this._timeouts.set(c,window.setTimeout(m,M,...ca))}remove(c){(c=this._timeouts.get(c))&&window.clearTimeout(c)}clean(){this._timeouts.forEach(c=>void window.clearTimeout(c));this._timeouts.clear()}},EA=class{constructor(c){$b(this,"gestures",new Set);$b(this,"_targetEventStore",new Iw(this));$b(this,"gestureEventStores",
{});$b(this,"gestureTimeoutStores",{});$b(this,"handlers",{});$b(this,"config",{});$b(this,"pointerIds",new Set);$b(this,"touchIds",new Set);$b(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}});c.drag&&Dg(this,"drag");c.wheel&&Dg(this,"wheel");c.scroll&&Dg(this,"scroll");c.move&&Dg(this,"move");c.pinch&&Dg(this,"pinch");c.hover&&Dg(this,"hover")}setEventIds(c){if("touches"in c)return this.touchIds=new Set(Wd(c));if("pointerId"in c)return"pointerup"===c.type||"pointercancel"===c.type?
this.pointerIds.delete(c.pointerId):"pointerdown"===c.type&&this.pointerIds.add(c.pointerId),this.pointerIds}applyHandlers(c,m){this.handlers=c;this.nativeHandlers=m}applyConfig(c,m){this.config=Kg(c,m,this.config)}clean(){this._targetEventStore.clean();for(const c of this.gestures)this.gestureEventStores[c].clean(),this.gestureTimeoutStores[c].clean()}effect(){this.config.shared.target&&this.bind();return()=>this._targetEventStore.clean()}bind(...c){var m=this.config.shared;const M={};let ca;if(m.target&&
(ca=m.target(),!ca))return;if(m.enabled){for(const ua of this.gestures){const Ga=this.config[ua],La=Jw(M,Ga.eventOptions,!!ca);Ga.enabled&&(new (rt.get(ua))(this,c,ua)).bind(La)}m=Jw(M,m.eventOptions,!!ca);for(const ua in this.nativeHandlers)m(ua,"",Ga=>this.nativeHandlers[ua](Qc(Qc({},this.state.shared),{},{event:Ga,args:c})),void 0,!0)}for(const ua in M)M[ua]=we(...M[ua]);if(!ca)return M;for(const ua in M){const {device:Ga,capture:La,passive:fb}=Nd(ua);this._targetEventStore.add(ca,Ga,"",M[ua],
{capture:La,passive:fb})}}},Jw=(c,m,M)=>(ca,ua,Ga,La={},fb=!1)=>{var vb,Wb;const oc=null!==(vb=La.capture)&&void 0!==vb?vb:m.capture;La=null!==(Wb=La.passive)&&void 0!==Wb?Wb:m.passive;ca=fb?ca:Md(ca,ua,oc);M&&La&&(ca+="Passive");c[ca]=c[ca]||[];c[ca].push(Ga)},FA=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/,Jr=Qf(ea(22)),ut=Qf(ea(22)),Kw=Qf(ea(22)),Lw=Qf(ea(22)),GA=Qf(ea(22)),HA=Qf(ea(22)),IA=Qf(ea(22)),JA=Qf(ea(22)),KA={none:(c,m)=>"none",["default"]:(c,m)=>"default",pointer:(c,m)=>"pointer",crosshair:(c,
m)=>"crosshair",move:(c,m)=>"move",wait:(c,m)=>"wait",progress:(c,m)=>"progress",grab:(c,m)=>Sd('\x3cpath d\x3d"m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill\x3d"%23fff"/\x3e\x3cg stroke\x3d"%23000" stroke-linecap\x3d"round" stroke-width\x3d".75"\x3e\x3cpath d\x3d"m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin\x3d"round"/\x3e\x3cpath d\x3d"m20.5664 21.7344v-3.459"/\x3e\x3cpath d\x3d"m18.5508 21.7461-.016-3.473"/\x3e\x3cpath d\x3d"m16.5547 18.3047.021 3.426"/\x3e\x3c/g\x3e',
c,m),grabbing:(c,m)=>Sd("\x3cpath d\x3d'm13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill\x3d'%23fff'/\x3e\x3cg stroke\x3d'%23000' stroke-width\x3d'.75'\x3e\x3cpath d\x3d'm13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin\x3d'round'/\x3e\x3cpath d\x3d'm20.5664 19.7344v-3.459' stroke-linecap\x3d'round'/\x3e\x3cpath d\x3d'm18.5508 19.7461-.016-3.473' stroke-linecap\x3d'round'/\x3e\x3cpath d\x3d'm16.5547 16.3047.021 3.426' stroke-linecap\x3d'round'/\x3e\x3c/g\x3e",
c,m),text:(c,m)=>Sd("\x3cpath d\x3d'm6.94 2v-1c-1.35866267-.08246172-2.66601117.53165299-3.47 1.63-.80398883-1.09834701-2.11133733-1.71246172-3.47-1.63v1c1.30781678-.16635468 2.55544738.59885876 3 1.84v5.1h-1v1h1v4.16c-.4476345 1.2386337-1.69302129 2.002471-3 1.84v1c1.35687108.0731933 2.6600216-.5389494 3.47-1.63.8099784 1.0910506 2.11312892 1.7031933 3.47 1.63v-1c-1.28590589.133063-2.49760499-.6252793-2.94-1.84v-4.18h1v-1h-1v-5.08c.43943906-1.21710975 1.65323743-1.97676587 2.94-1.84z' transform\x3d'translate(14 9)'/\x3e",
c,m),["resize-edge"]:(c,m)=>Sd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",c,m),["resize-corner"]:(c,m)=>Sd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",
c,m),["ew-resize"]:(c,m)=>Sd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",c,m),["ns-resize"]:(c,m)=>Sd("\x3cpath d\x3d'm9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill\x3d'%23000'/\x3e",
c+90,m),["nesw-resize"]:(c,m)=>Sd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",c,m),["nwse-resize"]:(c,m)=>Sd("\x3cpath d\x3d'm19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill\x3d'%23fff'/\x3e\x3cpath d\x3d'm18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill\x3d'%23000'/\x3e",
c+90,m),rotate:(c,m)=>Sd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+45,m),["nwse-rotate"]:(c,m)=>Sd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c,m),["nesw-rotate"]:(c,m)=>Sd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+90,m),["senw-rotate"]:(c,m)=>Sd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+180,m),["swne-rotate"]:(c,m)=>Sd('\x3cg\x3e\x3cpath d\x3d"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill\x3d"black"/\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill\x3d"white"/\x3e\x3c/g\x3e',
c+270,m)},LA=Qf(ea(22));Qf(ea(22));var Mw=ea(22),Nw=Qf(ea(22));if(!ea(22).useState)throw Error("mobx-react-lite requires React with Hooks support");if(!Cc)throw Error("mobx-react-lite@3 requires mobx at least version 6 to be available");var MA=ea(23),Kq=Qf(ea(22)),Ow="undefined"===typeof FinalizationRegistry?void 0:FinalizationRegistry,NA=1E4,OA=function(c){var m="function"===typeof Symbol&&Symbol.iterator,M=m&&c[m],ca=0;if(M)return M.call(c);if(c&&"number"===typeof c.length)return{next:function(){c&&
ca>=c.length&&(c=void 0);return{value:c&&c[ca++],done:!c}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.");},Pw=Ow?ue(Ow):$e(),PA=Pw.addReactionToTrack,QA=Pw.recordReactionAsCommitted,Qw=function(c,m){var M="function"===typeof Symbol&&c[Symbol.iterator];if(!M)return c;c=M.call(c);var ca,ua=[];try{for(;(void 0===m||0<m--)&&!(ca=c.next()).done;)ua.push(ca.value)}catch(La){var Ga={error:La}}finally{try{ca&&!ca.done&&(M=c["return"])&&M.call(c)}finally{if(Ga)throw Ga.error;
}}return ua},RA=function(){return function(){}}(),tp=ea(22),Rw="function"===typeof Symbol&&Symbol.for,Sw=Rw?Symbol.for("react.forward_ref"):"function"===typeof tp.forwardRef&&(0,tp.forwardRef)(function(c){return null}).$$typeof,Tw=Rw?Symbol.for("react.memo"):"function"===typeof tp.memo&&(0,tp.memo)(function(c){return null}).$$typeof,SA={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};Pf.displayName="Observer";ea(22);ea(22);ea(22);(function(c){c||=Ne;ob({reactionScheduler:c})})(MA.unstable_batchedUpdates);
var TA=Qf(ea(22)),vt=ea(581),Vk=TA.forwardRef(function(c,m){var {children:M,opacity:ca,centered:ua,className:Ga=""}=c,La=Ti(c,["children","opacity","centered","className"]);return(0,vt.jsx)(Pf,{children:()=>(0,vt.jsx)("div",{ref:m,className:`tl-positioned-div ${Ga}`,style:ca?{opacity:ca}:void 0,draggable:!1,children:(0,vt.jsx)("div",ng(Gf({className:`tl-positioned-inner ${ua?"tl-centered":""}`},La),{children:M}))})})}),UA=Qf(ea(22)),wt=ea(581),vl=UA.forwardRef(function(c,m){var {id:M,className:ca=
"",style:ua,children:Ga}=c,La=Ti(c,["id","className","style","children"]);return(0,wt.jsx)(Pf,{children:()=>(0,wt.jsx)("svg",{ref:m,style:ua,className:`tl-positioned-svg ${ca}`,children:(0,wt.jsx)("g",ng(Gf({id:M,className:"tl-centered-g"},La),{children:Ga}))})})}),Lq=Qf(ea(22)),Uw=Qf(ea(22)),Kr=Qf(ea(22)),VA=ea(581),pn=Ee(function(c){var {id:m,bounds:M,zIndex:ca,rotation:ua=0,className:Ga="",children:La}=c;c=Ti(c,"id bounds zIndex rotation className children".split(" "));const fb=Kr.useRef(null);
Kr.useLayoutEffect(()=>{fb.current.style.transform=`translate(
        calc(${M.minX}px - var(--tl-padding)),
        calc(${M.minY}px - var(--tl-padding)))
        rotate(${ua+(M.rotation||0)}rad)`},[M.minX,M.minY,ua,M.rotation]);Kr.useLayoutEffect(()=>{const vb=fb.current;vb.style.width=`calc(${Math.floor(M.width)}px + (var(--tl-padding) * 2))`;vb.style.height=`calc(${Math.floor(M.height)}px + (var(--tl-padding) * 2))`},[M.width,M.height]);Kr.useLayoutEffect(()=>{const vb=fb.current;void 0!==ca&&(vb.style.zIndex=ca.toString())},[ca]);return(0,VA.jsx)("div",ng(Gf({id:m,ref:fb,className:`tl-positioned ${Ga}`,"aria-label":"container"},c),{children:La}))}),
WA=Qf(ea(22)),Vw=ea(581),XA=Ee(function({shapes:c,hidden:m,bounds:M,rotation:ca=0}){const {components:{ContextBar:ua},viewport:{bounds:Ga,camera:{point:[La,fb],zoom:vb}}}=nd(),Wb=WA.useRef(null);var oc=Me.getRotatedBounds(M,ca);oc=Me.multiplyBounds(oc,vb);Hb(Wb,M,ca,10005);if(!ua)throw Error("Expected a ContextBar component.");const uc=Me.translateBounds(oc,[La*vb,fb*vb]);return(0,Vw.jsx)("div",{ref:Wb,className:"tl-counter-scaled-positioned","aria-label":"context-bar-container","data-html2canvas-ignore":"true",
children:(0,Vw.jsx)(ua,{hidden:m,shapes:c,bounds:M,offsets:{left:uc.minX,right:Ga.width-uc.maxX,top:uc.minY,bottom:Ga.height-uc.maxY,width:uc.width,height:uc.height},scaledBounds:oc,rotation:ca})})}),Ww=Qf(ea(22)),YA=ea(581),Xw=Ee(function({children:c}){const m=Ww.useRef(null),{viewport:M}=nd(),ca=m.current,{zoom:ua,point:Ga}=M.camera;Ww.useEffect(()=>{ca&&(ca.style.transform=`scale(${ua}) translate3d(${Ga[0]}px, ${Ga[1]}px, 0)`)},[ua,Ga,ca]);return(0,YA.jsx)("div",{ref:m,className:"tl-absolute tl-layer",
children:c})}),Lr=ea(581),Yw=Ee(function({shape:c,isHovered:m=!1,isSelected:M=!1,isBinding:ca=!1,isEditing:ua=!1,isLocked:Ga=!1,meta:La}){const {bounds:fb,props:{scale:vb,rotation:Wb=0},ReactIndicator:oc}=c;return(0,Lr.jsx)(pn,{"data-type":"Indicator","data-html2canvas-ignore":"true",bounds:fb,rotation:Wb,scale:vb,zIndex:ua?1E3:1E4,children:(0,Lr.jsx)(vl,{children:(0,Lr.jsx)("g",{className:`tl-indicator-container ${M?"tl-selected":"tl-hovered"} ${Ga?"tl-locked":""}`,children:(0,Lr.jsx)(oc,{isEditing:ua,
isBinding:ca,isHovered:m,isLocked:Ga,isSelected:M,isErasing:!1,meta:La})})})})}),Zw=Qf(ea(22)),Mr=ea(581),ZA=Ee(function({bounds:c,shape:m}){const {viewport:{camera:{zoom:M}},components:{QuickLinks:ca}}=nd();var ua=Ve();const Ga=Qg(m);if(!ca)throw Error("Expected a QuickLinks component.");ua=50>c.height*M||!ua.selectedShapesArray.includes(m);return(0,Mr.jsx)(pn,{bounds:c,className:"tl-quick-links-container","data-html2canvas-ignore":"true",children:(0,Mr.jsx)(Vk,{children:(0,Mr.jsx)("span",ng(Gf({style:{position:"absolute",
top:"100%",pointerEvents:"all",transformOrigin:"left top",paddingTop:"8px",transform:"scale(var(--tl-scale))",minWidth:"320px"}},Ga),{onPointerDown:La=>La.stopPropagation(),children:(0,Mr.jsx)(ca,{className:"tl-backlinks-count "+(ua?"tl-backlinks-count-rounded":""),id:m.id,shape:m})}))})})}),Nr=ea(581),$A=Ee(function({bounds:c,shape:m}){const {viewport:{camera:{zoom:M}},components:{BacklinksCount:ca}}=nd();var ua=Ve();if(!ca)throw Error("Expected a BacklinksCount component.");const Ga=La=>La.stopPropagation();
ua=50>c.height*M||!ua.selectedShapesArray.includes(m)||m.hideSelection;return(0,Nr.jsx)(pn,{bounds:c,className:"tl-backlinks-count-container",children:(0,Nr.jsx)(Vk,{children:(0,Nr.jsx)("span",{style:{position:"absolute",left:"100%",pointerEvents:"all",transformOrigin:"left top",transform:"translateY(6px) scale(var(--tl-scale))"},onPointerDown:Ga,onWheelCapture:Ga,onKeyDown:Ga,title:"Shape Backlinks",children:(0,Nr.jsx)(ca,{className:"tl-backlinks-count "+(ua?"tl-backlinks-count-rounded":""),id:m.id,
shape:m})})})})}),aB=Qf(ea(22)),$w=ea(581),bB=Ee(function({bounds:c,hidden:m,shapes:M,rotation:ca=0,detail:ua="size"}){const {components:{SelectionDetail:Ga},viewport:{camera:{zoom:La}}}=nd(),fb=aB.useRef(null),vb=Me.multiplyBounds(c,La);Hb(fb,c,ca,10003);if(!Ga)throw Error("Expected a SelectionDetail component.");return(0,$w.jsx)("div",{ref:fb,className:`tl-counter-scaled-positioned ${m?"tl-fade-out":""}`,"aria-label":"bounds-detail-container","data-html2canvas-ignore":"true",children:(0,$w.jsx)(Ga,
{shapes:M,bounds:c,scaledBounds:vb,zoom:La,rotation:ca,detail:ua})})}),ax=ea(581),cB=Ee(function({shape:c,isHovered:m=!1,isSelected:M=!1,isBinding:ca=!1,isErasing:ua=!1,isEditing:Ga=!1,onEditingEnd:La,asset:fb,meta:vb,zIndex:Wb}){const {bounds:oc,props:{rotation:uc,scale:Sc},ReactComponent:kd}=c,fd=Ve(),xd=Qg(c);var Jd=fd.getParentGroup(c);Jd=fd.selectedIds.has(null==Jd?void 0:Jd.id);return(0,ax.jsx)(pn,{"data-shape-id":c.id,"data-html2canvas-ignore":!M&&!Jd&&0!==fd.selectedShapes.size||null,zIndex:Wb,
"data-type":"Shape",bounds:oc,rotation:uc,scale:Sc,children:(0,ax.jsx)(kd,{meta:vb,isEditing:Ga,isBinding:ca,isHovered:m,isSelected:M,isErasing:ua,events:xd,asset:fb,onEditingEnd:La})})}),up=ea(581),bx=[[-1,.15,64],[.05,.375,16],[.15,1,4],[.7,2.5,1]],dB=Ee(function({size:c}){const {viewport:{camera:{point:m,zoom:M}}}=nd();return(0,up.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg","data-html2canvas-ignore":"true",children:[(0,up.jsx)("defs",{children:bx.map(([ca,
ua,Ga],La)=>{Ga=Ga*c*M;var fb=m[0]*M,vb=m[1]*M;fb=0<fb?fb%Ga:Ga+fb%Ga;vb=0<vb?vb%Ga:Ga+vb%Ga;ca=Qi(M,[ca,ua],[0,1]);return(0,up.jsx)("pattern",{id:`grid-${La}`,width:Ga,height:Ga,patternUnits:"userSpaceOnUse",children:!(2<ca||.1>ca)&&(0,up.jsx)("circle",{className:"tl-grid-dot",cx:fb,cy:vb,r:1.5,opacity:Math.max(0,Math.min(ca,1))})},`grid-pattern-${La}`)})}),bx.map((ca,ua)=>(0,up.jsx)("rect",{width:"100%",height:"100%",fill:`url(#grid-${ua})`},`grid-rect-${ua}`))]})}),cx=Ee(function({size:c}){return(0,up.jsx)(dB,
{size:c})}),dx=ea(581),ex=Ee(function({bounds:c}){const m=Vd("background");return(0,dx.jsx)(vl,ng(Gf({"data-html2canvas-ignore":"true"},m),{children:(0,dx.jsx)("rect",{className:"tl-bounds-bg",width:Math.max(1,c.width),height:Math.max(1,c.height),pointerEvents:"all",rx:8,ry:8})}))});ea(22);var fx=ea(581),gx=Ee(function({scaledBounds:c,shapes:m,detail:M="size",rotation:ca=0}){var ua;const Ga=1===m.length?ca:null!=(ua=c.rotation)?ua:0;return(0,fx.jsx)(Vk,{centered:!0,children:(0,fx.jsx)("div",{className:"tl-bounds-detail",
style:{transform:Ga<ci||Ga>3*ci?`rotate(${Ga}rad) translateY(${c.height/2+24}px)`:`rotate(${Math.PI+Ga}rad) translateY(${c.height/2+32}px)`,padding:"2px 3px",borderRadius:"1px"},children:1===m.length&&"line"===m[0].type?`${ne.dist(m[0].props.handles.start.point,m[0].props.handles.end.point).toFixed()}`:"size"===M?`${c.width.toFixed()} \xD7 ${c.height.toFixed()}`:`\u2220${Dh.radiansToDegrees(Dh.clampRadians(ca)).toFixed()}\xB0`})})}),xt=ea(581),eB={top_left_corner:"tl-cursor-nwse",top_right_corner:"tl-cursor-nesw",
bottom_right_corner:"tl-cursor-nwse",bottom_left_corner:"tl-cursor-nesw"},Or=Ee(function({cx:c,cy:m,size:M,targetSize:ca,corner:ua,isHidden:Ga}){const La=Vd(ua);return(0,xt.jsxs)("g",ng(Gf({opacity:Ga?0:1},La),{children:[(0,xt.jsx)("rect",{className:"tl-transparent "+(Ga?"":eB[ua]),"aria-label":`${ua} target`,x:c-1.25*ca,y:m-1.25*ca,width:2.5*ca,height:2.5*ca,pointerEvents:Ga?"none":"all"}),(0,xt.jsx)("rect",{className:"tl-corner-handle","aria-label":`${ua} handle`,x:c-M/2,y:m-M/2,width:M,height:M,
pointerEvents:"none"})]}))}),Pr=ea(581),yt=Ee(function({cx:c,cy:m,size:M,direction:ca,isHidden:ua}){const Ga=Ve();return(0,Pr.jsxs)("g",{className:"tl-clone-handle",opacity:ua?0:1,children:[(0,Pr.jsx)("circle",{"aria-label":`${ca} handle`,pointerEvents:"all",onPointerDown:La=>Ga.api.clone(ca),cx:c,cy:m,r:M}),(0,Pr.jsx)("line",{x1:c-M/2,y1:m,x2:c+M/2,y2:m}),(0,Pr.jsx)("line",{x1:c,y1:m-M/2,x2:c,y2:m+M/2})]})}),fB=ea(581),gB={top_edge:"tl-cursor-ns",right_edge:"tl-cursor-ew",bottom_edge:"tl-cursor-ns",
left_edge:"tl-cursor-ew"},Qr=Ee(function({x:c,y:m,width:M,height:ca,targetSize:ua,edge:Ga,disabled:La,isHidden:fb}){const vb=Vd(Ga);return(0,fB.jsx)("rect",Gf({pointerEvents:fb||La?"none":"all",className:"tl-transparent tl-edge-handle "+(fb?"":gB[Ga]),"aria-label":`${Ga} target`,opacity:fb?0:1,x:c-ua,y:m-ua,width:Math.max(1,M+2*ua),height:Math.max(1,ca+2*ua)},vb))}),zt=ea(581);Ee(function({cx:c,cy:m,size:M,targetSize:ca,isHidden:ua}){const Ga=Vd("rotate");return(0,zt.jsxs)("g",ng(Gf({opacity:ua?0:
1},Ga),{children:[(0,zt.jsx)("circle",{className:"tl-transparent ","aria-label":"rotate target",cx:c,cy:m,r:ca,pointerEvents:ua?"none":"all"}),(0,zt.jsx)("circle",{className:"tl-rotate-handle","aria-label":"rotate handle",cx:c,cy:m,r:M/2,pointerEvents:"none"})]}))});ea(22);var hx=ea(581),Rr=Ee(function({cx:c,cy:m,targetSize:M,corner:ca,isHidden:ua}){const Ga=Vd(ca);return(0,hx.jsx)("g",ng(Gf({opacity:ua?0:1},Ga),{children:(0,hx.jsx)("rect",{className:"tl-transparent","aria-label":`${ca} target`,x:c-
2.5*M,y:m-2.5*M,width:3*M,height:3*M,pointerEvents:ua?"none":"all"})}))}),Cj=ea(581),ix=Ee(function({bounds:c,showResizeHandles:m,showRotateHandles:M,showCloneHandles:ca,shapes:ua}){var Ga,La;const fb=Ve();let {width:vb,height:Wb}=c;var oc=fb.viewport.camera.zoom;c=8/oc;const uc=6/oc;oc=30/oc;const Sc=2*c,kd=1===ua.length?ua[0].canResize:[!0,!0],fd=null!=(La=null==(Ga=fb.editingShape)?void 0:Ga.props.borderRadius)?La:0;return(0,Cj.jsx)(Cj.Fragment,{children:0<ua.length&&(0,Cj.jsxs)(vl,{children:[!fb.editingShape&&
(0,Cj.jsx)("rect",{className:"tl-bounds-fg",width:Math.max(vb,1),height:Math.max(Wb,1),rx:fd,ry:fd,pointerEvents:"none"}),(0,Cj.jsx)(Qr,{x:2*uc,y:0,width:vb-4*uc,height:0,targetSize:uc,edge:"top_edge",disabled:!kd[1],isHidden:!m}),(0,Cj.jsx)(Qr,{x:vb,y:2*uc,width:0,height:Wb-4*uc,targetSize:uc,edge:"right_edge",disabled:!kd[0],isHidden:!m}),(0,Cj.jsx)(Qr,{x:2*uc,y:Wb,width:vb-4*uc,height:0,targetSize:uc,edge:"bottom_edge",disabled:!kd[1],isHidden:!m}),(0,Cj.jsx)(Qr,{x:0,y:2*uc,width:0,height:Wb-4*
uc,targetSize:uc,edge:"left_edge",disabled:!kd[0],isHidden:!m}),(0,Cj.jsx)(Rr,{cx:0,cy:0,targetSize:uc,corner:"top_left_resize_corner",isHidden:!M}),(0,Cj.jsx)(Rr,{cx:vb+2*uc,cy:0,targetSize:uc,corner:"top_right_resize_corner",isHidden:!M}),(0,Cj.jsx)(Rr,{cx:vb+2*uc,cy:Wb+2*uc,targetSize:uc,corner:"bottom_right_resize_corner",isHidden:!M}),(0,Cj.jsx)(Rr,{cx:0,cy:Wb+2*uc,targetSize:uc,corner:"bottom_left_resize_corner",isHidden:!M}),(0,Cj.jsx)(yt,{cx:-oc,cy:Wb/2,size:Sc,direction:"left",isHidden:!ca}),
(0,Cj.jsx)(yt,{cx:vb+oc,cy:Wb/2,size:Sc,direction:"right",isHidden:!ca}),(0,Cj.jsx)(yt,{cx:vb/2,cy:Wb+oc,size:Sc,direction:"down",isHidden:!ca}),(null==kd?void 0:kd.every(xd=>xd))&&(0,Cj.jsxs)(Cj.Fragment,{children:[(0,Cj.jsx)(Or,{cx:0,cy:0,size:c,targetSize:uc,corner:"top_left_corner",isHidden:!m}),(0,Cj.jsx)(Or,{cx:vb,cy:0,size:c,targetSize:uc,corner:"top_right_corner",isHidden:!m}),(0,Cj.jsx)(Or,{cx:vb,cy:Wb,size:c,targetSize:uc,corner:"bottom_right_corner",isHidden:!m}),(0,Cj.jsx)(Or,{cx:0,cy:Wb,
size:c,targetSize:uc,corner:"bottom_left_corner",isHidden:!m})]})]})})}),At=ea(581),jx=Ee(function({bounds:c}){return(0,At.jsx)(pn,{bounds:c,zIndex:10001,children:(0,At.jsx)(vl,{children:(0,At.jsx)("rect",{className:"tl-brush",x:0,y:0,width:c.width,height:c.height})})})}),kx=ea(581);Ee(function(){return(0,kx.jsx)(kx.Fragment,{})});var Bt=ea(581),lx=Ee(function({shape:c,handle:m,id:M}){c=Cd(c,M);const [ca,ua]=m.point;return(0,Bt.jsxs)("g",ng(Gf({className:"tl-handle","aria-label":"handle"},c),{transform:`translate(${ca}, ${ua})`,
children:[(0,Bt.jsx)("circle",{className:"tl-handle-bg",pointerEvents:"all"}),(0,Bt.jsx)("circle",{className:"tl-counter-scaled tl-handle",pointerEvents:"none",r:4})]}))}),mx=Qf(ea(22)),Ct=ea(581),Dt=Ee(function({direction:c}){const {viewport:{bounds:m}}=nd(),M=mx.useRef(null);mx.useLayoutEffect(()=>{const ca=M.current;if(ca){var ua=[m.width/2,m.height/2],Ga=Me.getRectangleSides([12,12],[m.width-24,m.height-24]);for(const [,[La,fb]]of Ga)Ga=q(ua,c,La,fb),Ga.didIntersect&&(Ga=Ga.points[0],ca.style.transform=
`translate(${Ga[0]-6}px,${Ga[1]-6}px) rotate(${ne.toAngle(c)}rad)`)}},[c,m]);return(0,Ct.jsx)("div",{ref:M,className:"tl-direction-indicator","data-html2canvas-ignore":"true",children:(0,Ct.jsx)("svg",{height:12,width:12,children:(0,Ct.jsx)("polygon",{points:"0,0 12,6 0,12"})})})}),fj=ea(581),hB=Ee(function({id:c,className:m,brush:M,shapes:ca,assets:ua,bindingShapes:Ga,editingShape:La,hoveredShape:fb,hoveredGroup:vb,selectionBounds:Wb,selectedShapes:oc,erasingShapes:uc,selectionDirectionHint:Sc,cursor:kd=
"default",cursorRotation:fd=0,selectionRotation:xd=0,showSelection:Jd=!0,showHandles:$c=!0,showSelectionRotation:hd=!1,showResizeHandles:od=!0,showRotateHandles:Kd=!0,showCloneHandles:zd=!0,showSelectionDetail:Te=!0,showContextBar:We=!0,showGrid:eg=!0,gridSize:of=8,onEditingEnd:Tf=aA,theme:Jg=xi,children:bh}){var Eg;const ch=Lq.useRef(null),{viewport:Bf,components:If,meta:Ef}=nd(),Yf=Ve(),dh=Lq.useCallback(Wg=>{Yf.inputs.updateContainerOffset([Wg.minX,Wg.minY])},[]);Ke(Jg,c);wd(ch);qe(ch,Bf,dh);Ih(ch);
Be();Ed(ch,kd,fd);re(ch);Ig(ch);c=uf();const Fh=(kd=1===(null==oc?void 0:oc.length)&&oc[0])&&"handles"in kd.props?null==oc?void 0:oc[0]:void 0,Pi=Lq.useMemo(()=>new Set(oc||[]),[oc]),fi=Lq.useMemo(()=>new Set(uc||[]),[uc]);kd=1===(null==oc?void 0:oc.length)?oc[0]:void 0;vb=[...(new Set([vb,fb]))].filter(Hc);return(0,fj.jsxs)("div",{ref:ch,className:`tl-container ${null!=m?m:""}`,children:[(0,fj.jsxs)("div",ng(Gf({tabIndex:-1,className:"tl-absolute tl-canvas"},c),{children:[eg&&If.Grid&&(0,fj.jsx)(If.Grid,
{size:of}),(0,fj.jsxs)(Xw,{children:[If.SelectionBackground&&oc&&Wb&&Jd&&(0,fj.jsx)(pn,{"data-type":"SelectionBackground",bounds:Wb,zIndex:2,"data-html2canvas-ignore":"true",children:(0,fj.jsx)(If.SelectionBackground,{shapes:oc,bounds:Wb,showResizeHandles:od,showRotateHandles:Kd})}),ca&&ca.map((Wg,Gi)=>(0,fj.jsx)(cB,{shape:Wg,asset:ua&&Wg.props.assetId?ua[Wg.props.assetId]:void 0,isEditing:Wg===La,isHovered:Wg===fb,isBinding:null==Ga?void 0:Ga.includes(Wg),isSelected:Pi.has(Wg),isErasing:fi.has(Wg),
meta:Ef,zIndex:1E3+Gi,onEditingEnd:Tf},"shape_"+Wg.id)),!Yf.isIn("select.pinching")&&(null==oc?void 0:oc.map(Wg=>(0,fj.jsx)(Yw,{shape:Wg,isEditing:Wg===La,isHovered:!1,isBinding:!1,isSelected:!0,isLocked:Wg.props.isLocked},"selected_indicator_"+Wg.id))),vb.map(Wg=>Wg!==La&&(0,fj.jsx)(Yw,{shape:Wg},"hovered_indicator_"+Wg.id)),kd&&If.BacklinksCount&&(0,fj.jsx)($A,{hidden:!1,bounds:kd.bounds,shape:kd}),fb&&fb!==kd&&If.QuickLinks&&(0,fj.jsx)(ZA,{hidden:!1,bounds:fb.bounds,shape:fb}),M&&If.Brush&&(0,fj.jsx)(If.Brush,
{bounds:M}),oc&&Wb&&(0,fj.jsxs)(fj.Fragment,{children:[Jd&&If.SelectionForeground&&(0,fj.jsx)(pn,{"data-type":"SelectionForeground","data-html2canvas-ignore":"true",bounds:Wb,zIndex:La&&oc.includes(La)?1002:10002,children:(0,fj.jsx)(If.SelectionForeground,{shapes:oc.filter(Wg=>!Wg.props.isLocked),bounds:Wb,showResizeHandles:od,showRotateHandles:Kd,showCloneHandles:zd})}),$c&&Fh&&If.Handle&&(0,fj.jsx)(pn,{"data-type":"onlySelectedShapeWithHandles","data-html2canvas-ignore":"true",bounds:Wb,zIndex:10003,
children:(0,fj.jsx)(vl,{children:Object.entries(null!=(Eg=Fh.props.handles)?Eg:{}).map(([Wg,Gi])=>Lq.createElement(If.Handle,{key:`${Gi.id}_handle_${Gi.id}`,shape:Fh,handle:Gi,id:Wg}))})}),oc&&If.SelectionDetail&&(0,fj.jsx)(bB,{"data-html2canvas-ignore":"true",shapes:oc,bounds:Wb,detail:hd?"rotation":"size",hidden:!Te,rotation:xd},"detail"+oc.map(Wg=>Wg.id).join(""))]})]}),Sc&&Wb&&oc&&(0,fj.jsx)(Dt,{direction:Sc,bounds:Wb,shapes:oc}),(0,fj.jsx)("div",{id:"tl-dev-tools-canvas-anchor","data-html2canvas-ignore":"true"})]})),
(0,fj.jsx)(Xw,{children:oc&&Wb&&(0,fj.jsx)(fj.Fragment,{children:oc&&If.ContextBar&&(0,fj.jsx)(XA,{shapes:oc.filter(Wg=>!Wg.props.isLocked),hidden:!We,bounds:kd?kd.bounds:Wb,rotation:kd?kd.props.rotation:0},"context"+oc.map(Wg=>Wg.id).join(""))})}),bh]})}),nx=Qf(ea(22)),ox=Qf(ea(22)),px=ea(581);Ee(function({children:c}){const m=ox.useRef(null),{viewport:M}=nd();ox.useEffect(()=>nc(()=>{const ca=m.current;if(ca){var {zoom:ua,point:Ga}=M.camera;ca.style.transform=`scale(${ua}) translateX(${Ga[0]}px) translateY(${Ga[1]}px)`}}),
[]);return(0,px.jsx)("svg",{className:"tl-absolute tl-overlay",pointerEvents:"none",children:(0,px.jsx)("g",{ref:m,pointerEvents:"none",children:c})})});var iB=ea(581),jB=Ee(function(c){const m=Yc(c),M=Ue(c.id);qd(m,c);Tc(m,c);return(0,iB.jsx)(M.Provider,{value:m,children:c.children})}),kB=ea(581),lB=Ee(function({id:c="noid",viewport:m,inputs:M,callbacks:ca=xi,meta:ua=xi,components:Ga=xi,children:La}){const [fb,vb]=nx.useState(()=>{const {Brush:oc,ContextBar:uc,DirectionIndicator:Sc,Grid:kd,Handle:fd,
SelectionBackground:xd,SelectionDetail:Jd,SelectionForeground:$c}=Ga,hd=Ti(Ga,"Brush ContextBar DirectionIndicator Grid Handle SelectionBackground SelectionDetail SelectionForeground".split(" "));return{id:c,viewport:m,inputs:M,callbacks:ca,meta:ua,components:ng(Gf({},hd),{Brush:null===oc?void 0:jx,ContextBar:uc,DirectionIndicator:null===Sc?void 0:Dt,Grid:null===kd?void 0:cx,Handle:null===fd?void 0:lx,SelectionBackground:null===xd?void 0:ex,SelectionDetail:null===Jd?void 0:gx,SelectionForeground:null===
$c?void 0:ix})}});nx.useLayoutEffect(()=>{const {Brush:oc,ContextBar:uc,DirectionIndicator:Sc,Grid:kd,Handle:fd,SelectionBackground:xd,SelectionDetail:Jd,SelectionForeground:$c}=Ga,hd=Ti(Ga,"Brush ContextBar DirectionIndicator Grid Handle SelectionBackground SelectionDetail SelectionForeground".split(" "));return nc(()=>{vb({id:c,viewport:m,inputs:M,callbacks:ca,meta:ua,components:ng(Gf({},hd),{Brush:null===oc?void 0:jx,ContextBar:uc,DirectionIndicator:null===Sc?void 0:Dt,Grid:null===kd?void 0:cx,
Handle:null===fd?void 0:lx,SelectionBackground:null===xd?void 0:ex,SelectionDetail:null===Jd?void 0:gx,SelectionForeground:null===$c?void 0:ix})})})},[]);const Wb=bd(c);return(0,kB.jsx)(Wb.Provider,{value:fb,children:La})}),qx=ea(581),mB=ea(581),nB=Ee(function(c){const m=Ve();return(0,mB.jsx)(Tg,Gf({viewport:m.viewport,inputs:m.inputs,callbacks:m._events,brush:m.brush,editingShape:m.editingShape,hoveredShape:m.hoveredShape,hoveredGroup:m.hoveredGroup,bindingShapes:m.bindingShapes,selectionDirectionHint:m.selectionDirectionHint,
selectionBounds:m.selectionBounds,selectedShapes:m.selectedShapesArray,erasingShapes:m.erasingShapesArray,shapes:m.shapes,assets:m.assets,showGrid:m.settings.showGrid,penMode:m.settings.penMode,showSelection:m.showSelection,showSelectionRotation:m.showSelectionRotation,showResizeHandles:m.showResizeHandles,showRotateHandles:m.showRotateHandles,showCloneHandles:m.showCloneHandles,showSelectionDetail:m.showSelectionDetail,showContextBar:m.showContextBar,cursor:m.cursors.cursor,cursorRotation:m.cursors.rotation,
selectionRotation:m.selectionRotation,onEditingEnd:m.clearEditingState},c))});ea(581);var vp=Qf(ea(22)),qn=Qf(ea(22)),oB=ea(581),pB="add-link block-search block connector group internal-link link-to-block link-to-page link-to-whiteboard move-to-sidebar-right object-compact object-expanded open-as-page page-search page references-hide references-show select-cursor text ungroup whiteboard-element whiteboard".split(" "),hh=c=>{var {name:m,className:M}=c;c=Ti(c,["name","className"]);const ca=pB.includes(m)?
"tie tie-":"ti ti-";return(0,oB.jsx)("i",Gf({className:[ca+m,M].join(" ")},c))},wo=ea(581),Mq=window.LSUI,rx=ea(581),Et=ea(581),qB=({style:c,icon:m,onClick:M})=>(0,Et.jsx)("button",{"data-html2canvas-ignore":"true",style:c,className:"tl-circle-button",onPointerDown:M,children:(0,Et.jsx)("div",{className:"tl-circle-button-icons-wrapper",children:(0,Et.jsx)(hh,{name:m})})}),Ft=ea(581),rB=window.LSUI,si=Qf(ea(22)).default.createContext({}),sB=Qf(ea(22)),sx=ea(581),Qj=c=>{var {action:m,shortcut:M,opts:ca}=
c;c=Ti(c,["action","shortcut","opts"]);var {renderers:ua}=sB.useContext(si);ua=null==ua?void 0:ua.KeyboardShortcut;return(0,sx.jsx)("div",ng(Gf({className:"tl-menu-right-slot"},c),{children:(0,sx.jsx)(ua,{action:m,shortcut:M,opts:ca})}))},Wk=ea(581),rn=window.LSUI,tB=Ee(function(){const c=Ve(),m=M=>{M.preventDefault()};return(0,Wk.jsxs)(rn.DropdownMenu,{children:[(0,Wk.jsx)(rn.DropdownMenuTrigger,{className:"tl-button text-sm px-2 important",id:"tl-zoom",children:(100*c.viewport.camera.zoom).toFixed(0)+
"%"}),(0,Wk.jsxs)(rn.DropdownMenuContent,{onCloseAutoFocus:M=>M.preventDefault(),id:"zoomPopup",sideOffset:12,children:[(0,Wk.jsxs)(rn.DropdownMenuItem,{onSelect:m,onClick:c.api.zoomToFit,children:["Zoom to drawing",(0,Wk.jsx)(Qj,{action:"whiteboard/zoom-to-fit"})]}),(0,Wk.jsxs)(rn.DropdownMenuItem,{onSelect:m,onClick:c.api.zoomToSelection,disabled:0===c.selectedShapesArray.length,children:["Zoom to fit selection",(0,Wk.jsx)(Qj,{action:"whiteboard/zoom-to-selection"})]}),(0,Wk.jsxs)(rn.DropdownMenuItem,
{onSelect:m,onClick:c.api.zoomIn,children:["Zoom in",(0,Wk.jsx)(Qj,{action:"whiteboard/zoom-in"})]}),(0,Wk.jsxs)(rn.DropdownMenuItem,{onSelect:m,onClick:c.api.zoomOut,children:["Zoom out",(0,Wk.jsx)(Qj,{action:"whiteboard/zoom-out"})]}),(0,Wk.jsxs)(rn.DropdownMenuItem,{onSelect:m,onClick:c.api.resetZoom,children:["Reset zoom",(0,Wk.jsx)(Qj,{action:"whiteboard/reset-zoom"})]})]})]})}),Dj=ea(581),uB=window.LSUI,vB=Ee(function(){const c=Ve(),{handlers:{t:m}}=qn.useContext(si),M=qn.useCallback(()=>{c.api.undo()},
[c]),ca=qn.useCallback(()=>{c.api.redo()},[c]),ua=qn.useCallback(()=>{c.api.zoomIn()},[c]),Ga=qn.useCallback(()=>{c.api.zoomOut()},[c]),La=qn.useCallback(()=>{c.api.toggleGrid()},[c]),fb=qn.useCallback(()=>{c.api.toggleSnapToGrid()},[c]),vb=qn.useCallback(()=>{c.api.togglePenMode()},[c]);return(0,Dj.jsxs)("div",{className:"tl-action-bar","data-html2canvas-ignore":"true",children:[!c.readOnly&&(0,Dj.jsxs)("div",{className:"tl-toolbar tl-history-bar mr-2 mb-2",children:[(0,Dj.jsx)(Zh,{tooltip:m("whiteboard/undo"),
onClick:M,children:(0,Dj.jsx)(hh,{name:"arrow-back-up"})}),(0,Dj.jsx)(Zh,{tooltip:m("whiteboard/redo"),onClick:ca,children:(0,Dj.jsx)(hh,{name:"arrow-forward-up"})})]}),(0,Dj.jsxs)("div",{className:"tl-toolbar tl-zoom-bar mr-2 mb-2",children:[(0,Dj.jsx)(Zh,{tooltip:m("whiteboard/zoom-in"),onClick:ua,id:"tl-zoom-in",children:(0,Dj.jsx)(hh,{name:"plus"})}),(0,Dj.jsx)(Zh,{tooltip:m("whiteboard/zoom-out"),onClick:Ga,id:"tl-zoom-out",children:(0,Dj.jsx)(hh,{name:"minus"})}),(0,Dj.jsx)(uB.Separator,{orientation:"vertical"}),
(0,Dj.jsx)(tB,{})]}),(0,Dj.jsxs)("div",{className:"tl-toolbar tl-grid-bar mr-2 mb-2",children:[(0,Dj.jsx)(Ng,{tooltip:m("whiteboard/toggle-grid"),className:"tl-button",pressed:c.settings.showGrid,id:"tl-show-grid",onPressedChange:La,children:(0,Dj.jsx)(hh,{name:"grid-dots"})}),!c.readOnly&&(0,Dj.jsx)(Ng,{tooltip:m("whiteboard/snap-to-grid"),className:"tl-button",pressed:c.settings.snapToGrid,id:"tl-snap-to-grid",onPressedChange:fb,children:(0,Dj.jsx)(hh,{name:c.settings.snapToGrid?"magnet":"magnet-off"})})]}),
!c.readOnly&&(0,Dj.jsx)("div",{className:"tl-toolbar tl-pen-mode-bar mb-2",children:(0,Dj.jsx)(Ng,{tooltip:m("whiteboard/toggle-pen-mode"),className:"tl-button",pressed:c.settings.penMode,id:"tl-toggle-pen-mode",onPressedChange:vb,children:(0,Dj.jsx)(hh,{name:c.settings.penMode?"pencil":"pencil-off"})})})]})}),tx=Qf(ea(22)),wB=Qf(ea(23)),Gt=ea(581),Sr=c=>`[${c.map(m=>{var M;return null!=(M=null==m?void 0:m.toFixed(2))?M:"-"}).join(", ")}]`,xB=Ee(()=>{var c;const {viewport:{bounds:m,camera:{point:M,
zoom:ca}},inputs:ua}=nd(),Ga=tx.default.useRef();tx.default.useEffect(()=>{const fb=document.getElementById("tl-statusbar-anchor");Ga.current=fb},[]);const La=[["Z",null!=(c=null==ca?void 0:ca.toFixed(2))?c:"null"],["MP",Sr(ua.currentPoint)],["MS",Sr(ua.currentScreenPoint)],["VP",Sr(M)],["VBR",Sr([m.maxX,m.maxY])]].map(fb=>fb.join("")).join("|");c=Ga.current?wB.default.createPortal((0,Gt.jsx)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:La}),Ga.current):null;return(0,Gt.jsx)(Gt.Fragment,
{children:c})}),Nq=Qf(ea(22)),Tr=ea(581),jm=Ee(c=>{var {id:m,icon:M,tooltip:ca,tooltipSide:ua="left",handleClick:Ga}=c;c=Ti(c,["id","icon","tooltip","tooltipSide","handleClick"]);var La;const fb=Ve(),vb=null==(La=[...fb.Tools,op,pp])?void 0:La.find(Wb=>Wb.id===m);La=(La=null==vb?void 0:vb.shortcut)&&ca?(0,Tr.jsxs)("div",{className:"flex",children:[ca,(0,Tr.jsx)(Qj,{action:La})]}):ca;return(0,Tr.jsx)(Zh,ng(Gf({},c),{tooltipSide:ua,tooltip:La,"data-tool":m,"data-selected":m===fb.selectedTool.id,onClick:Ga,
children:"string"===typeof M?(0,Tr.jsx)(hh,{name:M}):M}))}),yB=Qf(ea(22)),sn=ea(581),Ht=window.LSUI,ux=Ee(function(c){var {popoverSide:m="left",setGeometry:M,activeGeometry:ca,chevron:ua=!0}=c;c=Ti(c,["popoverSide","setGeometry","activeGeometry","chevron"]);var {handlers:{t:Ga}}=yB.default.useContext(si);const La=[{id:"box",icon:"square",tooltip:Ga("whiteboard/rectangle")},{id:"ellipse",icon:"circle",tooltip:Ga("whiteboard/circle")},{id:"polygon",icon:"triangle",tooltip:Ga("whiteboard/triangle")}];
Ga={id:"shapes",icon:"triangle-square-circle",tooltip:Ga("whiteboard/shape")};Ga=ca?La.find(fb=>fb.id===ca):Ga;return(0,sn.jsxs)(Ht.Popover,{children:[(0,sn.jsx)(Ht.PopoverTrigger,{asChild:!0,children:(0,sn.jsxs)("div",ng(Gf({},c),{className:"tl-geometry-tools-pane-anchor",children:[(0,sn.jsx)(jm,ng(Gf({},Ga),{tooltipSide:m})),ua&&(0,sn.jsx)(hh,{"data-selected":ca,className:"tl-popover-indicator",name:"chevron-down-left"})]}))}),(0,sn.jsx)(Ht.PopoverContent,{className:"p-0 w-auto",side:m,sideOffset:15,
collisionBoundary:document.querySelector(".logseq-tldraw"),children:(0,sn.jsx)("div",{className:`tl-toolbar tl-geometry-toolbar ${["left","right"].includes(m)?"flex-col":"flex-row"}`,children:La.map(fb=>(0,sn.jsx)(jm,{id:fb.id,icon:fb.icon,handleClick:M,tooltipSide:m},fb.id))})})]})}),Ur=ea(581),Vr=window.LSUI,vx=Qf(ea(22)),Rj=ea(581),Wr=window.LSUI,zB=Qf(ea(22)),It=ea(22),AB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,
strokeLinecap:"round",strokeLinejoin:"round"},BB=((c,m)=>{const M=(0,It.forwardRef)((ca,ua)=>{var {color:Ga="currentColor",size:La=24,strokeWidth:fb=2,absoluteStrokeWidth:vb,children:Wb}=ca;ca=Ti(ca,["color","size","strokeWidth","absoluteStrokeWidth","children"]);return(0,It.createElement)("svg",Gf(ng(Gf({ref:ua},AB),{width:La,height:La,stroke:Ga,strokeWidth:vb?24*Number(fb)/Number(La):fb,className:`lucide lucide-${c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`}),ca),[...m.map(([oc,uc])=>
(0,It.createElement)(oc,uc)),...((Array.isArray(Wb)?Wb:[Wb])||[])])});M.displayName=`${c}`;return M})("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Fm=ea(581),wp=window.LSUI,CB=Qf(ea(22)),DB=ea(581),wk=ea(581),wx=window.LSUI,EB=Ee(function(){const c=Ve(),{handlers:{t:m}}=Nq.useContext(si),M=Nq.useCallback(La=>{c.api.setColor(La)},[]),ca=Nq.useCallback(La=>{(La=La.currentTarget.dataset.tool)&&c.selectTool(La)},[]),[ua,Ga]=Nq.useState(()=>{var La;return null!=(La=Object.values(nb).find(fb=>
fb===c.selectedTool.id))?La:Object.values(nb)[0]});Nq.useEffect(()=>{Ga(La=>{var fb;return null!=(fb=Object.values(nb).find(vb=>vb===c.selectedTool.id))?fb:La})},[c.selectedTool.id]);return(0,wk.jsx)("div",{className:"tl-primary-tools","data-html2canvas-ignore":"true",children:(0,wk.jsxs)("div",{className:"tl-toolbar tl-tools-floating-panel",children:[(0,wk.jsx)(jm,{handleClick:()=>c.selectTool("select"),tooltip:m("whiteboard/select"),id:"select",icon:"select-cursor"}),(0,wk.jsx)(jm,{handleClick:()=>
c.selectTool("move"),tooltip:m("whiteboard/pan"),id:"move",icon:c.isIn("move.panning")?"hand-grab":"hand-stop"}),(0,wk.jsx)(wx.Separator,{orientation:"horizontal"}),(0,wk.jsx)(jm,{handleClick:()=>c.selectTool("logseq-portal"),tooltip:m("whiteboard/add-block-or-page"),id:"logseq-portal",icon:"circle-plus"}),(0,wk.jsx)(jm,{handleClick:()=>c.selectTool("pencil"),tooltip:m("whiteboard/draw"),id:"pencil",icon:"ballpen"}),(0,wk.jsx)(jm,{handleClick:()=>c.selectTool("highlighter"),tooltip:m("whiteboard/highlight"),
id:"highlighter",icon:"highlight"}),(0,wk.jsx)(jm,{handleClick:()=>c.selectTool("erase"),tooltip:m("whiteboard/eraser"),id:"erase",icon:"eraser"}),(0,wk.jsx)(jm,{handleClick:()=>c.selectTool("line"),tooltip:m("whiteboard/connector"),id:"line",icon:"connector"}),(0,wk.jsx)(jm,{handleClick:()=>c.selectTool("text"),tooltip:m("whiteboard/text"),id:"text",icon:"text"}),(0,wk.jsx)(ux,{activeGeometry:ua,setGeometry:ca}),(0,wk.jsx)(wx.Separator,{orientation:"horizontal",style:{margin:"0 -4px"}}),(0,wk.jsx)(bj,
{popoverSide:"left",color:c.settings.color,setColor:M}),(0,wk.jsx)(Gl,{scaleLevel:c.settings.scaleLevel,popoverSide:"left",compact:!0})]})})}),Jt=ea(581),FB=Ee(function(){const c=Ve();return(0,Jt.jsxs)("div",{className:"tl-statusbar","data-html2canvas-ignore":"true",children:[c.selectedTool.id," | ",c.selectedTool.currentState.id,(0,Jt.jsx)("div",{style:{flex:1}}),(0,Jt.jsx)("div",{id:"tl-statusbar-anchor",className:"flex gap-1"})]})}),xp=ea(581),GB=Ee(function(){const c=Ve();return(0,xp.jsxs)(xp.Fragment,
{children:[dc()&&(0,xp.jsx)(FB,{}),dc()&&(0,xp.jsx)(xB,{}),!c.readOnly&&(0,xp.jsx)(EB,{}),(0,xp.jsx)(vB,{})]})}),Oq=Qf(ea(22)),Sj=Qf(ea(22)),xx=Qf(ea(22)),HB=Qf(ea(22)),tn=ea(581),yx=({id:c,showReferenceContent:m=!1})=>{var M;const {handlers:{isWhiteboardPage:ca,redirectToPage:ua,sidebarAddBlock:Ga,queryBlockByUUID:La},renderers:{Breadcrumb:fb,PageName:vb}}=HB.default.useContext(si);var Wb="";let oc=rg(c)?"B":"P",uc="";if(rg(c)){Wb=La(c);if(!Wb)return(0,tn.jsx)("span",{className:"p-2",children:"Invalid reference. Did you remove it?"});
uc=Wb.title;Wb="whiteboard-shape"===(null==(M=Wb.properties)?void 0:M["ls-type"])?"link-to-whiteboard":"link-to-block"}else Wb=ca(c)?"link-to-whiteboard":"link-to-page";M=uc&&23<uc.length?uc.slice(0,20)+"...":uc;return(0,tn.jsxs)("button",{className:"inline-flex gap-1 items-center w-full",onPointerDown:Sc=>{Sc.stopPropagation();Sc.shiftKey?Ga(c,"B"===oc?"block":"page"):ua(c)},children:[(0,tn.jsx)(hh,{name:Wb}),(0,tn.jsx)("span",{className:"pointer-events-none block-link-reference-row",children:"P"===
oc?(0,tn.jsx)(vb,{pageName:c}):(0,tn.jsxs)(tn.Fragment,{children:[(0,tn.jsx)(fb,{levelLimit:1,blockId:c,endSeparator:m}),m&&M]})})]})},ak=Qf(ea(22)),Ck=ea(22),IB=["children"],Xr="undefined"!==typeof document?Ck.useLayoutEffect:Ck.useEffect,th=Qf(ea(22)),Rh=ea(22),JB=ea(23),Pq,Tj,KB="undefined"!=typeof document?Rh.useLayoutEffect:Rh.useEffect;!function(c){c[c.DEBUG=0]="DEBUG";c[c.INFO=1]="INFO";c[c.WARN=2]="WARN";c[c.ERROR=3]="ERROR"}(Tj||={});var LB=((Pq={})[Tj.DEBUG]="debug",Pq[Tj.INFO]="log",Pq[Tj.WARN]=
"warn",Pq[Tj.ERROR]="error",Pq),un=sh(function(){var c=jg(Tj.ERROR);return{log:jg(function(m,M,ca){var ua;void 0===ca&&(ca=Tj.INFO);ca>=(null!=(ua=("undefined"==typeof globalThis?window:globalThis).VIRTUOSO_LOG_LEVEL)?ua:c(4))&&console[LB[ca]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",m,M)}),logLevel:c}},[],{singleton:!0}),Dk=sh(function(){var c=ah(),m=ah(),M=jg(0),ca=ah(),ua=jg(0),Ga=ah(),La=ah(),fb=jg(0),vb=jg(0),Wb=jg(0),oc=jg(0),uc=ah(),Sc=ah(),kd=jg(!1),
fd=jg(!1);return Zg(Of(c,Bg(function(xd){return xd.scrollTop})),m),Zg(Of(c,Bg(function(xd){return xd.scrollHeight})),La),Zg(m,ua),{scrollContainerState:c,scrollTop:m,viewportHeight:Ga,headerHeight:fb,fixedHeaderHeight:vb,fixedFooterHeight:Wb,footerHeight:oc,scrollHeight:La,smoothScrollTargetReached:ca,react18ConcurrentRendering:fd,scrollTo:uc,scrollBy:Sc,statefulScrollTop:ua,deviation:M,scrollingInProgress:kd}},[],{singleton:!0}),mi={lvl:0},Kt=sh(function(){return{recalcInProgress:jg(!1)}},[],{singleton:!0}),
MB={offsetHeight:"height",offsetWidth:"width"},Gm=sh(function(c){var m=c[0].log,M=c[1].recalcInProgress;c=ah();var ca=ah(),ua=Oi(ca,0),Ga=ah(),La=ah(),fb=jg(0),vb=jg([]),Wb=jg(void 0),oc=jg(void 0),uc=jg(function(hd,od){return Qb(hd,MB[od])}),Sc=jg(void 0),kd=jg(0),fd={offsetTree:[],sizeTree:mi,groupOffsetTree:mi,lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]},xd=Oi(Of(c,yh(vb,m,kd),wi(uh,fd),wh()),fd);Zg(Of(vb,Ah(function(hd){return 0<hd.length}),yh(xd,kd),Bg(function(hd){var od=hd[0],Kd=hd[1],
zd=hd[2];hd=od.reduce(function(Te,We,eg){return Dd(Te,We,Ui(We,Kd.offsetTree,zd)||eg)},mi);return Ia({},Kd,{groupIndices:od,groupOffsetTree:hd})})),xd);Zg(Of(ca,yh(xd),Ah(function(hd){return hd[0]<hd[1].lastIndex}),Bg(function(hd){var od=hd[1];return[{startIndex:hd[0],endIndex:od.lastIndex,size:od.lastSize}]})),c);Zg(Wb,oc);var Jd=Oi(Of(Wb,Bg(function(hd){return void 0===hd})),!0);Zg(Of(oc,Ah(function(hd){return void 0!==hd&&xd(4).sizeTree===mi}),Bg(function(hd){return[{startIndex:0,endIndex:0,size:hd}]})),
c);fd=Si(Of(c,yh(xd),wi(function(hd,od){od=od[1];return{changed:od!==hd.sizes,sizes:od}},{changed:!1,sizes:fd}),Bg(function(hd){return hd.changed})));li(Of(fb,wi(function(hd,od){return{diff:hd.prev-od,prev:od}},{diff:0,prev:0}),Bg(function(hd){return hd.diff})),function(hd){0<hd?(M(0,!0),Ga(0,hd)):0>hd&&La(0,hd)});li(Of(fb,yh(m)),function(hd){0>hd[0]&&(0,hd[1])("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:fb},
Tj.ERROR)});m=Si(Ga);Zg(Of(Ga,yh(xd),Bg(function(hd){var od=hd[0];hd=hd[1];if(0<hd.groupIndices.length)throw Error("Virtuoso: prepending items does not work with groups");return se(hd.sizeTree).reduce(function(Kd,zd){var Te=zd.k;zd=zd.v;return{ranges:[].concat(Kd.ranges,[{startIndex:Kd.prevIndex,endIndex:Te+od-1,size:Kd.prevSize}]),prevIndex:Te+od,prevSize:zd}},{ranges:[],prevIndex:0,prevSize:hd.lastSize}).ranges})),c);var $c=Si(Of(La,yh(xd,kd),Bg(function(hd){return Ui(-hd[0],hd[1].offsetTree,hd[2])})));
return Zg(Of(La,yh(xd,kd),Bg(function(hd){var od=hd[0],Kd=hd[1];hd=hd[2];if(0<Kd.groupIndices.length)throw Error("Virtuoso: shifting items does not work with groups");var zd=se(Kd.sizeTree).reduce(function(Te,We){return Dd(Te,Math.max(0,We.k+od),We.v)},mi);return Ia({},Kd,{sizeTree:zd},gi(Kd.offsetTree,0,zd,hd))})),xd),{data:Sc,totalCount:ca,sizeRanges:c,groupIndices:vb,defaultItemSize:oc,fixedItemSize:Wb,unshiftWith:Ga,shiftWith:La,shiftWithOffset:$c,beforeUnshiftWith:m,firstItemIndex:fb,gap:kd,
sizes:xd,listRefresh:fd,statefulTotalCount:ua,trackItemSizes:Jd,itemSize:uc}},bi(un,Kt),{singleton:!0}),NB="undefined"!=typeof document&&"scrollBehavior"in document.documentElement.style,Qq=sh(function(c){function m(){Jd&&(Jd(),Jd=null);hd&&(hd(),hd=null);$c&&(clearTimeout($c),$c=null);fb(0,!1)}var M=c[0],ca=M.sizes,ua=M.totalCount,Ga=M.listRefresh;M=M.gap;var La=c[1],fb=La.scrollingInProgress,vb=La.viewportHeight,Wb=La.scrollTo,oc=La.smoothScrollTargetReached,uc=La.headerHeight,Sc=La.footerHeight,
kd=La.fixedHeaderHeight;La=La.fixedFooterHeight;c=c[2].log;var fd=ah(),xd=jg(0),Jd=null,$c=null,hd=null;return Zg(Of(fd,yh(ca,vb,ua,xd,uc,Sc,c),yh(M,kd,La),Bg(function(od){var Kd=od[0],zd=Kd[0],Te=Kd[1],We=Kd[2],eg=Kd[3],of=Kd[4],Tf=Kd[5],Jg=Kd[6],bh=Kd[7],Eg=od[1];Kd=od[2];od=od[3];var ch=kj(zd),Bf=ch.align,If=ch.behavior,Ef=ch.offset;--eg;ch=Hh(ch,Te,eg);Tf=Ui(ch,Te.offsetTree,Eg)+Tf;"end"===Bf?(Tf+=Kd+vd(Te.sizeTree,ch)[1]-We+od,ch===eg&&(Tf+=Jg)):"center"===Bf?Tf+=(Kd+vd(Te.sizeTree,ch)[1]-We+
od)/2:Tf-=of;Ef&&(Tf+=Ef);var Yf=function(Fh){m();Fh?(bh("retrying to scroll to",{location:zd},Tj.DEBUG),fd(0,zd)):bh("list did not change, scroll successful",{},Tj.DEBUG)};if(m(),"smooth"===If){var dh=!1;hd=li(Ga,function(Fh){dh=dh||Fh});Jd=sk(oc,function(){Yf(dh)})}else Jd=sk(Of(Ga,function(Fh){var Pi=setTimeout(function(){Fh(!1)},150);return function(fi){fi&&(Fh(!0),clearTimeout(Pi))}}),Yf);$c=setTimeout(function(){m()},1200);fb(0,!0);return bh("scrolling from index to",{index:ch,top:Tf,behavior:If},
Tj.DEBUG),{top:Tf,behavior:If}})),Wb),{scrollToIndex:fd,topListHeight:xd}},bi(Gm,Dk,un),{singleton:!0}),OB={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},Rq=sh(function(c){var m=c[0],M=m.scrollContainerState;c=m.scrollTop;var ca=m.viewportHeight,ua=m.headerHeight,Ga=m.footerHeight,La=m.scrollBy;m=jg(!1);var fb=jg(!0),vb=ah(),Wb=ah(),oc=jg(4),uc=jg(0),Sc=Oi(Of(Am(Of(Lh(c),Wj(1),Ej(!0)),Of(Lh(c),Wj(1),Ej(!1),Cl(100))),wh()),
!1),kd=Oi(Of(Am(Of(La,Ej(!0)),Of(La,Ej(!1),Cl(200))),wh()),!1);Zg(Of(zi(Lh(c),Lh(uc)),Bg(function(fd){return fd[0]<=fd[1]}),wh()),fb);Zg(Of(fb,Xj(50)),Wb);ca=Si(Of(zi(M,Lh(ca),Lh(ua),Lh(Ga),Lh(oc)),wi(function(fd,xd){var Jd,$c,hd=xd[0],od=hd.scrollTop;hd=hd.scrollHeight;var Kd=xd[1],zd={viewportHeight:Kd,scrollTop:od,scrollHeight:hd};return od+Kd-hd>-xd[4]?(od>fd.state.scrollTop?(Jd="SCROLLED_DOWN",$c=fd.state.scrollTop-od):(Jd="SIZE_DECREASED",$c=fd.state.scrollTop-od||fd.scrollTopDelta),{atBottom:!0,
state:zd,atBottomBecause:Jd,scrollTopDelta:$c}):{atBottom:!1,notAtBottomBecause:zd.scrollHeight>fd.state.scrollHeight?"SIZE_INCREASED":Kd<fd.state.viewportHeight?"VIEWPORT_HEIGHT_DECREASING":od<fd.state.scrollTop?"SCROLLING_UPWARDS":"NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",state:zd}},OB),wh(function(fd,xd){return fd&&fd.atBottom===xd.atBottom})));ua=Oi(Of(M,wi(function(fd,xd){var Jd=xd.scrollTop,$c=xd.scrollHeight;xd=xd.viewportHeight;return 1.01>Math.abs(fd.scrollHeight-$c)?{scrollTop:Jd,scrollHeight:$c,
jump:0,changed:!1}:fd.scrollTop!==Jd&&1>$c-(Jd+xd)?{scrollHeight:$c,scrollTop:Jd,jump:fd.scrollTop-Jd,changed:!0}:{scrollHeight:$c,scrollTop:Jd,jump:0,changed:!0}},{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),Ah(function(fd){return fd.changed}),Bg(function(fd){return fd.jump})),0);Zg(Of(ca,Bg(function(fd){return fd.atBottom})),m);Zg(Of(m,Xj(50)),vb);Ga=jg("down");Zg(Of(M,Bg(function(fd){return fd.scrollTop}),wh(),wi(function(fd,xd){return kd(4)?{direction:fd.direction,prevScrollTop:xd}:{direction:xd<
fd.prevScrollTop?"up":"down",prevScrollTop:xd}},{direction:"down",prevScrollTop:0}),Bg(function(fd){return fd.direction})),Ga);Zg(Of(M,Xj(50),Ej("none")),Ga);M=jg(0);return Zg(Of(Sc,Ah(function(fd){return!fd}),Ej(0)),M),Zg(Of(c,Xj(100),yh(Sc),Ah(function(fd){return!!fd[1]}),wi(function(fd,xd){return[fd[1],xd[0]]},[0,0]),Bg(function(fd){return fd[1]-fd[0]})),M),{isScrolling:Sc,isAtTop:fb,isAtBottom:m,atBottomState:ca,atTopStateChange:Wb,atBottomStateChange:vb,scrollDirection:Ga,atBottomThreshold:oc,
atTopThreshold:uc,scrollVelocity:M,lastJumpDueToItemResize:ua}},bi(Dk)),xo=sh(function(c){var m=c[0].log;c=jg(!1);var M=Si(Of(c,Ah(function(ca){return ca}),wh()));return li(c,function(ca){ca&&m(4)("props updated",{},Tj.DEBUG)}),{propsReady:c,didMount:M}},bi(un),{singleton:!0}),Lt=sh(function(c){var m=c[0],M=m.sizes,ca=m.listRefresh;m=m.defaultItemSize;var ua=c[1].scrollTop,Ga=c[2].scrollToIndex;c=c[3].didMount;var La=jg(!0),fb=jg(0);return Zg(Of(c,yh(fb),Ah(function(vb){return!!vb[1]}),Ej(!1)),La),
li(Of(zi(ca,c),yh(La,M,m),Ah(function(vb){var Wb=vb[1],oc=vb[3];return vb[0][1]&&(vb[2].sizeTree!==mi||void 0!==oc)&&!Wb}),yh(fb)),function(vb){var Wb=vb[1];setTimeout(function(){sk(ua,function(){La(0,!0)});Ga(0,Wb)})}),{scrolledToInitialItem:La,initialTopMostItemIndex:fb}},bi(Gm,Dk,Qq,xo),{singleton:!0}),PB=sh(function(c){function m(xd){vb(0,{index:"LAST",align:"end",behavior:xd})}function M(xd){var Jd=sk(fb,function($c){!xd||$c.atBottom||"SIZE_INCREASED"!==$c.notAtBottomBecause||fd||(uc(4)("scrolling to bottom due to increased size",
{},Tj.DEBUG),m("auto"))});setTimeout(Jd,100)}var ca=c[0],ua=ca.totalCount,Ga=ca.listRefresh,La=c[1];ca=La.isAtBottom;var fb=La.atBottomState,vb=c[2].scrollToIndex;La=c[3].scrolledToInitialItem;var Wb=c[4],oc=Wb.propsReady;Wb=Wb.didMount;var uc=c[5].log;c=c[6].scrollingInProgress;var Sc=jg(!1),kd=ah(),fd=null;return li(Of(zi(Of(Lh(ua),Wj(1)),Wb),yh(Lh(Sc),ca,La,c),Bg(function(xd){var Jd=xd[0],$c=Jd[0];Jd=Jd[1]&&xd[3];var hd="auto";Jd&&(hd=xd[1],xd=xd[2]||xd[4],hd="function"==typeof hd?Qn(hd(xd)):xd&&
Qn(hd),Jd=Jd&&!!hd);return{totalCount:$c,shouldFollow:Jd,followOutputBehavior:hd}}),Ah(function(xd){return xd.shouldFollow})),function(xd){var Jd=xd.totalCount,$c=xd.followOutputBehavior;fd&&(fd(),fd=null);fd=sk(Ga,function(){uc(4)("following output to ",{totalCount:Jd},Tj.DEBUG);m($c);fd=null})}),li(Of(zi(Lh(Sc),ua,oc),Ah(function(xd){return xd[0]&&xd[2]}),wi(function(xd,Jd){Jd=Jd[1];return{refreshed:xd.value===Jd,value:Jd}},{refreshed:!1,value:0}),Ah(function(xd){return xd.refreshed}),yh(Sc,ua)),
function(xd){M(!1!==xd[1])}),li(kd,function(){M(!1!==Sc(4))}),li(zi(Lh(Sc),fb),function(xd){var Jd=xd[1];xd[0]&&!Jd.atBottom&&"VIEWPORT_HEIGHT_DECREASING"===Jd.notAtBottomBecause&&m("auto")}),{followOutput:Sc,autoscrollToBottom:kd}},bi(Gm,Rq,Qq,Lt,xo,un,Dk)),zx=sh(function(c){var m=c[0],M=m.totalCount,ca=m.groupIndices;m=m.sizes;var ua=c[1];c=ua.scrollTop;ua=ua.headerHeight;var Ga=ah(),La=ah(),fb=Si(Of(Ga,Bg(gl)));return Zg(Of(fb,Bg(function(vb){return vb.totalCount})),M),Zg(Of(fb,Bg(function(vb){return vb.groupIndices})),
ca),Zg(Of(zi(c,m,ua),Ah(function(vb){return vb[1].groupOffsetTree!==mi}),Bg(function(vb){return vd(vb[1].groupOffsetTree,Math.max(vb[0]-vb[2],0),"v")[0]}),wh(),Bg(function(vb){return[vb]})),La),{groupCounts:Ga,topItemsIndexes:La}},bi(Gm,Dk)),Mt=sh(function(c){var m=c[0];c=m.scrollTop;var M=m.viewportHeight,ca=m.deviation,ua=m.headerHeight,Ga=m.fixedHeaderHeight;m=ah();var La=jg(0),fb=jg(0),vb=jg(0);c=Oi(Of(zi(Lh(c),Lh(M),Lh(ua),Lh(m,Pm),Lh(vb),Lh(La),Lh(Ga),Lh(ca),Lh(fb)),Bg(function(Wb){var oc=Wb[0],
uc=Wb[1],Sc=Wb[2],kd=Wb[3],fd=kd[0];kd=kd[1];var xd=Wb[4],Jd=Wb[6],$c=Wb[7],hd=Wb[8],od=oc-$c;Wb=Wb[5]+Jd;var Kd=Math.max(Sc-od,0),zd="none",Te="number"==typeof hd?hd:hd.top||0;hd="number"==typeof hd?hd:hd.bottom||0;return fd-=$c,kd+=Sc+Jd,fd+(Sc+Jd)>oc+Wb-Te&&(zd="up"),kd-$c<oc-Kd+uc+hd&&(zd="down"),"none"!==zd?[Math.max(od-Sc-Rn(xd,"top",zd)-Te,0),od-Kd-Jd+uc+Rn(xd,"bottom",zd)+hd]:null}),Ah(function(Wb){return null!=Wb}),wh(Pm)),[0,0]);return{listBoundary:m,overscan:vb,topListHeight:La,increaseViewportBy:fb,
visibleRange:c}},bi(Dk),{singleton:!0}),Ax={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0},yp=sh(function(c){var m=c[0],M=m.sizes,ca=m.totalCount,ua=m.data,Ga=m.firstItemIndex,La=m.gap,fb=c[1],vb=c[2],Wb=vb.visibleRange;m=vb.listBoundary;vb=vb.topListHeight;var oc=c[3],uc=oc.scrolledToInitialItem,Sc=oc.initialTopMostItemIndex;oc=c[4].topListHeight;var kd=c[5],fd=c[6].didMount,xd=c[7].recalcInProgress;c=jg([]);var Jd=ah();Zg(fb.topItemsIndexes,
c);M=Oi(Of(zi(fd,xd,Lh(Wb,Pm),Lh(ca),Lh(M),Lh(Sc),uc,Lh(c),Lh(Ga),Lh(La),ua),Ah(function($c){return $c[0]&&!$c[1]}),Bg(function($c){var hd=$c[2],od=hd[0],Kd=hd[1];hd=$c[3];var zd=$c[5],Te=$c[6],We=$c[7],eg=$c[8],of=$c[9],Tf=$c[10];$c=$c[4];var Jg=$c.sizeTree,bh=$c.offsetTree;if(0===hd||0===od&&0===Kd)return Ia({},Ax,{totalCount:hd});if(Jg===mi)return Lo(function(fi,Wg,Gi){return Wg.groupOffsetTree!==mi?(fi=Ai(fi,Wg),[{index:vd(Wg.groupOffsetTree,fi)[0],size:0,offset:0},{index:fi,size:0,offset:0,data:Gi&&
Gi[0]}]):[{index:fi,size:0,offset:0,data:Gi&&Gi[0]}]}("number"==typeof zd?zd:"LAST"===zd.index?hd-1:zd.index,$c,Tf),[],hd,of,$c,eg);zd=[];if(0<We.length){var Eg,ch=We[0],Bf=We[We.length-1],If=0;for(Jg=Tb(Ug(Jg,ch,Bf));!(Eg=Jg()).done;){var Ef=Eg.value;Eg=Ef.value;var Yf=Math.min(Ef.end,Bf);for(Ef=Math.max(Ef.start,ch);Ef<=Yf;Ef++)zd.push({index:Ef,size:Eg,offset:If,data:Tf&&Tf[Ef]}),If+=Eg}}if(!Te)return Lo([],zd,hd,of,$c,eg);var dh=0<We.length?We[We.length-1]+1:0,Fh=function(fi,Wg,Gi,Ji){return void 0===
Ji&&(Ji=0),0<Ji&&(Wg=Math.max(Wg,fi[mh(fi,Ji,Jf)].offset)),zg((Hk=Gi,tu=mh(Wi=fi,Wg,zn=oi),uu=mh(Wi,Hk,zn,tu),Wi.slice(tu,uu+1)),Ch);var Wi,Hk,zn,tu,uu}(bh,od,Kd,dh);if(0===Fh.length)return null;var Pi=hd-1;return Lo(Zj([],function(fi){for(var Wg,Gi=Tb(Fh);!(Wg=Gi()).done;){var Ji=Wg.value,Wi=Ji.value;Wg=Wi.offset;var Hk=Ji.start,zn=Wi.size;Wi.offset<od&&(Wi=(Hk+=Math.floor((od-Wi.offset+of)/(zn+of)))-Ji.start,Wg+=Wi*zn+Wi*of);Hk<dh&&(Wg+=(dh-Hk)*zn,Hk=dh);for(Ji=Math.min(Ji.end,Pi);Hk<=Ji&&!(Wg>=
Kd);Hk++)fi.push({index:Hk,size:zn,offset:Wg,data:Tf&&Tf[Hk]}),Wg+=zn+of}}),zd,hd,of,$c,eg)}),Ah(function($c){return null!==$c}),wh()),Ax);return Zg(Of(ua,Ah(function($c){return void 0!==$c}),Bg(function($c){return $c.length})),ca),Zg(Of(M,Bg(function($c){return $c.topListHeight})),oc),Zg(oc,vb),Zg(Of(M,Bg(function($c){return[$c.top,$c.bottom]})),m),Zg(Of(M,Bg(function($c){return $c.items})),Jd),Ia({listState:M,topItemsIndexes:c,endReached:Si(Of(M,Ah(function($c){return 0<$c.items.length}),yh(ca,
ua),Ah(function($c){var hd=$c[0].items;return hd[hd.length-1].originalIndex===$c[1]-1}),Bg(function($c){return[$c[1]-1,$c[2]]}),wh(Pm),Bg(function($c){return $c[0]}))),startReached:Si(Of(M,Xj(200),Ah(function($c){var hd=$c.items;return 0<hd.length&&hd[0].originalIndex===$c.topItems.length}),Bg(function($c){return $c.items[0].index}),wh())),rangeChanged:Si(Of(M,Ah(function($c){return 0<$c.items.length}),Bg(function($c){$c=$c.items;for(var hd=0,od=$c.length-1;"group"===$c[hd].type&&hd<od;)hd++;for(;"group"===
$c[od].type&&od>hd;)od--;return{startIndex:$c[hd].index,endIndex:$c[od].index}}),wh(yk))),itemsRendered:Jd},kd)},bi(Gm,zx,Mt,Lt,Qq,Rq,xo,Kt),{singleton:!0}),QB=sh(function(c){var m=c[0],M=m.sizes,ca=m.firstItemIndex,ua=m.data;m=m.gap;var Ga=c[1].listState;c=c[2].didMount;var La=jg(0);return Zg(Of(c,yh(La),Ah(function(fb){return 0!==fb[1]}),yh(M,ca,m,ua),Bg(function(fb){var vb=fb[0][1],Wb=fb[1],oc=fb[2],uc=fb[3];fb=fb[4];var Sc=void 0===fb?[]:fb;fb=0;if(0<Wb.groupIndices.length)for(var kd,fd=Tb(Wb.groupIndices);!((kd=
fd()).done||kd.value-fb>=vb);)fb++;vb+=fb;return Lo(Array.from({length:vb}).map(function(xd,Jd){return{index:Jd,size:0,offset:0,data:Sc[Jd]}}),[],vb,uc,Wb,oc)})),Ga),{initialItemCount:La}},bi(Gm,yp,xo),{singleton:!0}),Bx=sh(function(c){c=c[0].scrollVelocity;var m=jg(!1),M=ah(),ca=jg(!1);return Zg(Of(c,yh(ca,m,M),Ah(function(ua){return!!ua[1]}),Bg(function(ua){var Ga=ua[0],La=ua[1],fb=ua[2];ua=ua[3];var vb=La.enter;if(fb){if((0,La.exit)(Ga,ua))return!1}else if(vb(Ga,ua))return!0;return fb}),wh()),
m),li(Of(zi(m,c,M),yh(ca)),function(ua){var Ga=ua[0];ua=ua[1];return Ga[0]&&ua&&ua.change&&ua.change(Ga[1],Ga[2])}),{isSeeking:m,scrollSeekConfiguration:ca,scrollVelocity:c,scrollSeekRangeChanged:M}},bi(Rq),{singleton:!0}),RB=sh(function(c){c=c[0].topItemsIndexes;var m=jg(0);return Zg(Of(m,Ah(function(M){return 0<M}),Bg(function(M){return Array.from({length:M}).map(function(ca,ua){return ua})})),c),{topItemCount:m}},bi(yp)),Nt=sh(function(c){var m=c[0],M=m.footerHeight,ca=m.headerHeight,ua=m.fixedHeaderHeight;
m=m.fixedFooterHeight;var Ga=c[1].listState;c=ah();M=Oi(Of(zi(M,m,ca,ua,Ga),Bg(function(La){var fb=La[4];return La[0]+La[1]+La[2]+La[3]+fb.offsetBottom+fb.bottom})),0);return Zg(Lh(M),c),{totalListHeight:M,totalListHeightChanged:c}},bi(Dk,yp),{singleton:!0}),SB=Qm(function(){return/iP(ad|hone|od).+Version\/[\d.]+.*Safari/i.test(navigator.userAgent)}),TB=sh(function(c){function m(Jd){0<Jd?(ca(0,{top:-Jd,behavior:"auto"}),Ga(0,0)):(Ga(0,0),ca(0,{top:-Jd,behavior:"auto"}))}var M=c[0],ca=M.scrollBy,ua=
M.scrollTop,Ga=M.deviation,La=M.scrollingInProgress,fb=c[1];M=fb.isScrolling;var vb=fb.isAtBottom,Wb=fb.scrollDirection,oc=c[3],uc=oc.beforeUnshiftWith,Sc=oc.shiftWithOffset,kd=oc.sizes;oc=oc.gap;var fd=c[4].log,xd=c[5].recalcInProgress;c=Si(Of(c[2].listState,yh(fb.lastJumpDueToItemResize),wi(function(Jd,$c){var hd=Jd[1],od=$c[0],Kd=od.items,zd=od.totalCount;od=od.bottom+od.offsetBottom;var Te=0;return Jd[2]===zd&&0<hd.length&&0<Kd.length&&(0===Kd[0].originalIndex&&0===hd[0].originalIndex||0!=(Te=
od-Jd[3])&&(Te+=$c[1])),[Te,Kd,zd,od]},[0,[],0,0]),Ah(function(Jd){return 0!==Jd[0]}),yh(ua,Wb,La,vb,fd),Ah(function(Jd){return!Jd[3]&&0!==Jd[1]&&"up"===Jd[2]}),Bg(function(Jd){var $c=Jd[0][0];return(0,Jd[5])("Upward scrolling compensation",{amount:$c},Tj.DEBUG),$c})));return li(Of(c,yh(Ga,M)),function(Jd){var $c=Jd[0],hd=Jd[1];Jd[2]&&SB()?Ga(0,hd-$c):m(-$c)}),li(Of(zi(Oi(M,!1),Ga,xd),Ah(function(Jd){return!Jd[0]&&!Jd[2]&&0!==Jd[1]}),Bg(function(Jd){return Jd[1]}),Xj(1)),m),Zg(Of(Sc,Bg(function(Jd){return{top:-Jd}})),
ca),li(Of(uc,yh(kd,oc),Bg(function(Jd){var $c=Jd[0];return $c*Jd[1].lastSize+$c*Jd[2]})),function(Jd){Ga(0,Jd);requestAnimationFrame(function(){Hl(ca,{top:Jd});requestAnimationFrame(function(){Ga(0,0);xd(0,!1)})})}),{deviation:Ga}},bi(Dk,Rq,yp,Gm,un,Kt)),UB=sh(function(c){var m=c[0].totalListHeight,M=c[1].didMount,ca=c[2].scrollTo;c=jg(0);return li(Of(M,yh(c),Ah(function(ua){return 0!==ua[1]}),Bg(function(ua){return{top:ua[1]}})),function(ua){sk(Of(m,Ah(function(Ga){return 0!==Ga})),function(){setTimeout(function(){ca(0,
ua)})})}),{initialScrollTop:c}},bi(Nt,xo,Dk),{singleton:!0}),VB=sh(function(c){var m=c[0].viewportHeight;c=c[1].totalListHeight;var M=jg(!1);return{alignToBottom:M,paddingTopAddition:Oi(Of(zi(M,m,c),Ah(function(ca){return ca[0]}),Bg(function(ca){return Math.max(0,ca[1]-ca[2])}),wh()),0)}},bi(Dk,Nt),{singleton:!0}),Cx=sh(function(c){var m=c[0];c=m.scrollTo;m=m.scrollContainerState;var M=ah(),ca=ah(),ua=ah(),Ga=jg(!1),La=jg(void 0);return Zg(Of(zi(M,ca),Bg(function(fb){var vb=fb[0];return{scrollTop:Math.max(0,
vb.scrollTop-fb[1].offsetTop),scrollHeight:vb.scrollHeight,viewportHeight:vb.viewportHeight}})),m),Zg(Of(c,yh(ca),Bg(function(fb){var vb=fb[0];return Ia({},vb,{top:vb.top+fb[1].offsetTop})})),ua),{useWindowScroll:Ga,customScrollParent:La,windowScrollContainerState:M,windowViewportRect:ca,windowScrollTo:ua}},bi(Dk)),WB=["done","behavior","align"],XB=sh(function(c){var m=c[0],M=m.sizes,ca=m.totalCount;m=m.gap;var ua=c[1],Ga=ua.scrollTop,La=ua.viewportHeight,fb=ua.headerHeight,vb=ua.fixedHeaderHeight,
Wb=ua.fixedFooterHeight,oc=ua.scrollingInProgress;c=c[2].scrollToIndex;ua=ah();return Zg(Of(ua,yh(M,La,ca,fb,vb,Wb,Ga),yh(m),Bg(function(uc){var Sc=uc[0],kd=Sc[0],fd=Sc[1],xd=Sc[2],Jd=Sc[3],$c=Sc[4],hd=Sc[5],od=Sc[6];Sc=Sc[7];var Kd=uc[1];uc=kd.done;var zd=kd.behavior,Te=kd.align,We=zc(kd,WB),eg=null;kd=Hh(kd,fd,Jd-1);$c=Ui(kd,fd.offsetTree,Kd)+$c+hd;return $c<Sc+hd?eg=Ia({},We,{behavior:zd,align:null!=Te?Te:"start"}):$c+vd(fd.sizeTree,kd)[1]>Sc+xd-od&&(eg=Ia({},We,{behavior:zd,align:null!=Te?Te:
"end"})),eg?uc&&sk(Of(oc,Wj(1),Ah(function(of){return!1===of})),uc):uc&&uc(),eg}),Ah(function(uc){return null!==uc})),c),{scrollIntoView:ua}},bi(Gm,Dk,Qq,yp,un),{singleton:!0}),YB=["listState","topItemsIndexes"],ZB=sh(function(c){return Ia({},c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])},bi(Mt,QB,xo,Bx,Nt,UB,VB,Cx,XB)),Dx=sh(function(c){var m=c[0],M=m.totalCount,ca=m.sizeRanges,ua=m.fixedItemSize,Ga=m.defaultItemSize,La=m.trackItemSizes,fb=m.itemSize,vb=m.data,Wb=m.firstItemIndex,oc=m.groupIndices,
uc=m.statefulTotalCount;m=m.gap;var Sc=c[1],kd=Sc.initialTopMostItemIndex;Sc=Sc.scrolledToInitialItem;var fd=c[2],xd=c[3],Jd=c[4],$c=Jd.listState,hd=Jd.topItemsIndexes;Jd=zc(Jd,YB);var od=c[5].scrollToIndex,Kd=c[7].topItemCount,zd=c[8].groupCounts,Te=c[9];c=c[10];return Zg(Jd.rangeChanged,Te.scrollSeekRangeChanged),Zg(Of(Te.windowViewportRect,Bg(function(We){return We.visibleHeight})),fd.viewportHeight),Ia({totalCount:M,data:vb,firstItemIndex:Wb,sizeRanges:ca,initialTopMostItemIndex:kd,scrolledToInitialItem:Sc,
topItemsIndexes:hd,topItemCount:Kd,groupCounts:zd,fixedItemHeight:ua,defaultItemHeight:Ga,gap:m},xd,{statefulTotalCount:uc,listState:$c,scrollToIndex:od,trackItemSizes:La,itemSize:fb,groupIndices:oc},Jd,Te,fd,c)},bi(Gm,Lt,Dk,PB,yp,Qq,TB,RB,zx,ZB,un)),Ex=Qm(function(){if("undefined"==typeof document)return"sticky";var c=document.createElement("div");return c.style.position="-webkit-sticky","-webkit-sticky"===c.style.position?"-webkit-sticky":"sticky"}),Yr=th.createContext(void 0),Fx=th.createContext(void 0),
$B=["placeholder"],aC=["style","children"],bC=["style","children"],cC=sh(function(){var c=jg(function(vb){return"Item "+vb}),m=jg(null),M=jg(function(vb){return"Group "+vb}),ca=jg({}),ua=jg(um),Ga=jg("div"),La=jg(cj),fb=function(vb,Wb){return void 0===Wb&&(Wb=null),Oi(Of(ca,Bg(function(oc){return oc[vb]}),wh()),Wb)};return{context:m,itemContent:c,groupContent:M,components:ca,computeItemKey:ua,headerFooterTag:Ga,scrollerRef:La,FooterComponent:fb("Footer"),HeaderComponent:fb("Header"),TopItemListComponent:fb("TopItemList"),
ListComponent:fb("List","div"),ItemComponent:fb("Item","div"),GroupComponent:fb("Group","div"),ScrollerComponent:fb("Scroller","div"),EmptyPlaceholder:fb("EmptyPlaceholder"),ScrollSeekPlaceholder:fb("ScrollSeekPlaceholder")}}),dC=sh(function(c){function m(ua,Ga,La){Zg(Of(ua,yh(ca.components),Bg(function(fb){var vb,Wb=fb[0];fb=fb[1];return console.warn("react-virtuoso: "+La+" property is deprecated. Pass components."+Ga+" instead."),Ia({},fb,((vb={})[Ga]=Wb,vb))})),ca.components)}var M=c[0],ca=c[1];
c={item:Lj(ca.itemContent,"Rename the %citem%c prop to %citemContent."),group:Lj(ca.groupContent,"Rename the %cgroup%c prop to %cgroupContent."),topItems:Lj(M.topItemCount,"Rename the %ctopItems%c prop to %ctopItemCount."),itemHeight:Lj(M.fixedItemHeight,"Rename the %citemHeight%c prop to %cfixedItemHeight."),scrollingStateChange:Lj(M.isScrolling,"Rename the %cscrollingStateChange%c prop to %cisScrolling."),adjustForPrependedItems:ah(),maxHeightCacheSize:ah(),footer:ah(),header:ah(),HeaderContainer:ah(),
FooterContainer:ah(),ItemContainer:ah(),ScrollContainer:ah(),GroupContainer:ah(),ListContainer:ah(),emptyComponent:ah(),scrollSeek:ah()};return li(c.adjustForPrependedItems,function(){console.warn("react-virtuoso: adjustForPrependedItems is no longer supported. Use the firstItemIndex property instead - https://virtuoso.dev/prepend-items.","color: red;","color: inherit;","color: blue;")}),li(c.maxHeightCacheSize,function(){console.warn("react-virtuoso: maxHeightCacheSize is no longer necessary. Setting it has no effect - remove it from your code.")}),
li(c.HeaderContainer,function(){console.warn("react-virtuoso: HeaderContainer is deprecated. Use headerFooterTag if you want to change the wrapper of the header component and pass components.Header to change its contents.")}),li(c.FooterContainer,function(){console.warn("react-virtuoso: FooterContainer is deprecated. Use headerFooterTag if you want to change the wrapper of the footer component and pass components.Footer to change its contents.")}),li(c.scrollSeek,function(ua){var Ga=ua.placeholder;
ua=zc(ua,$B);console.warn("react-virtuoso: scrollSeek property is deprecated. Pass scrollSeekConfiguration and specify the placeholder in components.ScrollSeekPlaceholder instead.");Ga=Ia({},(0,ca.components)(4),{ScrollSeekPlaceholder:Ga});(0,ca.components)(0,Ga);(0,M.scrollSeekConfiguration)(0,ua)}),m(c.footer,"Footer","footer"),m(c.header,"Header","header"),m(c.ItemContainer,"Item","ItemContainer"),m(c.ListContainer,"List","ListContainer"),m(c.ScrollContainer,"Scroller","ScrollContainer"),m(c.emptyComponent,
"EmptyPlaceholder","emptyComponent"),m(c.GroupContainer,"Group","GroupContainer"),Ia({},M,ca,c)},bi(Dx,cC)),eC=function(c){return th.createElement("div",{style:{height:c.height}})},fC={position:Ex(),zIndex:1,overflowAnchor:"none"},gC={overflowAnchor:"none"},Gx=th.memo(function(c){c=c.showTopList;c=void 0!==c&&c;var m=yi("listState"),M=wl("sizeRanges"),ca=yi("useWindowScroll"),ua=yi("customScrollParent"),Ga=wl("windowScrollContainerState"),La=wl("scrollContainerState");ca=ua||ca?Ga:La;var fb=yi("itemContent"),
vb=yi("context"),Wb=yi("groupContent");Ga=yi("trackItemSizes");La=yi("itemSize");var oc=yi("log"),uc=wl("gap");M=Vb(M,La,Ga,c?cj:ca,oc,uc,ua).callbackRef;ua=th.useState(0);var Sc=ua[0],kd=ua[1];Ot("deviation",function(Kd){Sc!==Kd&&kd(Kd)});ua=yi("EmptyPlaceholder");var fd=yi("ScrollSeekPlaceholder")||eC;ca=yi("ListComponent");var xd=yi("ItemComponent"),Jd=yi("GroupComponent"),$c=yi("computeItemKey"),hd=yi("isSeeking"),od=0<yi("groupIndices").length;Ga=yi("paddingTopAddition");Ga=c?{}:{boxSizing:"border-box",
paddingTop:m.offsetTop+Ga,paddingBottom:m.offsetBottom,marginTop:Sc};return!c&&0===m.totalCount&&ua?(0,Rh.createElement)(ua,oj(ua,vb)):(0,Rh.createElement)(ca,Ia({},oj(ca,vb),{ref:M,style:Ga,"data-test-id":c?"virtuoso-top-item-list":"virtuoso-item-list"}),(c?m.topItems:m.items).map(function(Kd){var zd=Kd.originalIndex,Te=$c(zd+m.firstItemIndex,Kd.data,vb);return hd?(0,Rh.createElement)(fd,Ia({},oj(fd,vb),{key:Te,index:Kd.index,height:Kd.size,type:Kd.type||"item"},"group"===Kd.type?{}:{groupIndex:Kd.groupIndex})):
"group"===Kd.type?(0,Rh.createElement)(Jd,Ia({},oj(Jd,vb),{key:Te,"data-index":zd,"data-known-size":Kd.size,"data-item-index":Kd.index,style:fC}),Wb(Kd.index)):(0,Rh.createElement)(xd,Ia({},oj(xd,vb),{key:Te,"data-index":zd,"data-known-size":Kd.size,"data-item-index":Kd.index,"data-item-group-index":Kd.groupIndex,style:gC}),od?fb(Kd.index,Kd.groupIndex,Kd.data,vb):fb(Kd.index,Kd.data,vb))}))}),hC={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},zp=
{width:"100%",height:"100%",position:"absolute",top:0},iC={width:"100%",position:Ex(),top:0},jC=th.memo(function(){var c=yi("HeaderComponent"),m=wl("headerHeight"),M=yi("headerFooterTag"),ca=lc(function(Ga){return m(Qb(Ga,"height"))}),ua=yi("context");return c?(0,Rh.createElement)(M,{ref:ca},(0,Rh.createElement)(c,oj(c,ua))):null}),kC=th.memo(function(){var c=yi("FooterComponent"),m=wl("footerHeight"),M=yi("headerFooterTag"),ca=lc(function(Ga){return m(Qb(Ga,"height"))}),ua=yi("context");return c?
(0,Rh.createElement)(M,{ref:ca},(0,Rh.createElement)(c,oj(c,ua))):null}),lC=function(c){c=c.children;var m=(0,Rh.useContext)(Yr),M=wl("viewportHeight"),ca=wl("fixedItemHeight"),ua=lc(Mj(M,function(Ga){return Qb(Ga,"height")}));return th.useEffect(function(){m&&(M(m.viewportHeight),ca(m.itemHeight))},[m,M,ca]),th.createElement("div",{style:zp,ref:ua,"data-viewport-type":"element"},c)},mC=function(c){c=c.children;var m=(0,Rh.useContext)(Yr),M=wl("windowViewportRect"),ca=wl("fixedItemHeight"),ua=yi("customScrollParent");
ua=Rm(M,ua);return th.useEffect(function(){m&&(ca(m.itemHeight),M({offsetTop:0,visibleHeight:m.viewportHeight,visibleWidth:100}))},[m,M,ca]),th.createElement("div",{ref:ua,style:zp,"data-viewport-type":"window"},c)},nC=function(c){c=c.children;var m=yi("TopItemListComponent"),M=yi("headerHeight");M=Ia({},iC,{marginTop:M+"px"});var ca=yi("context");return(0,Rh.createElement)(m||"div",{style:M,context:ca},c)},Zr=pc(dC,{required:{},optional:{context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",
itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",
headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",react18ConcurrentRendering:"react18ConcurrentRendering",item:"item",group:"group",topItems:"topItems",itemHeight:"itemHeight",scrollingStateChange:"scrollingStateChange",maxHeightCacheSize:"maxHeightCacheSize",footer:"footer",header:"header",
ItemContainer:"ItemContainer",ScrollContainer:"ScrollContainer",ListContainer:"ListContainer",GroupContainer:"GroupContainer",emptyComponent:"emptyComponent",HeaderContainer:"HeaderContainer",FooterContainer:"FooterContainer",scrollSeek:"scrollSeek"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",adjustForPrependedItems:"adjustForPrependedItems",autoscrollToBottom:"autoscrollToBottom"},events:{isScrolling:"isScrolling",endReached:"endReached",
startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},th.memo(function(c){var m=yi("useWindowScroll"),M=0<yi("topItemsIndexes").length,ca=yi("customScrollParent"),ua=ca||m?mC:lC;return th.createElement(ca||m?qC:pC,Ia({},c),th.createElement(ua,null,th.createElement(jC,null),th.createElement(Gx,null),th.createElement(kC,
null)),M&&th.createElement(nC,null,th.createElement(Gx,{showTopList:!0})))})),oC=Zr.Component,wl=Zr.usePublisher,yi=Zr.useEmitterValue,Ot=Zr.useEmitter,pC=vq({usePublisher:wl,useEmitterValue:yi,useEmitter:Ot}),qC=em({usePublisher:wl,useEmitterValue:yi,useEmitter:Ot}),Hx={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},rC={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},Ix=Math.round,Jx=Math.ceil,$r=Math.floor,Pt=Math.min,Ap=Math.max,
sC=sh(function(c){var m=c[0],M=m.overscan,ca=m.visibleRange,ua=m.listBoundary,Ga=c[1];m=Ga.scrollTop;var La=Ga.viewportHeight,fb=Ga.scrollBy,vb=Ga.scrollTo,Wb=Ga.smoothScrollTargetReached,oc=Ga.scrollContainerState,uc=Ga.footerHeight;Ga=Ga.headerHeight;var Sc=c[2],kd=c[3],fd=c[4],xd=fd.propsReady,Jd=fd.didMount,$c=c[5];fd=$c.windowViewportRect;var hd=$c.windowScrollTo,od=$c.useWindowScroll,Kd=$c.customScrollParent;$c=$c.windowScrollContainerState;c=c[6];var zd=jg(0),Te=jg(0),We=jg(Hx),eg=jg({height:0,
width:0}),of=jg({height:0,width:0}),Tf=ah(),Jg=ah(),bh=jg(0),Eg=jg(void 0),ch=jg({row:0,column:0});Zg(Of(zi(Jd,Te,Eg),Ah(function(Bf){return 0!==Bf[1]}),Bg(function(Bf){return{items:$o(0,Bf[1]-1,Bf[2]),top:0,bottom:0,offsetBottom:0,offsetTop:0,itemHeight:0,itemWidth:0}})),We);Zg(Of(zi(Lh(zd),ca,Lh(ch,qq),Lh(of,function(Bf,If){return Bf&&Bf.width===If.width&&Bf.height===If.height}),Eg),yh(eg),Bg(function(Bf){var If=Bf[0],Ef=If[0],Yf=If[1],dh=Yf[0],Fh=Yf[1],Pi=If[2],fi=If[3],Wg=If[4],Gi=Bf[1];Bf=Pi.row;
var Ji=Pi.column;If=fi.height;Yf=fi.width;var Wi=Gi.width;if(0===Ef||0===Wi)return Hx;if(0===Yf)return Ia({},rC,{items:$o(0,0,Wg)});Ji=Ap(1,$r((Wi+Ji)/(Yf+Ji)));dh=Ji*$r((dh+Bf)/(If+Bf));Fh=Ji*Jx((Fh+Bf)/(If+Bf))-1;Fh=Pt(Ef-1,Ap(Fh,Ji-1));dh=$o(Pt(Fh,Ap(0,dh)),Fh,Wg);fi=dm(Gi,Pi,fi,dh);Pi=fi.top;fi=fi.bottom;Ef=Jx(Ef/Ji);return{items:dh,offsetTop:Pi,offsetBottom:Ef*If+(Ef-1)*Bf-fi,top:Pi,bottom:fi,itemHeight:If,itemWidth:Yf}})),We);Zg(Of(Eg,Ah(function(Bf){return void 0!==Bf}),Bg(function(Bf){return Bf.length})),
zd);Zg(Of(eg,Bg(function(Bf){return Bf.height})),La);Zg(Of(zi(eg,of,We,ch),Bg(function(Bf){Bf=dm(Bf[0],Bf[3],Bf[1],Bf[2].items);return[Bf.top,Bf.bottom]}),wh(Pm)),ua);ca=Si(Of(Lh(We),Ah(function(Bf){return 0<Bf.items.length}),yh(zd),Ah(function(Bf){var If=Bf[0].items;return If[If.length-1].index===Bf[1]-1}),Bg(function(Bf){return Bf[1]-1}),wh()));ua=Si(Of(Lh(We),Ah(function(Bf){Bf=Bf.items;return 0<Bf.length&&0===Bf[0].index}),Ej(0),wh()));La=Si(Of(Lh(We),Ah(function(Bf){return 0<Bf.items.length}),
Bg(function(Bf){Bf=Bf.items;return{startIndex:Bf[0].index,endIndex:Bf[Bf.length-1].index}}),wh(yk)));Zg(La,kd.scrollSeekRangeChanged);Zg(Of(Tf,yh(eg,of,zd,ch),Bg(function(Bf){var If=Bf[1],Ef=Bf[2],Yf=Bf[3],dh=Bf[4],Fh=kj(Bf[0]);Bf=Fh.align;var Pi=Fh.behavior,fi=Fh.offset;Fh=Fh.index;"LAST"===Fh&&(Fh=Yf-1);Yf=ym(If,dh,Ef,Ap(0,Fh,Pt(Yf-1,Fh)));return"end"===Bf?Yf=Ix(Yf-If.height+Ef.height):"center"===Bf&&(Yf=Ix(Yf-If.height/2+Ef.height/2)),fi&&(Yf+=fi),{top:Yf,behavior:Pi}})),vb);Jd=Oi(Of(We,Bg(function(Bf){return Bf.offsetBottom+
Bf.bottom})),0);return Zg(Of(fd,Bg(function(Bf){return{width:Bf.visibleWidth,height:Bf.visibleHeight}})),eg),Ia({data:Eg,totalCount:zd,viewportDimensions:eg,itemDimensions:of,scrollTop:m,scrollHeight:Jg,overscan:M,scrollBy:fb,scrollTo:vb,scrollToIndex:Tf,smoothScrollTargetReached:Wb,windowViewportRect:fd,windowScrollTo:hd,useWindowScroll:od,customScrollParent:Kd,windowScrollContainerState:$c,deviation:bh,scrollContainerState:oc,footerHeight:uc,headerHeight:Ga,initialItemCount:Te,gap:ch},kd,{gridState:We,
totalListHeight:Jd},Sc,{startReached:ua,endReached:ca,rangeChanged:La,propsReady:xd},c)},bi(Mt,Dk,Rq,Bx,xo,Cx,un)),tC=["placeholder"],uC=sh(function(){var c=jg(function(Wb){return"Item "+Wb}),m=jg({}),M=jg(null),ca=jg("virtuoso-grid-item"),ua=jg("virtuoso-grid-list"),Ga=jg(um),La=jg("div"),fb=jg(cj),vb=function(Wb,oc){return void 0===oc&&(oc=null),Oi(Of(m,Bg(function(uc){return uc[Wb]}),wh()),oc)};return{context:M,itemContent:c,components:m,computeItemKey:Ga,itemClassName:ca,listClassName:ua,headerFooterTag:La,
scrollerRef:fb,FooterComponent:vb("Footer"),HeaderComponent:vb("Header"),ListComponent:vb("List","div"),ItemComponent:vb("Item","div"),ScrollerComponent:vb("Scroller","div"),ScrollSeekPlaceholder:vb("ScrollSeekPlaceholder","div")}}),vC=sh(function(c){function m(ua,Ga,La){Zg(Of(ua,yh(ca.components),Bg(function(fb){var vb,Wb=fb[0];fb=fb[1];return console.warn("react-virtuoso: "+La+" property is deprecated. Pass components."+Ga+" instead."),Ia({},fb,((vb={})[Ga]=Wb,vb))})),ca.components)}var M=c[0],
ca=c[1];c={item:Lj(ca.itemContent,"Rename the %citem%c prop to %citemContent."),ItemContainer:ah(),ScrollContainer:ah(),ListContainer:ah(),emptyComponent:ah(),scrollSeek:ah()};return li(c.scrollSeek,function(ua){var Ga=ua.placeholder;ua=zc(ua,tC);console.warn("react-virtuoso: scrollSeek property is deprecated. Pass scrollSeekConfiguration and specify the placeholder in components.ScrollSeekPlaceholder instead.");Ga=Ia({},(0,ca.components)(4),{ScrollSeekPlaceholder:Ga});(0,ca.components)(0,Ga);(0,M.scrollSeekConfiguration)(0,
ua)}),m(c.ItemContainer,"Item","ItemContainer"),m(c.ListContainer,"List","ListContainer"),m(c.ScrollContainer,"Scroller","ScrollContainer"),Ia({},M,ca,c)},bi(sC,uC)),wC=th.memo(function(){var c=zj("gridState"),m=zj("listClassName"),M=zj("itemClassName"),ca=zj("itemContent"),ua=zj("computeItemKey"),Ga=zj("isSeeking"),La=Ll("scrollHeight"),fb=zj("ItemComponent"),vb=zj("ListComponent"),Wb=zj("ScrollSeekPlaceholder"),oc=zj("context"),uc=Ll("itemDimensions"),Sc=Ll("gap"),kd=zj("log"),fd=lc(function(xd){La(xd.parentElement.parentElement.scrollHeight);
var Jd=xd.firstChild;Jd&&uc(Jd.getBoundingClientRect());Sc({row:Um("row-gap",getComputedStyle(xd).rowGap,kd),column:Um("column-gap",getComputedStyle(xd).columnGap,kd)})});return(0,Rh.createElement)(vb,Ia({ref:fd,className:m},oj(vb,oc),{style:{paddingTop:c.offsetTop,paddingBottom:c.offsetBottom}}),c.items.map(function(xd){var Jd=ua(xd.index,xd.data,oc);return Ga?(0,Rh.createElement)(Wb,Ia({key:Jd},oj(Wb,oc),{index:xd.index,height:c.itemHeight,width:c.itemWidth})):(0,Rh.createElement)(fb,Ia({},oj(fb,
oc),{className:M,"data-index":xd.index,key:Jd}),ca(xd.index,xd.data,oc))}))}),xC=th.memo(function(){var c=zj("HeaderComponent"),m=Ll("headerHeight"),M=zj("headerFooterTag"),ca=lc(function(Ga){return m(Qb(Ga,"height"))}),ua=zj("context");return c?(0,Rh.createElement)(M,{ref:ca},(0,Rh.createElement)(c,oj(c,ua))):null}),yC=th.memo(function(){var c=zj("FooterComponent"),m=Ll("footerHeight"),M=zj("headerFooterTag"),ca=lc(function(Ga){return m(Qb(Ga,"height"))}),ua=zj("context");return c?(0,Rh.createElement)(M,
{ref:ca},(0,Rh.createElement)(c,oj(c,ua))):null}),zC=function(c){c=c.children;var m=(0,Rh.useContext)(Fx),M=Ll("itemDimensions"),ca=Ll("viewportDimensions"),ua=lc(function(Ga){ca(Ga.getBoundingClientRect())});return th.useEffect(function(){m&&(ca({height:m.viewportHeight,width:m.viewportWidth}),M({height:m.itemHeight,width:m.itemWidth}))},[m,ca,M]),th.createElement("div",{style:zp,ref:ua},c)},AC=function(c){c=c.children;var m=(0,Rh.useContext)(Fx),M=Ll("windowViewportRect"),ca=Ll("itemDimensions"),
ua=zj("customScrollParent");ua=Rm(M,ua);return th.useEffect(function(){m&&(ca({height:m.itemHeight,width:m.itemWidth}),M({offsetTop:0,visibleHeight:m.viewportHeight,visibleWidth:m.viewportWidth}))},[m,M,ca]),th.createElement("div",{ref:ua,style:zp},c)},Qt=pc(vC,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",
headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",item:"item",ItemContainer:"ItemContainer",ScrollContainer:"ScrollContainer",ListContainer:"ListContainer",scrollSeek:"scrollSeek"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",
atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange"}},th.memo(function(c){c=Ia({},c);var m=zj("useWindowScroll"),M=zj("customScrollParent"),ca=M||m?AC:zC;return th.createElement(M||m?CC:BC,Ia({},c),th.createElement(ca,null,th.createElement(xC,null),th.createElement(wC,null),th.createElement(yC,null)))})),Ll=Qt.usePublisher,zj=Qt.useEmitterValue,Kx=Qt.useEmitter,BC=vq({usePublisher:Ll,useEmitterValue:zj,useEmitter:Kx}),CC=em({usePublisher:Ll,useEmitterValue:zj,useEmitter:Kx}),
DC=sh(function(){var c=jg(function(vb){return th.createElement("td",null,"Item $",vb)}),m=jg(null),M=jg(null),ca=jg(null),ua=jg({}),Ga=jg(um),La=jg(cj),fb=function(vb,Wb){return void 0===Wb&&(Wb=null),Oi(Of(ua,Bg(function(oc){return oc[vb]}),wh()),Wb)};return{context:m,itemContent:c,fixedHeaderContent:M,fixedFooterContent:ca,components:ua,computeItemKey:Ga,scrollerRef:La,TableComponent:fb("Table","table"),TableHeadComponent:fb("TableHead","thead"),TableFooterComponent:fb("TableFoot","tfoot"),TableBodyComponent:fb("TableBody",
"tbody"),TableRowComponent:fb("TableRow","tr"),ScrollerComponent:fb("Scroller","div"),EmptyPlaceholder:fb("EmptyPlaceholder"),ScrollSeekPlaceholder:fb("ScrollSeekPlaceholder"),FillerRow:fb("FillerRow")}}),EC=sh(function(c){return Ia({},c[0],c[1])},bi(Dx,DC)),FC=function(c){return th.createElement("tr",null,th.createElement("td",{style:{height:c.height}}))},GC=function(c){return th.createElement("tr",null,th.createElement("td",{style:{height:c.height,padding:0,border:0}}))},HC=th.memo(function(){var c=
Ii("listState"),m=Ml("sizeRanges"),M=Ii("useWindowScroll"),ca=Ii("customScrollParent"),ua=Ml("windowScrollContainerState"),Ga=Ml("scrollContainerState");M=ca||M?ua:Ga;var La=Ii("itemContent");ua=Ii("trackItemSizes");ca=Vb(m,Ii("itemSize"),ua,M,Ii("log"),void 0,ca);m=ca.callbackRef;var fb=ca.ref;ca=th.useState(0);var vb=ca[0],Wb=ca[1];St("deviation",function($c){vb!==$c&&(fb.current.style.marginTop=$c+"px",Wb($c))});ua=Ii("EmptyPlaceholder");var oc=Ii("ScrollSeekPlaceholder")||FC;M=Ii("FillerRow")||
GC;ca=Ii("TableBodyComponent");var uc=Ii("TableRowComponent"),Sc=Ii("computeItemKey"),kd=Ii("isSeeking");Ga=Ii("paddingTopAddition");var fd=Ii("firstItemIndex"),xd=Ii("statefulTotalCount"),Jd=Ii("context");if(0===xd&&ua)return(0,Rh.createElement)(ua,oj(ua,Jd));ua=c.offsetTop+Ga+vb;Ga=c.offsetBottom;ua=0<ua?th.createElement(M,{height:ua,key:"padding-top"}):null;M=0<Ga?th.createElement(M,{height:Ga,key:"padding-bottom"}):null;c=c.items.map(function($c){var hd=$c.originalIndex,od=Sc(hd+fd,$c.data,Jd);
return kd?(0,Rh.createElement)(oc,Ia({},oj(oc,Jd),{key:od,index:$c.index,height:$c.size,type:$c.type||"item"})):(0,Rh.createElement)(uc,Ia({},oj(uc,Jd),{key:od,"data-index":hd,"data-known-size":$c.size,"data-item-index":$c.index,style:{overflowAnchor:"none"}}),La($c.index,$c.data,Jd))});return(0,Rh.createElement)(ca,Ia({ref:m,"data-test-id":"virtuoso-item-list"},oj(ca,Jd)),[ua].concat(c,[M]))}),IC=function(c){c=c.children;var m=(0,Rh.useContext)(Yr),M=Ml("viewportHeight"),ca=Ml("fixedItemHeight"),
ua=lc(Mj(M,function(Ga){return Qb(Ga,"height")}));return th.useEffect(function(){m&&(M(m.viewportHeight),ca(m.itemHeight))},[m,M,ca]),th.createElement("div",{style:zp,ref:ua,"data-viewport-type":"element"},c)},JC=function(c){c=c.children;var m=(0,Rh.useContext)(Yr),M=Ml("windowViewportRect"),ca=Ml("fixedItemHeight"),ua=Ii("customScrollParent");ua=Rm(M,ua);return th.useEffect(function(){m&&(ca(m.itemHeight),M({offsetTop:0,visibleHeight:m.viewportHeight,visibleWidth:100}))},[m,M,ca]),th.createElement("div",
{ref:ua,style:zp,"data-viewport-type":"window"},c)},Rt=pc(EC,{required:{},optional:{context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",
atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",react18ConcurrentRendering:"react18ConcurrentRendering"},methods:{scrollToIndex:"scrollToIndex",
scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},th.memo(function(c){var m=Ii("useWindowScroll"),M=Ii("customScrollParent"),ca=Ml("fixedHeaderHeight"),ua=Ml("fixedFooterHeight"),
Ga=Ii("fixedHeaderContent"),La=Ii("fixedFooterContent"),fb=Ii("context");ca=lc(Mj(ca,function(uc){return Qb(uc,"height")}));var vb=lc(Mj(ua,function(uc){return Qb(uc,"height")}));ua=M||m?LC:KC;m=M||m?JC:IC;M=Ii("TableComponent");var Wb=Ii("TableHeadComponent"),oc=Ii("TableFooterComponent");Ga=Ga?th.createElement(Wb,Ia({key:"TableHead",style:{zIndex:1,position:"sticky",top:0},ref:ca},oj(Wb,fb)),Ga()):null;La=La?th.createElement(oc,Ia({key:"TableFoot",style:{zIndex:1,position:"sticky",bottom:0},ref:vb},
oj(oc,fb)),La()):null;return th.createElement(ua,Ia({},c),th.createElement(m,null,th.createElement(M,Ia({style:{borderSpacing:0}},oj(M,fb)),[Ga,th.createElement(HC,{key:"TableBody"}),La])))})),Ml=Rt.usePublisher,Ii=Rt.useEmitterValue,St=Rt.useEmitter,KC=vq({usePublisher:Ml,useEmitterValue:Ii,useEmitter:St}),LC=em({usePublisher:Ml,useEmitterValue:Ii,useEmitter:St}),Lx=Qf(ea(22)),km=function(c){function m(M){M=c.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+
M+" for more information.")||this;if(void 0===M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}ml(m,c);return m}(lq(Error)),Mx={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",
crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",
firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",
lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",
midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",
salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},MC=/^#[a-fA-F0-9]{6}$/,NC=/^#[a-fA-F0-9]{8}$/,OC=/^#[a-fA-F0-9]{3}$/,PC=/^#[a-fA-F0-9]{4}$/,
Tt=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,QC=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,RC=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,SC=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,Ut=function(c){return 7===c.length&&c[1]===c[2]&&
c[3]===c[4]&&c[5]===c[6]?"#"+c[1]+c[3]+c[5]:c},TC=Po(ap,ap.length,[]),Nx=ea(581),Nl=Qf(ea(22)),Xk=class{static insertTextFirefox(c,m){c.setRangeText(m,c.selectionStart||0,c.selectionEnd||0,"end");c.dispatchEvent(new InputEvent("input",{data:m,inputType:"insertText",isComposing:!1}))}static insert(c,m){const M=c.ownerDocument,ca=M.activeElement;ca!==c&&c.focus();M.execCommand("insertText",!1,m)||Xk.insertTextFirefox(c,m);ca===M.body?c.blur():ca instanceof HTMLElement&&ca!==c&&ca.focus()}static set(c,
m){c.select();Xk.insert(c,m)}static getSelection(c){const {selectionStart:m,selectionEnd:M}=c;return c.value.slice(m?m:void 0,M?M:void 0)}static wrapSelection(c,m,M){const {selectionStart:ca,selectionEnd:ua}=c,Ga=Xk.getSelection(c);Xk.insert(c,m+Ga+(null!=M?M:m));c.selectionStart=(ca||0)+m.length;c.selectionEnd=(ua||0)+m.length}static replace(c,m,M){let ca=0;c.value.replace(m,(...ua)=>{const Ga=ca+ua[ua.length-2],La=ua[0].length;c.selectionStart=Ga;c.selectionEnd=Ga+La;ua="string"===typeof M?M:M(...ua);
Xk.insert(c,ua);c.selectionStart=Ga;ca+=ua.length-La;return ua})}static findLineEnd(c,m){const M=c.lastIndexOf("\n",m-1)+1;return"\t"!==c.charAt(M)?m:M+1}static indent(c){var m;const {selectionStart:M,selectionEnd:ca,value:ua}=c;var Ga=ua.slice(M,ca);if((Ga=null==(m=/\n/g.exec(Ga))?void 0:m.length)&&0<Ga){m=ua.lastIndexOf("\n",M-1)+1;var La=c.value.slice(m,ca-1);Ga=La.replace(/^|\n/g,"$\x26  ");La=Ga.length-La.length;c.setSelectionRange(m,ca-1);Xk.insert(c,Ga);c.setSelectionRange(M+1,ca+La)}else Xk.insert(c,
"  ")}static unindent(c){const {selectionStart:m,selectionEnd:M,value:ca}=c;var ua=ca.lastIndexOf("\n",m-1)+1;const Ga=Xk.findLineEnd(ca,M);var La=c.value.slice(ua,Ga);const fb=La.replace(/(^|\n)(\t| {1,2})/g,"$1");La=La.length-fb.length;c.setSelectionRange(ua,Ga);Xk.insert(c,fb);ua=(ua=/\t| {1,2}/.exec(ca.slice(ua,m)))?ua[0].length:0;c.setSelectionRange(m-ua,Math.max(m-ua,M-La))}},Vt=ea(581),as=c=>c.stopPropagation(),bs=Nl.memo(function({font:c,text:m,color:M,fontStyle:ca,fontSize:ua,fontWeight:Ga,
offsetX:La=0,offsetY:fb=0,scale:vb=1,isEditing:Wb=!1,pointerEvents:oc=!1,onBlur:uc,onChange:Sc}){const kd=Nl.useRef(null),fd=Nl.useRef(!1),xd=Nl.useCallback(zd=>{Sc(sp.normalizeText(zd.currentTarget.value))},[Sc]),Jd=Nl.useCallback(zd=>{if("Escape"!==zd.key)if("Tab"===zd.key&&0===m.length)zd.preventDefault();else{if("Meta"!==zd.key&&!zd.metaKey)zd.stopPropagation();else if("z"===zd.key&&zd.metaKey){document.execCommand(zd.shiftKey?"redo":"undo",!1);zd.stopPropagation();zd.preventDefault();return}"Tab"===
zd.key&&(zd.preventDefault(),zd.shiftKey?Xk.unindent(zd.currentTarget):Xk.indent(zd.currentTarget),null==Sc?void 0:Sc(sp.normalizeText(zd.currentTarget.value)))}},[Sc]),$c=Nl.useCallback(zd=>{Wb&&(zd.currentTarget.setSelectionRange(0,0),null==uc?void 0:uc())},[uc]),hd=Nl.useCallback(zd=>{Wb&&fd.current&&document.activeElement===zd.currentTarget&&zd.currentTarget.select()},[Wb]),od=Nl.useCallback(zd=>{Wb&&zd.stopPropagation()},[Wb]);Nl.useEffect(()=>{Wb&&requestAnimationFrame(()=>{fd.current=!0;const zd=
kd.current;zd&&(zd.focus(),zd.select())})},[Wb,uc]);const Kd=Nl.useRef(null);Nl.useLayoutEffect(()=>{const zd=Kd.current;if(zd){var Te=sg(m||"Enter text",{fontFamily:"var(--ls-font-family)",fontSize:ua,lineHeight:1,fontWeight:Ga},4);zd.style.transform=`scale(${vb}, ${vb}) translate(${La}px, ${fb}px)`;zd.style.width=Te[0]+1+"px";zd.style.height=Te[1]+1+"px"}},[m,Ga,ua,fb,La,vb]);return(0,Vt.jsx)("div",{className:"tl-text-label-wrapper",children:(0,Vt.jsxs)("div",{className:"tl-text-label-inner-wrapper",
ref:Kd,style:{font:c,fontStyle:ca,fontSize:ua,fontWeight:Ga,color:M,pointerEvents:oc?"all":"none",userSelect:Wb?"text":"none"},children:[Wb?(0,Vt.jsx)("textarea",{ref:kd,style:{font:c,color:M,fontStyle:ca,fontSize:ua,fontWeight:Ga},className:"tl-text-label-textarea",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"Enter text",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:m,color:M,onFocus:hd,
onChange:xd,onKeyDown:Jd,onBlur:$c,onPointerDown:od,onContextMenu:as,onCopy:as,onPaste:as,onCut:as}):m,"​"]})})}),vn=ea(581),Ox={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Bp=class extends ok{constructor(){super(...arguments);wb(this,"canEdit",!0);wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isBinding:M,isSelected:ca,isEditing:ua,onEditingEnd:Ga})=>{const {props:{size:[La,fb],stroke:vb,fill:Wb,noFill:oc,strokeWidth:uc,strokeType:Sc,borderRadius:kd,opacity:fd,label:xd,italic:Jd,fontWeight:$c,fontSize:hd}}=
this;var od=xd||ua?sg(xd,{fontFamily:"var(--ls-font-family)",fontSize:hd,lineHeight:1,fontWeight:$c},4):[0,0];const Kd=ne.mul(this.props.size,.5);od=Math.max(.5,Math.min(1,La/od[0],fb/od[1]));const zd=this.getBounds(),Te=Lx.useMemo(()=>ne.sub(Kd,ne.toFixed([zd.width/2,zd.height/2])),[zd,od,Kd]),We=Lx.useCallback(eg=>{var of;null==(of=this.update)?void 0:of.call(this,{label:eg})},[xd]);return(0,vn.jsxs)("div",ng(Gf({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},className:"tl-box-container",
children:[(0,vn.jsx)(bs,{font:"20px / 1 var(--ls-font-family)",text:xd,color:Df(vb,"text"),offsetX:Te[0],offsetY:Te[1],fontSize:hd,scale:od,isEditing:ua,onChange:We,onBlur:Ga,fontStyle:Jd?"italic":"normal",fontWeight:$c,pointerEvents:!!xd}),(0,vn.jsxs)(vl,{opacity:m?.2:fd,children:[M&&(0,vn.jsx)(sq,{mode:"svg",strokeWidth:uc,size:[La,fb]}),(0,vn.jsx)("rect",{className:ca||!oc?"tl-hitarea-fill":"tl-hitarea-stroke",x:uc/2,y:uc/2,rx:kd,ry:kd,width:Math.max(.01,La-uc),height:Math.max(.01,fb-uc),pointerEvents:"all"}),
(0,vn.jsx)("rect",{x:uc/2,y:uc/2,rx:kd,ry:kd,width:Math.max(.01,La-uc),height:Math.max(.01,fb-uc),strokeWidth:uc,stroke:Df(vb,"stroke"),strokeDasharray:"dashed"===Sc?"8 2":void 0,fill:oc?"none":Df(Wb,"background")})]})]}))}));wb(this,"setScaleLevel",c=>Wh(this,null,function*(){this.update({scaleLevel:c,fontSize:Ox[null!=c?c:"md"],strokeWidth:Ox[null!=c?c:"md"]/10});this.onResetBounds()}));wb(this,"ReactIndicator",Ee(()=>{const {props:{size:[c,m],borderRadius:M,isLocked:ca}}=this;return(0,vn.jsx)("g",
{children:(0,vn.jsx)("rect",{width:c,height:m,rx:M,ry:M,fill:"transparent",strokeDasharray:ca?"8 2":void 0})})}));wb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));void 0!==c.borderRadius&&(c.borderRadius=Math.max(0,c.borderRadius));return Nk(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}};wb(Bp,"id","box");wb(Bp,"defaultProps",{id:"box",parentId:"page",type:"box",point:[0,0],size:[100,100],borderRadius:2,
stroke:"",fill:"",noFill:!1,fontWeight:400,fontSize:20,italic:!1,strokeType:"line",strokeWidth:2,opacity:1,label:""});pe([$g],Bp.prototype,"scaleLevel",1);pe([Ag],Bp.prototype,"setScaleLevel",2);var Px=Qf(ea(22)),lm=ea(581),Qx={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Cp=class extends ct{constructor(){super(...arguments);wb(this,"canEdit",!0);wb(this,"ReactComponent",Ee(({isSelected:c,isErasing:m,events:M,isEditing:ca,onEditingEnd:ua})=>{const {size:[Ga,La],stroke:fb,fill:vb,noFill:Wb,strokeWidth:oc,
strokeType:uc,opacity:Sc,label:kd,italic:fd,fontWeight:xd,fontSize:Jd}=this.props;var $c=kd||ca?sg(kd,{fontFamily:"var(--ls-font-family)",fontSize:Jd,lineHeight:1,fontWeight:xd},4):[0,0];const hd=ne.mul(this.props.size,.5);$c=Math.max(.5,Math.min(1,Ga/$c[0],La/$c[1]));const od=this.getBounds(),Kd=Px.useMemo(()=>ne.sub(hd,ne.toFixed([od.width/2,od.height/2])),[od,$c,hd]),zd=Px.useCallback(Te=>{var We;null==(We=this.update)?void 0:We.call(this,{label:Te})},[kd]);return(0,lm.jsxs)("div",ng(Gf({},M),
{style:{width:"100%",height:"100%",overflow:"hidden"},className:"tl-ellipse-container",children:[(0,lm.jsx)(bs,{font:"18px / 1 var(--ls-font-family)",text:kd,color:Df(fb,"text"),offsetX:Kd[0],offsetY:Kd[1],scale:$c,isEditing:ca,onChange:zd,onBlur:ua,fontStyle:fd?"italic":"normal",fontSize:Jd,fontWeight:xd,pointerEvents:!!kd}),(0,lm.jsxs)(vl,ng(Gf({},M),{opacity:m?.2:Sc,children:[(0,lm.jsx)("ellipse",{className:c||!Wb?"tl-hitarea-fill":"tl-hitarea-stroke",cx:Ga/2,cy:La/2,rx:Math.max(.01,(Ga-oc)/2),
ry:Math.max(.01,(La-oc)/2)}),(0,lm.jsx)("ellipse",{cx:Ga/2,cy:La/2,rx:Math.max(.01,(Ga-oc)/2),ry:Math.max(.01,(La-oc)/2),strokeWidth:oc,stroke:Df(fb,"stroke"),strokeDasharray:"dashed"===uc?"8 2":void 0,fill:Wb?"none":Df(vb,"background")})]}))]}))}));wb(this,"setScaleLevel",c=>Wh(this,null,function*(){this.update({scaleLevel:c,fontSize:Qx[null!=c?c:"md"],strokeWidth:Qx[null!=c?c:"md"]/10});this.onResetBounds()}));wb(this,"ReactIndicator",Ee(()=>{const {size:[c,m],isLocked:M}=this.props;return(0,lm.jsx)("g",
{children:(0,lm.jsx)("ellipse",{cx:c/2,cy:m/2,rx:c/2,ry:m/2,strokeWidth:2,fill:"transparent",strokeDasharray:M?"8 2":"undefined"})})}));wb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));return Nk(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(c){const {size:[m,M],stroke:ca,fill:ua,noFill:Ga,strokeWidth:La,strokeType:fb,opacity:vb}=this.props;return(0,lm.jsxs)("g",{opacity:vb,children:[(0,lm.jsx)("ellipse",
{className:Ga?"tl-hitarea-stroke":"tl-hitarea-fill",cx:m/2,cy:M/2,rx:Math.max(.01,(m-La)/2),ry:Math.max(.01,(M-La)/2)}),(0,lm.jsx)("ellipse",{cx:m/2,cy:M/2,rx:Math.max(.01,(m-La)/2),ry:Math.max(.01,(M-La)/2),strokeWidth:La,stroke:Df(ca,"stroke"),strokeDasharray:"dashed"===fb?"8 2":void 0,fill:Ga?"none":Df(ua,"background")})]})}};wb(Cp,"id","ellipse");wb(Cp,"defaultProps",{id:"ellipse",parentId:"page",type:"ellipse",point:[0,0],size:[100,100],stroke:"",fill:"",noFill:!1,fontWeight:400,fontSize:20,
italic:!1,strokeType:"line",strokeWidth:2,opacity:1,label:""});pe([$g],Cp.prototype,"scaleLevel",1);pe([Ag],Cp.prototype,"setScaleLevel",2);var Sq=ea(581),Wt=class extends Fr{constructor(){super(...arguments);wb(this,"ReactComponent",Ee(({events:c})=>{const m=this.getBounds(),M=Ve(),ca=M.selectedShapesArray.some(Ga=>M.shapesInGroups([this]).includes(Ga)),ua=this.ReactIndicator;return(0,Sq.jsxs)(vl,ng(Gf({},c),{className:"tl-group-container",children:[(0,Sq.jsx)("rect",{className:"tl-hitarea-fill",
x:1,y:1,width:Math.max(.01,m.width-2),height:Math.max(.01,m.height-2),pointerEvents:"all"}),ca&&(0,Sq.jsx)("g",{stroke:"var(--color-selectedFill)",children:(0,Sq.jsx)(ua,{})})]}))}));wb(this,"ReactIndicator",Ee(()=>{const c=this.getBounds();return(0,Sq.jsx)("rect",{strokeDasharray:"8 2",x:-8,y:-8,rx:4,ry:4,width:c.width+16,height:c.height+16,fill:"transparent"})}))}};wb(Wt,"id","group");wb(Wt,"defaultProps",{id:"group",type:"group",parentId:"page",point:[0,0],size:[0,0],children:[]});var cs=ea(581),
UC={xs:1,sm:1.6,md:2,lg:3.2,xl:4.8,xxl:6},yo=class extends lp{constructor(c={}){super(c);wb(this,"ReactComponent",Ee(({events:m,isErasing:M})=>{const {pointsPath:ca,props:{stroke:ua,strokeWidth:Ga,opacity:La}}=this;return(0,cs.jsx)(vl,ng(Gf({},m),{opacity:M?.2:1,children:(0,cs.jsx)("path",{d:ca,strokeWidth:16*Ga,stroke:Df(ua,"stroke"),fill:"none",pointerEvents:"all",strokeLinejoin:"round",strokeLinecap:"round",opacity:La})}))}));wb(this,"setScaleLevel",m=>Wh(this,null,function*(){this.update({scaleLevel:m,
strokeWidth:UC[null!=m?m:"md"]});this.onResetBounds()}));wb(this,"ReactIndicator",Ee(()=>{const {pointsPath:m,props:M}=this;return(0,cs.jsx)("path",{d:m,fill:"none",strokeDasharray:M.isLocked?"8 2":"undefined"})}));wb(this,"validateProps",m=>{m=Nk(this,m);void 0!==m.strokeWidth&&(m.strokeWidth=Math.max(m.strokeWidth,1));return m});Cc(this)}get pointsPath(){const {points:c}=this.props;return Nj.getCurvedPathForPoints(c)}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(){const {pointsPath:c,
props:{stroke:m,strokeWidth:M,opacity:ca}}=this;return(0,cs.jsx)("path",{d:c,strokeWidth:16*M,stroke:Df(m,"stroke"),fill:"none",pointerEvents:"all",strokeLinejoin:"round",strokeLinecap:"round",opacity:ca})}};wb(yo,"id","highlighter");wb(yo,"defaultProps",{id:"highlighter",parentId:"page",type:"highlighter",point:[0,0],points:[],isComplete:!1,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:.5});pe([$g],yo.prototype,"pointsPath",1);pe([$g],yo.prototype,"scaleLevel",1);pe([Ag],yo.prototype,
"setScaleLevel",2);var Xt=Qf(ea(22)),ds=ea(581),Yt={xs:.5,sm:.8,md:1,lg:1.5,xl:2,xxl:3},wn=class extends ok{constructor(){super(...arguments);wb(this,"canChangeAspectRatio",!0);wb(this,"canFlip",!1);wb(this,"canEdit",!0);wb(this,"htmlAnchorRef",Xt.createRef());wb(this,"setScaleLevel",c=>Wh(this,null,function*(){var m;const M=ne.mul(this.props.size,Yt[null!=c?c:"md"]/Yt[null!=(m=this.props.scaleLevel)?m:"md"]);this.update({scaleLevel:c});yield Bc();this.update({size:M})}));wb(this,"onResetBounds",
c=>{var m;if(this.htmlAnchorRef.current){const M=this.htmlAnchorRef.current.getBoundingClientRect(),[ca,ua]=ne.div([M.width,M.height],null!=(m=null==c?void 0:c.zoom)?m:1);this.update({size:[Math.max(Math.min(ca||400,1400),10),Math.max(Math.min(ua||400,1400),10)]})}return this});wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isEditing:M})=>{const {props:{html:ca,scaleLevel:ua}}=this,Ga=Sm(),La=Ve(),fb=La.selectedIds.has(this.id),vb=Ga||fb&&!M||"select"!==La.selectedTool.id,Wb=Xt.useCallback(uc=>
{vb||uc.stopPropagation()},[vb]),oc=Yt[null!=ua?ua:"md"];Xt.useEffect(()=>{0===this.props.size[1]&&(this.onResetBounds({zoom:La.viewport.camera.zoom}),La.persist({replace:!0}))},[]);return(0,ds.jsx)(Vk,ng(Gf({style:{overflow:"hidden",pointerEvents:"all",opacity:m?.2:1}},c),{children:(0,ds.jsx)("div",{onWheelCapture:Wb,onPointerDown:Wb,onPointerUp:Wb,className:"tl-html-container",style:{pointerEvents:Ga||!M&&!fb?"none":"all",overflow:M?"auto":"hidden",width:`calc(100% / ${oc})`,height:`calc(100% / ${oc})`,
transform:`scale(${oc})`},children:(0,ds.jsx)("div",{ref:this.htmlAnchorRef,className:"tl-html-anchor",dangerouslySetInnerHTML:{__html:ca.trim()}})})}))}));wb(this,"ReactIndicator",Ee(()=>{const {props:{size:[c,m],isLocked:M}}=this;return(0,ds.jsx)("rect",{width:c,height:m,fill:"transparent",strokeDasharray:M?"8 2":"undefined"})}));wb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[1],1));return Nk(this,c)})}get scaleLevel(){var c;return null!=
(c=this.props.scaleLevel)?c:"md"}};wb(wn,"id","html");wb(wn,"defaultProps",{id:"html",type:"html",parentId:"page",point:[0,0],size:[600,0],html:""});pe([$g],wn.prototype,"scaleLevel",1);pe([Ag],wn.prototype,"setScaleLevel",2);var Rx=Qf(ea(22)),Tq=ea(581),zo=class extends ok{constructor(){super(...arguments);wb(this,"frameRef",Rx.createRef());wb(this,"canEdit",!0);wb(this,"onIFrameSourceChange",c=>{this.update({url:c})});wb(this,"reload",()=>{var c,m;this.frameRef.current&&(this.frameRef.current.src=
null==(m=null==(c=this.frameRef)?void 0:c.current)?void 0:m.src)});wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isEditing:M})=>{Rx.useRef(null);const ca=Ve();return(0,Tq.jsx)(Vk,ng(Gf({style:{overflow:"hidden",pointerEvents:"all",opacity:m?.2:1}},c),{children:(0,Tq.jsx)("div",{className:"tl-iframe-container",style:{pointerEvents:M||ca.readOnly?"all":"none",userSelect:"none"},children:this.props.url&&(0,Tq.jsx)("div",{style:{overflow:"hidden",position:"relative",height:"100%"},children:(0,Tq.jsx)("iframe",
{ref:this.frameRef,className:"absolute inset-0 w-full h-full m-0",width:"100%",height:"100%",src:`${this.props.url}`,frameBorder:"0",sandbox:"allow-scripts allow-same-origin allow-presentation"})})})}))}));wb(this,"ReactIndicator",Ee(()=>{const {props:{size:[c,m],isLocked:M}}=this;return(0,Tq.jsx)("rect",{width:c,height:m,fill:"transparent",rx:8,ry:8,strokeDasharray:M?"8 2":"undefined"})}))}};wb(zo,"id","iframe");wb(zo,"defaultProps",{id:"iframe",type:"iframe",parentId:"page",point:[0,0],size:[853,
480],url:""});pe([Ag],zo.prototype,"onIFrameSourceChange",2);pe([Ag],zo.prototype,"reload",2);var VC=Qf(ea(22)),Dp=ea(581),es=class extends dt{constructor(){super(...arguments);wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isBinding:M,asset:ca})=>{const {props:{opacity:ua,objectFit:Ga,clipping:La,size:[fb,vb]}}=this,[Wb,oc,uc,Sc]=Array.isArray(La)?La:[La,La,La,La],{handlers:kd}=VC.useContext(si);return(0,Dp.jsxs)(Vk,ng(Gf({},c),{opacity:m?.2:ua,children:[M&&(0,Dp.jsx)(sq,{mode:"html",strokeWidth:4,
size:[fb,vb]}),(0,Dp.jsx)("div",{"data-asset-loaded":!!ca,className:"tl-image-shape-container",children:ca?(0,Dp.jsx)("img",{src:kd?kd.makeAssetUrl(ca.src):ca.src,draggable:!1,style:{position:"relative",top:-Wb,left:-Sc,width:fb+(Sc-oc),height:vb+(Wb-uc),objectFit:Ga}}):"Asset is missing"})]}))}));wb(this,"ReactIndicator",Ee(()=>{const {props:{size:[c,m],isLocked:M}}=this;return(0,Dp.jsx)("rect",{width:c,height:m,fill:"transparent",strokeDasharray:M?"8 2":"undefined"})}))}getShapeSVGJsx({assets:c}){var m,
M;const ca=this.getBounds(),{assetId:ua,clipping:Ga}=this.props;if(c=c.find(La=>La.id===ua)){Array.isArray(Ga);const La=null==(M=null==(m=window.logseq)?void 0:m.api)?void 0:M.make_asset_url;return(0,Dp.jsx)("image",{width:ca.width,height:ca.height,href:La?La(c.src):c.src})}return super.getShapeSVGJsx({})}};wb(es,"id","image");wb(es,"defaultProps",{id:"image1",parentId:"page",type:"image",point:[0,0],size:[100,100],opacity:1,assetId:"",clipping:0,objectFit:"fill",isAspectRatioLocked:!0});var Zt=Qf(ea(22)),
WC=Qf(ea(22)),$t=ea(581),Ep=ea(581),Sx={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},XC=WC.memo(function({style:c,start:m,end:M,decorationStart:ca,decorationEnd:ua,scaleLevel:Ga}){const La=ne.dist(m,M);if(2>La)return null;const {strokeWidth:fb}=c,vb=1+fb*Sx[null!=Ga?Ga:"md"]/10,Wb="M"+ne.toFixed(m)+"L"+ne.toFixed(M);Ga=Math.min(La/3,fb*Sx[null!=Ga?Ga:"md"]);ca=ca?Vl(m,M,Ga):null;ua=ua?Vl(M,m,Ga):null;return(0,Ep.jsxs)(Ep.Fragment,{children:[(0,Ep.jsx)("path",{className:"tl-stroke-hitarea",d:Wb}),(0,Ep.jsx)("path",
{d:Wb,strokeWidth:vb,stroke:c.stroke,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"dashed"===c.strokeType?"8 4":void 0,pointerEvents:"stroke"}),ca&&(0,Ep.jsx)(No,{left:ca.left,middle:m,right:ca.right,stroke:c.stroke,strokeWidth:vb}),ua&&(0,Ep.jsx)(No,{left:ua.left,middle:M,right:ua.right,stroke:c.stroke,strokeWidth:vb})]})}),fs=ea(581),Ek=ea(581),YC={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Fp=class extends Fq{constructor(){super(...arguments);wb(this,"hideSelection",!0);wb(this,"canEdit",
!0);wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isEditing:M,onEditingEnd:ca})=>{const {stroke:ua,handles:{start:Ga,end:La},opacity:fb,label:vb,italic:Wb,fontWeight:oc,fontSize:uc,id:Sc}=this.props,kd=vb||M?sg(vb||"Enter text",{fontFamily:"var(--ls-font-family)",fontSize:uc,lineHeight:1,fontWeight:oc},6):[0,0],fd=ne.med(Ga.point,La.point);var xd=ne.dist(Ga.point,La.point);xd=Math.max(.5,Math.min(1,Math.max(xd/(kd[1]+128),xd/(kd[0]+128))));const Jd=this.getBounds(),$c=Zt.useMemo(()=>ne.sub(fd,
ne.toFixed([Jd.width/2,Jd.height/2])),[Jd,xd,fd]),hd=Zt.useCallback(od=>{var Kd;null==(Kd=this.update)?void 0:Kd.call(this,{label:od})},[vb]);return(0,Ek.jsxs)("div",ng(Gf({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},className:"tl-line-container",children:[(0,Ek.jsx)(bs,{font:"20px / 1 var(--ls-font-family)",text:vb,fontSize:uc,color:Df(ua,"text"),offsetX:$c[0],offsetY:$c[1],scale:xd,isEditing:M,onChange:hd,onBlur:ca,fontStyle:Wb?"italic":"normal",fontWeight:oc,pointerEvents:!!vb}),
(0,Ek.jsxs)(vl,{opacity:m?.2:fb,id:Sc+"_svg",children:[(0,Ek.jsx)(bp,{id:Sc,bounds:Jd,labelSize:kd,offset:$c,scale:xd}),(0,Ek.jsx)("g",{pointerEvents:"none",mask:vb||M?`url(#${Sc}_clip)`:"",children:this.getShapeSVGJsx({preview:!1})})]})]}))}));wb(this,"setScaleLevel",c=>Wh(this,null,function*(){this.update({scaleLevel:c,fontSize:YC[null!=c?c:"md"]});this.onResetBounds()}));wb(this,"ReactIndicator",Ee(({isEditing:c})=>{const {id:m,decorations:M,label:ca,strokeWidth:ua,fontSize:Ga,fontWeight:La,handles:{start:fb,
end:vb},isLocked:Wb}=this.props,oc=this.getBounds(),uc=ca||c?sg(ca,{fontFamily:"var(--ls-font-family)",fontSize:Ga,lineHeight:1,fontWeight:La},6):[0,0],Sc=ne.med(fb.point,vb.point);var kd=ne.dist(fb.point,vb.point);kd=Math.max(.5,Math.min(1,Math.max(kd/(uc[1]+128),kd/(uc[0]+128))));const fd=Zt.useMemo(()=>ne.sub(Sc,ne.toFixed([oc.width/2,oc.height/2])),[oc,kd,Sc]);return(0,Ek.jsxs)("g",{children:[(0,Ek.jsx)("path",{mask:ca?`url(#${m}_clip)`:"",d:vj({strokeWidth:ua},fb.point,vb.point,null==M?void 0:
M.start,null==M?void 0:M.end),strokeDasharray:Wb?"8 2":"undefined"}),ca&&!c&&(0,Ek.jsx)("rect",{x:oc.width/2-uc[0]/2*kd+fd[0],y:oc.height/2-uc[1]/2*kd+fd[1],width:uc[0]*kd,height:uc[1]*kd,rx:4*kd,ry:4*kd,fill:"transparent"})]})}));wb(this,"validateProps",c=>Nk(this,c))}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx({preview:c}){const {stroke:m,fill:M,strokeWidth:ca,strokeType:ua,decorations:Ga,label:La,scaleLevel:fb,handles:{start:vb,end:Wb}}=this.props,oc=ne.med(vb.point,
Wb.point);return(0,Ek.jsxs)(Ek.Fragment,{children:[(0,Ek.jsx)(XC,{style:{stroke:Df(m,"text"),fill:M,strokeWidth:ca,strokeType:ua},scaleLevel:fb,start:vb.point,end:Wb.point,decorationStart:null==Ga?void 0:Ga.start,decorationEnd:null==Ga?void 0:Ga.end}),c&&(0,Ek.jsx)(Ek.Fragment,{children:(0,Ek.jsx)("text",{style:{transformOrigin:"top left"},fontFamily:"Inter",fontSize:20,transform:`translate(${oc[0]}, ${oc[1]})`,textAnchor:"middle",fill:Df(m,"text"),stroke:Df(m,"text"),children:La})})]})}};wb(Fp,"id",
"line");wb(Fp,"defaultProps",{id:"line",parentId:"page",type:"line",point:[0,0],handles:{start:{id:"start",canBind:!0,point:[0,0]},end:{id:"end",canBind:!0,point:[1,1]}},stroke:"",fill:"",noFill:!0,fontWeight:400,fontSize:20,italic:!1,strokeType:"line",strokeWidth:1,opacity:1,decorations:{end:"arrow"},label:""});pe([$g],Fp.prototype,"scaleLevel",1);pe([Ag],Fp.prototype,"setScaleLevel",2);var Fk=Qf(ea(22)),gj=ea(581),Uq={xs:.5,sm:.8,md:1,lg:1.5,xl:2,xxl:3},ZC=Ee(({type:c,fill:m,opacity:M,children:ca})=>
{const ua="var(--ls-secondary-background-color)"!==m?Df(m,"background"):"var(--ls-tertiary-background-color)";m=m&&"var(--ls-secondary-background-color)"!==m?Cf(m)?`var(--ls-highlight-color-${m})`:m:"var(--ls-secondary-background-color)";return(0,gj.jsxs)("div",{className:`tl-logseq-portal-header tl-logseq-portal-header-${"P"===c?"page":"block"}`,children:[(0,gj.jsx)("div",{className:"absolute inset-0 tl-logseq-portal-header-bg",style:{opacity:M,background:"P"===c?ua:`linear-gradient(0deg, ${m}, ${ua})`}}),
(0,gj.jsx)("div",{className:"relative",children:ca})]})}),Aj=class extends ok{constructor(c={}){var m;super(c);wb(this,"hideRotateHandle",!0);wb(this,"canChangeAspectRatio",!0);wb(this,"canFlip",!0);wb(this,"canEdit",!0);wb(this,"persist",null);wb(this,"initialHeightCalculated",!0);wb(this,"getInnerHeight",null);wb(this,"setCollapsed",M=>Wh(this,null,function*(){var ca;if("B"===this.props.blockType){if(this.update({compact:M}),this.canResize[1]=!M,!M)this.onResetBounds()}else{const ua=this.props.size[1];
this.canResize[1]=!M;this.update({isAutoResizing:!M,collapsed:M,size:[this.props.size[0],M?this.getHeaderHeight():this.props.collapsedHeight],collapsedHeight:M?ua:this.props.collapsedHeight})}null==(ca=this.persist)?void 0:ca.call(this)}));wb(this,"setScaleLevel",M=>Wh(this,null,function*(){var ca;const ua=ne.mul(this.props.size,Uq[null!=M?M:"md"]/Uq[null!=(ca=this.props.scaleLevel)?ca:"md"]);this.update({scaleLevel:M});yield Bc();this.update({size:ua})}));wb(this,"onResetBounds",M=>{M=this.getAutoResizeHeight();
null!==M&&1<Math.abs(M-this.props.size[1])&&(this.update({size:[this.props.size[0],M]}),this.initialHeightCalculated=!0);return this});wb(this,"onResize",(M,ca)=>{var ua;const {bounds:Ga,rotation:La,scale:[fb,vb]}=ca;M=[...this.scale];0>fb&&(M[0]*=-1);0>vb&&(M[1]*=-1);ca=Ga.height;this.props.isAutoResizing&&(ca=null!=(ua=this.getAutoResizeHeight())?ua:ca);return this.update({point:[Ga.minX,Ga.minY],size:[Math.max(1,Ga.width),Math.max(1,ca)],scale:M,rotation:La})});wb(this,"PortalComponent",Ee(({})=>
{const {props:{pageId:M,fill:ca,opacity:ua}}=this,{renderers:Ga}=Fk.useContext(si),La=Ve(),fb=Fk.useRef(null),[,vb]=this.useComponentSize(fb,this.props.compact?".tl-logseq-cp-container \x3e .single-block":".tl-logseq-cp-container \x3e .page");if(null==Ga||!Ga.Page)return null;const {Page:Wb,Block:oc}=Ga,[uc,Sc]=Fk.useState(!1);Fk.useEffect(()=>{var kd,fd;if(this.props.isAutoResizing){const xd=(null!=(fd=null==(kd=this.getInnerHeight)?void 0:kd.call(this))?fd:vb)+this.getHeaderHeight();vb&&1<Math.abs(xd-
this.props.size[1])&&(this.update({size:[this.props.size[0],xd]}),uc&&La.persist({replace:!0}))}},[vb,this.props.isAutoResizing]);Fk.useEffect(()=>{this.initialHeightCalculated||setTimeout(()=>{this.onResetBounds();La.persist({replace:!0})})},[this.initialHeightCalculated]);Fk.useEffect(()=>{setTimeout(function(){Sc(!0)})},[]);return(0,gj.jsxs)(gj.Fragment,{children:[(0,gj.jsx)("div",{className:"absolute inset-0 tl-logseq-cp-container-bg",style:{textRendering:.5>La.viewport.camera.zoom?"optimizeSpeed":
"auto",background:ca&&"var(--ls-secondary-background-color)"!==ca?Cf(ca)?`var(--ls-highlight-color-${ca})`:ca:"var(--ls-secondary-background-color)",opacity:ua}}),(0,gj.jsx)("div",{ref:fb,className:"relative tl-logseq-cp-container",style:{overflow:this.props.isAutoResizing?"visible":"auto"},children:(uc||!this.initialHeightCalculated)&&("B"===this.props.blockType&&this.props.compact?(0,gj.jsx)(oc,{blockId:M}):(0,gj.jsx)(Wb,{pageName:M}))})]})}));wb(this,"ReactComponent",Ee(M=>{var ca;const {events:ua,
isErasing:Ga,isEditing:La,isBinding:fb}=M,{props:{opacity:vb,pageId:Wb,fill:oc,scaleLevel:uc,strokeWidth:Sc,size:kd}}=this,fd=Ve(),{renderers:xd,handlers:Jd}=Fk.useContext(si);this.persist=()=>fd.persist();const $c=Sm(),hd=fd.selectedIds.has(this.id)&&1===fd.selectedIds.size,od=fd.isIn("logseq-portal.creating")&&!Wb,Kd=($c||hd&&!La||"select"!==fd.selectedTool.id)&&!od,zd=Fk.useCallback(Bf=>{Kd||Bf.stopPropagation()},[Kd]),Te=1===fd.selectedShapesArray.length&&fd.selectedShapesArray.some(Bf=>"logseq-portal"===
Bf.type&&Bf.props.id!==this.props.id&&Wb&&Bf.props.pageId===Wb),We=Uq[null!=uc?uc:"md"];Fk.useEffect(()=>this.props.collapsed&&La?(this.update({size:[this.props.size[0],this.props.collapsedHeight]}),()=>{this.update({size:[this.props.size[0],this.getHeaderHeight()]})}):()=>{},[La,this.props.collapsed]);Fk.useEffect(()=>{if(od){const Bf=[fd.viewport.bounds.width,fd.viewport.bounds.height],If=fd.viewport.getScreenPoint([this.bounds.minX,this.bounds.minY]);(If[0]>Bf[0]-400||If[1]>Bf[1]-240||1.5<fd.viewport.camera.zoom||
.5>fd.viewport.camera.zoom)&&fd.viewport.zoomToBounds(ng(Gf({},this.bounds),{minY:this.bounds.maxY+25}))}},[fd.viewport.bounds.height.toFixed(2)]);const eg=Fk.useCallback((Bf,If)=>{this.initialHeightCalculated=!1;If=If?"P":"B";this.update({pageId:Bf,size:[400,320],blockType:If,compact:"B"===If});fd.selectTool("select");fd.history.resume();fd.history.persist()},[]),of=this.PortalComponent;var Tf=Fk.useMemo(()=>{var Bf;if(Wb&&"B"===this.props.blockType)return null==(Bf=null==Jd?void 0:Jd.queryBlockByUUID(Wb))?
void 0:Bf.title},[null==Jd?void 0:Jd.queryBlockByUUID,Wb]);Tf="B"===this.props.blockType&&"string"!==typeof Tf;const Jg=(!this.props.collapsed||La)&&!Tf;if(null==xd||!xd.Page)return null;const {Breadcrumb:bh,PageName:Eg}=xd,ch={width:`calc(100% / ${We})`,height:`calc(100% / ${We})`,opacity:Ga?.2:1};1!==We&&(ch.transform=`scale(${We})`);return(0,gj.jsxs)(Vk,ng(Gf({style:{pointerEvents:"all"}},ua),{children:[fb&&(0,gj.jsx)(sq,{mode:"html",strokeWidth:Sc,size:kd}),(0,gj.jsx)("div",{"data-inner-events":!Kd,
onWheelCapture:zd,onPointerDown:zd,onPointerUp:zd,style:{width:"100%",height:"100%",pointerEvents:$c||!La&&!hd?"none":"all"},children:od?(0,gj.jsx)(Vs,{onChange:eg,onAddBlock:Bf=>{setTimeout(()=>{var If,Ef,Yf;fd.api.editShape(this);null==(Yf=null==(Ef=null==(If=window.logseq)?void 0:If.api)?void 0:Ef.edit_block)?void 0:Yf.call(Ef,Bf)})},placeholder:"Create or search your graph..."}):(0,gj.jsxs)("div",{className:"tl-logseq-portal-container","data-collapsed":this.collapsed,"data-page-id":Wb,"data-portal-selected":Te,
"data-editing":La,style:ch,children:[!this.props.compact&&!Tf&&(0,gj.jsx)(ZC,{type:null!=(ca=this.props.blockType)?ca:"P",fill:oc,opacity:vb,children:"P"===this.props.blockType?(0,gj.jsx)(Eg,{pageName:Wb}):(0,gj.jsx)(bh,{blockId:Wb})}),Tf&&(0,gj.jsx)("div",{className:"tl-target-not-found",children:"Target not found"}),Jg&&(0,gj.jsx)(of,Gf({},M))]})})]}))}));wb(this,"ReactIndicator",Ee(()=>{const M=this.getBounds();return(0,gj.jsx)("rect",{width:M.width,height:M.height,fill:"transparent",rx:8,ry:8,
strokeDasharray:this.props.isLocked?"8 2":"undefined"})}));wb(this,"validateProps",M=>{var ca;if(void 0!==M.size){const ua=Uq[null!=(ca=this.props.scaleLevel)?ca:"md"];M.size[0]=Math.max(M.size[0],60*ua);M.size[1]=Math.max(M.size[1],40*ua)}return Nk(this,M)});Cc(this);c.collapsed&&Object.assign(this.canResize,[!0,!1]);0===(null==(m=c.size)?void 0:m[1])&&(this.initialHeightCalculated=!1)}static isPageOrBlock(c){return c?/^\(\(.*\)\)$/.test(c)&&40===c.length?"B":"P":!1}get collapsed(){return"B"===this.props.blockType?
this.props.compact:this.props.collapsed}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}useComponentSize(c,m=""){const [M,ca]=Fk.useState([0,0]),ua=Ve();Fk.useEffect(()=>{setTimeout(()=>{if(null==c?0:c.current){const Ga=m?c.current.querySelector(m):c.current;if(Ga){const La=()=>{const {width:vb,height:Wb}=Ga.getBoundingClientRect(),oc=ne.div([vb,Wb],ua.viewport.camera.zoom);ca(oc);return oc};La();this.getInnerHeight=()=>La()[1];const fb=new ResizeObserver(()=>{La()});fb.observe(Ga);
return()=>{fb.disconnect()}}}return()=>{}},10)},[c,m]);return M}getHeaderHeight(){var c;const m=Uq[null!=(c=this.props.scaleLevel)?c:"md"];return this.props.compact?0:40*m}getAutoResizeHeight(){return this.getInnerHeight?this.getHeaderHeight()+this.getInnerHeight():null}getShapeSVGJsx({}){var c,m,M;const ca=this.getBounds();return(0,gj.jsxs)(gj.Fragment,{children:[(0,gj.jsx)("rect",{fill:this.props.fill&&"var(--ls-secondary-background-color)"!==this.props.fill?Cf(this.props.fill)?`var(--ls-highlight-color-${this.props.fill})`:
this.props.fill:"var(--ls-secondary-background-color)",stroke:Df(this.props.fill,"background"),strokeWidth:null!=(c=this.props.strokeWidth)?c:2,fillOpacity:null!=(m=this.props.opacity)?m:.2,width:ca.width,rx:8,ry:8,height:ca.height}),!this.props.compact&&(0,gj.jsx)("rect",{fill:this.props.fill&&"var(--ls-secondary-background-color)"!==this.props.fill?Df(this.props.fill,"background"):"var(--ls-tertiary-background-color)",fillOpacity:null!=(M=this.props.opacity)?M:.2,x:1,y:1,width:ca.width-2,height:38,
rx:8,ry:8}),(0,gj.jsx)("text",{style:{transformOrigin:"top left"},transform:`translate(${ca.width/2}, ${10+ca.height/2})`,textAnchor:"middle",fontFamily:"var(--ls-font-family)",fontSize:"32",fill:"var(--ls-secondary-text-color)",stroke:"var(--ls-secondary-text-color)",children:"P"===this.props.blockType?this.props.pageName:""})]})}};wb(Aj,"id","logseq-portal");wb(Aj,"defaultSearchQuery","");wb(Aj,"defaultSearchFilter",null);wb(Aj,"defaultProps",{id:"logseq-portal",type:"logseq-portal",parentId:"page",
point:[0,0],size:[400,50],collapsedHeight:0,stroke:"",fill:"",noFill:!1,borderRadius:8,strokeWidth:2,strokeType:"line",opacity:1,pageId:"",collapsed:!1,compact:!1,scaleLevel:"md",isAutoResizing:!0});pe([$g],Aj.prototype,"collapsed",1);pe([Ag],Aj.prototype,"setCollapsed",2);pe([$g],Aj.prototype,"scaleLevel",1);pe([Ag],Aj.prototype,"setScaleLevel",2);var {min:Gp,PI:$C}=Math,Vq=$C+1E-4,au=ea(581),aD={xs:1,sm:1.6,md:2,lg:3.2,xl:4.8,xxl:6},bD={easing:c=>Math.sin(c*Math.PI/2),simulatePressure:!0},cD={easing:c=>
c*c,simulatePressure:!1},Ao=class extends lp{constructor(c={}){super(c);wb(this,"ReactComponent",Ee(({events:m,isErasing:M})=>{const {props:{opacity:ca}}=this;return(0,au.jsx)(vl,ng(Gf({},m),{opacity:M?.2:ca,children:this.getShapeSVGJsx()}))}));wb(this,"setScaleLevel",m=>Wh(this,null,function*(){this.update({scaleLevel:m,strokeWidth:aD[null!=m?m:"md"]});this.onResetBounds()}));wb(this,"ReactIndicator",Ee(()=>{const {pointsPath:m}=this;return(0,au.jsx)("path",{d:m,strokeDasharray:this.props.isLocked?
"8 2":"undefined"})}));wb(this,"validateProps",m=>{m=Nk(this,m);void 0!==m.strokeWidth&&(m.strokeWidth=Math.max(m.strokeWidth,1));return m});Cc(this)}get pointsPath(){var c=this.props;if(2>c.points.length)var m="";else m=ng(Gf({size:1+1.5*c.strokeWidth,thinning:.65,streamline:.65,smoothing:.65},.5===c.points[1][2]?bD:cD),{last:c.isComplete}),c=Ws(c.points,m),m=Nj.getSvgPathFromStroke(uq(c,m));return m}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(){const {pointsPath:c,
props:{stroke:m,strokeWidth:M,strokeType:ca}}=this;return(0,au.jsx)("path",{pointerEvents:"all",d:c,strokeWidth:M/2,strokeLinejoin:"round",strokeLinecap:"round",stroke:Df(m,"text"),fill:Df(m,"text"),strokeDasharray:"dashed"===ca?"12 4":void 0})}};wb(Ao,"id","pencil");wb(Ao,"defaultProps",{id:"pencil",parentId:"page",type:"pencil",point:[0,0],points:[],isComplete:!1,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:1});pe([$g],Ao.prototype,"pointsPath",1);pe([$g],Ao.prototype,"scaleLevel",
1);pe([Ag],Ao.prototype,"setScaleLevel",2);var Tx=Qf(ea(22)),Ol=ea(581),Ux={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Hp=class extends ln{constructor(){super(...arguments);wb(this,"canEdit",!0);wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isSelected:M,isEditing:ca,onEditingEnd:ua})=>{const {offset:[Ga,La],props:{stroke:fb,fill:vb,noFill:Wb,strokeWidth:oc,opacity:uc,strokeType:Sc,label:kd,italic:fd,fontWeight:xd,fontSize:Jd}}=this,$c=this.getVertices(oc/2).join();var hd=kd||ca?sg(kd,{fontFamily:"var(--ls-font-family)",
fontSize:Jd,lineHeight:1,fontWeight:xd},4):[0,0];const od=[this.props.size[0]/2,2*this.props.size[1]/3];hd=Math.max(.5,Math.min(1,this.props.size[0]/(2*hd[0]),this.props.size[1]/(2*hd[1])));const Kd=this.getBounds(),zd=Tx.useMemo(()=>ne.sub(od,ne.toFixed([Kd.width/2,Kd.height/2])),[Kd,hd,od]),Te=Tx.useCallback(We=>{var eg;null==(eg=this.update)?void 0:eg.call(this,{label:We})},[kd]);return(0,Ol.jsxs)("div",ng(Gf({},c),{style:{width:"100%",height:"100%",overflow:"hidden"},children:[(0,Ol.jsx)(bs,{font:"20px / 1 var(--ls-font-family)",
text:kd,fontSize:Jd,color:Df(fb,"text"),offsetX:zd[0],offsetY:zd[1]/hd,scale:hd,isEditing:ca,onChange:Te,onBlur:ua,fontStyle:fd?"italic":"normal",fontWeight:xd,pointerEvents:!!kd}),(0,Ol.jsx)(vl,{opacity:m?.2:uc,children:(0,Ol.jsxs)("g",{transform:`translate(${Ga}, ${La})`,children:[(0,Ol.jsx)("polygon",{className:M||!Wb?"tl-hitarea-fill":"tl-hitarea-stroke",points:$c}),(0,Ol.jsx)("polygon",{points:$c,stroke:Df(fb,"stroke"),fill:Wb?"none":Df(vb,"background"),strokeWidth:oc,rx:2,ry:2,strokeLinejoin:"round",
strokeDasharray:"dashed"===Sc?"8 2":void 0})]})})]}))}));wb(this,"setScaleLevel",c=>Wh(this,null,function*(){this.update({scaleLevel:c,fontSize:Ux[null!=c?c:"md"],strokeWidth:Ux[null!=c?c:"md"]/10});this.onResetBounds()}));wb(this,"ReactIndicator",Ee(()=>{const {offset:[c,m],props:{strokeWidth:M,isLocked:ca}}=this;return(0,Ol.jsx)("g",{children:(0,Ol.jsx)("polygon",{transform:`translate(${c}, ${m})`,points:this.getVertices(M/2).join(),strokeDasharray:ca?"8 2":"undefined"})})}));wb(this,"validateProps",
c=>{void 0!==c.sides&&(c.sides=Math.max(c.sides,3));return Nk(this,c)})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getShapeSVGJsx(c){const {offset:[m,M],props:{stroke:ca,fill:ua,noFill:Ga,strokeWidth:La,opacity:fb,strokeType:vb}}=this;c=this.getVertices(La/2).join();return(0,Ol.jsxs)("g",{transform:`translate(${m}, ${M})`,opacity:fb,children:[(0,Ol.jsx)("polygon",{className:Ga?"tl-hitarea-stroke":"tl-hitarea-fill",points:c}),(0,Ol.jsx)("polygon",{points:c,stroke:Df(ca,"stroke"),
fill:Ga?"none":Df(ua,"background"),strokeWidth:La,rx:2,ry:2,strokeLinejoin:"round",strokeDasharray:"dashed"===vb?"8 2":void 0})]})}};wb(Hp,"id","polygon");wb(Hp,"defaultProps",{id:"polygon",parentId:"page",type:"polygon",point:[0,0],size:[100,100],sides:3,ratio:1,isFlippedY:!1,stroke:"",fill:"",fontWeight:400,fontSize:20,italic:!1,noFill:!1,strokeType:"line",strokeWidth:2,opacity:1,label:""});pe([$g],Hp.prototype,"scaleLevel",1);pe([Ag],Hp.prototype,"setScaleLevel",2);var mm=Qf(ea(22)),xn=ea(581),
dD={xs:10,sm:16,md:20,lg:32,xl:48,xxl:60},Ip=class extends et{constructor(){super(...arguments);wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isEditing:M,onEditingEnd:ca})=>{const {props:{opacity:ua,fontFamily:Ga,fontSize:La,fontWeight:fb,italic:vb,lineHeight:Wb,text:oc,stroke:uc,padding:Sc}}=this,kd=mm.useRef(null),fd=mm.useRef(!1),xd=mm.useRef(null),Jd=mm.useCallback(zd=>{const {isSizeLocked:Te}=this.props;zd=sp.normalizeText(zd.currentTarget.value);Te?this.update({text:zd,size:this.getAutoSizedBoundingBox({text:zd})}):
this.update({text:zd})},[]),$c=mm.useCallback(zd=>{if("Escape"!==zd.key)if("Tab"===zd.key&&0===oc.length)zd.preventDefault();else{if("Meta"!==zd.key&&!zd.metaKey)zd.stopPropagation();else if("z"===zd.key&&zd.metaKey){zd.shiftKey?document.execCommand("redo",!1):document.execCommand("undo",!1);zd.stopPropagation();zd.preventDefault();return}"Tab"===zd.key&&(zd.preventDefault(),zd.shiftKey?Xk.unindent(zd.currentTarget):Xk.indent(zd.currentTarget),this.update({text:sp.normalizeText(zd.currentTarget.value)}))}},
[]),hd=mm.useCallback(zd=>{M&&(null==ca?void 0:ca())},[ca]),od=mm.useCallback(zd=>{M&&fd.current&&document.activeElement===zd.currentTarget&&zd.currentTarget.select()},[M]),Kd=mm.useCallback(zd=>{M&&zd.stopPropagation()},[M]);mm.useEffect(()=>{M&&requestAnimationFrame(()=>{fd.current=!0;const zd=kd.current;zd&&(zd.focus(),zd.select())})},[M,ca]);mm.useLayoutEffect(()=>{if(0===this.props.size[0]||0===this.props.size[1])this.onResetBounds()},[]);return(0,xn.jsx)(Vk,ng(Gf({},c),{opacity:m?.2:ua,children:(0,xn.jsx)("div",
{ref:xd,className:"tl-text-shape-wrapper","data-hastext":!!oc,"data-isediting":M,style:{fontFamily:Ga,fontStyle:vb?"italic":"normal",fontSize:La,fontWeight:fb,padding:Sc,lineHeight:Wb,color:Df(uc,"text")},children:M?(0,xn.jsx)("textarea",{ref:kd,className:"tl-text-shape-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:oc,onFocus:od,onChange:Jd,onKeyDown:$c,
onBlur:hd,onPointerDown:Kd}):(0,xn.jsxs)(xn.Fragment,{children:[oc,"​"]})})}))}));wb(this,"setScaleLevel",c=>Wh(this,null,function*(){this.update({scaleLevel:c,fontSize:dD[null!=c?c:"md"]});this.onResetBounds()}));wb(this,"ReactIndicator",Ee(({isEditing:c})=>{const {props:{borderRadius:m,isLocked:M},bounds:ca}=this;return c?null:(0,xn.jsx)("rect",{width:ca.width,height:ca.height,rx:m,ry:m,fill:"transparent",strokeDasharray:M?"8 2":"undefined"})}));wb(this,"validateProps",c=>Nk(this,c));wb(this,"getBounds",
()=>{const [c,m]=this.props.point,[M,ca]=this.props.size;return{minX:c,minY:m,maxX:c+M,maxY:m+ca,width:M,height:ca}});wb(this,"onResizeStart",({isSingle:c})=>{var m;if(!c)return this;this.scale=[...(null!=(m=this.props.scale)?m:[1,1])];return this.update({isSizeLocked:!1})});wb(this,"onResetBounds",()=>{this.update({size:this.getAutoSizedBoundingBox(),isSizeLocked:!0});return this})}get scaleLevel(){var c;return null!=(c=this.props.scaleLevel)?c:"md"}getAutoSizedBoundingBox(c={}){const {text:m=this.props.text,
fontFamily:M=this.props.fontFamily,fontSize:ca=this.props.fontSize,fontWeight:ua=this.props.fontWeight,lineHeight:Ga=this.props.lineHeight,padding:La=this.props.padding}=c,[fb,vb]=sg(m,{fontFamily:M,fontSize:ca,lineHeight:Ga,fontWeight:ua},La);return[fb,vb]}getShapeSVGJsx(){var c=window.navigator.userAgent.toLowerCase();if(c.includes("webkit")&&!c.includes("chrome"))return super.getShapeSVGJsx(null);const {props:{text:m,stroke:M,fontSize:ca,fontFamily:ua}}=this;c=this.getBounds();return(0,xn.jsx)("foreignObject",
{width:c.width,height:c.height,children:(0,xn.jsx)("div",{style:{color:Df(M,"text"),fontSize:ca,fontFamily:ua,display:"contents"},children:m})})}};wb(Ip,"id","text");wb(Ip,"defaultProps",{id:"box",parentId:"page",type:"text",point:[0,0],size:[0,0],isSizeLocked:!0,text:"",lineHeight:1.2,fontSize:20,fontWeight:400,italic:!1,padding:4,fontFamily:"var(--ls-font-family)",borderRadius:0,stroke:"",fill:"",noFill:!0,strokeType:"line",strokeWidth:2,opacity:1});pe([$g],Ip.prototype,"scaleLevel",1);pe([Ag],
Ip.prototype,"setScaleLevel",2);var Vx=Qf(ea(22)),gs=ea(581),hs=class extends ok{constructor(){super(...arguments);wb(this,"canFlip",!1);wb(this,"canEdit",!0);wb(this,"canChangeAspectRatio",!1);wb(this,"ReactComponent",Ee(({events:c,isErasing:m,asset:M,isEditing:ca})=>{const {props:{opacity:ua}}=this,Ga=Sm();var La=Ve();const fb=La.selectedIds.has(this.id),vb=Ga||fb&&!ca||"select"!==La.selectedTool.id;La=Vx.useCallback(oc=>{vb||oc.stopPropagation()},[vb]);const {handlers:Wb}=Vx.useContext(si);return(0,gs.jsx)(Vk,
ng(Gf({style:{overflow:"hidden",pointerEvents:"all",opacity:m?.2:ua}},c),{children:(0,gs.jsx)("div",{onWheelCapture:La,onPointerDown:La,onPointerUp:La,className:"tl-video-container",style:{pointerEvents:Ga||!ca&&!fb?"none":"all",overflow:ca?"auto":"hidden"},children:M&&(0,gs.jsx)("video",{controls:!0,src:Wb?Wb.makeAssetUrl(M.src):M.src})})}))}));wb(this,"ReactIndicator",Ee(()=>{const {props:{size:[c,m],isLocked:M}}=this;return(0,gs.jsx)("rect",{width:c,height:m,fill:"transparent",strokeDasharray:M?
"8 2":"undefined"})}))}};wb(hs,"id","video");wb(hs,"defaultProps",{id:"video1",parentId:"page",type:"video",point:[0,0],size:[100,100],opacity:1,assetId:"",clipping:0,isAspectRatioLocked:!0});var bk=ea(581),Wx=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,Xx=class extends ok{constructor(){super(...arguments);wb(this,"aspectRatio",480/853);wb(this,"canChangeAspectRatio",!1);wb(this,"canFlip",!1);wb(this,"canEdit",!0);wb(this,
"onYoutubeLinkChange",c=>{this.update({url:c,size:Xx.defaultProps.size})});wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isEditing:M})=>{const ca=Ve();return(0,bk.jsx)(Vk,ng(Gf({style:{overflow:"hidden",pointerEvents:"all",opacity:m?.2:1}},c),{children:(0,bk.jsx)("div",{className:"rounded-lg w-full h-full relative overflow-hidden shadow-xl tl-youtube-container",style:{pointerEvents:M||ca.readOnly?"all":"none",userSelect:"none",background:`url('https://img.youtube.com/vi/${this.embedId}/mqdefault.jpg') no-repeat center/cover`},
children:this.embedId?(0,bk.jsx)("div",{style:{overflow:"hidden",position:"relative",height:"100%"},children:(0,bk.jsx)("iframe",{className:"absolute inset-0 w-full h-full m-0",width:"853",height:"480",src:`https://www.youtube.com/embed/${this.embedId}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"Embedded youtube"})}):(0,bk.jsx)("div",{className:"w-full h-full flex items-center justify-center p-4",style:{backgroundColor:"var(--ls-primary-background-color)"},
children:(0,bk.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 502 210.649",height:"210.65",width:"128",children:(0,bk.jsxs)("g",{children:[(0,bk.jsx)("path",{d:"M498.333 45.7s-2.91-20.443-11.846-29.447C475.157 4.44 462.452 4.38 456.627 3.687c-41.7-3-104.25-3-104.25-3h-.13s-62.555 0-104.255 3c-5.826.693-18.523.753-29.86 12.566-8.933 9.004-11.84 29.447-11.84 29.447s-2.983 24.003-2.983 48.009v22.507c0 24.006 2.983 48.013 2.983 48.013s2.907 20.44 11.84 29.446c11.337 11.817 26.23 11.44 32.86 12.677 23.84 2.28 101.315 2.983 101.315 2.983s62.62-.094 104.32-3.093c5.824-.694 18.527-.75 29.857-12.567 8.936-9.006 11.846-29.446 11.846-29.446s2.98-24.007 2.98-48.013V93.709c0-24.006-2.98-48.01-2.98-48.01",
fill:"#cd201f"}),(0,bk.jsx)("g",{children:(0,bk.jsx)("path",{d:"M187.934 169.537h-18.96V158.56c-7.19 8.24-13.284 12.4-19.927 12.4-5.826 0-9.876-2.747-11.9-7.717-1.23-3.02-2.103-7.736-2.103-14.663V68.744h18.957v81.833c.443 2.796 1.636 3.823 4.043 3.823 3.63 0 6.913-3.153 10.93-8.817V68.744h18.96v100.793zM102.109 139.597c.996 9.98-2.1 14.93-7.987 14.93s-8.98-4.95-7.98-14.93v-39.92c-1-9.98 2.093-14.657 7.98-14.657 5.89 0 8.993 4.677 7.996 14.657l-.01 39.92zm18.96-37.923c0-10.77-2.164-18.86-5.987-23.95-5.054-6.897-12.973-9.72-20.96-9.72-9.033 0-15.913 2.823-20.957 9.72-3.886 5.09-5.97 13.266-5.97 24.036l-.016 35.84c0 10.71 1.853 18.11 5.736 23.153 5.047 6.873 13.227 10.513 21.207 10.513 7.986 0 16.306-3.64 21.36-10.513 3.823-5.043 5.586-12.443 5.586-23.153v-35.926zM46.223 114.647v54.889h-19.96v-54.89S5.582 47.358 1.314 34.815H22.27L36.277 87.38l13.936-52.566H71.17l-24.947 79.833z"})}),
(0,bk.jsxs)("g",{fill:"#fff",children:[(0,bk.jsx)("path",{d:"M440.413 96.647c0-9.33 2.557-11.874 8.59-11.874 5.99 0 8.374 2.777 8.374 11.997v10.893l-16.964.02V96.647zm35.96 25.986l-.003-20.4c0-10.656-2.1-18.456-5.88-23.5-5.06-6.823-12.253-10.436-21.317-10.436-9.226 0-16.42 3.613-21.643 10.436-3.84 5.044-6.076 13.28-6.076 23.943v34.927c0 10.596 2.46 18.013 6.296 23.003 5.227 6.813 12.42 10.216 21.87 10.216 9.44 0 16.853-3.566 21.85-10.81 2.2-3.196 3.616-6.82 4.226-10.823.164-1.81.64-5.933.64-11.753v-2.827h-18.96c0 7.247.037 11.557-.133 12.54-1.033 4.834-3.623 7.25-8.07 7.25-6.203 0-8.826-4.636-8.76-13.843v-17.923h35.96zM390.513 140.597c0 9.98-2.353 13.806-7.563 13.806-2.973 0-6.4-1.53-9.423-4.553l.02-60.523c3.02-2.98 6.43-4.55 9.403-4.55 5.21 0 7.563 2.93 7.563 12.91v42.91zm2.104-72.453c-6.647 0-13.253 4.087-19.09 11.27l.02-43.603h-17.963V169.54h17.963l.027-10.05c6.036 7.47 12.62 11.333 19.043 11.333 7.193 0 12.45-3.85 14.863-11.267 1.203-4.226 1.993-10.733 1.993-19.956V99.684c0-9.447-1.21-15.907-2.416-19.917-2.41-7.466-7.247-11.623-14.44-11.623M340.618 169.537h-18.956V158.56c-7.193 8.24-13.283 12.4-19.926 12.4-5.827 0-9.877-2.747-11.9-7.717-1.234-3.02-2.107-7.736-2.107-14.663V69.744h18.96v80.833c.443 2.796 1.633 3.823 4.043 3.823 3.63 0 6.913-3.153 10.93-8.817V69.744h18.957v99.793z"}),
(0,bk.jsx)("path",{d:"M268.763 169.537h-19.956V54.77h-20.956V35.835l62.869-.024v18.96h-21.957v114.766z"})]})]})})})})}))}));wb(this,"ReactIndicator",Ee(()=>{const {props:{size:[c,m],isLocked:M}}=this;return(0,bk.jsx)("rect",{width:c,height:m,fill:"transparent",rx:8,ry:8,strokeDasharray:M?"8 2":"undefined"})}));wb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.max(c.size[0],1),c.size[1]=Math.max(c.size[0]*this.aspectRatio,1));return Nk(this,c)})}get embedId(){var c,m;const M=this.props.url,
ca=M.match(Wx);return null!=(m=null!=(c=null==ca?void 0:ca[1])?c:M)?m:""}getShapeSVGJsx(){const c=this.getBounds(),m=this.embedId;return m?(0,bk.jsxs)("g",{children:[(0,bk.jsx)("image",{width:c.width,height:c.height,href:`https://img.youtube.com/vi/${m}/mqdefault.jpg`,className:"grayscale-[50%]"}),(0,bk.jsx)("svg",{x:c.width/4,y:c.height/4,width:c.width/2,height:c.height/2,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,bk.jsx)("path",{d:"M4.76447 3.12199C5.63151 3.04859 6.56082 3 7.5 3C8.43918 3 9.36849 3.04859 10.2355 3.12199C11.2796 3.21037 11.9553 3.27008 12.472 3.39203C12.9425 3.50304 13.2048 3.64976 13.4306 3.88086C13.4553 3.90618 13.4902 3.94414 13.5133 3.97092C13.7126 4.20149 13.8435 4.4887 13.918 5.03283C13.9978 5.6156 14 6.37644 14 7.52493C14 8.66026 13.9978 9.41019 13.9181 9.98538C13.8439 10.5206 13.7137 10.8061 13.5125 11.0387C13.4896 11.0651 13.4541 11.1038 13.4296 11.1287C13.2009 11.3625 12.9406 11.5076 12.4818 11.6164C11.9752 11.7365 11.3143 11.7942 10.2878 11.8797C9.41948 11.9521 8.47566 12 7.5 12C6.52434 12 5.58052 11.9521 4.7122 11.8797C3.68572 11.7942 3.02477 11.7365 2.51816 11.6164C2.05936 11.5076 1.7991 11.3625 1.57037 11.1287C1.54593 11.1038 1.51035 11.0651 1.48748 11.0387C1.28628 10.8061 1.15612 10.5206 1.08193 9.98538C1.00221 9.41019 1 8.66026 1 7.52493C1 6.37644 1.00216 5.6156 1.082 5.03283C1.15654 4.4887 1.28744 4.20149 1.48666 3.97092C1.5098 3.94414 1.54468 3.90618 1.56942 3.88086C1.7952 3.64976 2.05752 3.50304 2.52796 3.39203C3.04473 3.27008 3.7204 3.21037 4.76447 3.12199ZM0 7.52493C0 5.28296 0 4.16198 0.729985 3.31713C0.766457 3.27491 0.815139 3.22194 0.854123 3.18204C1.63439 2.38339 2.64963 2.29744 4.68012 2.12555C5.56923 2.05028 6.52724 2 7.5 2C8.47276 2 9.43077 2.05028 10.3199 2.12555C12.3504 2.29744 13.3656 2.38339 14.1459 3.18204C14.1849 3.22194 14.2335 3.27491 14.27 3.31713C15 4.16198 15 5.28296 15 7.52493C15 9.74012 15 10.8477 14.2688 11.6929C14.2326 11.7348 14.1832 11.7885 14.1444 11.8281C13.3629 12.6269 12.3655 12.71 10.3709 12.8763C9.47971 12.9505 8.50782 13 7.5 13C6.49218 13 5.52028 12.9505 4.62915 12.8763C2.63446 12.71 1.63712 12.6269 0.855558 11.8281C0.816844 11.7885 0.767442 11.7348 0.731221 11.6929C0 10.8477 0 9.74012 0 7.52493ZM5.25 5.38264C5.25 5.20225 5.43522 5.08124 5.60041 5.15369L10.428 7.27105C10.6274 7.35853 10.6274 7.64147 10.428 7.72895L5.60041 9.84631C5.43522 9.91876 5.25 9.79775 5.25 9.61736V5.38264Z",
fill:"#D10014",fillRule:"evenodd",clipRule:"evenodd"})})]}):super.getShapeSVGJsx({})}},Bo=Xx;wb(Bo,"id","youtube");wb(Bo,"defaultProps",{id:"youtube",type:"youtube",parentId:"page",point:[0,0],size:[853,480],url:""});pe([$g],Bo.prototype,"embedId",1);pe([Ag],Bo.prototype,"onYoutubeLinkChange",2);var Jp=Qf(ea(22)),Hm=ea(581),Yx=/https?:\/\/(x|twitter).com\/[0-9a-zA-Z_]{1,20}\/status\/([0-9]*)/,Zx=class extends ok{constructor(){super(...arguments);wb(this,"canFlip",!1);wb(this,"canEdit",!0);wb(this,
"initialHeightCalculated",!0);wb(this,"getInnerHeight",null);wb(this,"onTwitterLinkChange",c=>{this.update({url:c,size:Zx.defaultProps.size})});wb(this,"ReactComponent",Ee(({events:c,isErasing:m,isEditing:M})=>{const {renderers:{Tweet:ca}}=Jp.useContext(si),ua=Ve(),Ga=Jp.useRef(null),[,La]=this.useComponentSize(Ga);Jp.useEffect(()=>{var fb,vb;const Wb=null!=(vb=null==(fb=this.getInnerHeight)?void 0:fb.call(this))?vb:La;La&&1<Math.abs(Wb-this.props.size[1])&&(this.update({size:[this.props.size[0],
Wb]}),ua.persist({replace:!0}))},[La]);Jp.useEffect(()=>{this.initialHeightCalculated||setTimeout(()=>{this.onResetBounds();ua.persist({replace:!0})})},[this.initialHeightCalculated]);return(0,Hm.jsx)(Vk,ng(Gf({style:{overflow:"hidden",pointerEvents:"all",opacity:m?.2:1}},c),{children:(0,Hm.jsx)("div",{className:"rounded-xl w-full h-full relative shadow-xl tl-tweet-container",style:{pointerEvents:M||ua.readOnly?"all":"none",userSelect:"none"},children:this.embedId?(0,Hm.jsx)("div",{ref:Ga,children:(0,Hm.jsx)(ca,
{tweetId:this.embedId})}):null})}))}));wb(this,"ReactIndicator",Ee(()=>{const {props:{size:[c,m],isLocked:M}}=this;return(0,Hm.jsx)("rect",{width:c,height:m,fill:"transparent",rx:8,ry:8,strokeDasharray:M?"8 2":"undefined"})}));wb(this,"onResetBounds",c=>{c=this.getAutoResizeHeight();null!==c&&1<Math.abs(c-this.props.size[1])&&(this.update({size:[this.props.size[0],c]}),this.initialHeightCalculated=!0);return this});wb(this,"onResize",(c,m)=>{var M;const {bounds:ca,rotation:ua,scale:[Ga,La]}=m;c=[...this.scale];
0>Ga&&(c[0]*=-1);0>La&&(c[1]*=-1);m=null!=(M=this.getAutoResizeHeight())?M:ca.height;return this.update({point:[ca.minX,ca.minY],size:[Math.max(1,ca.width),Math.max(1,m)],scale:c,rotation:ua})});wb(this,"validateProps",c=>{void 0!==c.size&&(c.size[0]=Math.min(Math.max(c.size[0],300),550),c.size[1]=Math.max(c.size[1],1));return Nk(this,c)})}get embedId(){var c,m;const M=this.props.url,ca=M.match(Yx);return null!=(m=null!=(c=null==ca?void 0:ca[1])?c:M)?m:""}useComponentSize(c,m=""){const [M,ca]=Jp.useState([0,
0]),ua=Ve();Jp.useEffect(()=>{if(null==c?0:c.current){const Ga=m?c.current.querySelector(m):c.current;if(Ga){const La=()=>{const {width:vb,height:Wb}=Ga.getBoundingClientRect(),oc=ne.div([vb,Wb],ua.viewport.camera.zoom);ca(oc);return oc};La();this.getInnerHeight=()=>La()[1];const fb=new ResizeObserver(()=>{La()});fb.observe(Ga);return()=>{fb.disconnect()}}}return()=>{}},[c,m]);return M}getAutoResizeHeight(){return this.getInnerHeight?this.getInnerHeight():null}getShapeSVGJsx(){const c=this.getBounds();
return this.embedId?(0,Hm.jsxs)("g",{children:[(0,Hm.jsx)("rect",{width:c.width,height:c.height,fill:"#15202b",rx:8,ry:8}),(0,Hm.jsx)("svg",{x:c.width/4,y:c.height/4,width:c.width/2,height:c.height/2,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,Hm.jsx)("path",{d:"m13.464 4.4401c0.0091 0.13224 0.0091 0.26447 0.0091 0.39793 0 4.0664-3.0957 8.7562-8.7562 8.7562v-0.0024c-1.6721 0.0024-3.3095-0.47658-4.7172-1.3797 0.24314 0.02925 0.48751 0.04387 0.73248 0.04448 1.3857 0.0013 2.7319-0.46374 3.8221-1.3199-1.3169-0.024981-2.4717-0.8836-2.8751-2.1371 0.4613 0.08897 0.93662 0.070688 1.3894-0.053016-1.4357-0.29007-2.4686-1.5515-2.4686-3.0165v-0.039001c0.42779 0.23827 0.90676 0.37051 1.3967 0.38513-1.3522-0.90372-1.769-2.7026-0.95247-4.1091 1.5625 1.9226 3.8678 3.0914 6.3425 3.2151-0.24802-1.0689 0.090798-2.1889 0.89031-2.9403 1.2395-1.1651 3.1889-1.1054 4.3541 0.13346 0.68921-0.13589 1.3498-0.38879 1.9543-0.74711-0.22974 0.71237-0.71054 1.3175-1.3528 1.702 0.60999-0.071907 1.206-0.23522 1.7672-0.48446-0.41316 0.61913-0.93358 1.1584-1.5356 1.5942z",
fill:"#1d9bf0",fillRule:"evenodd",clipRule:"evenodd"})})]}):super.getShapeSVGJsx({})}},Kp=Zx;wb(Kp,"id","tweet");wb(Kp,"defaultProps",{id:"tweet",type:"tweet",parentId:"page",point:[0,0],size:[331,290],url:""});pe([$g],Kp.prototype,"embedId",1);pe([Ag],Kp.prototype,"onTwitterLinkChange",2);var bu=Qf(ea(22)),cu=ea(581),Wq=class extends ok{constructor(){super(...arguments);wb(this,"frameRef",bu.createRef());wb(this,"canChangeAspectRatio",!0);wb(this,"canFlip",!0);wb(this,"canEdit",!0);wb(this,"ReactComponent",
Ee(({events:c,asset:m,isErasing:M,isEditing:ca})=>{bu.useRef(null);const {handlers:ua}=bu.useContext(si);Ve();const Ga=Sm();return(0,cu.jsx)(Vk,ng(Gf({style:{overflow:"hidden",pointerEvents:"all",opacity:M?.2:1}},c),{children:m?(0,cu.jsx)("embed",{src:ua?ua.inflateAsset(m.src).url:m.src,className:"relative tl-pdf-container",onWheelCapture:stop,onPointerDown:stop,onPointerUp:stop,style:{width:"100%",height:"100%",pointerEvents:!Ga&&ca?"all":"none"}}):null}))}));wb(this,"ReactIndicator",Ee(()=>{const {props:{size:[c,
m],isLocked:M}}=this;return(0,cu.jsx)("rect",{width:c,height:m,fill:"transparent",rx:8,ry:8,strokeDasharray:M?"8 2":"undefined"})}))}};wb(Wq,"id","pdf");wb(Wq,"defaultProps",{id:"pdf",type:"pdf",parentId:"page",point:[0,0],size:[595,842],assetId:""});ea(581);var $x=[Bp,Cp,yo,es,hs,Fp,Ao,Hp,Ip,Bo,Kp,zo,wn,Wq,Aj,Wt],du=class extends Em{constructor(){super(...arguments);wb(this,"Shape",Bp)}};wb(du,"id","box");wb(du,"shortcut","whiteboard/rectangle");var eu=class extends Em{constructor(){super(...arguments);
wb(this,"Shape",Cp)}};wb(eu,"id","ellipse");wb(eu,"shortcut","whiteboard/ellipse");var fu=class extends Gr{};wb(fu,"id","erase");wb(fu,"shortcut","whiteboard/eraser");var gu=class extends Gq{constructor(){super(...arguments);wb(this,"Shape",yo);wb(this,"simplify",!0);wb(this,"simplifyTolerance",.618)}};wb(gu,"id","highlighter");wb(gu,"shortcut","whiteboard/highlighter");var Yk=class extends Hr{constructor(){super(...arguments);wb(this,"Shape",Fp)}};wb(Yk,"id","line");wb(Yk,"shortcut","whiteboard/connector");
var hu=class extends Gq{constructor(){super(...arguments);wb(this,"Shape",Ao);wb(this,"simplify",!1)}};wb(hu,"id","pencil");wb(hu,"shortcut","whiteboard/pencil");var ay=class extends Em{constructor(){super(...arguments);wb(this,"Shape",Hp)}};wb(ay,"id","polygon");var iu=class extends Ir{constructor(){super(...arguments);wb(this,"Shape",Ip)}};wb(iu,"id","text");wb(iu,"shortcut","whiteboard/text");var ju=class extends Em{constructor(){super(...arguments);wb(this,"Shape",Bo)}};wb(ju,"id","youtube");
var fk=class extends ei{constructor(){super(...arguments);wb(this,"creatingShape");wb(this,"offset",[0,0]);wb(this,"onEnter",()=>{this.app.history.pause();tc(()=>{var c=ne.sub(this.app.inputs.originPoint,this.offset);this.app.settings.snapToGrid&&(c=ne.snap(c,8));this.creatingShape=c=new Aj({id:Re(),parentId:this.app.currentPage.id,point:c,size:Aj.defaultProps.size,fill:this.app.settings.color,stroke:this.app.settings.color});this.app.currentPage.addShapes(c);this.app.setEditingShape(c);this.app.setSelectedShapes([c])})});
wb(this,"onPointerDown",c=>{switch(c.type){case "shape":if(c.shape===this.creatingShape)break;this.app.selectTool("select");break;case "canvas":c.order||this.app.selectTool("select")}});wb(this,"onExit",()=>{var c;this.creatingShape&&(this.app.history.resume(),(null==(c=this.creatingShape)?0:c.props.pageId)?this.app.setSelectedShapes([this.creatingShape.id]):(this.app.deleteShapes([this.creatingShape.id]),this.app.setEditingShape()),this.creatingShape=void 0)})}};wb(fk,"id","creating");var Gk=class extends ei{constructor(){super(...arguments);
wb(this,"cursor","crosshair");wb(this,"onPointerDown",c=>{this.tool.transition("creating")})}};wb(Gk,"id","idle");var Pn=class extends mn{constructor(){super(...arguments);wb(this,"Shape",Aj);wb(this,"onPinch",c=>{this.app.viewport.pinchZoom(c.point,c.delta,c.delta[2])})}};wb(Pn,"id","logseq-portal");wb(Pn,"shortcut","whiteboard/portal");wb(Pn,"states",[Gk,fk]);wb(Pn,"initial","idle");var iv=class extends Em{constructor(){super(...arguments);wb(this,"Shape",wn)}};wb(iv,"id","youtube");var jv=class extends Em{constructor(){super(...arguments);
wb(this,"Shape",zo)}};wb(jv,"id","iframe");var kv=Qf(ea(584)),ol=ea(581),Mo=new Map($x.map(c=>[c.id,c])),tq=class{constructor(c){wb(this,"shapes");wb(this,"pageId");wb(this,"assets");c&&this.load(c)}load(c){var m;const M=null==(m=null==c?void 0:c.pages)?void 0:m[0];this.pageId=null==M?void 0:M.id;this.assets=c.assets;this.shapes=null==M?void 0:M.shapes.map(ca=>{var ua=ca.type;if(!ua)throw Error("No shape type provided.");const Ga=Mo.get(ua);if(!Ga)throw Error(`Could not find shape class for ${ua}`);
return new Ga(ca)}).filter(ca=>"group"!==ca.type)}generatePreviewJsx(c,m){var M,ca;const ua=[...(null!=(M=this.shapes)?M:[]).map(Wb=>Wb.getRotatedBounds())];(M=null==c?void 0:c.currentView)&&ua.push(M);let Ga=Me.getCommonBounds(ua);if(!Ga)return null;Ga=Me.expandBounds(Ga,16);Ga=m?Me.ensureRatio(Ga,m):Ga;const La=Wb=>[(Wb[0]-Ga.minX).toFixed(2),(Wb[1]-Ga.minY).toFixed(2)],[fb,vb]=M?La([M.minX,M.minY]):[0,0];return Ga&&(0,ol.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg","data-common-bound-x":Ga.minX.toFixed(2),
"data-common-bound-y":Ga.minY.toFixed(2),"data-common-bound-width":Ga.width.toFixed(2),"data-common-bound-height":Ga.height.toFixed(2),viewBox:[0,0,Ga.width,Ga.height].join(" "),children:[(0,ol.jsx)("defs",{children:M&&(0,ol.jsxs)(ol.Fragment,{children:[(0,ol.jsx)("rect",{id:this.pageId+"-camera-rect",transform:`translate(${fb}, ${vb})`,width:M.width,height:M.height}),(0,ol.jsxs)("mask",{id:this.pageId+"-camera-mask",children:[(0,ol.jsx)("rect",{width:Ga.width,height:Ga.height,fill:"white"}),(0,ol.jsx)("use",
{href:`#${this.pageId}-camera-rect`,fill:"black"})]})]})}),(0,ol.jsx)("g",{id:this.pageId+"-preview-shapes",children:null==(ca=this.shapes)?void 0:ca.map(Wb=>{var oc,uc;const {bounds:Sc,props:{rotation:kd}}=Wb,[fd,xd]=La([Sc.minX,Sc.minY]),Jd=+(180*((null!=kd?kd:0)+(null!=(oc=Sc.rotation)?oc:0))/Math.PI).toFixed(2),[$c,hd]=[(Sc.width/2).toFixed(2),(Sc.height/2).toFixed(2)];return(0,ol.jsx)("g",{transform:[`translate(${fd}, ${xd})`,`rotate(${Jd}, ${$c}, ${hd})`].join(" "),children:Wb.getShapeSVGJsx({assets:null!=
(uc=this.assets)?uc:[]})},Wb.id)})}),(0,ol.jsx)("rect",{mask:M?`url(#${this.pageId}-camera-mask)`:"",width:Ga.width,height:Ga.height,fill:"transparent"}),M&&(0,ol.jsx)("use",{id:"minimap-camera-rect","data-x":fb,"data-y":vb,"data-width":M.width,"data-height":M.height,href:`#${this.pageId}-camera-rect`,fill:"transparent",stroke:"red",strokeWidth:4/c.camera.zoom})]})}exportAsSVG(c){return(c=this.generatePreviewJsx(void 0,c))?kv.default.renderToString(c):""}},eD=Qf(ea(22)),Xq=ea(581),Yq=eD.forwardRef((c,
m)=>{var {value:M,className:ca}=c;c=Ti(c,["autoResize","value","className"]);return(0,Xq.jsx)("div",{className:"tl-input"+(ca?" "+ca:""),children:(0,Xq.jsxs)("div",{className:"tl-input-sizer",children:[(0,Xq.jsx)("div",{className:"tl-input-hidden",children:M}),(0,Xq.jsx)("input",Gf({ref:m,value:M,className:"tl-text-input",type:"text"},c))]})})}),$h=ea(581),Im=({type:c,active:m})=>(0,$h.jsx)("span",{className:"tl-type-tag","data-active":m,children:(0,$h.jsx)("i",{className:`tie tie-${({B:"block",P:"page",
WP:"whiteboard",BA:"new-block",PA:"new-page",WA:"new-whiteboard",BS:"block-search",PS:"page-search"})[c]}`})}),lv=(c,m)=>(0,$h.jsx)("span",{children:c.split(new RegExp(`(${m.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$\x26")})`,"gi")).map((M,ca)=>1===ca%2?(0,$h.jsx)("mark",{className:"tl-highlighted",children:M}):M).map((M,ca)=>(0,$h.jsx)(ak.default.Fragment,{children:M},ca))}),tr=(c,m)=>{const {handlers:M}=ak.default.useContext(si),[ca,ua]=ak.default.useState(null),Ga=Le(c,200);ak.default.useEffect(()=>
{let La=!1;if(0<Ga.length){const fb={"pages?":!0,"blocks?":!0,"files?":!1};"B"===m?fb["pages?"]=!1:"P"===m&&(fb["blocks?"]=!1);M.search(Ga,fb).then(vb=>{La||ua(vb)})}else ua(null);return()=>{La=!0}},[Ga,null==M?void 0:M.search]);return ca},Vs=Ee(({className:c,style:m,placeholder:M,onChange:ca,onBlur:ua,onAddBlock:Ga})=>{const [La,fb]=ak.default.useState(Aj.defaultSearchQuery),[vb,Wb]=ak.default.useState(Aj.defaultSearchFilter),oc=ak.default.useRef(null),{handlers:uc,renderers:Sc}=ak.default.useContext(si),
kd=uc.t,fd=ak.default.useCallback((of,Tf)=>{var Jg;console.log({id:of,isPage:Tf});setTimeout(()=>ca(of,Tf));null==(Jg=oc.current)?void 0:Jg.blur();of&&(Aj.defaultSearchQuery="",Aj.defaultSearchFilter=null)},[]),xd=ak.default.useCallback(of=>Wh(void 0,null,function*(){const Tf=yield null==uc?void 0:uc.addNewBlock(of);Tf&&(fd(Tf),null==Ga?void 0:Ga(Tf));return Tf}),[Ga]),Jd=ak.default.useRef(null),[$c,hd]=ak.default.useState(0),od=tr(La,vb),[Kd,zd]=ak.default.useState("circle-plus"),[Te,We]=ak.default.useState(!1);
ak.default.useEffect(()=>{setTimeout(()=>{var of;null==(of=oc.current)?void 0:of.focus()})},[vb]);ak.default.useEffect(()=>{Aj.defaultSearchQuery=La;Aj.defaultSearchFilter=vb},[La,vb]);const eg=ak.default.useMemo(()=>{var of;const Tf=[];if(null==Sc||!Sc.Breadcrumb||!uc)return[];Ga&&Tf.push({actionIcon:"circle-plus",onChosen:()=>!!xd(La),element:(0,$h.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,$h.jsx)(Im,{active:!0,type:"BA"}),0<La.length?(0,$h.jsxs)($h.Fragment,{children:[(0,$h.jsx)("strong",
{children:kd("whiteboard/new-block")}),La]}):(0,$h.jsx)("strong",{children:kd("whiteboard/new-block-no-colon")})]})});(null==(of=null==od?void 0:od.pages)?0:of.some(Jg=>Jg.title.toLowerCase()===La.toLowerCase()))||!La||Tf.push({actionIcon:"circle-plus",onChosen:()=>Wh(void 0,null,function*(){let Jg=yield null==uc?void 0:uc.addNewPage(La);fd(Jg,!0);return!0}),element:(0,$h.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,$h.jsx)(Im,{active:!0,type:"PA"}),(0,$h.jsx)("strong",{children:kd("whiteboard/new-page")}),
La]})},{actionIcon:"circle-plus",onChosen:()=>Wh(void 0,null,function*(){let Jg=yield null==uc?void 0:uc.addNewWhiteboard(La);fd(Jg,!0);return!0}),element:(0,$h.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,$h.jsx)(Im,{active:!0,type:"WA"}),(0,$h.jsx)("strong",{children:kd("whiteboard/new-whiteboard")}),La]})});0===La.length&&null===vb&&Tf.push({actionIcon:"search",onChosen:()=>{Wb("B");return!0},element:(0,$h.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,$h.jsx)(Im,
{type:"BS"}),kd("whiteboard/search-only-blocks")]})},{actionIcon:"search",onChosen:()=>{Wb("P");return!0},element:(0,$h.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,$h.jsx)(Im,{type:"PS"}),kd("whiteboard/search-only-pages")]})});vb&&"P"!==vb||!od||!od.pages||Tf.push(...od.pages.map(Jg=>({actionIcon:"search",onChosen:()=>{fd(Jg.id,!0);return!0},element:(0,$h.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,$h.jsx)(Im,{type:uc.isWhiteboardPage(Jg.id)?"WP":"P"}),lv(Jg.title,
La)]})})));vb&&"B"!==vb||!od||!od.blocks||Tf.push(...od.blocks.filter(Jg=>Jg.title&&Jg.uuid).map(({title:Jg,uuid:bh})=>{const Eg=uc.queryBlockByUUID(bh);return{actionIcon:"search",onChosen:()=>{var ch,Bf,If;return Eg?(fd(bh),null==(If=null==(Bf=null==(ch=window.logseq)?void 0:ch.api)?void 0:Bf.set_blocks_id)?void 0:If.call(Bf,[bh]),!0):!1},element:(0,$h.jsx)($h.Fragment,{children:(0,$h.jsxs)("div",{className:"tl-quick-search-option-row",children:[(0,$h.jsx)(Im,{type:"B"}),lv(Jg,La)]})})}}));return Tf},
[La,vb,od,null==Sc?void 0:Sc.Breadcrumb,uc]);ak.default.useEffect(()=>{const of=Tf=>{var Jg,bh;let Eg=$c;"ArrowDown"===Tf.key?Eg=Math.min(eg.length-1,$c+1):"ArrowUp"===Tf.key?Eg=Math.max(0,$c-1):"Enter"===Tf.key?(null==(Jg=eg[$c])?void 0:Jg.onChosen(),Tf.stopPropagation(),Tf.preventDefault()):"Backspace"===Tf.key&&0===La.length?Wb(null):"Escape"===Tf.key&&fd("");Eg!==$c&&(Jg=eg[Eg],hd(Eg),zd(Jg.actionIcon),Tf.stopPropagation(),Tf.preventDefault(),(Tf=null==(bh=Jd.current)?void 0:bh.querySelector(".tl-quick-search-option:nth-child("+
(Eg+1)+")"))&&(null==Tf?void 0:Tf.scrollIntoViewIfNeeded(!1)))};document.addEventListener("keydown",of,!0);return()=>{document.removeEventListener("keydown",of,!0)}},[eg,$c,La]);return(0,$h.jsxs)("div",{className:"tl-quick-search "+(null!=c?c:""),style:m,children:[(0,$h.jsx)(qB,{icon:Kd,onClick:()=>{var of;null==(of=eg[$c])?void 0:of.onChosen()}}),(0,$h.jsxs)("div",{className:"tl-quick-search-input-container",children:[vb&&(0,$h.jsxs)("div",{className:"tl-quick-search-input-filter",children:[(0,$h.jsx)(Im,
{type:vb}),"B"===vb?"Search blocks":"Search pages",(0,$h.jsx)("div",{className:"tl-quick-search-input-filter-remove",onClick:()=>Wb(null),children:(0,$h.jsx)(hh,{name:"x"})})]}),(0,$h.jsx)(Yq,{ref:oc,type:"text",value:La,className:"tl-quick-search-input",placeholder:null!=M?M:"Create or search your graph...",onChange:of=>fb(of.target.value),onKeyDown:of=>{"Enter"===of.key&&fd(La);of.stopPropagation()},onFocus:()=>{We(!0)},onBlur:()=>{We(!1);null==ua?void 0:ua()}})]}),0<eg.length&&(0,$h.jsx)("div",
{onWheelCapture:of=>of.stopPropagation(),className:"tl-quick-search-options",ref:Jd,style:{visibility:Te?"visible":"hidden",pointerEvents:Te?"all":"none"},children:(0,$h.jsx)(oC,{style:{height:40*Math.min(Math.max(1,eg.length),12)},totalCount:eg.length,itemContent:of=>{const {actionIcon:Tf,onChosen:Jg,element:bh}=eg[of];return(0,$h.jsx)("div",{"data-focused":of===$c,className:"tl-quick-search-option",tabIndex:0,onMouseEnter:()=>{zd(Tf);hd(of)},onPointerDownCapture:Eg=>{Jg()&&(Eg.stopPropagation(),
Eg.preventDefault())},children:bh},of)}})})]})}),Ri=ea(581),fD=Ee(function(c){var {pageId:m,portalType:M,refs:ca,side:ua,onRefsChange:Ga}=c;c=Ti(c,"pageId portalType shapeType refs side onRefsChange".split(" "));const {handlers:{t:La}}=xx.default.useContext(si),fb=ca.length+(m?1:0),vb=0===ca.length,Wb=uc=>{uc&&!ca.includes(uc)&&vb&&Ga([...ca,uc])},oc=!(!m||!M);return(0,Ri.jsx)(rk,ng(Gf({},c),{side:ua,align:"start",alignOffset:-6,label:(0,Ri.jsx)(Qh,{content:La("whiteboard/link"),sideOffset:14,children:(0,Ri.jsxs)("div",
{className:"flex gap-1 relative items-center justify-center px-1",children:[(0,Ri.jsx)(hh,{name:0<fb?"link":"add-link"}),0<fb&&(0,Ri.jsx)("div",{className:"tl-shape-links-count",children:fb})]})}),children:(0,Ri.jsxs)("div",{className:"color-level rounded-lg","data-show-reference-panel":oc,children:[oc&&(0,Ri.jsxs)("div",{className:"tl-shape-links-reference-panel",children:[(0,Ri.jsxs)("div",{className:"text-base inline-flex gap-1 items-center",children:[(0,Ri.jsx)(hh,{className:"opacity-50",name:"internal-link"}),
La("whiteboard/references")]}),(0,Ri.jsx)(rl,{type:M,id:m})]}),(0,Ri.jsxs)("div",{className:"tl-shape-links-panel color-level",children:[(0,Ri.jsxs)("div",{className:"text-base inline-flex gap-1 items-center",children:[(0,Ri.jsx)(hh,{className:"opacity-50",name:"add-link"}),La("whiteboard/link-to-any-page-or-block")]}),vb&&(0,Ri.jsx)(Vs,{style:{width:"calc(100% - 46px)",marginLeft:"46px"},placeholder:La("whiteboard/start-typing-to-search"),onChange:Wb}),0<ca.length&&(0,Ri.jsx)("div",{className:"flex flex-col items-stretch gap-2",
children:ca.map((uc,Sc)=>(0,Ri.jsx)(rl,{id:uc,type:rg(uc)?"B":"P",onRemove:()=>{Ga(ca.filter((kd,fd)=>Sc!==fd))},showContent:!0},uc))})]})]})}))}),yn=ea(581),is=window.LSUI,ni=ea(581),js="EditPdf LogseqPortalViewMode Geometry AutoResizing Swatch NoFill StrokeType ScaleLevel TextStyle YoutubeLink TwitterLink IFrameSource ArrowMode Links".split(" "),hj=["YoutubeLink","TwitterLink","IFrameSource","Links","EditPdf"],ij=new Map,lj={"logseq-portal":["Swatch","LogseqPortalViewMode","ScaleLevel","AutoResizing",
"Links"],youtube:["YoutubeLink","Links"],tweet:["TwitterLink","Links"],iframe:["IFrameSource","Links"],box:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),ellipse:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),polygon:"Geometry TextStyle Swatch ScaleLevel NoFill StrokeType Links".split(" "),line:["TextStyle","Swatch","ScaleLevel","ArrowMode","Links"],pencil:["Swatch","Links","ScaleLevel"],highlighter:["Swatch","Links","ScaleLevel"],text:["TextStyle",
"Swatch","ScaleLevel","AutoResizing","Links"],html:["ScaleLevel","AutoResizing","Links"],image:["Links"],video:["Links"],pdf:["EditPdf","Links"]},Co=Object.entries(lj).filter(([,c])=>c.includes("NoFill")&&c.includes("Swatch")).map(([c])=>c),ck=Ee(()=>{const c=Ve(),{handlers:{t:m}}=Sj.default.useContext(si),M=kk("AutoResizing"),ca=M.every(ua=>ua.props.isAutoResizing);return(0,ni.jsx)(Ng,{tooltip:m("whiteboard/auto-resize"),toggle:M.every(ua=>"logseq-portal"===ua.props.type),className:"tl-button",pressed:ca,
onPressedChange:ua=>{M.forEach(Ga=>{if("logseq-portal"===Ga.props.type)Ga.update({isAutoResizing:ua});else Ga.onResetBounds({zoom:c.viewport.camera.zoom})});c.persist()},children:(0,ni.jsx)(hh,{name:"dimensions"})})}),Zk=Ee(()=>{const c=Ve();var {handlers:{t:m}}=Sj.default.useContext(si);const M=kk("LogseqPortalViewMode"),ca=M.every(ua=>ua.collapsed);if(!ca&&!M.every(ua=>!ua.collapsed))return null;m=(0,ni.jsxs)("div",{className:"flex",children:[ca?m("whiteboard/expand"):m("whiteboard/collapse"),(0,ni.jsx)(Qj,
{action:ca?"editor/expand-block-children":"editor/collapse-block-children"})]});return(0,ni.jsx)(Ng,{tooltip:m,toggle:M.every(ua=>"logseq-portal"===ua.props.type),className:"tl-button",pressed:ca,onPressedChange:()=>c.api.setCollapsed(!ca),children:(0,ni.jsx)(hh,{name:ca?"object-expanded":"object-compact"})})}),ti=Ee(()=>{const {handlers:{isMobile:c}}=Sj.default.useContext(si);var m=kk("ScaleLevel");m=1<(new Set(m.map(M=>M.scaleLevel))).size?"":m[0].scaleLevel;return(0,ni.jsx)(Gl,{scaleLevel:m,compact:c()})}),
by=Ee(()=>{const c=Ve(),{handlers:{t:m}}=Sj.default.useContext(si),M=kk("IFrameSource")[0],ca=Sj.default.useCallback(Ga=>{M.onIFrameSourceChange(Ga.target.value.trim().toLowerCase());c.persist()},[]),ua=Sj.default.useCallback(()=>{M.reload()},[]);return(0,ni.jsxs)("span",{className:"flex gap-3",children:[(0,ni.jsx)(Zh,{tooltip:m("whiteboard/reload"),type:"button",onClick:ua,children:(0,ni.jsx)(hh,{name:"refresh"})}),(0,ni.jsx)(Yq,{title:m("whiteboard/website-url"),className:"tl-iframe-src",value:`${M.props.url}`,
onChange:ca}),(0,ni.jsx)(Zh,{tooltip:m("whiteboard/open-website-url"),type:"button",onClick:()=>window.open(M.props.url),children:(0,ni.jsx)(hh,{name:"external-link"})})]})}),ks=Ee(()=>{const c=Ve(),{handlers:{t:m}}=Sj.default.useContext(si),M=kk("YoutubeLink")[0],ca=Sj.default.useCallback(ua=>{M.onYoutubeLinkChange(ua.target.value);c.persist()},[]);return(0,ni.jsxs)("span",{className:"flex gap-3",children:[(0,ni.jsx)(Yq,{title:m("whiteboard/youtube-url"),className:"tl-youtube-link",value:`${M.props.url}`,
onChange:ca}),(0,ni.jsx)(Zh,{tooltip:m("whiteboard/open-youtube-url"),type:"button",onClick:()=>{var ua,Ga,La;return null==(La=null==(Ga=null==(ua=window.logseq)?void 0:ua.api)?void 0:Ga.open_external_link)?void 0:La.call(Ga,M.props.url)},children:(0,ni.jsx)(hh,{name:"external-link"})})]})}),ls=Ee(()=>{const c=Ve(),{handlers:{t:m}}=Sj.default.useContext(si),M=kk("TwitterLink")[0],ca=Sj.default.useCallback(ua=>{M.onTwitterLinkChange(ua.target.value);c.persist()},[]);return(0,ni.jsxs)("span",{className:"flex gap-3",
children:[(0,ni.jsx)(Yq,{title:m("whiteboard/twitter-url"),className:"tl-twitter-link",value:`${M.props.url}`,onChange:ca}),(0,ni.jsx)(Zh,{tooltip:m("whiteboard/open-twitter-url"),type:"button",onClick:()=>{var ua,Ga,La;return null==(La=null==(Ga=null==(ua=window.logseq)?void 0:ua.api)?void 0:Ga.open_external_link)?void 0:La.call(Ga,M.props.url)},children:(0,ni.jsx)(hh,{name:"external-link"})})]})}),ku=Ee(()=>{const c=Ve(),{handlers:{t:m,setCurrentPdf:M}}=Sj.default.useContext(si),ca=c.selectedShapesArray[0];
return(0,ni.jsx)(Zh,{tooltip:m("whiteboard/edit-pdf"),type:"button",onClick:()=>M(c.assets[ca.props.assetId].src),children:(0,ni.jsx)(hh,{name:"edit"})})}),cy=Ee(()=>{const c=Ve(),{handlers:{t:m}}=Sj.default.useContext(si);var M=kk("NoFill");const ca=Sj.default.useCallback(ua=>{c.selectedShapesArray.forEach(Ga=>Ga.update({noFill:ua}));c.persist()},[]);M=M.every(ua=>ua.props.noFill);return(0,ni.jsx)(Ng,{tooltip:m("whiteboard/fill"),className:"tl-button",pressed:M,onPressedChange:ca,children:(0,ni.jsx)(hh,
{name:M?"droplet-off":"droplet"})})}),lu=Ee(()=>{const c=Ve(),m=kk("Swatch"),M=Sj.default.useCallback(ua=>{c.selectedShapesArray.forEach(Ga=>{Ga.update({fill:ua,stroke:ua})});c.persist()},[]),ca=Sj.default.useCallback(ua=>{c.selectedShapesArray.forEach(Ga=>{Ga.update({opacity:ua})});c.persist()},[]);return(0,ni.jsx)(bj,{popoverSide:"top",color:m[0].props.noFill?m[0].props.stroke:m[0].props.fill,opacity:m[0].props.opacity,setOpacity:ca,setColor:M})}),ui=Ee(()=>{const c=Ve(),m=Sj.default.useCallback(M=>
{c.api.convertShapes(M.currentTarget.dataset.tool)},[]);return(0,ni.jsx)(ux,{popoverSide:"top",chevron:!1,setGeometry:m})}),mu=Ee(()=>{const c=Ve(),{handlers:{t:m}}=Sj.default.useContext(si),M=kk("StrokeType"),ca=M.every(ua=>"dashed"===ua.props.strokeType)?"dashed":M.every(ua=>"line"===ua.props.strokeType)?"line":"mixed";return(0,ni.jsx)(uk,{title:m("whiteboard/stroke-type"),options:[{value:"line",icon:"circle",tooltip:"Solid"},{value:"dashed",icon:"circle-dashed",tooltip:"Dashed"}],value:ca,onValueChange:ua=>
{M.forEach(Ga=>{Ga.update({strokeType:ua})});c.persist()}})}),nu=Ee(()=>{const c=Ve(),{handlers:{t:m}}=Sj.default.useContext(si),M=kk("ArrowMode");var ca=M.every(Ga=>{var La;return"arrow"===(null==(La=Ga.props.decorations)?void 0:La.start)});const ua=M.every(Ga=>{var La;return"arrow"===(null==(La=Ga.props.decorations)?void 0:La.end)});ca=[ca?"start":null,ua?"end":null].filter(Hc);return(0,ni.jsx)(ri,{title:m("whiteboard/arrow-head"),options:[{value:"start",icon:"arrow-narrow-left"},{value:"end",icon:"arrow-narrow-right"}],
value:ca,onValueChange:Ga=>{M.forEach(La=>{var fb=La.update;var vb={start:Ga.includes("start")?"arrow":null,end:Ga.includes("end")?"arrow":null};fb.call(La,{decorations:vb})});c.persist()}})}),ou=Ee(()=>{const c=Ve(),{handlers:{t:m}}=Sj.default.useContext(si),M=kk("TextStyle"),ca=M.every(Ga=>500<Ga.props.fontWeight),ua=M.every(Ga=>Ga.props.italic);return(0,ni.jsxs)("span",{className:"flex gap-1",children:[(0,ni.jsx)(Ng,{tooltip:m("whiteboard/bold"),className:"tl-button",pressed:ca,onPressedChange:Ga=>
{M.forEach(La=>{La.update({fontWeight:Ga?700:400});La.onResetBounds()});c.persist()},children:(0,ni.jsx)(hh,{name:"bold"})}),(0,ni.jsx)(Ng,{tooltip:m("whiteboard/italic"),className:"tl-button",pressed:ua,onPressedChange:Ga=>{M.forEach(La=>{La.update({italic:Ga});La.onResetBounds()});c.persist()},children:(0,ni.jsx)(hh,{name:"italic"})})]})}),Lp=Ee(()=>{var c;const m=Ve(),M=m.selectedShapesArray[0];return(0,ni.jsx)(fD,{onRefsChange:ca=>{M.update({refs:ca});m.persist()},refs:null!=(c=M.props.refs)?
c:[],shapeType:M.props.type,side:"right",pageId:"logseq-portal"===M.props.type?M.props.pageId:void 0,portalType:"logseq-portal"===M.props.type?M.props.blockType:void 0})});ij.set("Geometry",ui);ij.set("AutoResizing",ck);ij.set("LogseqPortalViewMode",Zk);ij.set("ScaleLevel",ti);ij.set("YoutubeLink",ks);ij.set("TwitterLink",ls);ij.set("IFrameSource",by);ij.set("NoFill",cy);ij.set("Swatch",lu);ij.set("StrokeType",mu);ij.set("ArrowMode",nu);ij.set("TextStyle",ou);ij.set("Links",Lp);ij.set("EditPdf",ku);
var pu=c=>{var m;return(null!=(m=lj[c])?m:[]).filter(Hc)},Do=c=>{const m=c.map(ca=>ca.props.type),M=new Set(0<c.length?pu(m[0]):[]);for(let ca=1;ca<m.length&&0<M.size;ca++){const ua=pu(m[ca]);M.forEach(Ga=>{ua.includes(Ga)||M.delete(Ga)})}1<c.length&&hj.forEach(ca=>{M.has(ca)&&M.delete(ca)});return Array.from(M).sort((ca,ua)=>js.indexOf(ca)-js.indexOf(ua)).map(ca=>ij.get(ca))},Zq=ea(581),ms=window.LSUI,ns=Ee(({shapes:c,offsets:m,hidden:M})=>{const ca=Ve(),ua=Oq.useRef(null),Ga=Oq.useRef(null);Oq.useLayoutEffect(()=>
{setTimeout(()=>{const fb=Ga.current;if(fb){var {offsetWidth:vb,offsetHeight:Wb}=fb;ua.current=[vb,Wb]}})});Oq.useLayoutEffect(()=>{var fb;const vb=Ga.current;if(vb){var Wb=null!=(fb=ua.current)?fb:[0,0];fb=0;if(116>m.top){var oc=m.height/2+40;140>m.bottom&&(oc+=m.bottom-140)}else oc=-(m.height/2+40);16>m.left+m.width/2-Wb[0]/2?fb+=-(m.left+m.width/2-Wb[0]/2-16):16>m.right+m.width/2-Wb[0]/2&&(fb+=m.right+m.width/2-Wb[0]/2-16);var [uc,Sc]=[fb,oc];vb.style.transform=`translateX(${uc}px) translateY(${Sc}px)`}},
[m]);if(!ca)return null;const La=Do(c);return(0,Zq.jsx)(Vk,{centered:!0,children:0<La.length&&(0,Zq.jsx)("div",{ref:Ga,className:"tl-toolbar tl-context-bar",style:{visibility:M?"hidden":"visible",pointerEvents:M?"none":"all"},children:La.map((fb,vb)=>(0,Zq.jsxs)(Oq.Fragment,{children:[(0,Zq.jsx)(fb,{}),vb<La.length-1&&(0,Zq.jsx)(ms.Separator,{orientation:"vertical"})]},vb))})})}),$q=Qf(ea(22)),Rf=ea(581),pi=window.LSUI,ar=Ee(function({children:c,collisionRef:m}){var M,ca,ua,Ga,La,fb,vb,Wb,oc,uc,Sc,
kd,fd,xd,Jd,$c,hd;const od=Ve(),{handlers:Kd}=$q.useContext(si),zd=Kd.t,Te=$q.useRef(null),We=of=>{of();od.transition("select")},eg=$q.useMemo(()=>dc(),[]);return(0,Rf.jsxs)(pi.ContextMenu,{onOpenChange:of=>{of&&!od.isIn("select.contextMenu")?od.transition("select").selectedTool.transition("contextMenu"):!of&&od.isIn("select.contextMenu")&&od.selectedTool.transition("idle")},children:[(0,Rf.jsx)(pi.ContextMenuTrigger,{disabled:od.editingShape&&0!==Object.keys(od.editingShape).length,children:c}),
(0,Rf.jsx)(pi.ContextMenuContent,{className:"tl-menu tl-context-menu",ref:Te,onEscapeKeyDown:()=>od.transition("select"),collisionBoundary:m.current,asChild:!0,tabIndex:-1,children:(0,Rf.jsxs)("div",{children:[1<(null==(M=od.selectedShapes)?void 0:M.size)&&!od.readOnly&&(null==(ca=od.selectedShapesArray)?void 0:ca.some(of=>!of.props.isLocked))&&(0,Rf.jsxs)(Rf.Fragment,{children:[(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-button-row-wrap",children:[(0,Rf.jsxs)("div",{className:"tl-menu-button-row pb-0",
children:[(0,Rf.jsx)(Zh,{tooltip:zd("whiteboard/align-left"),onClick:()=>We(()=>od.align("left")),children:(0,Rf.jsx)(hh,{name:"layout-align-left"})}),(0,Rf.jsx)(Zh,{tooltip:zd("whiteboard/align-center-horizontally"),onClick:()=>We(()=>od.align("centerHorizontal")),children:(0,Rf.jsx)(hh,{name:"layout-align-center"})}),(0,Rf.jsx)(Zh,{tooltip:zd("whiteboard/align-right"),onClick:()=>We(()=>od.align("right")),children:(0,Rf.jsx)(hh,{name:"layout-align-right"})}),(0,Rf.jsx)(pi.Separator,{className:"tl-toolbar-separator",
orientation:"vertical"}),(0,Rf.jsx)(Zh,{tooltip:zd("whiteboard/distribute-horizontally"),onClick:()=>We(()=>od.distribute("horizontal")),children:(0,Rf.jsx)(hh,{name:"layout-distribute-vertical"})})]}),(0,Rf.jsxs)("div",{className:"tl-menu-button-row pt-0",children:[(0,Rf.jsx)(Zh,{tooltip:zd("whiteboard/align-top"),onClick:()=>We(()=>od.align("top")),children:(0,Rf.jsx)(hh,{name:"layout-align-top"})}),(0,Rf.jsx)(Zh,{tooltip:zd("whiteboard/align-center-vertically"),onClick:()=>We(()=>od.align("centerVertical")),
children:(0,Rf.jsx)(hh,{name:"layout-align-middle"})}),(0,Rf.jsx)(Zh,{tooltip:zd("whiteboard/align-bottom"),onClick:()=>We(()=>od.align("bottom")),children:(0,Rf.jsx)(hh,{name:"layout-align-bottom"})}),(0,Rf.jsx)(pi.Separator,{className:"tl-toolbar-separator",orientation:"vertical"}),(0,Rf.jsx)(Zh,{tooltip:zd("whiteboard/distribute-vertically"),onClick:()=>We(()=>od.distribute("vertical")),children:(0,Rf.jsx)(hh,{name:"layout-distribute-horizontal"})})]})]}),(0,Rf.jsx)(pi.ContextMenuSeparator,{className:"menu-separator"}),
(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.packIntoRectangle),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"layout-grid"}),zd("whiteboard/pack-into-rectangle")]}),(0,Rf.jsx)(pi.ContextMenuSeparator,{className:"menu-separator"})]}),0<(null==(ua=od.selectedShapes)?void 0:ua.size)&&(0,Rf.jsxs)(Rf.Fragment,{children:[(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.api.zoomToSelection),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",
name:"circle-dotted"}),zd("whiteboard/zoom-to-fit"),(0,Rf.jsx)(Qj,{action:"whiteboard/zoom-to-fit"})]}),(0,Rf.jsx)(pi.ContextMenuSeparator,{className:"menu-separator"})]}),(od.selectedShapesArray.some(of=>"group"===of.type||od.getParentGroup(of))||1<od.selectedShapesArray.length)&&(null==(Ga=od.selectedShapesArray)?void 0:Ga.some(of=>!of.props.isLocked))&&!od.readOnly&&(0,Rf.jsxs)(Rf.Fragment,{children:[od.selectedShapesArray.some(of=>"group"===of.type||od.getParentGroup(of))&&(0,Rf.jsxs)(pi.ContextMenuItem,
{className:"tl-menu-item",onClick:()=>We(od.api.unGroup),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"ungroup"}),zd("whiteboard/ungroup"),(0,Rf.jsx)(Qj,{action:"whiteboard/ungroup"})]}),1<od.selectedShapesArray.length&&(null==(La=od.selectedShapesArray)?void 0:La.some(of=>!of.props.isLocked))&&(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.api.doGroup),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"group"}),zd("whiteboard/group"),(0,Rf.jsx)(Qj,{action:"whiteboard/group"})]}),
(0,Rf.jsx)(pi.ContextMenuSeparator,{className:"menu-separator"})]}),0<(null==(fb=od.selectedShapes)?void 0:fb.size)&&(null==(vb=od.selectedShapesArray)?void 0:vb.some(of=>!of.props.isLocked))&&(0,Rf.jsxs)(Rf.Fragment,{children:[!od.readOnly&&(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.cut),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"cut"}),zd("whiteboard/cut")]}),(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.copy),children:[(0,Rf.jsx)(hh,
{className:"tl-menu-icon",name:"copy"}),zd("whiteboard/copy"),(0,Rf.jsx)(Qj,{action:"editor/copy"})]})]}),!od.readOnly&&(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.paste),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"clipboard"}),zd("whiteboard/paste"),(0,Rf.jsx)(Qj,{shortcut:`${vw}+v`})]}),1===(null==(Wb=od.selectedShapes)?void 0:Wb.size)&&!od.readOnly&&(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(()=>od.paste(void 0,!0)),children:[(0,Rf.jsx)(hh,
{className:"tl-menu-icon",name:"circle-dotted"}),zd("whiteboard/paste-as-link"),(0,Rf.jsx)(Qj,{shortcut:`${vw}+\u21E7+v`})]}),0<(null==(oc=od.selectedShapes)?void 0:oc.size)&&(0,Rf.jsxs)(Rf.Fragment,{children:[(0,Rf.jsx)(pi.ContextMenuSeparator,{className:"menu-separator"}),(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(()=>{var of,Tf;return Kd.exportToImage(od.currentPageId,{x:od.selectionBounds.minX+od.viewport.camera.point[0]-8,y:od.selectionBounds.minY+od.viewport.camera.point[1]-
8,width:(null==(of=od.selectionBounds)?void 0:of.width)+16,height:(null==(Tf=od.selectionBounds)?void 0:Tf.height)+16,zoom:od.viewport.camera.zoom})}),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"file-export"}),zd("whiteboard/export"),(0,Rf.jsx)("div",{className:"tl-menu-right-slot",children:(0,Rf.jsx)("span",{className:"keyboard-shortcut"})})]})]}),(0,Rf.jsx)(pi.ContextMenuSeparator,{className:"menu-separator"}),(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.api.selectAll),
children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"circle-dotted"}),zd("whiteboard/select-all"),(0,Rf.jsx)(Qj,{action:"editor/select-parent"})]}),1<(null==(uc=od.selectedShapes)?void 0:uc.size)&&(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.api.deselectAll),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"circle-dotted"}),zd("whiteboard/deselect-all")]}),!od.readOnly&&0<(null==(Sc=od.selectedShapes)?void 0:Sc.size)&&(null==(kd=od.selectedShapesArray)?void 0:
kd.some(of=>!of.props.isLocked))&&(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(()=>od.setLocked(!0)),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"lock"}),zd("whiteboard/lock"),(0,Rf.jsx)(Qj,{action:"whiteboard/lock"})]}),!od.readOnly&&0<(null==(fd=od.selectedShapes)?void 0:fd.size)&&(null==(xd=od.selectedShapesArray)?void 0:xd.some(of=>of.props.isLocked))&&(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(()=>od.setLocked(!1)),children:[(0,Rf.jsx)(hh,
{className:"tl-menu-icon",name:"lock-open"}),zd("whiteboard/unlock"),(0,Rf.jsx)(Qj,{action:"whiteboard/unlock"})]}),0<(null==(Jd=od.selectedShapes)?void 0:Jd.size)&&!od.readOnly&&(null==($c=od.selectedShapesArray)?void 0:$c.some(of=>!of.props.isLocked))&&(0,Rf.jsxs)(Rf.Fragment,{children:[(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.api.deleteShapes),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"backspace"}),zd("whiteboard/delete"),(0,Rf.jsx)(Qj,{action:"editor/delete"})]}),
1<(null==(hd=od.selectedShapes)?void 0:hd.size)&&!od.readOnly&&(0,Rf.jsxs)(Rf.Fragment,{children:[(0,Rf.jsx)(pi.ContextMenuSeparator,{className:"menu-separator"}),(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.flipHorizontal),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"flip-horizontal"}),zd("whiteboard/flip-horizontally")]}),(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.flipVertical),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",
name:"flip-vertical"}),zd("whiteboard/flip-vertically")]})]}),!od.readOnly&&(0,Rf.jsxs)(Rf.Fragment,{children:[(0,Rf.jsx)(pi.ContextMenuSeparator,{className:"menu-separator"}),(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.bringToFront),children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"circle-dotted"}),zd("whiteboard/move-to-front"),(0,Rf.jsx)(Qj,{action:"whiteboard/bring-to-front"})]}),(0,Rf.jsxs)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>We(od.sendToBack),
children:[(0,Rf.jsx)(hh,{className:"tl-menu-icon",name:"circle-dotted"}),zd("whiteboard/move-to-back"),(0,Rf.jsx)(Qj,{action:"whiteboard/send-to-back"})]})]}),eg&&(0,Rf.jsx)(pi.ContextMenuItem,{className:"tl-menu-item",onClick:()=>{1===od.selectedShapesArray.length?console.log(Ab(od.selectedShapesArray[0].serialized)):console.log(od.selectedShapesArray.map(of=>Ab(of.serialized)))},children:zd("whiteboard/dev-print-shape-props")})]})]})})]})}),qu=Qf(ea(22)),os=ea(581),gD=Ee(({shape:c})=>{const m=Ve();
var {handlers:M}=qu.default.useContext(si);M=M.t;const ca=qu.default.useMemo(()=>{var ua;const Ga=[...(null!=(ua=c.props.refs)?ua:[])].map(La=>[La,!0]);"logseq-portal"===c.props.type&&c.props.pageId&&Ga.unshift([c.props.pageId,!1]);return Ga.filter(La=>La[0].toLowerCase()!==m.currentPage.id&&La[0]!==c.props.pageId)},[c.props.id,c.props.type,c.props.parentId,c.props.refs]);return 0===ca.length?null:(0,os.jsx)("div",{className:"tl-quick-links",title:M("whiteboard/shape-quick-links"),children:ca.map(([ua,
Ga])=>(0,os.jsx)("div",{className:"tl-quick-links-row",children:(0,os.jsx)(yx,{id:ua,showReferenceContent:Ga})},ua))})}),Mp=Qf(ea(22)),Np=Qf(ea(22)),ps={image:[".png",".svg",".jpg",".jpeg",".gif"],video:[".mp4",".webm",".ogg"],pdf:[".pdf"]},qs=(c,m,M)=>Wh(void 0,[c,m,M],function*(ca,{point:ua,shiftKey:Ga,dataTransfer:La,fromDrop:fb},vb){function Wb(Ef,Yf){return Wh(this,null,function*(){const dh=Object.values(ca.assets).find(Fh=>Fh.src===Ef);return dh?dh:{id:Re(),type:Yf,src:Ef,size:yield ai(vb.makeAssetUrl(Ef),
Yf)}})}function oc(Ef){return Wh(this,null,function*(){const Yf=Ef.filter(dh=>"unknown"!==wq(dh.name)).map(dh=>Wh(this,null,function*(){try{const Fh=yield vb.saveAsset(dh);return yield Wb(Fh,wq(dh.name))}catch(Fh){console.error(Fh)}return null}));return(yield Promise.all(Yf)).filter(Hc)})}function uc(Ef){return[ng(Gf({},wn.defaultProps),{html:Ef,point:[ua[0],ua[1]]})]}function Sc(Ef){return Wh(this,null,function*(){return Sk(fd,xd,hd,$c,od,Jd,eg)(Ef)})}function kd(){return Wh(this,null,function*(){const Ef=
yield navigator.clipboard.read(),Yf=Sk(od,Jd,eg);return(yield Promise.all(Ef.map(dh=>Yf(dh)))).flat().filter(Hc)})}function fd(Ef){return Wh(this,null,function*(){var Yf=Ef.getData("file");if(!Yf)return null;const dh=yield Wb(Yf,"pdf");ca.addAssets([dh]);Yf=ng(Gf({},Wq.defaultProps),{id:Re(),assetId:dh.id,url:Yf,opacity:1});dh.size&&Object.assign(Yf,{point:[ua[0]-dh.size[0]/4+16,ua[1]-dh.size[1]/4+16],size:ne.div(dh.size,2)});return[Yf]})}function xd(Ef){return Wh(this,null,function*(){var Yf=Array.from(Ef.files);
return 0<Yf.length?(Jg=Yf=yield oc(Yf),Yf.map((dh,Fh)=>{switch(dh.type){case "video":var Pi=hs.defaultProps;break;case "image":Pi=es.defaultProps;break;case "pdf":Pi=Wq.defaultProps;break;default:return null}Pi=ng(Gf({},Pi),{id:Re(),assetId:dh.id,opacity:1});dh.size&&Object.assign(Pi,{point:[ua[0]-dh.size[0]/4+16*Fh,ua[1]-dh.size[1]/4+16*Fh],size:ne.div(dh.size,2)});return Pi})):null})}function Jd(Ef){return Wh(this,null,function*(){if(Ef.types.includes("text/plain")&&(Ga||fb))return null;const Yf=
yield Bm(Ef,"text/html");return Yf?Sk(Kd,uc)(Yf):null})}function $c(Ef){return Wh(this,null,function*(){var Yf,dh,Fh,Pi,fi,Wg,Gi=Ef.getData("block-uuid");if(Gi){Gi=Gi.trim();const Ji=null==(Fh=null==(dh=null==(Yf=window.logseq)?void 0:Yf.api)?void 0:dh.get_selected_blocks)?void 0:Fh.call(dh);Yf=Ji&&1<(null==Ji?void 0:Ji.length)?Ji.map(Wi=>Wi.uuid):[Gi];null==(Wg=null==(fi=null==(Pi=window.logseq)?void 0:Pi.api)?void 0:fi.set_blocks_id)?void 0:Wg.call(fi,Yf);Pi=Yf.map(Wi=>We(`((${Wi}))`));return(yield Promise.all(Pi)).flat().filter(Hc).map((Wi,
Hk)=>ng(Gf({},Wi),{point:[ua[0]+(Aj.defaultProps.size[0]+16)*Hk,ua[1]]}))}return null})}function hd(Ef){return Wh(this,null,function*(){var Yf=Ef.getData("page-name");return Yf?(Yf=Yf.trim(),We(`[[${Yf}]]`)):null})}function od(Ef){return Wh(this,null,function*(){var Yf=yield Bm(Ef,"text/plain");return Yf?(Yf=Yf.trim(),Sk(zd,Te)(Yf)):null})}function Kd(Ef){if(Ef=ca.api.getClonedShapesFromTldrString(decodeURIComponent(Ef),ua)){const {shapes:Yf,assets:dh,bindings:Fh}=Ef;bh.push(...dh);Eg.push(...Fh);
return Yf}return null}function zd(Ef){return Wh(this,null,function*(){try{const dh=new URL(Ef);var Yf=dh.host&&["http:","https:"].includes(dh.protocol)}catch(dh){Yf=!1}return Yf&&!Ga?Wx.test(Ef)?[ng(Gf({},Bo.defaultProps),{url:Ef,point:[ua[0],ua[1]]})]:Yx.test(Ef)?[ng(Gf({},Kp.defaultProps),{url:Ef,point:[ua[0],ua[1]]})]:[ng(Gf({},zo.defaultProps),{url:Ef,point:[ua[0],ua[1]]})]:null})}function Te(Ef){return Ef.startsWith("\x3ciframe")?[ng(Gf({},wn.defaultProps),{html:Ef,point:[ua[0],ua[1]]})]:null}
function We(Ef){return Wh(this,null,function*(){if(/^\(\(.*\)\)$/.test(Ef)&&40===Ef.length){var Yf=Ef.slice(2,-2);if(rg(Yf))return[ng(Gf({},Aj.defaultProps),{point:[ua[0],ua[1]],size:[400,0],pageId:Yf,fill:ca.settings.color,stroke:ca.settings.color,scaleLevel:ca.settings.scaleLevel,blockType:"B"})]}else if(/^\[\[.*\]\]$/.test(Ef))return Yf=Ef.slice(2,-2),[ng(Gf({},Aj.defaultProps),{point:[ua[0],ua[1]],size:[400,0],pageId:Yf,fill:ca.settings.color,stroke:ca.settings.color,scaleLevel:ca.settings.scaleLevel,
blockType:"P"})];return null})}function eg(Ef){return Wh(this,null,function*(){var Yf=yield Bm(Ef,"text/plain");return Yf&&(Yf=Yf.trim(),Yf=yield null==vb?void 0:vb.addNewBlock(Yf))?[ng(Gf({},Aj.defaultProps),{size:[400,0],point:[ua[0],ua[1]],pageId:Yf,fill:ca.settings.color,stroke:ca.settings.color,scaleLevel:ca.settings.scaleLevel,blockType:"B",compact:!0})]:null})}var of,Tf;let Jg=[],bh=[];const Eg=[];ca.cursors.setCursor("progress");let ch=[];try{La?ch.push(...(null!=(of=yield Sc(La))?of:[])):
ch.push(...(null!=(Tf=yield kd())?Tf:[]))}catch(Ef){console.error(Ef)}const Bf=ch.map(Ef=>ng(Gf({},Ef),{parentId:ca.currentPageId,isLocked:!1,id:rg(Ef.id)?Ef.id:Re()})),If=null==La?void 0:La.types.every(Ef=>"Files"===Ef);ca.wrapUpdate(()=>{var Ef=[...Jg,...bh];0<Ef.length&&ca.createAssets(Ef);0<Bf.length&&ca.createShapes(Bf);ca.currentPage.updateBindings(Object.fromEntries(Eg.map(Yf=>[Yf.id,Yf])));if(1===ca.selectedShapesArray.length&&1===Bf.length&&fb){Ef=ca.selectedShapesArray[0];const Yf=ca.getShapeById(Bf[0].id);
ca.createNewLineBinding(Ef,Yf)}ca.setSelectedShapes(Bf.map(Yf=>Yf.id));ca.selectedTool.transition("idle");ca.cursors.setCursor("default");(fb||If)&&ca.packIntoRectangle()})}),ru=Qf(ea(22)),rs=Qf(ea(22)),Jm=ea(581),su=[du,eu,ay,fu,gu,Yk,hu,iu,ju,jv,iv,Pn],hD=c=>{const {renderers:m}=vp.useContext(si);return(0,Jm.jsx)(m.BacklinksCount,ng(Gf({},c),{options:{"portal?":!1}}))},dy=()=>{const c=vp.useRef(null),m=Ve(),M=vp.useMemo(()=>({ContextBar:ns,BacklinksCount:hD,QuickLinks:gD}),[]);return(0,Jm.jsx)(ar,
{collisionRef:c,children:(0,Jm.jsx)("div",{ref:c,className:"logseq-tldraw logseq-tldraw-wrapper","data-tlapp":m.uuid,children:(0,Jm.jsx)(nB,{components:M,children:(0,Jm.jsx)(GB,{})})})})},iD=c=>{var {onPersist:m,readOnly:M,model:ca}=c;c=Ti(c,["onPersist","readOnly","model"]);const ua=lk(),Ga=vr(),La=wr(),fb=M?null:xr(),vb=vp.useCallback((Wb,oc)=>{null==m?void 0:m(Wb,oc)},[ca]);return(0,Jm.jsx)(jB,ng(Gf({Shapes:$x,Tools:su,onDrop:ua,onPaste:Ga,onCopy:La,readOnly:M,onCanvasDBClick:fb,onPersist:vb,model:ca},
c),{children:(0,Jm.jsx)(dy,{})}))},br=function(c){var {renderers:m,handlers:M}=c;c=Ti(c,["renderers","handlers"]);const ca={renderers:vp.useMemo(()=>Object.fromEntries(Object.entries(m).map(([ua,Ga])=>[ua,vp.memo(Ga)])),[]),handlers:M};return(0,Jm.jsx)(si.Provider,{value:ca,children:(0,Jm.jsx)(iD,Gf({},c))})}};
'use strict';var Cie=function(a,b){var c=$APP.eL.A(a),d=c?$APP.UOa:$APP.$Ma;a=$APP.yL.A(b);return $APP.gn.C(function(e){var f=$APP.Te(e);e=$APP.H.C(f,$APP.gu);f=c?$APP.H.C(f,d):$APP.H.C($APP.Eu.A(f),d);return $APP.m(f)?new $APP.l(null,2,[$APP.Nq,$APP.r.A(e),$APP.Upd,$APP.Upd.A(f)],null):null},$APP.nLa.A(a))},Die=function(a){return $APP.to.G(a,$APP.G([$APP.uo,!0]))},Eie=function(a,b,c,d){c=new $APP.l(null,5,[$APP.Nq,$APP.xa(c,"id"),$APP.sl,$APP.xa(c,"name"),$APP.Fw,Die($APP.xa(c,"bindings")),$APP.Upd,
$APP.xa(c,"nonce"),$APP.Wpc,Die(d)],null);d=$APP.Bo.I?$APP.Bo.I():$APP.Bo.call(null);var e=$APP.bu.A(a);e=$APP.m(e)?e:$APP.Bo.I?$APP.Bo.I():$APP.Bo.call(null);return $APP.mg([$APP.au,$APP.bu,$APP.veb,$APP.Ov,$APP.hu,$APP.Et,$APP.Vk,$APP.Ot,$APP.ju],[d,e,c,$APP.j4a,$APP.et,b,$APP.Vk.A(a),"whiteboard",$APP.vo.A?$APP.vo.A(b):$APP.vo.call(null,b)])},Fie=function(a,b,c,d){var e=$APP.vo.A?$APP.vo.A(b):$APP.vo.call(null,b);c=$APP.Qe([$APP.ZL($APP.Ov),$APP.j4a,$APP.ZL($APP.veb),new $APP.l(null,5,[$APP.Nq,
$APP.xa(c,"id"),$APP.sl,$APP.xa(c,"name"),$APP.Fw,Die($APP.xa(c,"bindings")),$APP.Upd,$APP.xa(c,"nonce"),$APP.Wpc,Die(d)],null)]);d=$APP.Bo.I?$APP.Bo.I():$APP.Bo.call(null);a=$APP.bu.A(a);a=$APP.m(a)?a:$APP.Bo.I?$APP.Bo.I():$APP.Bo.call(null);return new $APP.l(null,6,[$APP.Et,b,$APP.ju,e,$APP.Ot,"whiteboard",$APP.Eu,c,$APP.au,d,$APP.bu,a],null)},Gie=function(a,b,c,d){var e=$APP.eL.A($APP.EJ())?Eie:Fie;return e.K?e.K(a,b,c,d):e.call(null,a,b,c,d)},Hie=function(a,b,c,d,e,f){var g=$APP.NL.A?$APP.NL.A(e):
$APP.NL.call(null,e);a=Die(a.getCleanUpAssets());var h=$APP.Cg($APP.Zg.C(function(y){y=$APP.Te(y);y=$APP.H.C(y,$APP.Nq);return Die(b.getShapeById(y).serialized)},$APP.uj.C(c,d)));d=$APP.Cg($APP.Zg.C($APP.Nq,d));var n=$APP.Cg($APP.Zg.C($APP.Nq,c)),p=$APP.Cg($APP.nj.C($APP.di,$APP.uj.C(n,d)));c=$APP.z(p)?function(){var y=$APP.Ac($APP.Hh.A($APP.Zg.C($APP.iu,$APP.nLa.A(g))));return $APP.HJa($APP.qc(p),y,null)}():null;var q=$APP.z(p)?$APP.Fg(p,c):null;c=$APP.Cg($APP.yf.C(function(y){y=$APP.Nq.A(y);return p.A?
p.A(y):p.call(null,y)},h));var t=$APP.nj.C($APP.di,$APP.uj.C(d,n)),v=$APP.EJ();d=$APP.z(t)?$APP.nj.C($APP.eb,$APP.Ik.C(function(y){return $APP.YL(y,$APP.UOa)},function(){var y=new $APP.N(null,1,5,$APP.S,[$APP.Jl],null),C=$APP.Ik.C(function(F){return new $APP.N(null,2,5,$APP.S,[$APP.gu,$APP.vh(F)],null)},t);return $APP.vL?$APP.vL(v,y,C):$APP.aPb.call(null,v,y,C)}())):null;n=$APP.Ik.C(function(y){return new $APP.N(null,2,5,$APP.S,[$APP.zu,new $APP.N(null,2,5,$APP.S,[$APP.gu,$APP.vh(y)],null)],null)},
t);h=$APP.Zg.C(function(y){var C=$APP.m(q)?$APP.H.C(q,$APP.r.A($APP.gu.A(y))):null;return $APP.m(C)?$APP.U.F(y,$APP.iu,C):y},$APP.Zg.C($APP.cu,$APP.Zg.C(function(y){var C=$APP.Vk.A(g),F=$APP.EJ();return $APP.VOa(F,y,C)},h)));var w=function(){var y=$APP.Et.A(g);return $APP.m(y)?y:$APP.r.A(e)}();a=Gie(g,w,b,a);return $APP.z(h)||$APP.z(n)||$APP.vg.C($APP.Eu.A(a),$APP.Eu.A(g))?new $APP.l(null,6,[$APP.kjc,a,$APP.Gyd,h,$APP.nA,n,$APP.uEd,d,$APP.X1c,c,$APP.az,new $APP.l(null,2,[$APP.K7a,!0,$APP.O7a,f],null)],
null):null},Iie=function(a){return $APP.vh(a.id)},Jie=function(a,b){var c=$APP.Bw.A(b),d=$APP.Zpc.A(b);d=$APP.Ik.C(Iie,d);switch(c){case "sendToBack":c=function(){var f=Iie($APP.iH.A(b));if($APP.m(f)){var g=$APP.iu.A;f=new $APP.N(null,2,5,$APP.S,[$APP.gu,f],null);f=$APP.yL.A?$APP.yL.A(f):$APP.yL.call(null,f);g=g.call($APP.iu,f)}else g=null;return g}();var e=$APP.HJa($APP.qc(d),null,c);return a=$APP.le.C($APP.jo.C(function(f,g){return new $APP.l(null,2,[$APP.gu,g,$APP.iu,$APP.D.C(e,f)],null)},d),$APP.Yv(new $APP.l(null,
1,[$APP.Vk,$APP.Vk.A(a)],null)));case "bringToFront":return c=function(){var f=Iie($APP.hL.A(b));if($APP.m(f)){var g=$APP.iu.A;f=new $APP.N(null,2,5,$APP.S,[$APP.gu,f],null);f=$APP.yL.A?$APP.yL.A(f):$APP.yL.call(null,f);g=g.call($APP.iu,f)}else g=null;return g}(),e=$APP.HJa($APP.qc(d),c,null),a=$APP.le.C($APP.nj.C($APP.eb,$APP.jo.C(function(f,g){var h=new $APP.N(null,2,5,$APP.S,[$APP.gu,g],null);h=$APP.yL.A?$APP.yL.A(h):$APP.yL.call(null,h);return $APP.m(h)?new $APP.l(null,2,[$APP.gu,g,$APP.iu,$APP.D.C(e,
f)],null):null},d)),$APP.Yv(new $APP.l(null,1,[$APP.Vk,$APP.Vk.A(a)],null)));default:throw Error(["No matching clause: ",$APP.r.A(c)].join(""));}},Kie=function(a,b,c){c=$APP.hj(c);var d=$APP.gXb.A(c),e=$APP.uc($APP.A(b.pages)),f=$APP.NL(a),g=$APP.yd(new $APP.xg(null,new $APP.l(null,2,["sendToBack",null,"bringToFront",null],null),null),$APP.Bw.A(c))?Jie(f,c):null;c=$APP.Cg($APP.jo.C(function(v,w){v=w.id;w=w.nonce;w=$APP.m(w)?w:Date.now();return new $APP.l(null,2,[$APP.Nq,v,$APP.Upd,w],null)},e.shapes));
var h=$APP.EJ(),n=function(){var v=$APP.Vm.C($APP.u($APP.Z_d),new $APP.N(null,2,5,$APP.S,[h,a],null));return $APP.m(v)?v:$APP.Cg($APP.Zg.C(function(w){return $APP.ok.F(w,$APP.Nq,$APP.r)},Cie(h,$APP.Vk.A(f))))}();b=Hie(b,e,c,n,a,d);e=$APP.Te(b);n=$APP.H.C(e,$APP.kjc);b=$APP.H.C(e,$APP.X1c);var p=$APP.H.C(e,$APP.uEd),q=$APP.H.C(e,$APP.Gyd),t=$APP.H.C(e,$APP.nA);d=$APP.H.C(e,$APP.az);if($APP.z(e)||$APP.z(g)){g=$APP.Wk.G(t,new $APP.N(null,1,5,$APP.S,[n],null),$APP.G([q,g]));b=$APP.m($APP.bf(function(v){return $APP.B.C("group",
$APP.xi.A(v))},b))?$APP.U.F(d,$APP.cB,$APP.EA):$APP.m(function(){var v=$APP.Ue(p);return $APP.m(v)?$APP.af(function(w){return $APP.B.C("group",$APP.xi.A(w))},p):v}())?$APP.U.F(d,$APP.cB,$APP.sjd):$APP.m($APP.bf(function(v){return $APP.B.C("line",$APP.xi.A(v))&&$APP.B.C("arrow ",$APP.rC.A($APP.dhd.A(v)))},b))?$APP.U.F(d,$APP.cB,$APP.Bud):$APP.U.F(d,$APP.cB,$APP.gbd);$APP.lh.K($APP.Z_d,$APP.Rk,new $APP.N(null,2,5,$APP.S,[h,a],null),c);if($APP.yd(new $APP.xg(null,new $APP.l(null,1,[$APP.Bud,null],null),
null),$APP.cB.A(b)))return $APP.GJ($APP.GMd,new $APP.l(null,2,[$APP.Tk,g,$APP.az,b],null));c=$APP.GMd.A($APP.u($APP.CJ));g=$APP.Wk.C($APP.Tk.A(c),g);c=$APP.Vi.G($APP.G([b,$APP.az.A(c)]));$APP.GJ($APP.GMd,$APP.Se);return $APP.SL(h,g,c)}return null},Lie=function(a,b){var c=$APP.eL.A($APP.EJ()),d=new $APP.l(null,6,[$APP.Nq,$APP.r.A(b),$APP.sl,a,$APP.dNa,$APP.j4a,$APP.Fw,$APP.Se,$APP.Upd,1,$APP.Wpc,$APP.Bf],null);d=$APP.Qe([$APP.ZL($APP.Ov),$APP.j4a,$APP.ZL($APP.veb),d]);a=new $APP.l(null,7,[$APP.gu,
b,$APP.ju,$APP.vo.A?$APP.vo.A(a):$APP.vo.call(null,a),$APP.Et,a,$APP.Ot,"whiteboard",$APP.hu,$APP.et,$APP.au,$APP.Bo.I?$APP.Bo.I():$APP.Bo.call(null),$APP.bu,$APP.Bo.I?$APP.Bo.I():$APP.Bo.call(null)],null);c=c?$APP.Vi.G($APP.G([a,d])):$APP.U.F(a,$APP.Eu,d);return new $APP.N(null,1,5,$APP.S,[c],null)},Mie=function(a){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(function(){var b=$APP.m(a)?$APP.Rh(a):a;return $APP.m(b)?b:$APP.Aj?$APP.Aj():$APP.Bj.call(null)}()),function(b){return $APP.Y($APP.V($APP.m(a)?
a:$APP.r.A(b)),function(c){return $APP.Y($APP.V($APP.SL($APP.EJ(),Lie(c,b),new $APP.l(null,1,[$APP.cB,$APP.X1a],null))),function(){return $APP.V(b)})})})})},Nie=function(a,b){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.EJ()),function(c){return $APP.Y($APP.V($APP.eE.I?$APP.eE.I():$APP.eE.call(null)),function(d){return $APP.Y($APP.V($APP.NL(a)),function(e){return $APP.Y($APP.V($APP.cu(new $APP.l(null,5,[$APP.gu,d,$APP.Et,$APP.m(b)?b:"",$APP.hu,$APP.et,$APP.Nu,$APP.Vk.A(e),$APP.Hu,
$APP.Vk.A(e)],null))),function(f){return $APP.Y($APP.V($APP.SL(c,new $APP.N(null,1,5,$APP.S,[f],null),new $APP.l(null,2,[$APP.cB,$APP.YC,$APP.K7a,!0],null))),function(){return $APP.V(d)})})})})})})},Oie=function(){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(fetch("./whiteboard/onboarding.edn")),function(a){return $APP.Y($APP.V(a.text()),function(b){return $APP.Y($APP.V($APP.kpb(b)),function(c){return $APP.V(c)})})})})},Pie=function(a,b){var c=$APP.Te(a);a=$APP.H.C(c,$APP.Uu);c=$APP.H.C(c,
$APP.QB);var d=$APP.A(a);a=$APP.Vpc(c);d=$APP.YL(d,$APP.veb);c=$APP.Wpc.A(d);d=$APP.Fw.A(d);return b.cloneShapesIntoCurrentPage($APP.ij(new $APP.l(null,3,[$APP.Zpc,a,$APP.Wpc,c,$APP.Fw,d],null)))},Qie=function(a){var b=$APP.DQb();return($APP.Nc(b)||$APP.B.C(1,$APP.qc(b))&&$APP.B.C($APP.r.A(a),$APP.r.A($APP.gu.A($APP.A(b)))))&&$APP.ib($APP.Vm.C($APP.u($APP.CJ),new $APP.N(null,1,5,$APP.S,[$APP.TMb],null)))},Rie=function(a){var b=$APP.vK();$APP.m(b)&&$APP.ff.C(b.api.updateShapes,$APP.jj(a))},Sie=function(a){var b=
$APP.vK();if($APP.m(b)&&(b=$APP.uc($APP.A(b.pages)),$APP.m(b))){var c=$APP.NL.A?$APP.NL.A(a):$APP.NL.call(null,a);if($APP.m(c)){a=$APP.Zg;var d=a.C,e=$APP.Yk.C($APP.r,$APP.gu);c=$APP.nLa.A(c);c=$APP.Mu.A?$APP.Mu.A(c):$APP.Mu.call(null,c);a=d.call(a,e,c);$APP.z(a)&&b.updateShapesIndex($APP.jj(a))}}},Tie=function(a){return null!=a?$APP.Dn($APP.Y($APP.V(null),function(){return $APP.Y($APP.V(Oie()),function(b){return $APP.Y($APP.V(Pie(b,a)),function(){return $APP.V($APP.VMb())})})}),function(b){return console.warn("Failed to populate onboarding whiteboard",
b)}):null},Uie=function(a){a.cleanup($APP.Zg.C(function(b){return b.id},a.shapes))},Vie=function(a,b){b=$APP.to.G(b,$APP.G([new $APP.l(null,1,[$APP.uo,!0],null)]));b=$APP.Te(b);var c=$APP.H.C(b,$APP.tP),d=$APP.EJ();return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.m(c)?$APP.A6b(d,a,new $APP.l(null,1,[$APP.rl,100],null)):null),function(e){return $APP.Y($APP.V($APP.Zg.C(function(f){return $APP.ok.F($APP.ok.F(f,$APP.gu,$APP.r),$APP.Et,function(g){return $APP.ff.C($APP.r,$APP.xOb(g))})},
e)),function(f){return $APP.V($APP.ij(new $APP.l(null,1,[$APP.QB,f],null)))})})})},Wie=function(a){return $APP.An.C($APP.ffc($APP.EJ(),new $APP.N(null,1,5,$APP.S,[$APP.to.A(a)],null)),function(b){var c=(c=$APP.z(b))?$APP.A(b):c;return $APP.m(c)?(b=$APP.D.F(c,0,null),$APP.D.F(c,1,null),c=$APP.D.F(c,2,null),$APP.ifc($APP.m(c)?c:b)):null})},Xie=function(){return $APP.U_d.A?$APP.U_d.A(null):$APP.U_d.call(null,null)},Yie=function(){return $APP.W_d.A?$APP.W_d.A(null):$APP.W_d.call(null,null)},pje=function(a){return $APP.mg([Zie,
$ie,aje,bje,cje,dje,eje,fje,gje,$APP.JC,hje,ije,jje,kje,$APP.Rx,lje,mje,nje,oje],[function(b){return $APP.m($APP.zo.A?$APP.zo.A(b):$APP.zo.call(null,b))?$APP.r.A($APP.gu.A($APP.dQb($APP.EJ(),$APP.Rh(b)))):$APP.r.A($APP.gu.A($APP.NL.A?$APP.NL.A(b):$APP.NL.call(null,b)))},function(b){return $APP.ij($APP.vyc(b))},function(b){return $APP.lQb(b)},function(b){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(function(){var c=new $APP.l(null,1,[$APP.jQ,!1],null);return $APP.hQ?$APP.hQ(b,c):$APP.iQ.call(null,
b,c)}()),function(c){return $APP.V($APP.r.A($APP.gu.A(c)))})})},function(b){return $APP.dNb($APP.m(b)?$APP.vyc(b):null)},function(b){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(Mie(b)),function(c){return $APP.V($APP.r.A(c))})})},$APP.WH,function(b){return $APP.hec(b)},function(b){b=$APP.NL.A?$APP.NL.A(b):$APP.NL.call(null,b);return $APP.m(b)?$APP.QL(b):null},Vie,Wie,$APP.u2b,function(b,c){return $APP.azb(b,$APP.G([$APP.oz,c]))},function(b){return $APP.Y($APP.V(null),function(){return $APP.Y($APP.V(Nie(a,
b)),function(c){return $APP.V($APP.r.A(c))})})},function(b){return $APP.EM.G($APP.G([$APP.$g.A(b)]))},function(b,c){function d(){return(0,$APP.dLc)($APP.vh(b),$APP.Vi.G($APP.G([$APP.to.G(c,$APP.G([$APP.uo,!0])),new $APP.l(null,1,[$APP.$y,!0],null)])))}return $APP.mJ.A?$APP.mJ.A(d):$APP.mJ.call(null,d)},function(b,c){return $APP.yK($APP.EJ(),$APP.Vk.A($APP.NL(b)),$APP.$g.A(c))},function(b){return $APP.m(b)?$APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.Rh(b)),function(c){return $APP.Y($APP.V($APP.m(c)?
$APP.xO($APP.EJ(),c):null),function(){return $APP.Y($APP.V(function(){var d=$APP.m(c)?$APP.dQb($APP.EJ(),c):null;return $APP.m(d)?d:$APP.NL.A?$APP.NL.A(b):$APP.NL.call(null,b)}()),function(d){return $APP.Y($APP.V($APP.QL(d)),function(e){return $APP.V($APP.Y($APP.V(null),function(){return $APP.Y($APP.V(null==d?function(){var f=new $APP.l(null,1,[$APP.jQ,!1],null);return $APP.hQ?$APP.hQ(b,f):$APP.iQ.call(null,b,f)}():null),function(f){return $APP.Y($APP.V($APP.m(f)?f:d),function(g){return $APP.V($APP.kQ.C($APP.m(e)?
$APP.gu.A(g):$APP.lQb($APP.gu.A(g)),$APP.m($APP.m(c)?$APP.vg.C(c,$APP.gu.A(g)):c)?new $APP.l(null,1,[$APP.KO,c],null):null))})})}))})})})})}):null},function(b){return $APP.ij($APP.APb(b))}])},rje=function(a,b,c){return $APP.Dn($APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.u(qje)),function(){return $APP.Y($APP.V($APP.Y($APP.V(null),function(){return $APP.Y($APP.V($APP.GJ(new $APP.N(null,2,5,$APP.S,[$APP.MCd,$APP.EJ()],null),$APP.Bo.I?$APP.Bo.I():$APP.Bo.call(null))),function(){return $APP.V(Kie(a,
b,c))})})),function(d){return $APP.V($APP.kf(qje,d))})})}),function(d){console.error(d);return $APP.tE.A(new $APP.N(null,2,5,$APP.S,[$APP.cC,["Save whiteboard failed, error:",$APP.r.A(d.cause)].join("")],null))})},bje=new $APP.M(null,"addNewPage","addNewPage",1998524678),oje=new $APP.M(null,"queryBlockByUUID","queryBlockByUUID",2091812895),lje=new $APP.M(null,"exportToImage","exportToImage",-154356643),kje=new $APP.M(null,"addNewBlock","addNewBlock",1426762680),sje=new $APP.M(null,"KeyboardShortcut",
"KeyboardShortcut",1250004264),Zie=new $APP.M(null,"getBlockPageName","getBlockPageName",-1656908032),tje=new $APP.M(null,"renderers","renderers",-1460292282),uje=new $APP.M(null,"model","model",331153215),aje=new $APP.M(null,"getRedirectPageName","getRedirectPageName",-1858136925),eje=new $APP.M(null,"isMobile","isMobile",-2043133877),cje=new $APP.M(null,"setCurrentPdf","setCurrentPdf",-63289336),vje=new $APP.M(null,"onMount","onMount",-876858467),fje=new $APP.M(null,"insertFirstPageBlock","insertFirstPageBlock",
-1676658548),ije=new $APP.M(null,"makeAssetUrl","makeAssetUrl",217779988),wje=new $APP.M(null,"onPersist","onPersist",-1848738852),xje=new $APP.M(null,"Breadcrumb","Breadcrumb",-1351298906),jje=new $APP.M(null,"copyToClipboard","copyToClipboard",1092115063),nje=new $APP.M(null,"redirectToPage","redirectToPage",87147838),dje=new $APP.M(null,"addNewWhiteboard","addNewWhiteboard",554297706),hje=new $APP.M(null,"saveAsset","saveAsset",-668047853),yje=new $APP.M(null,"BacklinksCount","BacklinksCount",
364670631),zje=new $APP.M(null,"Block","Block",-1959785792),mje=new $APP.M(null,"sidebarAddBlock","sidebarAddBlock",-1204903203),Aje=new $APP.M(null,"Page","Page",-1267059506),Bje=new $APP.M(null,"PageName","PageName",-164991013),Cje=new $APP.M(null,"Tweet","Tweet",-452258680),gje=new $APP.M(null,"isWhiteboardPage","isWhiteboardPage",-134150579),Dje=new $APP.M(null,"BlockReference","BlockReference",-120254741),$ie=new $APP.M(null,"inflateAsset","inflateAsset",-1449040639);$APP.Zib("tldraw");var Eje=$APP.bj(585);var Fje,Gje,qje,Hje,Ije;$APP.x8d={};Fje=$APP.UI($APP.xa(Eje,"App"));$APP.A8d=$APP.xa(Eje,"generateJSXFromModel");
Gje=new $APP.l(null,8,[Aje,$APP.qG($APP.tG,function(a){return(0,$APP.jZc)(new $APP.l(null,2,[$APP.Iz,$APP.xa(a,"pageName"),$APP.$y,!0],null))},null,"frontend.extensions.tldraw/page-cp"),zje,$APP.qG($APP.tG,function(a){a=$APP.vh($APP.xa(a,"blockId"));var b=new $APP.l(null,2,[$APP.Nq,$APP.r.A(a),$APP.$y,!0],null),c=$APP.CK($APP.pZc);a=c.C?c.C(b,a):c.call(null,b,a);return $APP.kG(a)},null,"frontend.extensions.tldraw/block-cp"),xje,$APP.qG($APP.tG,function(a){return(0,$APP.FW)(new $APP.l(null,1,[$APP.XX,
!0],null),$APP.EJ(),$APP.vh($APP.xa(a,"blockId")),new $APP.l(null,2,[$APP.u4c,$APP.xa(a,"endSeparator"),$APP.Z_c,$APP.xa(a,"levelLimit",3)],null))},null,"frontend.extensions.tldraw/breadcrumb"),Cje,$APP.qG($APP.tG,function(a){return(0,$APP.jIc)($APP.xa(a,"tweetId"))},null,"frontend.extensions.tldraw/tweet"),Bje,$APP.qG($APP.tG,function(a){a=$APP.xa(a,"pageName");$APP.m(a)?(a=$APP.NL.A?$APP.NL.A(a):$APP.NL.call(null,a),a=$APP.m(a)?(0,$APP.$S)(new $APP.l(null,1,[$APP.XX,!0],null),a):null):a=null;return $APP.kG(a)},
null,"frontend.extensions.tldraw/page-name-link"),yje,function(a){return $APP.ff.C($APP.B8d,$APP.Zg.C(function(b){return $APP.to.G($APP.xa(a,b),$APP.G([new $APP.l(null,1,[$APP.uo,!0],null)]))},new $APP.N(null,3,5,$APP.S,["id","className","options"],null)))},Dje,$APP.qG($APP.tG,function(a){return(0,$APP.XS)($APP.Se,$APP.xa(a,"blockId"),null)},null,"frontend.extensions.tldraw/block-reference"),sje,$APP.qG($APP.tG,function(a){return $APP.kG(function(){var b=$APP.hj(a);if($APP.m(b)){var c=$APP.Te(b);
b=$APP.H.C(c,$APP.fD);var d=$APP.H.C(c,$APP.ZA);c=$APP.H.C(c,$APP.rB);b="string"===typeof b?$APP.tR($APP.$g.A(b)):d;var e=$APP.Vi.G($APP.G([new $APP.l(null,1,[$APP.N4,!1],null),c]));return"string"===typeof b?$APP.ksc(b,$APP.G([e])):$APP.ti.C(" | ",$APP.Zg.C(function(f){return $APP.ksc(f,$APP.G([e]))},b))}return null}())},null,"frontend.extensions.tldraw/keyboard-shortcut")],null);qje=$APP.kh.A(null);
Hje=$APP.qG($APP.tG,function(a,b,c,d,e){return $APP.Z("div",{style:{overscrollBehavior:"none"},onBlur:function(f){f=$APP.xa(f,"target").tagName;var g=new $APP.xg(null,new $APP.l(null,2,["INPUT",null,"TEXTAREA",null],null),null);f=g.A?g.A(f):g.call(null,f);return $APP.m(f)?$APP.nK():null},onWheel:$APP.CH,className:"draw tldraw whiteboard relative w-full h-full"},[$APP.m($APP.m(c)?$APP.ib(d):c)?$APP.Z("div",{style:{zIndex:200},className:"absolute inset-0 flex items-center justify-center"},[$APP.kG($APP.uR("Loading onboarding whiteboard ..."))]):
null,$APP.kG(function(){var f=new $APP.l(null,6,[tje,Gje,$APP.vt,pje(a),vje,e,$APP.rAd,!0,wje,function(g,h){return rje(a,g,h)},uje,b],null);return Fje.A?Fje.A(f):Fje.call(null,f)}())])},new $APP.N(null,2,5,$APP.S,[$APP.sG,new $APP.l(null,1,[$APP.Rtb,function(a,b){var c=$APP.A($APP.rG.A(a)),d=$APP.D.C($APP.rG.A(a),1),e=$APP.D.C($APP.rG.A(b),1),f=function(){var g=function(){var h=$APP.xa(d,"pages");h=null==h?null:$APP.A(h);return null==h?null:$APP.xa(h,"shapes")}();return $APP.Fg($APP.Zg.C(function(h){return $APP.xa(h,
"id")},g),g)}();a=function(){var g=$APP.xa(e,"pages");g=null==g?null:$APP.A(g);return null==g?null:$APP.xa(g,"shapes")}();a=$APP.yf.C(function(g){var h=$APP.H.C(f,$APP.xa(g,"id"));return $APP.m(h)?$APP.vg.C($APP.xa(g,"type"),$APP.xa(h,"type")):null},a);$APP.z(a)&&Rie(a);Sie(c);return b}],null)],null),"frontend.extensions.tldraw/tldraw-inner");
Ije=$APP.qG($APP.tG,function(a,b,c,d){function e(h){if($APP.m(h)){h.appUndo=Xie;h.appRedo=Yie;var n=$APP.xa(h,"api");return $APP.m(n)?$APP.An.C(f?Tie(n):null,function(){Uie(h.currentPage);$APP.eNb(h,b);return d.A?d.A(h):d.call(null,h)}):null}return null}if($APP.m($APP.YK($APP.r.A(a))))return null;var f=Qie(a),g=$APP.gqc(a);return $APP.m(g)?Hje(a,g,f,c,e):null},new $APP.N(null,2,5,$APP.S,[$APP.B8,new $APP.l(null,1,[$APP.Gw,function(a){var b=$APP.A($APP.rG.A(a));$APP.xO($APP.EJ(),b);return a}],null)],
null),"frontend.extensions.tldraw/tldraw-app-inner");$APP.y8d=$APP.qG($APP.tG,function(a,b){a=$APP.r.A(a);var c=$APP.yG(null),d=$APP.D.F(c,0,null);c=$APP.D.F(c,1,null);$APP.zG(function(){$APP.m($APP.m(d)?b:d)&&$APP.eNb(d,b);return function(){return $APP.Yb}},new $APP.N(null,2,5,$APP.S,[b,d],null));return Ije(a,b,d,c)},null,"frontend.extensions.tldraw/tldraw-app");$APP.By.Fi();
}).call(this);
//# sourceMappingURL=tldraw.js.map
